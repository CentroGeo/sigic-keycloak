import{jsx as e,jsxs as l,Fragment as H}from"react/jsx-runtime";import{as as An,ar as nt,u as Y,d as de,a as x,ak as In,e as He,j as ne,s as ma,v as ha,x as fa,bd as Ue,m as ct,F as he,K as M,ag as kt,ah as Tt,ai as Se,aj as $e,O as N,be as At,bf as Je,Z as se,N as te,_ as We,a0 as be,a$ as Ut,b0 as qt,b1 as A,Y as X,A as De,h as E,$ as Q,bg as ga,l as Pe,V as oe,M as ze,n as ke,B as me,q as J,w as It,f as Ne,T as ge,bh as ba,S as fe,P as ce,bi as Rn,G as pe,bj as Gt,bk as ya,aO as Ae,aK as va,bl as Sa,aM as Qe,bm as Ye,au as ie,aG as V,aN as Ze,aL as L,bn as jt,bo as vt,a4 as Ca,ac as xn,a1 as En,z as we,E as Me,H as ka,L as Ce,bp as Rt,bq as dt,br as wn,bs as Ta,a6 as Aa,bt as Ia,bu as Dn,bv as St,bw as Ra,a8 as Oe,bx as xa,by as Yt,aA as Bt,bz as Zt,bA as Ea,y as Le,a9 as Pn,aa as Ln,ab as wa,ad as _n,ae as Da,aH as On,b as ut,bB as ot,ax as $t,aI as Nn,aJ as Hn,D as qe,aS as pt,bC as Mn,bD as at,bE as Kn,bF as Xt,bG as en,R as rt,bH as Pa,J as xt,bI as Ct,bJ as Ge,bK as tn,bL as La,bM as _a,ay as Oa,az as nn,bN as Na,aZ as Ha,aW as Ma,bO as Ka,bP as an,bQ as Fn,bR as Fa,ba as Va,bS as sn,bT as on,b9 as za,bU as Ba,bV as Ua,bW as qa,o as Ga,p as rn,ap as ln,bX as ja}from"./main-Dml5vH_M.js";import*as it from"react";import{useState as b,useMemo as mt,useEffect as ht,Fragment as Vn,useId as $a,useRef as Xe}from"react";import{C as Jt,u as Te}from"./ConfirmDialog-BN0phSta.js";import{S as Ja,a as cn,F as re,b as Et,C as zn}from"./FormAccess-Dgk035ov.js";import{P as Wa}from"./PermissionTab-DRVls294.js";import{R as Qa}from"./RolesList-D4M15Xk_.js";import{u as ee,R as Ht}from"./RoutableTabs-D0MTj5jQ.js";import{V as Ya}from"./ViewHeader-CnGpO8mW.js";import{u as Wt}from"./useParams-Cmi1OAEj.js";import{D as ve}from"./SwitchControl-DVIXTwQM.js";import{K as Za}from"./KeyValueInput-CataZRq4.js";import{M as Bn}from"./MultiLineInput-BnUu5qtj.js";import{T as wt}from"./TimeSelector-jOZGz2AQ.js";import{s as Un}from"./sortBy-D3c44bb2.js";import{u as qn,F as Xa}from"./useFormatDate-Puc65BKQ.js";import{E as Gn}from"./ExpandableSection-CRQBD4mp.js";import{S as ei}from"./SessionsTable-DfgS4rWw.js";import{C as ti,a as ni}from"./ClientDescription-Cz5krl3V.js";import{L as ai}from"./LoginSettings-Cv6U-5ti.js";import{S as ii,a as si}from"./SamlSignature-CjZJlgs8.js";import{C as jn}from"./ClientSelect-DJq4F1jh.js";import{U as $n,D as oi,A as ri}from"./NewPolicyDialog-Diogklhm.js";import{d as Jn,i as bt,g as li}from"./utils-C-TUnOch.js";import{c as ci}from"./camelCase-CfPy5VTc.js";import{D as dn}from"./policyRepresentation-CscDyJFY.js";import{T as di,a as ui,P as un,D as lt,S as Wn,M as Qn,b as pi,A as mi}from"./Policies-Cdt9R5Am.js";import{D as ft}from"./DescriptionListTerm-DCQWux3S.js";import{C as hi}from"./CodeEditor-C7HQ48Ys.js";import{D as fi}from"./DeleteScopeDialog-CdT950ew.js";import{J as gi}from"./JsonFileUpload-BQS_emFV.js";import{D as bi}from"./DynamicComponents-Cxsqsl9R.js";import{C as Yn}from"./CopyToClipboardButton-BjKMP6CQ.js";import{F as Zn}from"./FileUpload-B3CkDAbJ.js";import{S as yi,C as vi,a as Si,n as Ci,t as ki}from"./SearchFilter-CfoaCrQT.js";import{A as pn,d as mn,e as Ti,C as hn,a as Ai,f as Ii}from"./ClientScopeTypes-DwzbyHD6.js";import{t as Ri}from"./translationFormatter-DtFomvax.js";import{u as xi,m as Ei}from"./useLocaleSort-DeXbTEE9.js";import{c as et,T as Xn,a as q,b as G}from"./Tabs-swfKYDgo.js";import{Q as wi}from"./question-circle-icon-CcYP0FMt.js";import{R as Di}from"./AddRoleMappingModal-FlNvMd3n.js";import{T as Pi}from"./Trans-BHLWmjXF.js";import{U as Li}from"./UserEvents-D0ZF_c1b.js";import{u as _i}from"./useIsAdminPermissionsClient-IDuSpu5V.js";import{A as Oi}from"./AdminEvents-BQlKf8zR.js";import"react-dom";import"./PageHandler-BQ1_55gR.js";import"./constants-BclHbWtx.js";import"./KeySelect-Ba6sDuzD.js";import"./_baseFlatten-BhRqdSvr.js";import"./filter-icon-BO7Evf9d.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./DataListItemRow-B3J1tfyO.js";import"./DatePicker-CU4S68sS.js";import"./debounce-DrUiQQ8A.js";import"./capitalize-BoQP_j-K.js";import"./_baseSlice-F8doVSIJ.js";import"./FileUploadForm-C-SwY-TA.js";import"./DropdownPanel-CdQAMxBj.js";import"./warning-triangle-icon-DjlHdM0O.js";import"./pickBy-BQkB_pck.js";const st={codeBlock:"pf-v5-c-code-block",codeBlockActions:"pf-v5-c-code-block__actions",codeBlockContent:"pf-v5-c-code-block__content",codeBlockHeader:"pf-v5-c-code-block__header"},ea=n=>{var{children:i=null,className:a,actions:t=null}=n,s=An(n,["children","className","actions"]);return it.createElement("div",Object.assign({className:nt(st.codeBlock,a)},s),t&&it.createElement("div",{className:nt(st.codeBlockHeader)},it.createElement("div",{className:nt(st.codeBlockActions)},t)),it.createElement("div",{className:nt(st.codeBlockContent)},i))};ea.displayName="CodeBlock";const ta=n=>{var{children:i=null,className:a}=n,t=An(n,["children","className"]);return it.createElement("div",Object.assign({className:nt(`${st.codeBlockActions}-item`,a)},t),i)};ta.displayName="CodeBlockAction";const Ni=({id:n,open:i,toggleDialog:a,protocol:t="openid-connect"})=>{const{adminClient:s}=Y(),{realm:o}=de(),{t:r}=x(),{enabled:d}=In(),c=He().clientInstallations[t],[m,u]=b(c[c.length-1].id),[g,h]=b(),[S,k]=b(!1),C=mt(()=>c.find(v=>v.id===m)??null,[m]),T=v=>v.replace(/<PrivateKeyPem>.*<\/PrivateKeyPem>/gs,`<PrivateKeyPem>${r("privateKeyMask")}</PrivateKeyPem>`);return ne(async()=>{if(C?.mediaType==="application/zip")return(await ma(`${fa(s.baseUrl)}admin/realms/${o}/clients/${n}/installation/providers/${m}`,{method:"GET",headers:ha(await s.getAccessToken())})).arrayBuffer();{const v=await s.clients.getInstallationProviders({id:n,providerId:m});return typeof v=="string"?T(v):Ue(v)}},v=>h(v),[n,m]),ht(()=>h(""),[n,m]),e(Jt,{titleKey:r("downloadAdaptorTitle"),continueButtonLabel:r("download"),onConfirm:()=>{Je.saveAs(new Blob([g],{type:C?.mediaType}),C?.filename)},open:i,toggleDialog:a,variant:ct.medium,children:e(he,{children:l(Ja,{hasGutter:!0,children:[e(cn,{children:e(M,{fieldId:"type",label:r("formatOption"),labelIcon:e(N,{helpText:r("downloadType"),fieldLabelId:"formatOption"}),children:e(kt,{isOpen:S,onOpenChange:v=>k(v),toggle:v=>e($e,{id:"type",ref:v,onClick:()=>k(!S),isExpanded:S,children:m}),selected:m,onSelect:(v,D)=>{u(D?.toString()||""),k(!1)},"aria-label":r("selectOne"),popperProps:{appendTo:document.body},children:e(Tt,{children:c.map(v=>e(Se,{value:v.id,isSelected:m===v.id,description:d?v.helpText:void 0,children:v.displayType},v.id))})})})}),!C?.downloadOnly&&e(cn,{isFilled:!0,children:e(M,{fieldId:"details",label:r("details"),labelIcon:e(N,{helpText:r("detailsHelp"),fieldLabelId:"details"}),children:e(At,{id:"details",readOnly:!0,rows:12,resizeOrientation:"vertical",value:g&&typeof g=="string"?g:"","aria-label":"text area example"})})})]})})})},Mt="tokenLifespan.inherited",Kt="tokenLifespan.expires",tt=({id:n,name:i,defaultValue:a,units:t})=>{const{t:s}=x(),[o,r]=b(!1),[d,p]=b(!1),c=()=>p(!0),m=()=>p(!1),{control:u}=se(),g=h=>typeof h=="number"||typeof h=="string"&&h!==""||d;return e(M,{label:s(n),fieldId:n,labelIcon:e(N,{helpText:s(`${n}Help`),fieldLabelId:n}),"data-testid":`token-lifespan-${n}`,children:e(te,{name:i,defaultValue:"",control:u,render:({field:h})=>l(We,{hasGutter:!0,children:[e(be,{children:e(kt,{toggle:S=>e($e,{ref:S,onClick:()=>r(!o),isExpanded:o,children:g(h.value)?s(Kt):s(Mt)}),isOpen:o,onOpenChange:S=>r(S),onSelect:(S,k)=>{h.onChange(k),r(!1)},selected:g(h.value)?s(Kt):s(Mt),children:l(Tt,{children:[e(Se,{value:"",children:s(Mt)}),e(Se,{value:60,children:s(Kt)})]})})}),e(be,{hidden:!g(h.value),children:e(wt,{validated:g(h.value)&&h.value<1?"warning":"default",units:t,value:h.value===""?a:h.value,onChange:h.onChange,onFocus:c,onBlur:m,min:1,isDisabled:!g(h.value)})})]})})})},Hi=({save:n,reset:i,protocol:a,hasConfigureAccess:t})=>{const{t:s}=x(),[o,r]=b(!1),{realmRepresentation:d}=de(),c=Ut()(qt.DPoP),{control:m}=se();return l(re,{role:"manage-realm",fineGrainedAccess:t,isHorizontal:!0,children:[a!=="openid-connect"&&e(M,{label:s("assertionLifespan"),fieldId:"assertionLifespan",labelIcon:e(N,{helpText:s("assertionLifespanHelp"),fieldLabelId:"assertionLifespan"}),children:e(te,{name:A("attributes.saml.assertion.lifespan"),defaultValue:"",control:m,render:({field:u})=>e(wt,{units:["minute","day","hour"],value:u.value,onChange:u.onChange})})}),a==="openid-connect"&&l(H,{children:[e(tt,{id:"accessTokenLifespan",name:A("attributes.access.token.lifespan"),defaultValue:d?.accessTokenLifespan,units:["minute","day","hour"]}),e(tt,{id:"clientSessionIdle",name:A("attributes.client.session.idle.timeout"),defaultValue:d?.clientSessionIdleTimeout,units:["minute","day","hour"]}),e(tt,{id:"clientSessionMax",name:A("attributes.client.session.max.lifespan"),defaultValue:d?.clientSessionMaxLifespan,units:["minute","day","hour"]}),e(tt,{id:"clientOfflineSessionIdle",name:A("attributes.client.offline.session.idle.timeout"),defaultValue:d?.offlineSessionIdleTimeout,units:["minute","day","hour"]}),d?.offlineSessionMaxLifespanEnabled&&e(tt,{id:"clientOfflineSessionMax",name:A("attributes.client.offline.session.max.lifespan"),defaultValue:d?.offlineSessionMaxLifespanEnabled?d.offlineSessionMaxLifespan:void 0,units:["minute","day","hour"]}),e(ve,{name:A("attributes.tls.client.certificate.bound.access.tokens"),label:s("oAuthMutual"),labelIcon:s("oAuthMutualHelp"),stringify:!0}),c&&e(ve,{name:A("attributes.dpop.bound.access.tokens"),label:s("oAuthDPoP"),labelIcon:s("oAuthDPoPHelp"),stringify:!0}),e(M,{label:s("keyForCodeExchange"),fieldId:"keyForCodeExchange",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:s("keyForCodeExchangeHelp"),fieldLabelId:"keyForCodeExchange"}),children:e(te,{name:A("attributes.pkce.code.challenge.method"),defaultValue:"",control:m,render:({field:u})=>e(kt,{toggle:g=>e($e,{id:"keyForCodeExchange",ref:g,onClick:()=>r(!o),isExpanded:o,children:[u.value||s("choose")]}),isOpen:o,onOpenChange:g=>r(g),onSelect:(g,h)=>{u.onChange(h),r(!1)},selected:u.value,children:e(Tt,{children:["","S256","plain"].map(g=>e(Se,{value:g,children:g||s("choose")},g))})})})}),e(ve,{name:A("attributes.require.pushed.authorization.requests"),label:s("pushedAuthorizationRequestRequired"),labelIcon:s("pushedAuthorizationRequestRequiredHelp"),stringify:!0}),e(ve,{name:A("attributes.client.use.lightweight.access.token.enabled"),label:s("lightweightAccessToken"),labelIcon:s("lightweightAccessTokenHelp"),stringify:!0}),e(ve,{name:A("attributes.client.introspection.response.allow.jwt.claim.enabled"),label:s("supportJwtClaimInIntrospectionResponse"),labelIcon:s("supportJwtClaimInIntrospectionResponseHelp"),stringify:!0}),e(M,{label:s("acrToLoAMapping"),fieldId:"acrToLoAMapping",labelIcon:e(N,{helpText:s("acrToLoAMappingHelp"),fieldLabelId:"acrToLoAMapping"}),children:e(Za,{label:s("acrToLoAMapping"),name:A("attributes.acr.loa.map")})}),e(M,{label:s("defaultACRValues"),fieldId:"defaultACRValues",labelIcon:e(N,{helpText:s("defaultACRValuesHelp"),fieldLabelId:"defaultACRValues"}),children:e(Bn,{id:"defaultACRValues","aria-label":"defaultACRValues",name:A("attributes.default.acr.values"),stringify:!0})}),e(X,{type:"text",name:A("attributes.minimum.acr.value"),label:s("minimumACRValue"),labelIcon:s("minimumACRValueHelp")})]}),l(De,{children:[e(E,{variant:"secondary",onClick:n,"data-testid":"OIDCAdvancedSave",children:s("save")}),e(E,{variant:"link",onClick:i,"data-testid":"OIDCAdvancedRevert",children:s("revert")})]})]})},Mi=({protocol:n,save:i,reset:a,hasConfigureAccess:t})=>{const{adminClient:s}=Y(),{t:o}=x(),[r,d]=b([]);return ne(()=>s.authenticationManagement.getFlows(),p=>{let c=[...p.filter(m=>m.providerId!=="client-flow")];c=Un(c,[m=>m.alias]),d(c)},[]),l(re,{role:"manage-clients",fineGrainedAccess:t,isHorizontal:!0,children:[e(Q,{name:"authenticationFlowBindingOverrides.browser",label:o("browserFlow"),labelIcon:o("browserFlowHelp"),controller:{defaultValue:""},options:[{key:"",value:o("choose")},...r.map(({id:p,alias:c})=>({key:p,value:c}))]}),n==="openid-connect"&&e(Q,{name:"authenticationFlowBindingOverrides.direct_grant",label:o("directGrant"),labelIcon:o("directGrantHelp"),controller:{defaultValue:""},options:[{key:"",value:o("choose")},...r.map(({id:p,alias:c})=>({key:p,value:c}))]}),l(De,{children:[e(E,{variant:"secondary",onClick:i,"data-testid":"OIDCAuthFlowOverrideSave",children:o("save")}),e(E,{variant:"link",onClick:a,"data-testid":"OIDCAuthFlowOverrideRevert",children:o("revert")})]})]})},Ki=n=>{const{field:i}=ga(n);return e(wt,{...n,...i})},Fi=({clientId:n,isOpen:i,onAdded:a,onClose:t})=>{const{adminClient:s}=Y(),{t:o}=x(),r=Pe(),{handleSubmit:d,formState:{isDirty:p,isValid:c}}=r,{addAlert:m,addError:u}=oe();async function g({node:h}){try{await s.clients.addClusterNode({id:n,node:h}),a(h),m(o("addedNodeSuccess"),J.success)}catch(S){u("addedNodeFail",S)}t()}return e(ze,{title:o("addNode"),isOpen:i,onClose:t,variant:"small",actions:[e(E,{id:"add-node-confirm",type:"submit",form:"add-host-form",isDisabled:!p||!c,children:o("save")},"confirm"),e(E,{id:"add-node-cancel",variant:me.link,onClick:t,children:o("cancel")},"cancel")],children:e(ke,{...r,children:e(he,{id:"add-host-form",onSubmit:d(g),isHorizontal:!0,children:e(X,{name:"node",label:o("nodeHost"),rules:{required:o("required")}})})})})},Vi=({save:n,client:{id:i,registeredNodes:a,access:t}})=>{const{adminClient:s}=Y(),{t:o}=x(),{addAlert:r,addError:d}=oe(),p=qn(),[c,m]=b(a||{}),[u,g]=b(!1),[h,S]=b(""),[k,C]=b(!1),[T,v]=b(0),D=()=>v(new Date().getTime()),z=async()=>{const I=await s.clients.testNodesAvailable({id:i});qi(I,"testCluster",r,o)},[B,_]=Te({titleKey:"deleteNode",messageKey:o("deleteNodeBody",{node:h}),continueButtonLabel:"delete",continueButtonVariant:me.danger,onConfirm:async()=>{try{await s.clients.deleteClusterNode({id:i,node:h}),m({...Object.keys(c).reduce((I,F)=>(F!==h&&(I[F]=c[F]),I),{})}),D(),r(o("deleteNodeSuccess"),J.success)}catch(I){d("deleteNodeFail",I)}}});return l(H,{children:[e(re,{role:"manage-clients",fineGrainedAccess:t?.configure,isHorizontal:!0,children:e(M,{label:o("nodeReRegistrationTimeout"),fieldId:"kc-node-reregistration-timeout",labelIcon:e(N,{helpText:o("nodeReRegistrationTimeoutHelp"),fieldLabelId:"nodeReRegistrationTimeout"}),children:l(We,{hasGutter:!0,children:[e(be,{children:e(Ki,{name:"nodeReRegistrationTimeout"})}),e(be,{children:e(E,{variant:me.secondary,onClick:()=>n(),children:o("save")})})]})})}),l(H,{children:[e(_,{}),e(Fi,{clientId:i,isOpen:k,onAdded:I=>{c[I]=Date.now()/1e3,D()},onClose:()=>C(!1)}),e(Gn,{toggleText:o("registeredClusterNodes"),onToggle:(I,F)=>g(F),isExpanded:u,children:e(It,{ariaLabelKey:"registeredClusterNodes",loader:()=>Promise.resolve(Object.entries(c||{}).map(I=>({host:I[0],registration:I[1]}))),toolbarItem:l(H,{children:[e(ge,{children:e(E,{id:"testClusterAvailability","data-testid":"test-cluster-availability",onClick:z,variant:me.secondary,isDisabled:Object.keys(c).length===0,children:o("testClusterAvailability")})}),e(ge,{children:e(E,{id:"registerNodeManually","data-testid":"registerNodeManually",onClick:()=>C(!0),variant:me.tertiary,children:o("registerNodeManually")})})]}),actions:[{title:o("delete"),onRowClick:I=>{S(I.host),B()}}],columns:[{name:"host",displayKey:"nodeHost"},{name:"registration",displayKey:"lastRegistration",cellFormatters:[I=>I?p(new Date(parseInt(I.toString())*1e3),Xa):""]}],emptyState:e(Ne,{message:o("noNodes"),instructions:o("noNodesInstructions"),primaryActionText:o("registerNodeManually"),onPrimaryAction:()=>C(!0)})},T)})]})]})},na=n=>{const{t:i}=x();return l(H,{children:[e(X,{name:"attributes.logoUri",label:i("logoUrl"),labelIcon:i("logoUrlHelp"),type:"url",...n}),e(X,{name:"attributes.policyUri",label:i("policyUrl"),labelIcon:i("policyUrlHelp"),type:"url",...n}),e(X,{name:"attributes.tosUri",label:i("termsOfServiceUrl"),labelIcon:i("termsOfServiceUrlHelp"),type:"url",...n})]})},zi=({save:n,reset:i,hasConfigureAccess:a})=>{const{t}=x(),{control:s}=se(),o=He().providers,r=o?.clientSignature.providers,d=o?.contentencryption.providers,p=o?.cekmanagement.providers,c=o?.signature.providers,m=S=>ba(S).map(k=>({key:k,value:k})),u=S=>[{key:"",value:t("choose")},...m(S)],g=S=>[{key:"any",value:t("any")},...m(S)],h=S=>[{key:"none",value:t("none")},...m(S)];return l(re,{role:"manage-clients",fineGrainedAccess:a,isHorizontal:!0,children:[e(na,{}),e(Q,{name:A("attributes.access.token.signed.response.alg"),label:t("accessTokenSignatureAlgorithm"),labelIcon:t("accessTokenSignatureAlgorithmHelp"),controller:{defaultValue:""},options:u(r)}),e(M,{label:t("useRfc9068AccessTokenType"),fieldId:"useRfc9068AccessTokenType",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("useRfc9068AccessTokenTypeHelp"),fieldLabelId:"useRfc9068AccessTokenType"}),children:e(te,{name:A("attributes.access.token.header.type.rfc9068"),defaultValue:"false",control:s,render:({field:S})=>e(fe,{id:"useRfc9068AccessTokenType",label:t("on"),labelOff:t("off"),isChecked:S.value==="true",onChange:(k,C)=>S.onChange(C.toString()),"aria-label":t("useRfc9068AccessTokenType")})})}),e(Q,{name:A("attributes.id.token.signed.response.alg"),label:t("idTokenSignatureAlgorithm"),labelIcon:t("idTokenSignatureAlgorithmHelp"),controller:{defaultValue:""},options:u(r)}),e(Q,{name:A("attributes.id.token.encrypted.response.alg"),label:t("idTokenEncryptionKeyManagementAlgorithm"),labelIcon:t("idTokenEncryptionKeyManagementAlgorithmHelp"),controller:{defaultValue:""},options:u(p)}),e(Q,{name:A("attributes.id.token.encrypted.response.enc"),label:t("idTokenEncryptionContentEncryptionAlgorithm"),labelIcon:t("idTokenEncryptionContentEncryptionAlgorithmHelp"),controller:{defaultValue:""},options:u(d)}),e(Q,{name:A("attributes.user.info.response.signature.alg"),label:t("userInfoSignedResponseAlgorithm"),labelIcon:t("userInfoSignedResponseAlgorithmHelp"),controller:{defaultValue:""},options:u(c)}),e(Q,{name:A("attributes.user.info.encrypted.response.alg"),label:t("userInfoResponseEncryptionKeyManagementAlgorithm"),labelIcon:t("userInfoResponseEncryptionKeyManagementAlgorithmHelp"),controller:{defaultValue:""},options:u(p)}),e(Q,{name:A("attributes.user.info.encrypted.response.enc"),label:t("userInfoResponseEncryptionContentEncryptionAlgorithm"),labelIcon:t("userInfoResponseEncryptionContentEncryptionAlgorithmHelp"),controller:{defaultValue:""},options:u(d)}),e(Q,{name:A("attributes.request.object.signature.alg"),label:t("requestObjectSignatureAlgorithm"),labelIcon:t("requestObjectSignatureAlgorithmHelp"),controller:{defaultValue:"any"},options:[{key:"any",value:t("any")},...h(r)]}),e(Q,{name:A("attributes.request.object.encryption.alg"),label:t("requestObjectEncryption"),labelIcon:t("requestObjectEncryptionHelp"),controller:{defaultValue:"any"},options:g(p)}),e(Q,{name:A("attributes.request.object.encryption.enc"),label:t("requestObjectEncoding"),labelIcon:t("requestObjectEncodingHelp"),controller:{defaultValue:"any"},options:g(d)}),e(Q,{name:A("attributes.request.object.required"),label:t("requestObjectRequired"),labelIcon:t("requestObjectRequiredHelp"),controller:{defaultValue:"not required"},options:["not required","request or request_uri","request only","request_uri only"].map(S=>({key:S,value:t(`requestObject.${S}`)}))}),e(M,{label:t("validRequestURIs"),fieldId:"validRequestURIs",labelIcon:e(N,{helpText:t("validRequestURIsHelp"),fieldLabelId:"validRequestURIs"}),children:e(Bn,{name:A("attributes.request.uris"),"aria-label":t("validRequestURIs"),addButtonLabel:"addRequestUri",stringify:!0})}),e(Q,{name:A("attributes.authorization.signed.response.alg"),label:t("authorizationSignedResponseAlg"),labelIcon:t("authorizationSignedResponseAlgHelp"),controller:{defaultValue:""},options:u(c)}),e(Q,{name:A("attributes.authorization.encrypted.response.alg"),label:t("authorizationEncryptedResponseAlg"),labelIcon:t("authorizationEncryptedResponseAlgHelp"),controller:{defaultValue:""},options:u(p)}),e(Q,{name:A("attributes.authorization.encrypted.response.enc"),label:t("authorizationEncryptedResponseEnc"),labelIcon:t("authorizationEncryptedResponseEncHelp"),controller:{defaultValue:""},options:u(d)}),l(De,{children:[e(E,{variant:"secondary",id:"fineGrainSave","data-testid":"fineGrainSave",onClick:n,children:t("save")}),e(E,{id:"fineGrainRevert","data-testid":"fineGrainRevert",variant:"link",onClick:i,children:t("revert")})]})]})},Bi=({save:n,reset:i})=>{const{t:a}=x();return l(re,{role:"manage-realm",isHorizontal:!0,children:[e(na,{}),e(X,{name:"attributes.saml_assertion_consumer_url_post",label:a("assertionConsumerServicePostBindingURL"),labelIcon:a("assertionConsumerServicePostBindingURLHelp"),type:"url"}),e(X,{name:"attributes.saml_assertion_consumer_url_redirect",label:a("assertionConsumerServiceRedirectBindingURL"),labelIcon:a("assertionConsumerServiceRedirectBindingURLHelp"),type:"url"}),e(X,{name:"attributes.saml_single_logout_service_url_post",label:a("logoutServicePostBindingURL"),labelIcon:a("logoutServicePostBindingURLHelp"),type:"url"}),e(X,{name:"attributes.saml_single_logout_service_url_redirect",label:a("logoutServiceRedirectBindingURL"),labelIcon:a("logoutServiceRedirectBindingURLHelp"),type:"url"}),e(X,{name:"attributes.saml_single_logout_service_url_soap",label:a("logoutServiceSoapBindingUrl"),labelIcon:a("logoutServiceSoapBindingUrlHelp"),type:"url"}),e(X,{name:"attributes.saml_single_logout_service_url_artifact",label:a("logoutServiceArtifactBindingUrl"),labelIcon:a("logoutServiceArtifactBindingUrlHelp"),type:"url"}),e(X,{name:"attributes.saml_artifact_binding_url",label:a("artifactBindingUrl"),labelIcon:a("artifactBindingUrlHelp"),type:"url"}),e(X,{name:"attributes.saml_artifact_resolution_service_url",label:a("artifactResolutionService"),labelIcon:a("artifactResolutionServiceHelp"),type:"url"}),l(De,{children:[e(E,{variant:"tertiary",onClick:n,"data-testid":"fineGrainSave",children:a("save")}),e(E,{variant:"link",onClick:i,"data-testid":"fineGrainRevert",children:a("revert")})]})]})},Ui=({save:n,reset:i,hasConfigureAccess:a})=>{const{t}=x(),{control:s,watch:o}=se(),r=Ut(),d=o(A("attributes.standard.token.exchange.enabled")),p=o(A("attributes.use.refresh.tokens"),"true");return l(re,{role:"manage-clients",fineGrainedAccess:a,isHorizontal:!0,children:[e(M,{label:t("excludeSessionStateFromAuthenticationResponse"),fieldId:"excludeSessionStateFromAuthenticationResponse",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("excludeSessionStateFromAuthenticationResponseHelp"),fieldLabelId:"excludeSessionStateFromAuthenticationResponse"}),children:e(te,{name:A("attributes.exclude.session.state.from.auth.response"),defaultValue:"",control:s,render:({field:c})=>e(fe,{id:"excludeSessionStateFromAuthenticationResponse-switch",label:t("on"),labelOff:t("off"),isChecked:c.value==="true",onChange:(m,u)=>c.onChange(u.toString()),"aria-label":t("excludeSessionStateFromAuthenticationResponse")})})}),e(M,{label:t("excludeIssuerFromAuthenticationResponse"),fieldId:"excludeIssuerFromAuthenticationResponse",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("excludeIssuerFromAuthenticationResponseHelp"),fieldLabelId:"excludeIssuerFromAuthenticationResponse"}),children:e(te,{name:A("attributes.exclude.issuer.from.auth.response"),defaultValue:"",control:s,render:({field:c})=>e(fe,{id:"excludeIssuerFromAuthenticationResponse-switch",label:t("on"),labelOff:t("off"),isChecked:c.value==="true",onChange:(m,u)=>c.onChange(u.toString()),"aria-label":t("excludeIssuerFromAuthenticationResponse")})})}),e(M,{label:t("useRefreshTokens"),fieldId:"useRefreshTokens",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("useRefreshTokensHelp"),fieldLabelId:"useRefreshTokens"}),children:e(te,{name:A("attributes.use.refresh.tokens"),defaultValue:"true",control:s,render:({field:c})=>e(fe,{id:"useRefreshTokens",label:t("on"),labelOff:t("off"),isChecked:c.value==="true",onChange:(m,u)=>c.onChange(u.toString()),"aria-label":t("useRefreshTokens")})})}),e(M,{label:t("useRefreshTokenForClientCredentialsGrant"),fieldId:"useRefreshTokenForClientCredentialsGrant",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("useRefreshTokenForClientCredentialsGrantHelp"),fieldLabelId:"useRefreshTokenForClientCredentialsGrant"}),children:e(te,{name:A("attributes.client_credentials.use_refresh_token"),defaultValue:"false",control:s,render:({field:c})=>e(fe,{id:"useRefreshTokenForClientCredentialsGrant",label:t("on"),labelOff:t("off"),isChecked:c.value==="true",onChange:(m,u)=>c.onChange(u.toString()),"aria-label":t("useRefreshTokenForClientCredentialsGrant")})})}),e(M,{label:t("useLowerCaseBearerType"),fieldId:"useLowerCaseBearerType",hasNoPaddingTop:!0,labelIcon:e(N,{helpText:t("useLowerCaseBearerTypeHelp"),fieldLabelId:"useLowerCaseBearerType"}),children:e(te,{name:A("attributes.token.response.type.bearer.lower-case"),defaultValue:"false",control:s,render:({field:c})=>e(fe,{id:"useLowerCaseBearerType",label:t("on"),labelOff:t("off"),isChecked:c.value==="true",onChange:(m,u)=>c.onChange(u.toString()),"aria-label":t("useLowerCaseBearerType")})})}),r(qt.StandardTokenExchangeV2)&&e(Q,{name:A("attributes.standard.token.exchange.enableRefreshRequestedTokenType"),label:t("enableRefreshRequestedTokenType"),labelIcon:t("enableRefreshRequestedTokenTypeHelp"),controller:{defaultValue:""},isDisabled:d?.toString()!=="true"||p?.toString()!=="true",options:[{key:"",value:t("choose")},{key:"NO",value:t("no")},{key:"SAME_SESSION",value:t("sameSession")}]}),l(De,{children:[e(E,{variant:"secondary",onClick:n,"data-testid":"OIDCCompatabilitySave",children:t("save")}),e(E,{variant:"link",onClick:i,"data-testid":"OIDCCompatabilityRevert",children:t("revert")})]})]})},qi=(n,i,a,t)=>{const s=n.successRequests?.length||0,o=n.failedRequests?.length||0;s===0&&o===0?a(t("noAdminUrlSet"),J.warning):o>0?(a(t(i+"Success",{successNodes:n.successRequests}),J.success),a(t(i+"Fail",{failedNodes:n.failedRequests}),J.danger)):a(t(i+"Success",{successNodes:n.successRequests}),J.success)},Gi=({save:n,client:i})=>{const{t:a}=x(),t="openid-connect",{setValue:s}=se(),{publicClient:o,attributes:r,protocol:d,authenticationFlowBindingOverrides:p}=i,c=m=>{for(const u of m)s(A(`attributes.${u}`),r?.[u]||"")};return e(ce,{variant:"light",className:"pf-v5-u-py-0",children:e(Rn,{label:a("jumpToSection"),sections:[{title:a("clustering"),isHidden:!o,panel:e(Vi,{client:i,save:n})},{title:a("fineGrainOpenIdConnectConfiguration"),isHidden:d!==t,panel:l(H,{children:[e(pe,{className:"pf-v5-u-pb-lg",children:a("fineGrainOpenIdConnectConfigurationHelp")}),e(zi,{save:n,reset:()=>{c(["logoUri","policyUri","tosUri","access.token.signed.response.alg","access.token.header.type.rfc9068","id.token.signed.response.alg","id.token.encrypted.response.alg","id.token.encrypted.response.enc","user.info.response.signature.alg","user.info.encrypted.response.alg","user.info.encrypted.response.enc","request.object.signature.alg","request.object.encryption.alg","request.object.encryption.enc","request.object.required","request.uris","authorization.signed.response.alg","authorization.encrypted.response.alg","authorization.encrypted.response.enc"])}})]})},{title:a("openIdConnectCompatibilityModes"),isHidden:d!==t,panel:l(H,{children:[e(pe,{className:"pf-v5-u-pb-lg",children:a("openIdConnectCompatibilityModesHelp")}),e(Ui,{save:()=>n(),reset:()=>c(["exclude.session.state.from.auth.response","use.refresh.tokens","client_credentials.use_refresh_token","token.response.type.bearer.lower-case"])})]})},{title:a("fineGrainSamlEndpointConfig"),isHidden:d===t,panel:l(H,{children:[e(pe,{className:"pf-v5-u-pb-lg",children:a("fineGrainSamlEndpointConfigHelp")}),e(Bi,{save:()=>n(),reset:()=>c(["logoUri","policyUri","tosUri","saml_assertion_consumer_url_post","saml_assertion_consumer_url_redirect","saml_single_logout_service_url_post","saml_single_logout_service_url_redirect","saml_single_logout_service_url_artifact","saml_artifact_binding_url","saml_artifact_resolution_service_url"])})]})},{title:a("advancedSettings"),panel:l(H,{children:[e(pe,{className:"pf-v5-u-pb-lg",children:a("advancedSettings"+Gt(d||""))}),e(Hi,{protocol:d,save:()=>n(),reset:()=>{c(["saml.assertion.lifespan","access.token.lifespan","session.idle.timeout","client.session.max.lifespan","client.offline.session.idle.timeout","client.offline.session.max.lifespan","dpop.bound.access.tokens","tls.client.certificate.bound.access.tokens","require.pushed.authorization.requests","client.use.lightweight.access.token.enabled","client.introspection.response.allow.jwt.claim.enabled","pkce.code.challenge.method","acr.loa.map","default.acr.values","minimum.acr.value"])}})]})},{title:a("authenticationOverrides"),panel:l(H,{children:[e(pe,{className:"pf-v5-u-pb-lg",children:a("authenticationOverridesHelp")}),e(Mi,{protocol:d,save:()=>n(),reset:()=>{s("authenticationFlowBindingOverrides.browser",p?.browser),s("authenticationFlowBindingOverrides.direct_grant",p?.direct_grant)}})]})}],borders:!0})})},ji=({client:n})=>{const{adminClient:i}=Y(),{t:a}=x();return e(ce,{variant:"light",className:"pf-v5-u-p-0",children:e(ei,{loader:async(s,o,r)=>ya(i,"ui-ext/sessions/client",{first:`${s}`,max:`${o}`,type:"ALL",clientId:n.id,search:r||""}),hiddenColumns:["clients"],emptyInstructions:a("noSessionsForClient")})})},$i=({client:n,save:i,reset:a})=>{const{t}=x(),{watch:s}=se(),{hasAccess:o}=Ae(),r=o("manage-clients")||n.access?.configure,d=s("protocol");return l(re,{isHorizontal:!0,fineGrainedAccess:n.access?.configure,role:"manage-clients",children:[!n.bearerOnly&&e(ai,{protocol:d}),d!=="saml"&&e(X,{type:"url",name:"adminUrl",label:t("adminURL"),labelIcon:t("adminURLHelp")}),n.bearerOnly&&e(Et,{name:"settings",save:i,reset:a,isDisabled:r})]})},Ji=({access:n})=>{const{t:i}=x(),{watch:a}=se(),t=He().themes.login,s=a("consentRequired"),o=a(A("attributes.display.on.consent.screen"));return l(re,{isHorizontal:!0,fineGrainedAccess:n,role:"manage-clients",children:[e(Q,{name:"attributes.login_theme",label:i("loginTheme"),labelIcon:i("loginThemeHelp"),controller:{defaultValue:""},options:[{key:"",value:i("choose")},...t.map(({name:r})=>({key:r,value:r}))]}),e(ve,{name:"consentRequired",label:i("consentRequired"),labelIcon:i("consentRequiredHelp")}),e(ve,{name:A("attributes.display.on.consent.screen"),label:i("displayOnClient"),labelIcon:i("displayOnClientHelp"),isDisabled:!s,stringify:!0}),e(va,{name:A("attributes.consent.screen.text"),label:i("consentScreenText"),labelIcon:i("consentScreenTextHelp"),isDisabled:!(s&&o==="true")})]})},fn=(n,i)=>(n?.startsWith("https://")||n?.startsWith("http://"))&&!n.includes("*")||n===""||i,Wi=({save:n,reset:i,client:{access:a}})=>{const{t}=x(),{control:s,watch:o}=se(),{hasAccess:r}=Ae(),d=r("manage-clients")||a?.configure,p=o("protocol"),c=o("frontchannelLogout"),m=p==="openid-connect"?"frontchannelLogoutOIDCHelp":"frontchannelLogoutHelp";return l(re,{isHorizontal:!0,fineGrainedAccess:a?.configure,role:"manage-clients",children:[e(M,{label:t("frontchannelLogout"),labelIcon:e(N,{helpText:t(m),fieldLabelId:"frontchannelLogout"}),fieldId:"kc-frontchannelLogout",hasNoPaddingTop:!0,children:e(te,{name:"frontchannelLogout",defaultValue:!0,control:s,render:({field:u})=>e(fe,{id:"kc-frontchannelLogout-switch",label:t("on"),labelOff:t("off"),isChecked:u.value,onChange:u.onChange,"aria-label":t("frontchannelLogout")})})}),p==="openid-connect"&&c&&e(X,{"data-testid":"frontchannelLogoutUrl",type:"url",name:A("attributes.frontchannel.logout.url"),label:t("frontchannelLogoutUrl"),labelIcon:t("frontchannelLogoutUrlHelp"),rules:{validate:u=>fn(u,t("frontchannelUrlInvalid").toString())}}),p==="openid-connect"&&c&&e(ve,{name:A("attributes.frontchannel.logout.session.required"),defaultValue:"true",label:t("frontchannelLogoutSessionRequired"),labelIcon:t("frontchannelLogoutSessionRequiredHelp"),stringify:!0}),p==="openid-connect"&&!c&&l(H,{children:[e(X,{"data-testid":"backchannelLogoutUrl",type:"url",name:A("attributes.backchannel.logout.url"),label:t("backchannelLogoutUrl"),labelIcon:t("backchannelLogoutUrlHelp"),rules:{validate:u=>fn(u,t("backchannelUrlInvalid").toString())}}),e(M,{label:t("backchannelLogoutSessionRequired"),labelIcon:e(N,{helpText:t("backchannelLogoutSessionRequiredHelp"),fieldLabelId:"backchannelLogoutSessionRequired"}),fieldId:"backchannelLogoutSessionRequired",hasNoPaddingTop:!0,children:e(te,{name:A("attributes.backchannel.logout.session.required"),defaultValue:"true",control:s,render:({field:u})=>e(fe,{id:"backchannelLogoutSessionRequired",label:t("on"),labelOff:t("off"),isChecked:u.value==="true",onChange:(g,h)=>u.onChange(h.toString()),"aria-label":t("backchannelLogoutSessionRequired")})})}),e(M,{label:t("backchannelLogoutRevokeOfflineSessions"),labelIcon:e(N,{helpText:t("backchannelLogoutRevokeOfflineSessionsHelp"),fieldLabelId:"backchannelLogoutRevokeOfflineSessions"}),fieldId:"backchannelLogoutRevokeOfflineSessions",hasNoPaddingTop:!0,children:e(te,{name:A("attributes.backchannel.logout.revoke.offline.tokens"),defaultValue:"false",control:s,render:({field:u})=>e(fe,{id:"backchannelLogoutRevokeOfflineSessions",label:t("on"),labelOff:t("off"),isChecked:u.value==="true",onChange:(g,h)=>u.onChange(h.toString()),"aria-label":t("backchannelLogoutRevokeOfflineSessions")})})})]}),e(Et,{name:"settings",save:n,reset:i,isDisabled:!d})]})},Qi=n=>{const{t:i}=x(),{watch:a}=se(),t=a("protocol"),{client:s}=n;return e(Rn,{label:i("jumpToSection"),className:"pf-v5-u-px-lg pf-v5-u-pb-lg",sections:[{title:i("generalSettings"),panel:e(he,{isHorizontal:!0,children:e(ti,{protocol:s.protocol,hasConfigureAccess:s.access?.configure})})},{title:i("accessSettings"),panel:e($i,{...n})},{title:i("samlCapabilityConfig"),isHidden:t!=="saml"||s.bearerOnly,panel:e(ii,{})},{title:i("signatureAndEncryption"),isHidden:t!=="saml"||s.bearerOnly,panel:e(si,{})},{title:i("capabilityConfig"),isHidden:t!=="openid-connect"||s.bearerOnly,panel:e(ni,{})},{title:i("loginSettings"),isHidden:s.bearerOnly,panel:e(Ji,{access:s.access?.configure})},{title:i("logoutSettings"),isHidden:s.bearerOnly,panel:e(Wi,{...n})}]})},Yi=({name:n,rowIndex:i,attribute:a,selectableValues:t,resources:s})=>{const{t:o}=x(),{control:r,register:d,getValues:p}=se(),[c,m]=b([!1]),u=(k,C)=>{const T=[...c];T[k]=C,m(T)},g=mt(()=>{let k=[];return t&&(k=Jn.find(C=>C.key===p().context?.[i]?.key)?.values),k},[p]),h=()=>{const k=s?.find(C=>C.name===p().resources?.[i]?.key)?.scopes;if(g?.length&&!s)return g.map(C=>e(Se,{value:C.key,children:C.name},C.key));if(k?.length)return k.map(C=>e(Se,{value:C.name,children:C.name},C.name))},S=k=>ci(k).replace(/\W/g,"");return e(L,{children:s||g?.length?e(te,{name:`${n}.${i}.value`,defaultValue:[],control:r,render:({field:k})=>e(jt,{toggleId:`${a.id}-value`,className:"kc-attribute-value-selectable",chipGroupProps:{numChips:1,expandedText:o("hide"),collapsedText:o("showRemaining")},onToggle:C=>u(i,C),isOpen:c[i],variant:vt.typeahead,typeAheadAriaLabel:o("selectOrTypeAKey"),placeholderText:o("selectOrTypeAKey"),selections:k.value,onSelect:C=>{k.onChange(C),u(i,!1)},children:h()})}):e(En,{id:`${S(a.key)}-value`,className:"value-input",defaultValue:a.value,"data-testid":"attribute-value-input","aria-label":o("value"),...d(`${n}.${i}.value`)})})},gn=({name:n,selectableValues:i,resources:a})=>{const{t}=x(),{control:s,watch:o}=se(),{fields:r,append:d,remove:p}=Sa({control:s,name:n}),[c,m]=b([!1]),u=(h,S)=>{const k=[...c];k[h]=S,m(k)};ht(()=>{r.length||d({key:"",value:""},{shouldFocus:!1})},[r]);const g=o(`${n}.${r.length-1}.value`,"");return l(Qe,{className:"kc-attributes__table","aria-label":"Role attribute keys and values",variant:"compact",children:[e(Ye,{children:l(ie,{children:[e(V,{width:40,children:t("key")}),e(V,{width:40,children:t("value")})]})}),l(Ze,{children:[r.map((h,S)=>l(ie,{"data-testid":"attribute-row",children:[e(L,{children:e(te,{name:`${n}.${S}.key`,defaultValue:"",control:s,render:({field:k})=>e(jt,{toggleId:`${n}.${S}.key`,className:"kc-attribute-key-selectable",onToggle:C=>u(S,C),isOpen:c[S],variant:vt.typeahead,typeAheadAriaLabel:t("selectOrTypeAKey"),placeholderText:t("selectOrTypeAKey"),selections:k.value,onSelect:C=>{k.onChange(C.toString()),u(S,!1)},children:i?.map(C=>e(Se,{selected:C.name===k.value,value:a?C.name:C.key,children:C.name},C.key))})})}),e(Yi,{name:n,attribute:h,rowIndex:S,selectableValues:i,resources:a}),e(L,{children:e(E,{id:`${n}-minus-button-${S}`,variant:"link",className:"kc-attributes__minus-icon",onClick:()=>p(S),"aria-label":t("remove"),children:e(Ca,{})})})]},h.id)),e(ie,{children:e(L,{children:e(E,{"aria-label":t("addAttribute",{label:t("attribute")}),id:`${n}-plus-icon`,variant:"link",className:"kc-attributes__plus-icon",onClick:()=>{d({key:"",value:""}),m([...c,!1])},icon:e(xn,{}),isDisabled:!g,"data-testid":"attribute-add-row",children:t("addAttribute",{label:t("attribute")})})})})]})]})},Zi=({data:n})=>{const{t:i}=x(),[a,t]=we();return l(H,{children:[e(E,{"data-testid":"authorization-revert",onClick:t,variant:"secondary",children:i("showAuthData")}),e(ze,{variant:ct.medium,isOpen:a,"aria-label":i("authData"),header:l(Me,{children:[e(pe,{component:ka.h1,children:i("authData")}),e(pe,{children:i("authDataDescription")})]}),onClose:t,actions:[e(E,{"data-testid":"cancel",id:"modal-cancel",onClick:t,children:i("cancel")},"cancel")],children:e(At,{readOnly:!0,rows:20,value:Ue(n)})})]})},Xi=({idx:n,rowIndex:i,outerPolicy:a,resource:t})=>{const[s,o]=b(!1),{t:r}=x(),{realm:d}=de(),{clientId:p}=Wt();return l(Ze,{isExpanded:s,children:[l(ie,{children:[e(L,{expand:{rowIndex:i,isExpanded:s,onToggle:()=>o(c=>!c)}}),e(L,{"data-testid":`name-column-${t.resource}`,children:e(Ce,{to:Rt({realm:d,id:p,permissionType:a.policy?.type,permissionId:a.policy?.id}),children:a.policy?.name})}),e(L,{id:a.status?.toLowerCase(),children:r(a.status?.toLowerCase())}),e(L,{children:r(`${a.policy?.decisionStrategy?.toLowerCase()}`)}),e(L,{children:a.status===dn.Permit?t.policies?.[i]?.scopes?.join(", "):"-"}),e(L,{children:a.status===dn.Deny&&t.policies?.[i]?.scopes?.length?t.policies[i].scopes?.join(", "):"-"})]}),l(ie,{isExpanded:s,children:[e(L,{}),e(L,{colSpan:5,children:s&&e(dt,{children:e(ft,{isHorizontal:!0,className:"keycloak_resource_details",children:e(Me,{children:e(di,{children:a.associatedPolicies?.map(c=>l(ui,{children:[e(Ce,{to:wn({realm:d,id:p,policyType:c.policy?.type,policyId:c.policy?.id}),children:c.policy?.name})," ",r("votedToStatus",{status:Ta(c.status)})]},"policyDetails"))})})})})})]},`child-${t.resource}`)]},n)},es=({rowIndex:n,resource:i,evaluateResults:a})=>{const[t,s]=b(!1),{t:o}=x();return l(Ze,{isExpanded:t,children:[l(ie,{children:[e(L,{expand:{rowIndex:n,isExpanded:t,onToggle:()=>s(r=>!r)}}),e(L,{"data-testid":`name-column-${i.resource}`,children:i.resource?.name}),e(L,{id:i.status?.toLowerCase(),children:o(`${i.status?.toLowerCase()}`)}),e(L,{children:i.allowedScopes?.length?i.allowedScopes.map(r=>r.name):"-"})]}),l(ie,{isExpanded:t,children:[e(L,{}),e(L,{colSpan:5,children:e(dt,{children:t&&e(ft,{isHorizontal:!0,className:"keycloak_resource_details",children:l(Qe,{"aria-label":o("evaluationResults"),children:[e(Ye,{children:l(ie,{children:[e(V,{"aria-hidden":"true"}),e(V,{children:o("permission")}),e(V,{children:o("results")}),e(V,{children:o("decisionStrategy")}),e(V,{children:o("grantedScopes")}),e(V,{children:o("deniedScopes")}),e(V,{"aria-hidden":"true"})]})}),Object.values(a[n].policies).map((r,d)=>e(Xi,{idx:d,rowIndex:n,outerPolicy:r,resource:i},d))]})})})})]},`child-${i.resource}`)]})};function ts(n,i){switch(i){case"STATUS_PERMITTED":return n.filter(({status:a})=>a==="PERMIT");case"STATUS_DENIED":return n.filter(({status:a})=>a==="DENY");default:return n}}const ns=({evaluateResult:n,refresh:i,back:a})=>{const{t}=x(),[s,o]=we(),[r,d]=b("ALL"),[p,c]=b(""),[m,u]=b(""),g=()=>{c(m)},h=T=>{T.key==="Enter"&&g()},S=mt(()=>ts(n.results,r).filter(({resource:T})=>T?.name?.includes(p)??!1),[n.results,r,p]),k=n.results.length===0,C=S.length===0;return l(ce,{children:[e(Aa,{children:l(Ia,{className:"providers-toolbar",children:[e(ge,{children:l(Dn,{children:[e(St,{isFill:!0,children:e(En,{name:"inputGroupName",id:"inputGroupName",type:"search","aria-label":t("search"),placeholder:t("search"),onChange:(T,v)=>u(v),onKeyDown:h})}),e(St,{children:e(E,{variant:me.control,"aria-label":t("search"),onClick:()=>g(),children:e(Ra,{})})})]})}),e(ge,{children:e(kt,{"data-testid":"filter-type-select",isOpen:s,className:"kc-filter-type-select",toggle:T=>e($e,{ref:T,onClick:o,isExpanded:s,style:{width:"300px"},children:r}),onSelect:(T,v)=>{d(v),o(),i()},selected:r,children:l(Tt,{children:[e(Se,{"data-testid":"all-results-option",value:"ALL",children:t("allResults")}),e(Se,{"data-testid":"result-permit-option",value:"STATUS_PERMITTED",children:t("resultPermit")}),e(Se,{"data-testid":"result-deny-option",value:"STATUS_DENIED",children:t("resultDeny")})]})})})]})}),!C&&l(Qe,{"aria-label":t("evaluationResults"),children:[e(Ye,{children:l(ie,{children:[e(V,{"aria-hidden":"true"}),e(V,{children:t("resource")}),e(V,{children:t("overallResults")}),e(V,{children:t("scopes")}),e(V,{"aria-hidden":"true"})]})}),S.map((T,v)=>e(es,{rowIndex:v,resource:T,evaluateResults:n.results},v))]}),(C||k)&&l(H,{children:[e(Oe,{}),e(Ne,{isSearchVariant:!0,message:t("noSearchResults"),instructions:t("noSearchResultsInstructions")})]}),e(he,{children:l(Et,{name:"authorization",children:[e(E,{"data-testid":"authorization-eval",id:"back-btn",onClick:a,children:t("back")})," ",e(E,{"data-testid":"authorization-reevaluate",id:"reevaluate-btn",variant:"secondary",onClick:i,children:t("reevaluate")})," ",e(Zi,{data:n.rpt})]})})]})},as=n=>{const{hasAccess:i}=Ae();return i("view-users")?e(is,{...n}):e(xa,{permissionNeeded:"view-users"})},is=({client:n})=>{const{adminClient:i}=Y(),a=Pe({mode:"onChange"}),{reset:t,trigger:s,formState:{isValid:o}}=a,{t:r}=x(),{addError:d}=oe(),p=de(),[c,m]=b(!1),[u,g]=b(!1),[h,S]=b([]),[k,C]=b([]),[T,v]=b(),[D,z]=b([]);ne(()=>i.roles.find(),_=>{z(_)},[]),ne(()=>Promise.all([i.clients.listResources({id:n.id}),i.clients.listAllScopes({id:n.id})]),([_,I])=>{S(_),C(I)},[]);const B=async()=>{if(!await s())return;const _=a.getValues(),I=Ea(_.resources),F={roleIds:_.roleIds??[],clientId:_.client.id,userId:_.user[0],resources:h.filter(y=>Object.keys(I).includes(y.name)).map(y=>({...y,scopes:y.scopes?.filter(K=>Object.values(I).flatMap(w=>w).includes(K.name))})),entitlements:!1,context:{attributes:Object.fromEntries(_.context.attributes.filter(y=>y.key||y.value!=="").map(({key:y,value:K})=>[y,K]))}};try{const y=await i.clients.evaluateResource({id:n.id,realm:p.realm},F);v(y)}catch(y){d("evaluateError",y)}};return T?e(ns,{evaluateResult:T,refresh:B,back:()=>v(void 0)}):e(ce,{children:l(ke,{...a,children:[l(Yt,{children:[e(un,{children:e(Bt,{headingLevel:"h2",children:r("identityInformation")})}),e(Zt,{children:l(re,{isHorizontal:!0,role:"view-clients",children:[e(jn,{name:"client",label:"client",helpText:"clientHelp",defaultValue:n.clientId}),e($n,{name:"user",label:"users",helpText:r("selectUser"),defaultValue:[],variant:"typeahead",isRequired:!0}),e(Q,{name:"roleIds",label:r("roles"),labelIcon:r("rolesHelp"),variant:"typeaheadMulti",placeholderText:r("selectARole"),controller:{defaultValue:[],rules:{required:!0}},options:D.map(_=>_.name)})]})})]}),l(Yt,{children:[e(un,{children:e(Bt,{headingLevel:"h2",children:r("permissions")})}),e(Zt,{children:l(re,{isHorizontal:!0,role:"view-clients",children:[e(M,{label:r("applyToResourceType"),fieldId:"applyToResourceType",labelIcon:e(N,{helpText:r("applyToResourceTypeHelp"),fieldLabelId:"applyToResourceType"}),children:e(fe,{id:"applyToResource-switch",label:r("on"),labelOff:r("off"),isChecked:u,onChange:(_,I)=>g(I),"aria-label":r("applyToResourceType")})}),u?l(H,{children:[e(X,{name:"alias",label:r("resourceType"),labelIcon:r("resourceTypeHelp"),rules:{required:r("required")}}),e(Q,{name:"authScopes",label:r("authScopes"),labelIcon:r("scopesSelect"),controller:{defaultValue:[]},variant:"typeaheadMulti",options:k.map(_=>_.name)})]}):e(M,{label:r("resourcesAndScopes"),id:"resourcesAndScopes",labelIcon:e(N,{helpText:r("contextualAttributesHelp"),fieldLabelId:"resourcesAndScopes"}),fieldId:"resourcesAndScopes",children:e(gn,{selectableValues:h.map(_=>({name:_.name,key:_._id})),resources:h,name:"resources"})}),e(Gn,{toggleText:r("contextualInfo"),onToggle:()=>m(!c),isExpanded:c,children:e(M,{label:r("contextualAttributes"),id:"contextualAttributes",labelIcon:e(N,{helpText:r("contextualAttributesHelp"),fieldLabelId:"contextualAttributes"}),fieldId:"contextualAttributes",children:e(gn,{selectableValues:Jn,name:"context.attributes"})})})]})})]}),l(De,{children:[e(E,{"data-testid":"authorization-eval",id:"authorization-eval",className:"pf-v5-u-mr-md",isDisabled:!o,onClick:()=>B(),children:r("evaluate")}),e(E,{"data-testid":"authorization-revert",id:"authorization-revert",className:"pf-v5-u-mr-md",variant:"link",onClick:()=>t(),children:r("revert")})]})]})})},ss=()=>{const{adminClient:n}=Y(),{t:i}=x(),{clientId:a}=Wt(),{addAlert:t,addError:s}=oe(),[o,r]=b(),[d,p]=b();ne(()=>n.clients.exportResource({id:a}),m=>{r(JSON.stringify(m,null,2)),p(m)},[]);const c=()=>{try{Je.saveAs(new Blob([Ue(d)],{type:"application/json"}),"test-authz-config.json"),t(i("exportAuthDetailsSuccess"),J.success)}catch(m){s("exportAuthDetailsError",m)}};return o?e(ce,{children:l(re,{isHorizontal:!0,role:"manage-authorization",className:"pf-v5-u-mt-lg",children:[e(hi,{"data-testid":"authorization-export-code-editor",value:o,language:"json",readOnly:!0,rows:10,style:{height:"30rem",overflow:"scroll"}}),l(De,{children:[e(E,{"data-testid":"authorization-export-download",onClick:()=>c(),children:i("download")}),e(E,{"data-testid":"authorization-export-copy",variant:"secondary",onClick:async()=>{try{await navigator.clipboard.writeText(o),t(i("copied"),J.success)}catch(m){s("copyError",m)}},children:i("copy")})]})]})}):e(Le,{})},bn=({permissionType:n,disabled:i=!1,clientId:a})=>{const{t}=x(),{realm:s}=de(),o=ut();return e(E,{"data-testid":`create-${n}`,className:i?"keycloak__permissions__empty_state ":"pf-v5-u-m-sm",variant:"secondary",onClick:()=>!i&&o(ot({realm:s,id:a,permissionType:n})),children:t(`create${Gt(n)}BasedPermission`)})},yn=({permissionType:n,disabled:i,...a})=>{const{t}=x();return i?e(On,{content:t(`no${Gt(n)}CreateHint`),children:e(bn,{...a,disabled:i,permissionType:n})}):e(bn,{...a,disabled:i,permissionType:n})},os=({clientId:n,isResourceEnabled:i,isScopeEnabled:a})=>{const{t}=x();return l(Pn,{"data-testid":"empty-state",variant:"lg",children:[e(Ln,{titleText:e(H,{children:t("emptyPermissions")}),icon:e(wa,{icon:xn}),headingLevel:"h1"}),e(_n,{children:t("emptyPermissionInstructions")}),l(Da,{children:[e(yn,{permissionType:"resource",disabled:i,clientId:n}),e("br",{}),e(yn,{permissionType:"scope",disabled:a,clientId:n})]})]})},rs=({row:n})=>l(H,{children:[n.associatedPolicies?.[0]?.name||"—"," ",e(Qn,{array:n.associatedPolicies})]}),ls=({clientId:n,isDisabled:i=!1})=>{const{adminClient:a}=Y(),{t}=x(),s=ut(),{addAlert:o,addError:r}=oe(),{realm:d}=de(),[p,c]=b(),[m,u]=b(),[g,h]=b(),[S,k]=b(),[C,T]=we(),[v,D]=b({}),[z,B]=b(0),_=()=>B(z+1),[I,F]=b(10),[y,K]=b(0);ne(async()=>{const O=await a.clients.findPermissions({first:y,max:I+1,id:n,...v});return await Promise.all(O.map(async ae=>{const R=await a.clients.getAssociatedPolicies({id:n,permissionId:ae.id});return{...ae,associatedPolicies:R,isExpanded:!1}}))},c,[z,v,y,I]),ne(async()=>{const O={first:0,max:1},[ae,R,j]=await Promise.all([a.clients.listPolicyProviders({id:n}),a.clients.listResources({...O,id:n}),a.clients.listAllScopes({...O,id:n})]);return{policies:ae.filter(Ie=>Ie.type==="resource"||Ie.type==="scope"),resources:R.length!==1,scopes:j.length!==1}},({policies:O,resources:ae,scopes:R})=>{h(O),k({resources:ae,scopes:R})},[]);const[w,f]=Te({titleKey:"deletePermission",messageKey:t("deletePermissionConfirm",{permission:m?.name}),continueButtonVariant:me.danger,continueButtonLabel:"confirm",onConfirm:async()=>{try{await a.clients.delPermission({id:n,type:m?.type,permissionId:m?.id}),o(t("permissionDeletedSuccess"),J.success),_()}catch(O){r("permissionDeletedError",O)}}});if(!p)return e(Le,{});const P=p.length===0,U=Object.keys(v).length!==0;return l(ce,{variant:"light",className:"pf-v5-u-p-0",children:[e(f,{}),(!P||U)&&e($t,{count:p.length,first:y,max:I,onNextClick:K,onPreviousClick:K,onPerPageSelect:(O,ae)=>{K(O),F(ae)},toolbarItem:l(H,{children:[e(ge,{children:e(Wn,{types:g,search:v,onSearch:D,type:"permission"})}),e(ge,{children:e(Nn,{onOpenChange:T,toggle:O=>e($e,{ref:O,onClick:T,isDisabled:i,variant:"primary","data-testid":"permissionCreateDropdown",children:t("createPermission")}),isOpen:C,children:l(Hn,{children:[e(qe,{"data-testid":"create-resource",isDisabled:i||S?.resources,component:"button",onClick:()=>s(ot({realm:d,id:n,permissionType:"resource"})),children:t("createResourceBasedPermission")}),e(Oe,{}),l(qe,{"data-testid":"create-scope",isDisabled:i||S?.scopes,component:"button",onClick:()=>s(ot({realm:d,id:n,permissionType:"scope"})),children:[t("createScopeBasedPermission"),S?.scopes&&e(pt,{className:"pf-v5-u-mt-sm",variant:"warning",isInline:!0,isPlain:!0,title:t("noScopeCreateHint")})]})]})})})]}),children:!P&&l(Qe,{"aria-label":t("resources"),variant:"compact",children:[e(Ye,{children:l(ie,{children:[e(V,{"aria-hidden":"true"}),e(V,{children:t("name")}),e(V,{children:t("type")}),e(V,{children:t("associatedPolicy")}),e(V,{children:t("description")}),e(V,{"aria-hidden":"true"})]})}),p.map((O,ae)=>l(Ze,{isExpanded:O.isExpanded,children:[l(ie,{children:[e(L,{expand:{rowIndex:ae,isExpanded:O.isExpanded,onToggle:(R,j)=>{const Ie=p.map((Re,Ke)=>Ke===j?{...Re,isExpanded:!Re.isExpanded}:Re);c(Ie)}}}),e(L,{"data-testid":`name-column-${O.name}`,children:e(Ce,{to:Rt({realm:d,id:n,permissionType:O.type,permissionId:O.id}),children:O.name})}),e(L,{children:g?.find(R=>R.type===O.type)?.name}),e(L,{children:e(rs,{row:O})}),e(L,{children:O.description||"—"}),e(L,{actions:{items:[{title:t("delete"),onClick:async()=>{u(O),w()}}]}})]}),l(ie,{isExpanded:O.isExpanded,children:[e(L,{}),e(L,{colSpan:5,children:e(dt,{children:O.isExpanded&&e(ft,{isHorizontal:!0,className:"keycloak_resource_details",children:e(lt,{name:"associatedPolicy",array:O.associatedPolicies,convert:R=>R.name,link:R=>wn({id:n,realm:d,policyId:R.id,policyType:R.type})})})})})]},`child-${O.id}`)]},O.id))]})}),P&&!U&&e(os,{clientId:n,isResourceEnabled:!i&&S?.resources,isScopeEnabled:!i&&S?.scopes}),P&&U&&e(Ne,{isSearchVariant:!0,message:t("noSearchResults"),instructions:t("noSearchResultsInstructions")})]})},cs=({id:n,clientId:i,uris:a})=>{const{adminClient:t}=Y(),{realm:s}=de(),[o,r]=b(),[d,p]=b();return ne(()=>Promise.all([t.clients.listScopesByResource({id:i,resourceName:n}),t.clients.listPermissionsByResource({id:i,resourceId:n})]),([c,m])=>{r(c),p(m)},[]),!d||!o?e(Le,{}):l(ft,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(pi,{name:"uris",array:a}),e(lt,{name:"scopes",array:o,convert:c=>c.name,link:c=>Mn({id:i,realm:s,scopeId:c.id})}),e(lt,{name:"associatedPermissions",array:d,convert:c=>c.name,link:c=>Rt({id:i,realm:s,permissionId:c.id,permissionType:"resource"})})]})},ds=({row:n})=>l(at,{wrapModifier:"truncate",children:[n.uris?.[0]," ",e(Qn,{array:n.uris})]}),us=({clientId:n,isDisabled:i=!1})=>{const{adminClient:a}=Y(),{t}=x(),s=ut(),{addAlert:o,addError:r}=oe(),{realm:d}=de(),[p,c]=b(),[m,u]=b(),[g,h]=b(),[S,k]=b(0),C=()=>k(S+1),[T,v]=b(10),[D,z]=b(0),[B,_]=b({});ne(()=>{const f={first:D,max:T+1,deep:!1,...B};return a.clients.listResources({...f,id:n})},f=>c(f.map(P=>({...P,isExpanded:!1}))),[S,B,D,T]);const I=async f=>a.clients.listPermissionsByResource({id:n,resourceId:f}),[F,y]=Te({titleKey:"deleteResource",children:l(H,{children:[t("deleteResourceConfirm"),g?.length&&e(pt,{variant:"warning",isInline:!0,isPlain:!0,title:t("deleteResourceWarning"),className:"pf-v5-u-pt-lg",children:e("p",{className:"pf-v5-u-pt-xs",children:g.map(f=>e("strong",{className:"pf-v5-u-pr-md",children:f.name},f.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await a.clients.delResource({id:n,resourceId:m?._id}),o(t("resourceDeletedSuccess"),J.success),C()}catch(f){r("resourceDeletedError",f)}}});if(!p)return e(Le,{});const K=p.length===0,w=Object.keys(B).length!==0;return l(ce,{variant:"light",className:"pf-v5-u-p-0",children:[e(y,{}),(!K||w)&&e($t,{count:p.length,first:D,max:T,onNextClick:z,onPreviousClick:z,onPerPageSelect:(f,P)=>{z(f),v(P)},toolbarItem:l(H,{children:[e(ge,{children:e(Wn,{search:B,onSearch:_,type:"resource"})}),e(ge,{children:e(E,{"data-testid":"createResource",isDisabled:i,component:f=>e(Ce,{...f,to:Xt({realm:d,id:n})}),children:t("createResource")})})]}),children:!K&&l(Qe,{"aria-label":t("resources"),variant:"compact",children:[e(Ye,{children:l(ie,{children:[e(V,{"aria-hidden":"true"}),e(V,{children:t("name")}),e(V,{children:t("displayName")}),e(V,{children:t("type")}),e(V,{children:t("owner")}),e(V,{children:t("uris")}),!i&&l(H,{children:[e(V,{"aria-hidden":"true"}),e(V,{"aria-hidden":"true"})]})]})}),p.map((f,P)=>l(Ze,{isExpanded:f.isExpanded,children:[l(ie,{children:[e(L,{expand:{rowIndex:P,isExpanded:f.isExpanded,onToggle:(U,O)=>{const ae=p.map((R,j)=>j===O?{...R,isExpanded:!R.isExpanded}:R);c(ae)}}}),e(L,{"data-testid":`name-column-${f.name}`,children:e(at,{wrapModifier:"truncate",children:e(Ce,{to:Kn({realm:d,id:n,resourceId:f._id}),children:f.name})})}),e(L,{children:e(at,{wrapModifier:"truncate",children:f.displayName})}),e(L,{children:e(at,{wrapModifier:"truncate",children:f.type})}),e(L,{children:e(at,{wrapModifier:"truncate",children:f.owner?.name})}),e(L,{children:e(ds,{row:f})}),!i&&l(H,{children:[e(L,{width:10,children:e(E,{variant:"link",component:U=>e(Ce,{...U,to:ot({realm:d,id:n,permissionType:"resource",selectedId:f._id})}),children:t("createPermission")})}),e(L,{actions:{items:[{title:t("delete"),onClick:async()=>{u(f),h(await I(f._id)),F()}}]}})]})]}),l(ie,{isExpanded:f.isExpanded,children:[e(L,{}),e(L,{colSpan:4,children:e(dt,{children:f.isExpanded&&e(cs,{clientId:n,id:f._id,uris:f.uris})})})]},`child-${f._id}`)]},f._id))]})}),K&&w&&e(Ne,{isSearchVariant:!0,message:t("noSearchResults"),instructions:t("noSearchResultsInstructions")}),K&&!w&&e(Ne,{message:t("emptyResources"),instructions:t("emptyResourcesInstructions"),isDisabled:i,primaryActionText:t("createResource"),onPrimaryAction:()=>s(Xt({realm:d,id:n}))})]})},ps=({clientId:n,isDisabled:i=!1})=>{const{adminClient:a}=Y(),{t}=x(),s=ut(),{realm:o}=de(),[r,d]=we(),[p,c]=b(),[m,u]=b(),[g,h]=b([]),[S,k]=b(0),C=()=>k(S+1),[T,v]=b(10),[D,z]=b(0),[B,_]=b("");ne(()=>{const w={first:D,max:T+1,deep:!1,name:B};return a.clients.listAllScopes({...w,id:n})},w=>{c(w.map(f=>({...f,isLoaded:!1}))),h(w.map(f=>({id:f.id,isExpanded:!1})))},[S,B,D,T]);const I=w=>p?.find(f=>f.id===w),F=w=>g.find(f=>f.id===w)?.isExpanded||!1;if(ne(()=>{const w=g.filter(f=>f.isExpanded).map(({id:f})=>I(f)).filter(f=>!f.isLoaded);return Promise.all(w.map(async f=>{const[P,U]=await Promise.all([a.clients.listAllResourcesByScope({id:n,scopeId:f.id}),a.clients.listAllPermissionsByScope({id:n,scopeId:f.id})]);return{...f,resources:P,permissions:U,isLoaded:!0}}))},w=>{let f=[...p||[]];w.forEach(P=>{const U=p?.findIndex(O=>P.id===O.id);f=[...f.slice(0,U),P,...f.slice(U+1)]}),c(f)},[g]),!p)return e(Le,{});const y=p.length===0,K=B!=="";return l(ce,{variant:"light",className:"pf-v5-u-p-0",children:[e(fi,{clientId:n,open:r,toggleDialog:d,selectedScope:m,refresh:C}),(!y||K)&&e($t,{count:p.length,first:D,max:T,onNextClick:z,onPreviousClick:z,onPerPageSelect:(w,f)=>{z(w),v(f)},inputGroupName:"search",inputGroupPlaceholder:t("searchByName"),inputGroupOnEnter:_,toolbarItem:e(ge,{children:e(E,{"data-testid":"createAuthorizationScope",component:w=>e(Ce,{...w,to:en({realm:o,id:n})}),children:t("createAuthorizationScope")})}),children:!y&&l(Qe,{"aria-label":t("scopes"),variant:"compact",children:[e(Ye,{children:l(ie,{children:[e(V,{"aria-hidden":"true"}),e(V,{children:t("name")}),e(V,{children:t("displayName")}),e(V,{"aria-hidden":"true"}),e(V,{"aria-hidden":"true"})]})}),p.map((w,f)=>l(Ze,{isExpanded:F(w.id),children:[l(ie,{children:[e(L,{expand:{rowIndex:f,isExpanded:F(w.id),onToggle:(P,U,O)=>{h([...g.slice(0,U),{id:w.id,isExpanded:O},...g.slice(U+1)])}}}),e(L,{"data-testid":`name-column-${w.name}`,children:e(Ce,{to:Mn({realm:o,id:n,scopeId:w.id}),children:w.name})}),e(L,{children:w.displayName}),e(L,{width:10,children:e(E,{variant:"link",component:P=>e(Ce,{...P,to:ot({realm:o,id:n,permissionType:"scope",selectedId:w.id})}),children:t("createPermission")})}),e(L,{isActionCell:!0,actions:{items:[{title:t("delete"),onClick:()=>{u(w),d()}}]}})]}),l(ie,{isExpanded:F(w.id),children:[e(L,{}),e(L,{colSpan:4,children:e(dt,{children:F(w.id)&&w.isLoaded?l(ft,{isHorizontal:!0,className:"keycloak_resource_details",children:[e(lt,{name:"resources",array:w.resources,convert:P=>P.name,link:P=>Kn({id:n,realm:o,resourceId:P._id})}),e(lt,{name:"associatedPermissions",array:w.permissions,convert:P=>P.name,link:P=>Rt({id:n,realm:o,permissionId:P.id,permissionType:P.type})})]}):e(Le,{})})})]},`child-${w.id}`)]},w.id))]})}),y&&!K&&e(Ne,{message:t("emptyAuthorizationScopes"),instructions:t("emptyAuthorizationInstructions"),isDisabled:i,onPrimaryAction:()=>s(en({id:n,realm:o})),primaryActionText:t("createAuthorizationScope")}),y&&K&&e(Ne,{isSearchVariant:!0,isDisabled:i,message:t("noSearchResults"),instructions:t("noSearchResultsInstructions")})]})},ms=({onConfirm:n,closeDialog:i})=>{const{t:a}=x(),[t,s]=b({});return l(ze,{title:a("import"),isOpen:!0,variant:"small",onClose:i,actions:[e(E,{id:"modal-confirm",onClick:()=>{n(t),i()},"data-testid":"confirm",children:a("confirm")},"confirm"),e(E,{"data-testid":"cancel",id:"modal-cancel",variant:me.link,onClick:()=>{i()},children:a("cancel")},"cancel")],children:[e(he,{children:e(gi,{id:"import-resource",onChange:s})}),Object.keys(t).length!==0&&l(H,{children:[e(Oe,{}),e("p",{className:"pf-v5-u-my-lg",children:a("importResources")}),l(he,{isHorizontal:!0,children:[e(M,{label:a("policyEnforcementMode"),labelIcon:e(N,{helpText:a("policyEnforcementModeHelp"),fieldLabelId:"policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(rt,{id:"policyEnforcementMode",name:"policyEnforcementMode",label:a(`policyEnforcementModes.${t.policyEnforcementMode}`),isChecked:!0,isDisabled:!0,className:"pf-v5-u-mb-md"})}),e(M,{label:a("decisionStrategy"),labelIcon:e(N,{helpText:a("decisionStrategyHelp"),fieldLabelId:"decisionStrategy"}),fieldId:"decisionStrategy",hasNoPaddingTop:!0,children:e(rt,{id:"decisionStrategy",name:"decisionStrategy",isChecked:!0,isDisabled:!0,label:a(`decisionStrategies.${t.decisionStrategy}`),className:"pf-v5-u-mb-md"})}),e(M,{hasNoPaddingTop:!0,label:a("allowRemoteResourceManagement"),fieldId:"allowRemoteResourceManagement",labelIcon:e(N,{helpText:a("allowRemoteResourceManagement"),fieldLabelId:"allowRemoteResourceManagement"}),children:e(fe,{id:"allowRemoteResourceManagement",label:a("on"),labelOff:a("off"),isChecked:t.allowRemoteResourceManagement,isDisabled:!0,"aria-label":a("allowRemoteResourceManagement")})})]}),e("div",{className:"pf-v5-u-mt-md",children:Object.entries(t).filter(([,o])=>Array.isArray(o)).map(([o,r])=>l(Vn,{children:[e(Oe,{}),e("p",{className:"pf-v5-u-my-sm",children:l("strong",{children:[r.length," ",a(o)]})})]},o))}),e(Oe,{}),e(pt,{variant:"warning",className:"pf-v5-u-mt-lg",isInline:!0,title:a("importWarning")})]})]})},vn=["ENFORCING","PERMISSIVE","DISABLED"],hs=({clientId:n})=>{const{adminClient:i}=Y(),{t:a}=x(),[t,s]=b(),[o,r]=we(),d=Pe({}),{control:p,reset:c,handleSubmit:m}=d,{addAlert:u,addError:g}=oe(),{hasAccess:h}=Ae(),S=!h("manage-authorization");ne(()=>i.clients.getResourceServer({id:n}),T=>{s(T),c(T)},[]);const k=async T=>{try{await i.clients.importResource({id:n},T),u(a("importResourceSuccess"),J.success),c({...T})}catch(v){g("importResourceError",v)}},C=async T=>{try{await i.clients.updateResourceServer({id:n},T),u(a("updateResourceSuccess"),J.success)}catch(v){g("resourceSaveError",v)}};return t?l(ce,{variant:"light",children:[o&&e(ms,{onConfirm:k,closeDialog:r}),l(re,{role:"manage-authorization",isHorizontal:!0,onSubmit:m(C),children:[e(M,{label:a("import"),fieldId:"import",labelIcon:e(N,{helpText:a("importHelp"),fieldLabelId:"import"}),children:e(E,{variant:"secondary",onClick:r,children:a("import")})}),e(Oe,{}),e(M,{label:a("policyEnforcementMode"),labelIcon:e(N,{helpText:a("policyEnforcementModeHelp"),fieldLabelId:"policyEnforcementMode"}),fieldId:"policyEnforcementMode",hasNoPaddingTop:!0,children:e(te,{name:"policyEnforcementMode","data-testid":"policyEnforcementMode",defaultValue:vn[0],control:p,render:({field:T})=>e(H,{children:vn.map(v=>e(rt,{id:v,"data-testid":v,isChecked:T.value===v,isDisabled:S,name:"policyEnforcementMode",onChange:()=>T.onChange(v),label:a(`policyEnforcementModes.${v}`),className:"pf-v5-u-mb-md"},v))})})}),l(ke,{...d,children:[e(oi,{isLimited:!0}),e(ve,{name:"allowRemoteResourceManagement",label:a("allowRemoteResourceManagement"),labelIcon:a("allowRemoteResourceManagementHelp")})]}),e(Et,{name:"authenticationSettings",reset:()=>c(t),isSubmit:!0})]})]}):e(Le,{})},Sn=({id:n,buttonLabel:i,client:a,secret:t,toggle:s})=>{const{t:o}=x(),r=se(),{hasAccess:d}=Ae(),p=d("manage-clients")||a.access?.configure;return l(We,{hasGutter:!0,children:[e(be,{isFilled:!0,children:l(Dn,{children:[e(St,{isFill:!0,children:e(Pa,{id:n,value:t,readOnly:!0})}),e(St,{children:e(Yn,{id:n,text:t,label:"clientSecret",variant:"control"})})]})}),e(be,{children:e(E,{variant:"secondary",isDisabled:r.formState.isDirty||!p,onClick:s,children:o(i)})})]})},Cn=({time:n})=>{const{t:i}=x(),a=qn();return e("div",{className:"pf-v5-u-my-md",children:(s=>s?i("secretExpiresOn",{time:a(new Date(s*1e3),{dateStyle:"full",timeStyle:"long"})}):void 0)(n)})},fs=({client:n,secret:i,toggle:a})=>{const{adminClient:t}=Y(),{t:s}=x(),{addAlert:o,addError:r}=oe(),[d,p]=b(n.attributes?.["client.secret.rotated"]),c=n.attributes?.["client.secret.expiration.time"],m=n.attributes?.["client.secret.rotated.expiration.time"],u=S=>new Date().getTime()>=S*1e3,[g,h]=Te({titleKey:"invalidateRotatedSecret",messageKey:"invalidateRotatedSecretExplain",continueButtonLabel:"confirm",onConfirm:async()=>{try{await t.clients.invalidateSecret({id:n.id}),p(void 0),o(s("invalidateRotatedSuccess"))}catch(S){r("invalidateRotatedError",S)}}});return ht(()=>{d!==n.attributes?.["client.secret.rotated"]&&p(n.attributes?.["client.secret.rotated"])},[n,d]),l(H,{children:[e(h,{}),l(M,{label:s("clientSecret"),fieldId:"kc-client-secret",className:"pf-v5-u-my-md",children:[e(Sn,{id:"kc-client-secret",client:n,secret:i,toggle:a,buttonLabel:"regenerate"}),e(Cn,{time:c}),u(c)&&e(pt,{variant:"warning",isInline:!0,title:s("secretHasExpired")})]}),d&&l(M,{label:s("secretRotated"),fieldId:"secretRotated",children:[e(Sn,{id:"secretRotated",client:n,secret:d,toggle:g,buttonLabel:"invalidateSecret"}),e(Cn,{time:m})]})]})},gs=({clientAuthenticatorType:n})=>{const{cryptoInfo:i}=He(),a=n==="client-jwt"?i?.clientSignatureAsymmetricAlgorithms??[]:i?.clientSignatureSymmetricAlgorithms??[],{t}=x(),{control:s}=se();return l(H,{children:[e(Q,{name:A("attributes.token.endpoint.auth.signing.alg"),label:t("signatureAlgorithm"),labelIcon:t("signatureAlgorithmHelp"),controller:{defaultValue:""},isScrollable:!0,maxMenuHeight:"200px",options:[{key:"",value:t("anyAlgorithm")},...a.map(o=>({key:o,value:o}))]}),e(M,{label:t("signatureMaxExp"),fieldId:"signatureMaxExp",className:"pf-v5-u-my-md",labelIcon:e(N,{helpText:t("signatureMaxExpHelp"),fieldLabelId:"signatureMaxExp"}),children:e(te,{name:A("attributes.token.endpoint.auth.signing.max.exp"),defaultValue:"",control:s,render:({field:o})=>e(wt,{value:o.value,onChange:o.onChange,units:["second","minute"],min:"1"})})})]})},bs=()=>{const{t:n}=x();return l(H,{children:[e(ve,{name:A("attributes.x509.allow.regex.pattern.comparison"),label:n("allowRegexComparison"),labelIcon:n("allowRegexComparisonHelp"),stringify:!0}),e(X,{name:A("attributes.x509.subjectdn"),label:n("subject"),labelIcon:n("subjectHelp"),rules:{required:n("required")}})]})},ys=({client:n,save:i,refresh:a})=>{const{adminClient:t}=Y(),{t:s}=x(),{addAlert:o,addError:r}=oe(),d=n.id,[p,c]=b([]),{control:m,formState:{isDirty:u},handleSubmit:g}=se(),h=xt({control:m,name:"clientAuthenticatorType",defaultValue:""}),[S,k]=b(""),[C,T]=b(""),v=p.find(f=>f.id===h),{componentTypes:D}=He(),z=mt(()=>D?.["org.keycloak.authentication.ClientAuthenticator"]?.find(f=>f.id===h)?.properties,[h,D]);ne(()=>Promise.all([t.authenticationManagement.getClientAuthenticatorProviders(),t.clients.getClientSecret({id:d})]),([f,P])=>{c(f),k(P.value)},[]);async function B(f,P){try{const U=await f(d);return o(s(`${P}Success`),J.success),U}catch(U){r(`${P}Error`,U)}}const _=async()=>{const f=await B(P=>t.clients.generateNewClientSecret({id:P}),"clientSecret");k(f?.value||""),a()},[I,F]=Te({titleKey:"confirmClientSecretTitle",messageKey:"confirmClientSecretBody",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:_}),y=async()=>{const f=await B(P=>t.clients.generateRegistrationAccessToken({id:P}),"accessToken");T(f?.registrationAccessToken||"")},[K,w]=Te({titleKey:"confirmAccessTokenTitle",messageKey:"confirmAccessTokenBody",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:y});return e(ce,{children:l(re,{onSubmit:g(i),isHorizontal:!0,className:"pf-v5-u-mt-md",role:"manage-clients",fineGrainedAccess:n.access?.configure,children:[e(F,{}),e(w,{}),l(Ct,{isFlat:!0,children:[l(Ge,{children:[e(Q,{name:"clientAuthenticatorType",label:s("clientAuthenticator"),labelIcon:s("clientAuthenticatorTypeHelp"),controller:{defaultValue:""},options:p.map(({id:f,displayName:P})=>({key:f,value:P||f}))}),(h==="client-jwt"||h==="client-secret-jwt")&&e(gs,{clientAuthenticatorType:h}),h==="client-jwt"&&e(M,{children:e(pt,{variant:"info",isInline:!0,title:s("signedJWTConfirm")})}),h==="client-x509"&&e(bs,{}),z&&e(he,{children:e(bi,{properties:z,convertToName:f=>`attributes.${f}`})}),e(De,{children:e(E,{variant:"primary",type:"submit",isDisabled:!u,children:s("save")})})]}),v?.supportsSecret&&l(H,{children:[e(Oe,{}),e(Ge,{children:e(fs,{client:n,secret:S,toggle:I})})]})]}),e(Ct,{isFlat:!0,children:e(Ge,{children:e(M,{label:s("registrationAccessToken"),fieldId:"kc-access-token",labelIcon:e(N,{helpText:s("registrationAccessTokenHelp"),fieldLabelId:"registrationAccessToken"}),children:l(We,{hasGutter:!0,children:[e(be,{isFilled:!0,children:e(zn,{id:"kc-access-token",isReadOnly:!0,children:C})}),e(be,{children:e(E,{variant:"secondary",onClick:K,children:s("regenerate")})})]})})})})]})})},kn=({id:n,keyInfo:i})=>{const{t:a}=x();return e(At,{readOnly:!0,rows:5,id:n,"data-testid":"certificate",value:i?.certificate,"aria-label":a("certificate")})},Qt=({keyInfo:n,plain:i=!1})=>{const{t:a}=x(),t=$a();return i?e(kn,{id:t,keyInfo:n}):e(M,{label:a("certificate"),fieldId:t,labelIcon:e(N,{helpText:a("certificateHelp"),fieldLabelId:t}),children:e(kn,{id:t,keyInfo:n})})},aa=({hidePassword:n=!1,isSaml:i=!1})=>{const{t:a}=x();return l(H,{children:[e(X,{name:"keyAlias",label:a("keyAlias"),labelIcon:a("keyAliasHelp"),rules:{required:a("required")}}),!n&&e(tn,{name:"keyPassword",label:a("keyPassword"),labelIcon:a("keyPasswordHelp"),rules:{required:a("required")}}),i&&e(X,{name:"realmAlias",label:a("realmCertificateAlias"),labelIcon:a("realmCertificateAliasHelp")}),e(tn,{name:"storePassword",label:a("storePassword"),labelIcon:a("storePasswordHelp"),rules:{required:a("required")}})]})},Tn="Certificate PEM",vs=new Map([["PKCS12","p12"],["JKS","jks"],["BCFKS","bcfks"]]),ia=n=>vs.get(n),Dt=({isSaml:n=!1,hasPem:i=!1,useFile:a=!1})=>{const{t}=x(),[s,o]=b(),{control:r,watch:d}=se(),p=d("format"),{cryptoInfo:c}=He(),m=[...c?.supportedKeystoreTypes??[],...i?[Tn]:[]];return l(he,{className:"pf-v5-u-pt-lg",children:[e(Q,{name:"format",label:t("archiveFormat"),labelIcon:t("archiveFormatHelp"),controller:{defaultValue:m[0]},menuAppendTo:"parent",options:m}),a&&e(M,{label:t("importFile"),labelIcon:e(N,{helpText:t("importFileHelp"),fieldLabelId:"importFile"}),fieldId:"importFile",children:e(te,{name:"file",defaultValue:"",control:r,render:({field:u})=>e(Zn,{id:"importFile",type:"text",value:u.value,hideDefaultPreview:!0,filename:s,browseButtonText:t("browse"),onDataChange:(g,h)=>{u.onChange(h)},onFileInputChange:(g,h)=>o(h.name)})})}),p!==Tn&&e(aa,{hidePassword:a,isSaml:n})]})},Ss=({clientId:n,save:i,toggleDialog:a})=>{const{t}=x(),s=Pe({defaultValues:{keyAlias:n},mode:"onChange"}),{handleSubmit:o,formState:{isValid:r}}=s;return l(ze,{variant:ct.medium,title:t("generateKeys"),isOpen:!0,onClose:a,actions:[e(E,{id:"modal-confirm","data-testid":"confirm",isDisabled:!r,onClick:()=>{o(d=>{i(d),a()})()},children:t("generate")},"confirm"),e(E,{id:"modal-cancel","data-testid":"cancel",variant:me.link,onClick:()=>{a()},children:t("cancel")},"cancel")],children:[e(Me,{children:e(pe,{children:t("generateKeysDescription")})}),e(ke,{...s,children:e(Dt,{})})]})},Cs=({save:n,toggleDialog:i})=>{const{t:a}=x(),t=Pe(),[s,o]=b(""),{control:r,handleSubmit:d}=t,p=He().cryptoInfo?.supportedKeystoreTypes??[],c=p.concat(["Certificate PEM","Public Key PEM","JSON Web Key Set"]),m=xt({control:r,name:"keystoreFormat",defaultValue:c[0]});return l(ze,{variant:ct.medium,title:a("generateKeys"),isOpen:!0,onClose:i,actions:[e(E,{id:"modal-confirm","data-testid":"confirm",onClick:()=>{d(u=>{n(u),i()})()},children:a("import")},"confirm"),e(E,{id:"modal-cancel","data-testid":"cancel",variant:me.link,onClick:i,children:a("cancel")},"cancel")],children:[e(Me,{children:e(pe,{children:a("generateKeysDescription")})}),e(he,{className:"pf-v5-u-pt-lg",children:l(ke,{...t,children:[e(Q,{name:"keystoreFormat",label:a("archiveFormat"),labelIcon:a("archiveFormatHelp"),controller:{defaultValue:c[0]},options:c}),p.includes(m)&&e(aa,{hidePassword:!0}),e(M,{label:a("importFile"),fieldId:"importFile",children:e(te,{name:"file",control:r,defaultValue:{value:"",filename:""},render:({field:u})=>e(Zn,{id:"importFile",value:u.value.value,filename:s,hideDefaultPreview:!0,type:"text",onDataChange:(g,h)=>{u.onChange({value:h})},onFileInputChange:(g,h)=>{o(h.name)}})})})]})})]})},Ft="jwt.credential",ks=({clientId:n,save:i,refresh:a,hasConfigureAccess:t})=>{const{adminClient:s}=Y(),{t:o}=x(),{control:r,getValues:d,formState:{isDirty:p}}=se(),{addAlert:c,addError:m}=oe(),[u,g]=b(),[h,S,k]=we(),[C,T,v]=we(),[D,z]=b(0),B=()=>{z(D+1),a()},_=xt({control:r,name:A("attributes.use.jwks.url"),defaultValue:"false"});ne(()=>s.clients.getKeyInfo({id:n,attr:Ft}),y=>g(y),[D]);const I=async y=>{try{const K=await s.clients.generateAndDownloadKey({id:n,attr:Ft},y);Je.saveAs(new Blob([K],{type:"application/octet-stream"}),`keystore.${ia(y.format??"")}`),c(o("generateSuccess"),J.success),B()}catch(K){m("generateError",K)}},F=async y=>{try{const K=new FormData,{file:w,...f}=y;for(const[P,U]of Object.entries(f))K.append(P,U);K.append("file",w.value),await s.clients.uploadCertificate({id:n,attr:Ft},K),c(o("importSuccess"),J.success),B()}catch(K){m("importError",K)}};return l(ce,{variant:"light",className:"keycloak__form",children:[h&&e(Ss,{clientId:d("clientId"),toggleDialog:S,save:I}),C&&e(Cs,{toggleDialog:T,save:F}),l(Ct,{isFlat:!0,children:[e(La,{children:e(_a,{children:o("jwksUrlConfig")})}),e(Ge,{children:e(Me,{children:e(pe,{children:o("keysIntro")})})}),e(Ge,{children:l(re,{role:"manage-clients",fineGrainedAccess:t,isHorizontal:!0,children:[e(ve,{name:A("attributes.use.jwks.url"),label:o("useJwksUrl"),labelIcon:o("useJwksUrlHelp"),stringify:!0}),_!=="true"&&(u?e(Qt,{plain:!0,keyInfo:u}):"No client certificate configured"),_==="true"&&e(X,{name:A("attributes.jwks.url"),label:o("jwksUrl"),labelIcon:o("jwksUrlHelp"),type:"url"}),l(De,{children:[e(E,{"data-testid":"saveKeys",onClick:i,isDisabled:!p,children:o("save")}),e(E,{"data-testid":"generate",variant:"secondary",onClick:()=>k(!0),children:o("generateNewKeys")}),e(E,{"data-testid":"import",variant:"secondary",onClick:()=>v(!0),isDisabled:_==="true",children:o("import")})]})]})})]})]})},Ts=({clientId:n,close:i,keyType:a})=>{const{adminClient:t}=Y(),{t:s}=x(),{realm:o}=de(),{addAlert:r,addError:d}=oe(),p=Pe({defaultValues:{realmAlias:o}}),c=async m=>{try{const u=await t.clients.downloadKey({id:n,attr:a},m);Je.saveAs(new Blob([u],{type:"application/octet-stream"}),`keystore.${ia(m.format??"")}`),r(s("samlKeysExportSuccess")),i()}catch(u){d("samlKeysExportError",u)}};return e(ze,{variant:"medium",title:s("exportSamlKeyTitle"),isOpen:!0,onClose:i,actions:[e(E,{id:"modal-confirm","data-testid":"confirm",type:"submit",form:"export-saml-key-form",children:s("export")},"confirm"),e(E,{id:"modal-cancel","data-testid":"cancel",variant:"link",onClick:()=>{i()},children:s("cancel")},"cancel")],children:e(he,{id:"export-saml-key-form",className:"pf-v5-u-pt-lg",onSubmit:p.handleSubmit(c),children:e(ke,{...p,children:e(Dt,{isSaml:!0})})})})},sa=async(n,i,a,t,s)=>{try{const o=new FormData,{file:r,...d}=i;Object.entries(d).map(([p,c])=>o.append(p==="format"?"keystoreFormat":p,c.toString())),o.append("file",r),await n.clients.uploadKey({id:a,attr:t},o),s()}catch(o){s(o)}},As=({id:n,attr:i,onClose:a,onCancel:t})=>{const{adminClient:s}=Y(),{t:o}=x(),[r,d]=b(!1),[p,c]=b(),m=Pe({mode:"onChange"}),{handleSubmit:u,formState:{isValid:g}}=m,{addAlert:h,addError:S}=oe(),k=T=>{sa(s,T,n,i,v=>{v?S("importError",v):h(o("importSuccess"),J.success)})},C=async()=>{try{const T=await s.clients.generateKey({id:n,attr:i});c(T),Je.saveAs(new Blob([T.privateKey],{type:"application/octet-stream"}),"private.key"),h(o("generateSuccess"),J.success)}catch(T){S("generateError",T)}};return e(ze,{variant:ct.medium,"aria-label":o("enableClientSignatureRequiredModal"),header:l(Me,{children:[e(Bt,{headingLevel:"h1",children:o("enableClientSignatureRequired")}),e(pe,{children:o("enableClientSignatureRequiredExplain")})]}),isOpen:!0,onClose:a,actions:[e(E,{id:"modal-confirm","data-testid":"confirm",variant:"primary",isDisabled:!g&&!p,onClick:()=>{r&&u(k)(),a()},children:o("confirm")},"confirm"),e(E,{id:"modal-cancel","data-testid":"cancel",variant:me.link,onClick:t,children:o("cancel")},"cancel")],children:l(ke,{...m,children:[l(he,{isHorizontal:!0,children:[e(M,{label:o("selectMethod"),fieldId:"selectMethod",hasNoPaddingTop:!0,children:l(Oa,{children:[e(nn,{children:e(rt,{isChecked:!r,name:"selectMethodType",onChange:()=>d(!1),label:o("selectMethodType.generate"),id:"selectMethodType-generate"})}),e(nn,{children:e(rt,{isChecked:r,name:"selectMethodType",onChange:()=>d(!0),label:o("selectMethodType.import"),id:"selectMethodType-import"})})]})}),!r&&e(M,{label:o("certificate"),fieldId:"certificate",labelIcon:e(N,{helpText:o("certificateHelp"),fieldLabelId:"certificate"}),children:l(We,{hasGutter:!0,children:[e(be,{isFilled:!0,children:e(Qt,{plain:!0,keyInfo:p})}),e(be,{children:e(E,{variant:"secondary","data-testid":"generate",onClick:C,children:o("generate")})})]})})]}),r&&e(Dt,{useFile:!0,hasPem:!0})]})})},Is=({id:n,attr:i,onClose:a})=>{const{adminClient:t}=Y(),{t:s}=x(),o=Pe(),{handleSubmit:r}=o,{addAlert:d,addError:p}=oe(),c=m=>{sa(t,m,n,i,u=>{u?p("importError",u):d(s("importSuccess"),J.success)})};return e(Jt,{open:!0,toggleDialog:a,continueButtonLabel:"import",titleKey:"importKey",onConfirm:()=>{r(c)(),a()},children:e(ke,{...o,children:e(Dt,{useFile:!0,hasPem:!0})})})},Vt=["saml.signing","saml.encryption"],je={"saml.signing":{name:A("attributes.saml.client.signature"),title:"signingKeysConfig",key:"clientSignature"},"saml.encryption":{name:A("attributes.saml.encrypt"),title:"encryptionKeysConfig",key:"encryptAssertions"}},Rs=({clientId:n,keyInfo:i,attr:a,onChanged:t,onGenerate:s,onImport:o})=>{const{t:r}=x(),{control:d,watch:p}=se(),c=je[a].title,m=je[a].key,u=je[a].name,[g,h]=we(),S=p(u);return l(H,{children:[g&&e(Ts,{keyType:a,clientId:n,close:h}),l(Na,{title:r(c),className:"kc-form-panel__panel",children:[e(Me,{className:"pf-v5-u-pb-lg",children:e(pe,{children:r(`${c}Explain`)})}),e(re,{role:"manage-clients",isHorizontal:!0,children:e(M,{labelIcon:e(N,{helpText:r(`${m}Help`),fieldLabelId:m}),label:r(m),fieldId:m,hasNoPaddingTop:!0,children:e(te,{name:u,control:d,defaultValue:"false",render:({field:k})=>e(fe,{"data-testid":m,id:m,label:r("on"),labelOff:r("off"),isChecked:k.value==="true",onChange:(C,T)=>{const v=T.toString();v==="true"?(t(a),k.onChange(v)):s(a,!1)},"aria-label":r(m)})})})})]}),i?.certificate&&S==="true"&&e(Ct,{isFlat:!0,children:e(Ge,{className:"kc-form-panel__body",children:l(he,{isHorizontal:!0,children:[e(Qt,{keyInfo:i}),l(De,{children:[e(E,{variant:"secondary",onClick:()=>s(a,!0),children:r("regenerate")}),e(E,{variant:"secondary",onClick:()=>o(a),children:r("importKey")}),e(E,{variant:"tertiary",onClick:h,children:r("export")})]})]})})})]})},xs=({clientId:n,save:i})=>{const{adminClient:a}=Y(),{t}=x(),[s,o]=b(),[r,d]=b(),[p,c]=b(),[m,u]=b(),[g,h]=b(0),{setValue:S}=se(),{addAlert:k,addError:C}=oe();ne(()=>Promise.all(Vt.map(I=>a.clients.getKeyInfo({id:n,attr:I}))),I=>d(I),[g]);const T=async I=>{const F=Vt.indexOf(I);try{const y=[...r||[]];y[F]=await a.clients.generateKey({id:n,attr:I}),d(y),Je.saveAs(new Blob([y[F].privateKey],{type:"application/octet-stream"}),"private.key"),k(t("generateSuccess"),J.success)}catch(y){C("generateError",y)}},v=p?je[p].key:"",[D,z]=Te({titleKey:t("disableSigning",{key:t(v)}),messageKey:t("disableSigningExplain",{key:t(v)}),continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:()=>{S(je[p].name,"false"),i()}}),[B,_]=Te({titleKey:"reGenerateSigning",messageKey:"reGenerateSigningExplain",continueButtonLabel:"yes",cancelButtonLabel:"no",onConfirm:()=>{T(p)}});return l(ce,{variant:"light",className:"keycloak__form",children:[s&&e(As,{id:n,attr:s,onClose:()=>{o(void 0),i(),h(g+1)},onCancel:()=>{S(je[p].name,"false"),o(void 0)}}),e(z,{}),e(_,{}),Vt.map((I,F)=>l(Vn,{children:[m===I&&e(Is,{id:n,attr:I,onClose:()=>u(void 0)}),e(Rs,{clientId:n,keyInfo:r?.[F],attr:I,onChanged:o,onGenerate:(y,K)=>{c(y),K?B():D()},onImport:()=>u(I)})]},I))]})},yt="dedicated",Es=({clientId:n,refresh:i,fineGrainedAccess:a,...t})=>{const{adminClient:s}=Y(),{t:o}=x(),{addAlert:r,addError:d}=oe(),{hasAccess:p}=Ae(),c=u=>u.id===yt,m=p("manage-clients")||a;return e(Ai,{isDisabled:c(t)||!m,clientScope:t,type:t.type,onSelect:async u=>{try{await Ii(s,n,t,t.type,u),r(o("clientScopeSuccess"),J.success),i()}catch(g){d("clientScopeError",g)}}})},ws=({clientId:n,protocol:i,clientName:a,fineGrainedAccess:t})=>{const{adminClient:s}=Y(),{t:o}=x(),{addAlert:r,addError:d}=oe(),{realm:p}=de(),c=xi(),[m,u]=b("name"),[g,h]=b(pn.none),[S,k]=b(!1),[C,T]=b(),[v,D]=b([]),z=R=>D(R.filter(({id:j})=>j!==yt)),[B,_]=b(!1),[I,F]=b(0),y=()=>F(I+1),K=R=>R.id===yt,{hasAccess:w}=Ae(),f=w("manage-clients")||t,P=w("view-clients")||t,U=async(R,j,Ie)=>{const Re=await s.clients.listDefaultClientScopes({id:n}),Ke=await s.clients.listOptionalClientScopes({id:n}),Be=await s.clientScopes.find(),W=le=>Be.find(Fe=>le===Fe.id),Z=Ke.map(le=>{const Fe=W(le.id);return{...le,type:hn.optional,description:Fe?.description}}),ue=Re.map(le=>{const Fe=W(le.id);return{...le,type:hn.default,description:Fe?.description}});let xe=[...Z,...ue];const Pt=xe.map(le=>le.name);T(Be.filter(le=>!Pt.includes(le.name)).filter(le=>le.protocol===i)),xe=c(xe,Ei("name")),P&&xe.unshift({id:yt,name:o("dedicatedScopeName",{clientName:a}),type:pn.none,description:o("dedicatedScopeDescription")});const Lt=m==="name"?Ci(Ie):ki(g),Ee=Number(R);return xe.filter(Lt).slice(Ee,Ee+Number(j))},[O,ae]=Te({titleKey:o("deleteClientScope",{count:v.length,name:v[0]?.name}),messageKey:"deleteConfirmClientScopes",continueButtonLabel:"delete",continueButtonVariant:me.danger,onConfirm:async()=>{try{await mn(s,n,v[0],v[0].type),r(o("clientScopeRemoveSuccess"),J.success),y()}catch(R){d("clientScopeRemoveError",R)}}});return l(H,{children:[C&&e(ri,{clientScopes:C,clientName:a,open:S,toggleDialog:()=>k(!S),onAdd:async R=>{try{await Promise.all(R.map(async j=>await Ti(s,n,j.scope,j.type))),r(o("clientScopeSuccess"),J.success),y()}catch(j){d("clientScopeError",j)}}}),e(It,{loader:U,ariaLabelKey:`clientScopeList-${I}`,searchPlaceholderKey:m==="name"?"searchByName":void 0,canSelectAll:!0,isPaginated:!0,isSearching:m==="type",onSelect:R=>z([...R]),searchTypeComponent:e(Si,{searchType:m,onSelect:R=>u(R)}),toolbarItem:l(H,{children:[e(yi,{searchType:m,type:g,onSelect:R=>u(R),onType:R=>{h(R),y()}}),f&&l(H,{children:[e(ae,{}),e(ge,{children:e(E,{onClick:()=>k(!0),children:o("addClientScope")})}),e(ge,{children:e(vi,{clientId:n,selectedRows:v,refresh:y})}),e(ge,{children:e(Nn,{onOpenChange:R=>_(R),toggle:R=>e($e,{"data-testid":"kebab","aria-label":"Kebab toggle",ref:R,variant:"plain",onClick:()=>_(!B),isExpanded:B,children:e(Ma,{})}),isOpen:B,children:e(Hn,{children:e(qe,{isDisabled:v.length===0,onClick:async()=>{try{await Promise.all(v.map(R=>mn(s,n,{...R},R.type))),_(!1),z([]),r(o("clientScopeRemoveSuccess")),y()}catch(R){d("clientScopeRemoveError",R)}},children:o("remove")},"deleteAll")})})})]})]}),columns:[{name:"name",displayKey:"assignedClientScope",cellRenderer:R=>K(R)?e(Ce,{to:Ha({realm:p,clientId:n}),children:R.name}):R.name},{name:"type",displayKey:"assignedType",cellRenderer:R=>e(Es,{clientId:n,refresh:y,...R})},{name:"description",cellFormatters:[Ri(o)]}],actions:f?[{title:o("remove"),onRowClick:async R=>(z([R]),O(),!0)}]:[],emptyState:e(Ne,{message:o("emptyClientScopes"),instructions:o("emptyClientScopesInstructions"),primaryActionText:o("emptyClientScopesPrimaryAction"),onPrimaryAction:()=>k(!0)})},I)]})},zt=({text:n,user:i,label:a})=>{const{t}=x();return i?e(ea,{id:a,actions:e(ta,{children:e(Yn,{id:"code",text:n,label:a})}),children:e(At,{id:`text-area-${a}`,rows:20,value:n,"aria-label":a})}):l(Pn,{variant:"lg",id:a,children:[e(Ln,{titleText:e(H,{children:t(`${a}No`)}),headingLevel:"h2"}),e(_n,{children:t(`${a}IsDisabled`)})]})},Ds=({protocolMappers:n})=>{const[i,a]=b(0);return ht(()=>{a(i+1)},[n]),e(It,{loader:()=>Promise.resolve(n),ariaLabelKey:"effectiveProtocolMappers",searchPlaceholderKey:"searchForProtocol","data-testid":"effective-protocol-mappers",columns:[{name:"mapperName",displayKey:"name"},{name:"containerName",displayKey:"parentClientScope"},{name:"type.category",displayKey:"category"},{name:"type.priority",displayKey:"priority"}]},i)},Ps=({effectiveRoles:n})=>{const[i,a]=b(0);return ht(()=>{a(i+1)},[n]),e(It,{loader:()=>Promise.resolve(n),ariaLabelKey:"effectiveRoleScopeMappings",searchPlaceholderKey:"searchForRole","data-testid":"effective-role-scope-mappings",columns:[{name:"name",displayKey:"role"},{name:"containerId",displayKey:"origin"}]},i)},Ls=({clientId:n,protocol:i})=>{const{adminClient:a}=Y(),t="openid",{t:s}=x(),{enabled:o}=In(),{realm:r}=de(),d=He().protocolMapperTypes[i],[p,c]=b([]),[m,u]=b(!1),[g,h]=b([t]),[S,k]=b(0),[C,T]=b(""),v=()=>T(`${new Date().getTime()}`),[D,z]=b([]),[B,_]=b([]),[I,F]=b(""),[y,K]=b(""),[w,f]=b(""),P=Xe(null),U=Xe(null),O=Xe(null),ae=Xe(null),R=Xe(null),j=Pe(),{watch:Ie}=j,Re=Ie("targetAudience"),{hasAccess:Ke}=Ae(),Be=Ke("view-users");return ne(()=>a.clients.listOptionalClientScopes({id:n}),W=>c(W),[]),ne(async()=>{const W=g.join(" "),Z=await a.clients.evaluatePermission({id:n,roleContainer:r,scope:W,type:"granted"});return{mapperList:await a.clients.evaluateListProtocolMapper({id:n,scope:W}),effectiveRoles:Z}},({mapperList:W,effectiveRoles:Z})=>{z(Z),W.map(ue=>{ue.type=d.find(xe=>xe.id===ue.protocolMapper)}),_(W),v()},[g]),ne(async()=>{const W=g.join(" "),Z=j.getValues("user");if(!Z)return[];const ue=Re.join(" ");return await Promise.all([a.clients.evaluateGenerateAccessToken({id:n,userId:Z[0],scope:W,audience:ue}),a.clients.evaluateGenerateUserInfo({id:n,userId:Z[0],scope:W}),a.clients.evaluateGenerateIdToken({id:n,userId:Z[0],scope:W})])},([W,Z,ue])=>{F(Ue(W)),K(Ue(Z)),f(Ue(ue))},[j.getValues("user"),g,Re]),l(H,{children:[l(ce,{variant:"light",children:[o&&e(Me,{className:"keycloak__section_intro__help",children:l(pe,{children:[e(wi,{})," ",s("evaluateExplain")]})}),l(he,{isHorizontal:!0,children:[e(M,{label:s("scopeParameter"),fieldId:"scopeParameter",labelIcon:e(N,{helpText:s("scopeParameterHelp"),fieldLabelId:"scopeParameter"}),children:l(We,{hasGutter:!0,children:[e(be,{isFilled:!0,children:e(jt,{toggleId:"scopeParameter",variant:vt.typeaheadMulti,typeAheadAriaLabel:s("scopeParameter"),onToggle:()=>u(!m),isOpen:m,selections:g,onSelect:W=>{const Z=W;g.includes(Z)?Z!==t&&h(g.filter(ue=>ue!==Z)):h([...g,Z])},"aria-labelledby":s("scopeParameter"),placeholderText:s("scopeParameterPlaceholder"),children:p.map((W,Z)=>e(Se,{value:W.name,children:W.name},Z))})}),e(be,{children:e(zn,{className:"keycloak__scopes_evaluate__clipboard-copy",children:g.join(" ")})})]})}),Be&&e(ke,{...j,children:e($n,{name:"user",label:"users",helpText:s("userHelp"),defaultValue:"",variant:vt.typeahead,isRequired:!0})}),e(ke,{...j,children:e(jn,{name:"targetAudience",label:s("targetAudience"),helpText:s("targetAudienceHelp"),defaultValue:[],variant:"typeaheadMulti",placeholderText:s("targetAudiencePlaceHolder")})})]})]}),l(Ka,{hasGutter:!0,className:"keycloak__scopes_evaluate__tabs",children:[l(an,{span:8,children:[e(et,{"aria-labelledby":"pf-tab-0-effectiveProtocolMappers",eventKey:0,id:"effectiveProtocolMappers",ref:P,children:e(Ds,{protocolMappers:B})}),e(et,{"aria-labelledby":"pf-tab-0-effectiveRoleScopeMappings",eventKey:1,id:"effectiveRoleScopeMappings",ref:U,hidden:!0,children:e(Ps,{effectiveRoles:D})}),e(et,{"aria-labelledby":s("generatedAccessToken"),eventKey:2,id:"tab-generated-access-token",ref:O,hidden:!0,children:e(zt,{text:I,user:j.getValues("user"),label:"generatedAccessToken"})}),e(et,{"aria-labelledby":s("generatedIdToken"),eventKey:3,id:"tab-generated-id-token",ref:ae,hidden:!0,children:e(zt,{text:w,user:j.getValues("user"),label:"generatedIdToken"})}),e(et,{"aria-labelledby":s("generatedUserInfo"),eventKey:4,id:"tab-generated-user-info",ref:R,hidden:!0,children:e(zt,{text:y,user:j.getValues("user"),label:"generatedUserInfo"})})]}),e(an,{span:4,children:l(Xn,{id:"tabs",isVertical:!0,activeKey:S,onSelect:(W,Z)=>k(Z),children:[e(q,{id:"effectiveProtocolMappers","aria-controls":"effectiveProtocolMappers","data-testid":"effective-protocol-mappers-tab",eventKey:0,title:l(G,{children:[s("effectiveProtocolMappers")," ",e(N,{fieldLabelId:"effectiveProtocolMappers",helpText:s("effectiveProtocolMappersHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:P}),e(q,{id:"effectiveRoleScopeMappings","aria-controls":"effectiveRoleScopeMappings","data-testid":"effective-role-scope-mappings-tab",eventKey:1,title:l(G,{children:[s("effectiveRoleScopeMappings")," ",e(N,{fieldLabelId:"effectiveRoleScopeMappings",helpText:s("effectiveRoleScopeMappingsHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:U}),e(q,{id:"generatedAccessToken","aria-controls":"generatedAccessToken","data-testid":"generated-access-token-tab",eventKey:2,title:l(G,{children:[s("generatedAccessToken")," ",e(N,{fieldLabelId:"generatedAccessToken",helpText:s("generatedAccessTokenHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:O}),e(q,{id:"generatedIdToken","aria-controls":"generatedIdToken","data-testid":"generated-id-token-tab",eventKey:3,title:l(G,{children:[s("generatedIdToken")," ",e(N,{fieldLabelId:"generatedIdToken",helpText:s("generatedIdTokenHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:ae}),e(q,{id:"generatedUserInfo","aria-controls":"generatedUserInfo","data-testid":"generated-user-info-tab",eventKey:4,title:l(G,{children:[s("generatedUserInfo")," ",e(N,{fieldLabelId:"generatedUserInfo",helpText:s("generatedUserInfoHelp"),noVerticalAlign:!1,unWrap:!0})]}),tabContentRef:R})]},C)})]})]})},_s=({client:n})=>{const{adminClient:i}=Y(),{t:a}=x(),{addAlert:t,addError:s}=oe(),{realm:o}=de(),[r,d]=b(),{hasAccess:p}=Ae(),c=p("manage-clients");ne(()=>i.clients.getServiceAccountUser({id:n.id}),u=>d(u),[]);const m=async u=>{try{const g=u.filter(h=>h.client===void 0).map(h=>h.role).flat();await i.users.addRealmRoleMappings({id:r?.id,roles:g}),await Promise.all(u.filter(h=>h.client!==void 0).map(h=>i.users.addClientRoleMappings({id:r?.id,clientUniqueId:h.client.id,roles:[h.role]}))),t(a("roleMappingUpdatedSuccess"),J.success)}catch(g){s("roleMappingUpdatedError",g)}};return r?l(H,{children:[l(ce,{className:"pf-v5-u-pb-0",children:[e(Fn,{className:"pf-v5-c-alert__icon keycloak--service-account--info-text"}),e("span",{className:"pf-v5-u-pl-sm",children:l(Pi,{i18nKey:"manageServiceAccountUser",children:["",e(Ce,{to:Fa({realm:o,id:r.id,tab:"settings"}),children:{link:r.username}})]})})]}),e(Di,{name:n.clientId,id:r.id,type:"users",isManager:c||n.access?.configure,save:m})]}):e(Le,{})},Os=({onChange:n,value:i,save:a,client:t,toggleDownloadDialog:s,toggleDeleteDialog:o})=>{const{t:r}=x(),[d,p]=Te({titleKey:"disableConfirmClientTitle",messageKey:"disableConfirmClient",continueButtonLabel:"disable",onConfirm:()=>{n(!i),a()}}),c=mt(()=>{const h=li(r,t.protocol??"openid-connect");return[{text:t.bearerOnly?e(On,{"data-testid":"bearer-only-explainer-tooltip",content:r("explainBearerOnly"),children:e(ln,{"data-testid":"bearer-only-explainer-label",icon:e(Fn,{}),children:h})}):e(ln,{children:h})}]},[t,r]),{hasAccess:m}=Ae(),u=m("manage-clients")||t.access?.configure,g=[e(qe,{onClick:s,children:r("downloadAdapterConfig")},"download"),e(qe,{onClick:()=>ja(t),children:r("export")},"export"),...!bt(t)&&u?[e(Oe,{},"divider"),e(qe,{"data-testid":"delete-client",onClick:o,children:r("delete")},"delete")]:[]];return l(H,{children:[e(p,{}),e(Ya,{titleKey:t.clientId,subKey:"clientsExplain",badges:c,divider:!1,isReadOnly:!u,helpTextKey:"enableDisable",dropdownItems:g,isEnabled:i,onToggle:h=>{h?(n(h),a()):d()}})]})};function Uo(){const{adminClient:n}=Y(),{t:i}=x(),{addAlert:a,addError:t}=oe(),{realm:s}=de(),{hasAccess:o}=Ae(),r=Ut(),d=o("manage-authorization"),p=o("view-authorization"),c=o("manage-clients"),m=o("view-clients"),u=o("view-users"),g=r(qt.AdminFineGrainedAuthz)&&(d||p),h=ut(),[S,k]=we(),[C,T]=we(),v=Pe(),{clientId:D}=Wt(),[z,B]=b(0),_=()=>B(z+1),I=_i(D),F=xt({control:v.control,name:"clientAuthenticatorType",defaultValue:"client-secret"}),[y,K]=b(),w=async()=>{const $=await n.clients.listRoles({id:D});return Un($,Ve=>Ve.name?.toUpperCase())},f=$=>Va({realm:s,clientId:D,tab:$}),P=ee(f("settings")),U=ee(f("keys")),O=ee(f("credentials")),ae=ee(f("roles")),R=ee(f("clientScopes")),j=ee(f("authorization")),Ie=ee(f("serviceAccount")),Re=ee(f("sessions")),Ke=ee(f("permissions")),Be=ee(f("advanced")),W=ee(f("events")),[Z,ue]=b("userEvents"),xe=$=>sn({realm:s,clientId:D,tab:$}),Pt=ee(xe("setup")),Lt=ee(xe("evaluate")),Ee=$=>on({realm:s,clientId:D,tab:$}),le=ee(Ee("settings")),Fe=ee(Ee("resources")),_t=ee(Ee("scopes")),oa=ee(Ee("policies")),ra=ee(Ee("permissions")),la=ee(Ee("evaluate")),ca=ee(Ee("export")),[da,ua]=Te({titleKey:"clientDeleteConfirmTitle",messageKey:"clientDeleteConfirm",continueButtonLabel:"delete",continueButtonVariant:me.danger,onConfirm:async()=>{try{await n.clients.del({id:D}),a(i("clientDeletedSuccess"),J.success),h(za({realm:s}))}catch($){t("clientDeleteError",$)}}}),Ot=$=>{Ga($,v.setValue),$.attributes?.["acr.loa.map"]&&v.setValue(A("attributes.acr.loa.map"),Object.entries(JSON.parse($.attributes["acr.loa.map"])).flatMap(([Ve,Nt])=>({key:Ve,value:Nt}))),v.reset(v.getValues(),{keepDirty:!1})};ne(()=>n.clients.findOne({id:D}),$=>{if(!$)throw new Error(i("notFound"));K(Ba($)),Ot($)},[D,z]);const _e=async({confirmed:$=!1,messageKey:Ve="clientSaveSuccess"}={confirmed:!1,messageKey:"clientSaveSuccess"})=>{if(!await v.trigger())return;if(!y?.publicClient&&y?.clientAuthenticatorType!==F&&!$){T();return}const Nt=rn(v.getValues()),gt=rn(Nt);gt.attributes?.["acr.loa.map"]&&(gt.attributes["acr.loa.map"]=JSON.stringify(Object.fromEntries(gt.attributes["acr.loa.map"].filter(({key:ye})=>ye!=="").map(({key:ye,value:pa})=>[ye,pa]))));try{const ye={...y,...gt};ye.clientId=ye.clientId?.trim(),await n.clients.update({id:D},ye),Ot(ye),K(ye),a(i(Ve),J.success)}catch(ye){t("clientSaveError",ye)}};return y?l(H,{children:[e(Jt,{continueButtonLabel:"yes",cancelButtonLabel:"no",titleKey:i("changeAuthenticatorConfirmTitle",{clientAuthenticatorType:F}),open:C,toggleDialog:T,onConfirm:()=>_e({confirmed:!0}),children:e(H,{children:i("changeAuthenticatorConfirm",{clientAuthenticatorType:F})})}),e(ua,{}),S&&e(Ni,{id:y.id,protocol:y.protocol,open:!0,toggleDialog:k}),e(te,{name:"enabled",control:v.control,defaultValue:!0,render:({field:$})=>e(Os,{value:$.value,onChange:$.onChange,client:y,save:_e,toggleDeleteDialog:da,toggleDownloadDialog:k})}),e(ce,{variant:"light",className:"pf-v5-u-p-0",children:e(ke,{...v,children:l(Ht,{"data-testid":"client-tabs","aria-label":"client-tabs",isBox:!0,mountOnEnter:!0,children:[e(q,{id:"settings","data-testid":"clientSettingsTab",title:e(G,{children:i("settings")}),...P,children:e(Qi,{client:y,save:()=>_e(),reset:()=>Ot(y)})}),(!y.publicClient&&!bt(y)||y.protocol==="saml")&&l(q,{id:"keys","data-testid":"keysTab",title:e(G,{children:i("keys")}),...U,children:[y.protocol==="openid-connect"&&e(ks,{clientId:D,save:_e,refresh:_,hasConfigureAccess:y.access?.configure}),y.protocol==="saml"&&e(xs,{clientId:D,save:_e})]}),!y.publicClient&&!bt(y)&&(m||y.access?.configure||y.access?.view)&&e(q,{id:"credentials",title:e(G,{children:i("credentials")}),...O,children:e(ys,{client:y,save:_e,refresh:_},z)}),e(q,{id:"roles","data-testid":"rolesTab",title:e(G,{children:i("roles")}),...ae,children:e(Qa,{loader:w,paginated:!1,messageBundle:"client",toCreate:qa({realm:s,clientId:y.id}),toDetail:$=>Ua({realm:s,clientId:y.id,id:$,tab:"details"}),isReadOnly:!(c||y.access?.configure)})}),!bt(y)&&!y.bearerOnly&&e(q,{id:"clientScopes","data-testid":"clientScopesTab",title:e(G,{children:i("clientScopes")}),...R,children:l(Ht,{defaultLocation:sn({realm:s,clientId:D,tab:"setup"}),mountOnEnter:!0,unmountOnExit:!0,children:[e(q,{id:"setup","data-testid":"clientScopesSetupTab",title:e(G,{children:i("setup")}),...Pt,children:e(ws,{clientName:y.clientId,clientId:D,protocol:y.protocol,fineGrainedAccess:y.access?.manage})}),e(q,{id:"evaluate","data-testid":"clientScopesEvaluateTab",title:e(G,{children:i("evaluate")}),...Lt,children:e(Ls,{clientId:D,protocol:y.protocol})})]})}),y.authorizationServicesEnabled&&!I&&(d||p)&&e(q,{id:"authorization","data-testid":"authorizationTab",title:e(G,{children:i("authorization")}),...j,children:l(Ht,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:on({realm:s,clientId:D,tab:"settings"}),children:[e(q,{id:"settings","data-testid":"authorizationSettings",title:e(G,{children:i("settings")}),...le,children:e(hs,{clientId:D})}),e(q,{id:"resources","data-testid":"authorizationResources",title:e(G,{children:i("resources")}),...Fe,children:e(us,{clientId:D,isDisabled:!d})}),e(q,{id:"scopes","data-testid":"authorizationScopes",title:e(G,{children:i("scopes")}),..._t,children:e(ps,{clientId:D,isDisabled:!d})}),e(q,{id:"policies","data-testid":"authorizationPolicies",title:e(G,{children:i("policies")}),...oa,children:e(mi,{clientId:D,isDisabled:!d})}),e(q,{id:"permissions","data-testid":"authorizationPermissions",title:e(G,{children:i("permissions")}),...ra,children:e(ls,{clientId:D,isDisabled:!d})}),u&&e(q,{id:"evaluate","data-testid":"authorizationEvaluate",title:e(G,{children:i("evaluate")}),...la,children:e(as,{client:y,save:_e})}),o("manage-authorization")&&e(q,{id:"export","data-testid":"authorizationExport",title:e(G,{children:i("export")}),...ca,children:e(ss,{})})]})}),y.serviceAccountsEnabled&&u&&e(q,{id:"serviceAccount","data-testid":"serviceAccountTab",title:e(G,{children:i("serviceAccount")}),...Ie,children:e(_s,{client:y})}),e(q,{id:"sessions","data-testid":"sessionsTab",title:e(G,{children:i("sessions")}),...Re,children:e(ji,{client:y})}),g&&(c||y.access?.manage)&&e(q,{id:"permissions","data-testid":"permissionsTab",title:e(G,{children:i("permissions")}),...Ke,children:e(Wa,{id:y.id,type:"clients"})}),e(q,{id:"advanced","data-testid":"advancedTab",title:e(G,{children:i("advanced")}),...Be,children:e(Gi,{save:_e,client:y})}),o("view-events")&&e(q,{"data-testid":"events-tab",title:e(G,{children:i("events")}),...W,children:l(Xn,{activeKey:Z,onSelect:($,Ve)=>ue(Ve),children:[e(q,{eventKey:"userEvents",title:e(G,{children:i("userEvents")}),children:e(Li,{client:y.clientId})}),e(q,{eventKey:"adminEvents",title:e(G,{children:i("adminEvents")}),children:e(Oi,{resourcePath:`clients/${y.id}`})})]})})]})})})]}):e(Le,{})}export{Uo as default};
//# sourceMappingURL=ClientDetails-4oMM7Bkx.js.map
