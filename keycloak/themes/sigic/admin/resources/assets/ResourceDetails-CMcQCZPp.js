import{jsxs as c,Fragment as y,jsx as r}from"react/jsx-runtime";import{u as x,a as B,V as _,l as E,b as K,aO as M,j as O,q as A,bT as w,aS as j,y as z,D as U,P as G,n as Y,Y as l,K as D,O as R,A as W,h as P,B as J,L as Q,o as X,p as Z,bE as $}from"./main-Dml5vH_M.js";import{useState as d}from"react";import{D as ee}from"./SwitchControl-DVIXTwQM.js";import{u as re}from"./ConfirmDialog-BN0phSta.js";import{F as ae}from"./FormAccess-Dgk035ov.js";import{K as te}from"./KeyValueInput-CataZRq4.js";import{M as se}from"./MultiLineInput-BnUu5qtj.js";import{V as oe}from"./ViewHeader-CnGpO8mW.js";import{u as ie}from"./useParams-Cmi1OAEj.js";import{S as ne}from"./ScopePicker-Bg-Itgx4.js";import"react-dom";import"./KeySelect-Ba6sDuzD.js";import"./useIsAdminPermissionsClient-IDuSpu5V.js";function we(){const{adminClient:o}=x(),{t:e}=B(),[m,N]=d(),[S,p]=d(),[b,V]=d(),{addAlert:f,addError:h}=_(),g=E({mode:"onChange"}),{setValue:C,handleSubmit:F}=g,{id:s,resourceId:t,realm:u}=ie(),I=K(),H=(a={})=>{X(a,C)},{hasAccess:T}=M(),v=!T("manage-authorization");O(()=>Promise.all([o.clients.findOne({id:s}),t?o.clients.getResource({id:s,resourceId:t}):Promise.resolve(void 0),t?o.clients.listPermissionsByResource({id:s,resourceId:t}):Promise.resolve(void 0)]),([a,i,n])=>{if(!a)throw new Error(e("notFound"));N(a),V(n),p(i),H(i)},[]);const L=async a=>{const i=Z(a);try{if(t)await o.clients.updateResource({id:s,resourceId:t},i);else{const n=await o.clients.createResource({id:s},i);p(i),I($({realm:u,id:s,resourceId:n._id}))}f(e((t?"update":"create")+"ResourceSuccess"),A.success)}catch(n){h("resourceSaveError",n)}},[k,q]=re({titleKey:"deleteResource",children:c(y,{children:[e("deleteResourceConfirm"),b?.length!==0&&r(j,{variant:"warning",isInline:!0,isPlain:!0,title:e("deleteResourceWarning"),className:"pf-v5-u-pt-lg",children:r("p",{className:"pf-v5-u-pt-xs",children:b?.map(a=>r("strong",{className:"pf-v5-u-pr-md",children:a.name},a.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await o.clients.delResource({id:s,resourceId:t}),f(e("resourceDeletedSuccess"),A.success),I(w({realm:u,clientId:s,tab:"resources"}))}catch(a){h("resourceDeletedError",a)}}});return m?c(y,{children:[r(q,{}),r(oe,{titleKey:t?S?.name:"createResource",dropdownItems:t?[r(U,{"data-testid":"delete-resource",isDisabled:v,onClick:()=>k(),children:e("delete")},"delete")]:void 0}),r(G,{variant:"light",children:r(Y,{...g,children:c(ae,{isHorizontal:!0,role:"manage-authorization",className:"keycloak__resource-details__form",onSubmit:F(L),children:[r(l,{name:t?"owner.name":"",label:e("owner"),labelIcon:e("ownerHelp"),defaultValue:m.clientId,readOnly:!0}),r(l,{name:"name",label:e("name"),labelIcon:e("resourceNameHelp"),rules:{required:e("required")}}),r(l,{name:"displayName",label:e("displayName"),labelIcon:e("displayNameHelp"),rules:{required:e("required")}}),r(l,{name:"type",label:e("type"),labelIcon:e("resourceDetailsTypeHelp")}),r(D,{label:e("uris"),fieldId:"uris",labelIcon:r(R,{helpText:e("urisHelp"),fieldLabelId:"uris"}),children:r(se,{name:"uris",type:"url","aria-label":e("uris"),addButtonLabel:"addUri"})}),r(ne,{clientId:s}),r(l,{name:"icon_uri",label:e("iconUri"),labelIcon:e("iconUriHelp"),type:"url"}),r(ee,{name:"ownerManagedAccess",label:e("ownerManagedAccess"),labelIcon:e("ownerManagedAccessHelp")}),r(D,{hasNoPaddingTop:!0,label:e("resourceAttribute"),labelIcon:r(R,{helpText:e("resourceAttributeHelp"),fieldLabelId:"resourceAttribute"}),fieldId:"resourceAttribute",children:r(te,{name:"attributes",isDisabled:v})}),r(W,{children:c("div",{className:"pf-v5-u-mt-md",children:[r(P,{variant:J.primary,type:"submit","data-testid":"save",children:e("save")}),r(P,{variant:"link","data-testid":"cancel",component:a=>r(Q,{...a,to:w({realm:u,clientId:s,tab:"resources"})}),children:e("cancel")})]})})]})})})]}):r(z,{})}export{we as default};
//# sourceMappingURL=ResourceDetails-CMcQCZPp.js.map
