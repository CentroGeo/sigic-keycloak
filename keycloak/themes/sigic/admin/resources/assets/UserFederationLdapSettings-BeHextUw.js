import{jsxs as C,Fragment as I,jsx as e}from"react/jsx-runtime";import{u as w,b as K,a as x,V as B,c as E,j as R,B as U,q as V,w as j,f as N,T as q,h as z,L as k,l as H,d as O,eZ as M,y as Z,n as _,P as F,e_ as P}from"./main-Dml5vH_M.js";import{useState as m}from"react";import{u as T,R as G}from"./RoutableTabs-D0MTj5jQ.js";import{U as J,s as Q}from"./UserFederationLdapForm-CopPet_9.js";import{u as W}from"./ConfirmDialog-BN0phSta.js";import{u as X,m as Y}from"./useLocaleSort-DeXbTEE9.js";import{E as $}from"./ExtendedHeader-CU_lK8qQ.js";import{a as D,b as A}from"./Tabs-swfKYDgo.js";import"react-dom";import"./PageHandler-BQ1_55gR.js";import"./DynamicComponents-Cxsqsl9R.js";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./DataListItemRow-B3J1tfyO.js";import"./KeySelect-Ba6sDuzD.js";import"./MultiLineInput-BnUu5qtj.js";import"./AddRoleMappingModal-FlNvMd3n.js";import"./translationFormatter-DtFomvax.js";import"./filter-icon-BO7Evf9d.js";import"./CodeEditor-C7HQ48Ys.js";import"./useParams-Cmi1OAEj.js";import"./constants-BclHbWtx.js";import"./FormAccess-Dgk035ov.js";import"./SettingsCache-BwAe_-Fz.js";import"./ViewHeader-CnGpO8mW.js";import"./isEqual-xoTijI-C.js";const ee=({toDetail:i,...a})=>e(k,{to:i(a.id),children:a.name}),te=({toCreate:i,toDetail:a})=>{const{adminClient:o}=w(),n=K(),{t}=x(),{addAlert:l,addError:u}=B(),[p,g]=m(0),f=()=>g(p+1),[y,h]=m([]),b=X(),{id:S}=E(),[c,d]=m();R(()=>o.components.find({parent:S,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),s=>{h(b(s.map(L=>({...L,name:L.name,type:L.providerId})),Y("name")))},[p]);const[r,v]=W({titleKey:t("deleteMappingTitle",{mapperId:c?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await o.components.del({id:c.id}),f(),l(t("mappingDeletedSuccess"),V.success),d(void 0)}catch(s){u("mappingDeletedError",s)}}});return C(I,{children:[e(v,{}),e(j,{loader:y,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(q,{children:e(z,{"data-testid":"add-mapper-btn",variant:"primary",component:s=>e(k,{...s,to:i}),children:t("addMapper")})}),actions:[{title:t("delete"),onRowClick:s=>{d(s),r()}}],columns:[{name:"name",cellRenderer:s=>e(ee,{...s,toDetail:a})},{name:"type"}],emptyState:e(N,{message:t("emptyMappers"),instructions:t("emptyMappersInstructions"),primaryActionText:t("emptyPrimaryAction"),onPrimaryAction:()=>n(i)})},p)]})};function xe(){const{adminClient:i}=w(),{t:a}=x(),o=H({mode:"onChange"}),{realm:n}=O(),{id:t}=E(),{addAlert:l,addError:u}=B(),[p,g]=m(),[f,y]=m(0),h=()=>y(r=>r+1);R(()=>i.components.findOne({id:t}),r=>{if(!r)throw new Error(a("notFound"));g(r),c(r)},[t,f]);const b=T(M({realm:n,id:t,tab:"settings"})),S=T(M({realm:n,id:t,tab:"mappers"})),c=r=>{o.reset({}),o.reset(r),o.setValue("config.periodicChangedUsersSync",r.config?.changedSyncPeriod?.[0]!=="-1"),o.setValue("config.periodicFullSync",r.config?.fullSyncPeriod?.[0]!=="-1")},d=async r=>{try{await i.components.update({id:t},Q(r)),l(a("userProviderSaveSuccess"),V.success),h()}catch(v){u("userProviderSaveError",v)}};return p?C(_,{...o,children:[e($,{provider:"LDAP",noDivider:!0,editMode:p.config?.editMode,save:()=>o.handleSubmit(d)()}),e(F,{variant:"light",className:"pf-v5-u-p-0",children:C(G,{defaultLocation:M({realm:n,id:t,tab:"settings"}),isBox:!0,children:[e(D,{id:"settings",title:e(A,{children:a("settings")}),...b,children:e(F,{variant:"light",children:e(J,{id:t,onSubmit:d})})}),e(D,{id:"mappers",title:e(A,{children:a("mappers")}),"data-testid":"ldap-mappers-tab",...S,children:e(te,{toCreate:P({realm:n,id:t,mapperId:"new"}),toDetail:r=>P({realm:n,id:t,mapperId:r})})})]})})]}):e(Z,{})}export{xe as default};
//# sourceMappingURL=UserFederationLdapSettings-BeHextUw.js.map
