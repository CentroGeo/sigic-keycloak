import{jsxs as h,jsx as e,Fragment as T}from"react/jsx-runtime";import{u as v,a as C,V as D,aO as R,P as E,K as x,S as P,O,a8 as V,q as b,b as F,j as L,y as j,aZ as A,c9 as w}from"./main-Dml5vH_M.js";import{useState as I}from"react";import{M as H}from"./MapperList-B-sXYsMv.js";import{u as K,R as N}from"./RoutableTabs-D0MTj5jQ.js";import{V as k}from"./ViewHeader-CnGpO8mW.js";import{u as q}from"./useParams-Cmi1OAEj.js";import{F as G}from"./FormAccess-Dgk035ov.js";import{R as z}from"./AddRoleMappingModal-FlNvMd3n.js";import{a as M,b as y}from"./Tabs-swfKYDgo.js";import"react-dom";import"./useLocaleSort-DeXbTEE9.js";import"./DataListItemRow-B3J1tfyO.js";import"./PageHandler-BQ1_55gR.js";import"./DynamicComponents-Cxsqsl9R.js";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./KeySelect-Ba6sDuzD.js";import"./MultiLineInput-BnUu5qtj.js";import"./CodeEditor-C7HQ48Ys.js";import"./constants-BclHbWtx.js";import"./translationFormatter-DtFomvax.js";import"./ConfirmDialog-BN0phSta.js";import"./filter-icon-BO7Evf9d.js";const B=({client:p})=>{const{adminClient:l}=v(),{t:s}=C(),{addAlert:r,addError:m}=D(),[t,f]=I(p),{hasAccess:a}=R(),u=a("manage-clients")||t.access?.manage,S=async c=>{try{const n=c.filter(i=>i.client===void 0).map(i=>i.role).flat();await Promise.all([l.clients.addRealmScopeMappings({id:t.id},n),...c.filter(i=>i.client!==void 0).map(i=>l.clients.addClientScopeMappings({id:t.id,client:i.client.id},[i.role]))]),r(s("clientScopeSuccess"),b.success)}catch(n){m("clientScopeError",n)}},g=async()=>{const c={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await l.clients.update({id:t.id},c),r(s("clientScopeSuccess"),b.success),f(c)}catch(n){m("clientScopeError",n)}};return h(E,{children:[e(G,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(x,{hasNoPaddingTop:!0,label:s("fullScopeAllowed"),labelIcon:e(O,{helpText:s("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(P,{id:"fullScopeAllowed",label:s("on"),labelOff:s("off"),isChecked:t.fullScopeAllowed,onChange:g,"aria-label":s("fullScopeAllowed")})})}),!t.fullScopeAllowed&&h(T,{children:[e(V,{}),e(z,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function he(){const{adminClient:p}=v(),{t:l}=C(),s=F(),{realm:r,clientId:m}=q(),{addAlert:t,addError:f}=D(),[a,u]=I();L(()=>p.clients.findOne({id:m}),u,[]);const S=o=>K(A({realm:r,clientId:m,tab:o})),g=S("mappers"),c=S("scope");if(!a)return e(j,{});const n=async o=>{if(Array.isArray(o))try{await p.clients.addMultipleProtocolMappers({id:a.id},o),u(await p.clients.findOne({id:a.id})),t(l("mappingCreatedSuccess"),b.success)}catch(d){f("mappingCreatedError",d)}else{const d=o;s(w({realm:r,id:a.id,mapperId:d.id,viewMode:"new"}))}},i=async o=>{try{await p.clients.delProtocolMapper({id:a.id,mapperId:o.id}),u({...a,protocolMappers:a.protocolMappers?.filter(d=>d.id!==o.id)}),t(l("mappingDeletedSuccess"),b.success)}catch(d){f("mappingDeletedError",d)}return!0};return h(T,{children:[e(k,{titleKey:a.clientId+"-dedicated",subKey:"dedicatedScopeExplain",divider:!1}),e(E,{variant:"light",className:"pf-v5-u-p-0",children:h(N,{isBox:!0,mountOnEnter:!0,defaultLocation:A({realm:r,clientId:m,tab:"mappers"}),children:[e(M,{title:e(y,{children:l("mappers")}),"data-testid":"mappersTab",...g,children:e(H,{model:a,onAdd:n,onDelete:i,detailLink:o=>w({realm:r,id:a.id,mapperId:o,viewMode:"edit"})})}),e(M,{title:e(y,{children:l("scope")}),"data-testid":"scopeTab",...c,children:e(B,{client:a})})]})})]})}export{he as default};
//# sourceMappingURL=DedicatedScopes-BNRJ8dYa.js.map
