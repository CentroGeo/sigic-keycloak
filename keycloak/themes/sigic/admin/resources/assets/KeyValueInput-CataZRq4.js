import{jsx as e,jsxs as c,Fragment as N}from"react/jsx-runtime";import{useState as q,useMemo as x,Fragment as F}from"react";import{a as C,bg as P,bn as T,ai as O,a1 as m,Z as w,bl as G,J as j,bO as B,bP as d,dC as $,dD as g,h as v,a4 as H,ac as b,a9 as L,ad as M,ae as R}from"./main-Dml5vH_M.js";import{K as z,A as J,a as K}from"./KeySelect-Ba6sDuzD.js";const U=({selectItems:t,keyValue:n,...l})=>{const{t:s}=C(),{field:r}=P(l),[u,i]=q(!1),p=x(()=>t.find(a=>a.key===n),[t,n]);return p?.values?e(T,{onToggle:a=>i(a),isOpen:u,onSelect:a=>{r.onChange(a),i(!1)},selections:r.value?[r.value]:s("choose"),placeholderText:s("valuePlaceholder"),children:p.values.map(a=>e(O,{value:a,children:a},a))}):e(m,{"aria-label":s("customValue"),"data-testid":l.name,...r})},X=({name:t,label:n="attributes",defaultKeyValue:l,isDisabled:s=!1})=>{const{t:r}=C(),{control:u,register:i,formState:{errors:p}}=w(),{fields:a,append:I,remove:S}=G({shouldUnregister:!0,control:u,name:t}),f=()=>I({key:"",value:""}),A=j({name:t,control:u,defaultValue:[]});return a.length>0?c(N,{children:[c(B,{hasGutter:!0,children:[e(d,{className:"pf-v5-c-form__label",span:5,children:e("span",{className:"pf-v5-c-form__label-text",children:r("key")})}),e(d,{className:"pf-v5-c-form__label",span:7,children:e("span",{className:"pf-v5-c-form__label-text",children:r("value")})}),a.map((E,o)=>{const h=p[t]?.[o],k=!!h?.key,y=!!h?.value||!!h?.message,_=h?.message||r("valueError");return c(F,{children:[c(d,{span:5,children:[l?e(z,{name:`${t}.${o}.key`,selectItems:l,rules:{required:!0}}):e(m,{placeholder:r("keyPlaceholder"),"aria-label":r("key"),"data-testid":`${t}-key`,...i(`${t}.${o}.key`,{required:!0}),validated:k?"error":"default",isRequired:!0,isDisabled:s}),k&&e($,{children:e(g,{variant:"error",children:r("keyError")})})]}),c(d,{span:5,children:[l?e(U,{name:`${t}.${o}.value`,keyValue:A[o]?.key,selectItems:l,rules:{required:!0}}):e(m,{placeholder:r("valuePlaceholder"),"aria-label":r("value"),"data-testid":`${t}-value`,...i(`${t}.${o}.value`,{required:!0}),validated:y?"error":"default",isRequired:!0,isDisabled:s}),y&&e($,{children:e(g,{variant:"error",children:_})})]}),e(d,{span:2,children:e(v,{variant:"link",title:r("removeAttribute"),onClick:()=>S(o),"data-testid":`${t}-remove`,isDisabled:s,children:e(H,{})})})]},E.id)})]}),e(J,{children:e(K,{children:e(v,{"data-testid":`${t}-add-row`,className:"pf-v5-u-px-0 pf-v5-u-mt-sm",variant:"link",icon:e(b,{}),onClick:f,isDisabled:s,children:r("addAttribute",{label:n})})})})]}):c(L,{"data-testid":`${t}-empty-state`,className:"pf-v5-u-p-0",variant:"xs",children:[e(M,{children:r("missingAttributes",{label:n})}),e(R,{children:e(v,{"data-testid":`${t}-add-row`,variant:"link",icon:e(b,{}),size:"sm",onClick:f,isDisabled:s,children:r("addAttribute",{label:n})})})]})};export{X as K};
//# sourceMappingURL=KeyValueInput-CataZRq4.js.map
