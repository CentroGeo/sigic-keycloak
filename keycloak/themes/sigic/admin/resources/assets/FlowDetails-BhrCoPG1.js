import{jsx as O,jsxs as te,Fragment as be}from"react/jsx-runtime";import{ar as Wt,as as ko,at as Rt,au as ta,av as Sl,aw as Nl,a as _e,ap as Mo,I as kl,u as mt,V as Io,l as Pn,M as nn,m as rn,n as Fn,F as on,h as ge,B as Je,q as We,j as Dt,ax as Ml,P as na,R as Il,Y as _n,$ as oi,f as Ll,ay as ii,az as si,aA as Al,aB as Tl,aC as Ol,aD as Rl,aE as Dl,aF as ra,aG as je,aH as zn,aI as $l,aJ as Pl,D as ct,aj as oa,z as ao,aK as Fl,A as zl,o as Hl,p as Vl,ai as ql,ag as Bl,ah as Gl,O as jl,aL as ze,d as Yl,c as Wl,b as Xl,am as Zl,ao as Ul,a6 as Kl,a7 as Ql,T as Jn,aM as Jl,aN as eu}from"./main-Dml5vH_M.js";import*as Re from"react";import F,{useEffect as oe,useState as re,useMemo as Ne,forwardRef as ia,useCallback as de,memo as ae,useContext as Hn,createContext as sa,useRef as Q}from"react";import{u as ai}from"./ConfirmDialog-BN0phSta.js";import{V as tu}from"./ViewHeader-CnGpO8mW.js";import{C as nu,B as ru,D as ou}from"./DuplicateFlowModal-DimyBdGI.js";import{N as iu}from"./NameDescription-J_2q-E71.js";import{u as su,m as au}from"./useLocaleSort-DeXbTEE9.js";import"react-dom";import{D as cu,a as lu,b as uu,c as du}from"./Droppable-BYpgxtpN.js";import{P as fu}from"./pencil-alt-icon-B3dGJCA1.js";import{D as hu}from"./DynamicComponents-Cxsqsl9R.js";import{T as aa}from"./trash-icon-sFYD2cXL.js";import{T as ci}from"./Trans-BHLWmjXF.js";import"./DataListItemRow-B3J1tfyO.js";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./KeySelect-Ba6sDuzD.js";import"./MultiLineInput-BnUu5qtj.js";import"./AddRoleMappingModal-FlNvMd3n.js";import"./translationFormatter-DtFomvax.js";import"./filter-icon-BO7Evf9d.js";import"./CodeEditor-C7HQ48Ys.js";const dt={modifiers:{compact:"pf-m-compact",selected:"pf-m-selected"},toggleGroup:"pf-v5-c-toggle-group",toggleGroupButton:"pf-v5-c-toggle-group__button",toggleGroupIcon:"pf-v5-c-toggle-group__icon",toggleGroupItem:"pf-v5-c-toggle-group__item",toggleGroupText:"pf-v5-c-toggle-group__text"};var Cn;(function(e){e.icon="icon",e.text="text"})(Cn||(Cn={}));const co=({variant:e,children:t})=>Re.createElement("span",{className:Wt(e==="icon"&&dt.toggleGroupIcon,e==="text"&&dt.toggleGroupText)},t);co.displayName="ToggleGroupItemElement";const Sn=e=>{var{text:t,icon:n,className:r,isDisabled:o=!1,isSelected:s=!1,"aria-label":i="",onChange:a=()=>{},buttonId:l=""}=e,u=ko(e,["text","icon","className","isDisabled","isSelected","aria-label","onChange","buttonId"]);const c=d=>{a(d,!s)};return!i&&n&&!t&&console.warn("An accessible aria-label is required when using the toggle group item icon variant."),Re.createElement("div",Object.assign({className:Wt(dt.toggleGroupItem,r)},u),Re.createElement("button",Object.assign({type:"button",className:Wt(dt.toggleGroupButton,s&&dt.modifiers.selected),"aria-pressed":s,onClick:c},i&&{"aria-label":i},o&&{disabled:!0},l&&{id:l}),n?Re.createElement(co,{variant:Cn.icon},n):null,t?Re.createElement(co,{variant:Cn.text},t):null))};Sn.displayName="ToggleGroupItem";const ca=e=>{var{className:t,children:n,isCompact:r=!1,areAllGroupsDisabled:o=!1,"aria-label":s}=e,i=ko(e,["className","children","isCompact","areAllGroupsDisabled","aria-label"]);const a=Re.Children.map(n,l=>Re.isValidElement(l)&&l.type===Sn?Re.cloneElement(l,o?{isDisabled:!0}:{}):l);return Re.createElement("div",Object.assign({className:Wt(dt.toggleGroup,r&&dt.modifiers.compact,t),role:"group","aria-label":s},i),a)};ca.displayName="ToggleGroup";const pu={name:"CodeBranchIcon",height:512,width:384,svgPath:"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z",yOffset:0,xOffset:0},gu=Rt(pu),mu={name:"DomainIcon",height:1024,width:1024,svgPath:"M544,511.9 C561.476067,511.948945 575.664266,525.962873 575.994253,543.371439 L576,543.9 L576,991.9 C575.951055,1009.37607 561.937127,1023.56427 544.528561,1023.89425 L544,1023.9 L352,1023.9 C334.523933,1023.85105 320.335734,1009.83713 320.005747,992.428561 L320,991.9 L320,543.9 C320.048945,526.423933 334.062873,512.235734 351.471439,511.905747 L352,511.9 L544,511.9 Z M704,576 L704,960 L640,960 L640,576 L704,576 Z M512,896 L384,896 L384,960 L512,960 L512,896 Z M960,513.1 L960,513.2 C960,665.4 884.1,799.9 768,880.9 L768,880.9 L768,799.4 C773.3,794.6 778.4,789.8 783.5,784.7 C855.624209,712.728348 896.108133,614.991161 896,513.1 L896,513.1 L960,513.1 Z M149.8,385 C100.714385,524.561202 135.973879,679.905126 240.5,784.6 C245.5,789.7 250.7,794.6 256,799.3 L256,799.3 L256,880.8 C139.9,799.8 63.9999013,665.3 63.9999013,513.1 C63.9712238,469.725105 70.236499,426.575548 82.6,385 L82.6,385 Z M512.1,704 L384,704 L384,832 L512.1,832 L512.1,704 Z M512,576 L448,576 L448,640 L512,640 L512,576 Z M864,-1.13686838e-13 C881.496381,-1.13686838e-13 895.713128,14.0417829 895.995713,31.4708215 L896,32 L896,406 C896,423.496381 881.958217,437.713128 864.529179,437.995713 L864,438 L608,438 C590.503619,438 576.286872,423.958217 576.004287,406.529179 L576,406 L576,32 C576,14.5036191 590.041783,0.286872383 607.470821,0.00428708574 L608,-1.13686838e-13 L864,-1.13686838e-13 Z M1024,64 L1024,384 L960,384 L960,64 L1024,64 Z M832,256 L640,256 L640,352 L832,352 L832,256 Z M224,-5.68434189e-14 C241.476067,0.0489452394 255.664266,14.0628726 255.994253,31.4714395 L256,32 L256,288 C255.951055,305.476067 241.937127,319.664266 224.528561,319.994253 L224,320 L32,320 C14.5239331,319.951055 0.335734448,305.937127 0.00574685353,288.528561 L0,288 L0,32 C0.0489452394,14.5239331 14.0628726,0.335734448 31.4714395,0.00574685353 L32,-5.68434189e-14 L224,-5.68434189e-14 Z M192,192 L64,192 L64,256 L192,256 L192,192 Z M512,65 L512,129 C460.642759,128.90985 409.795141,139.181409 362.5,159.2 C347.917219,165.399771 333.724426,172.47947 320,180.4 L320,180.4 L320,108.2 C380.012207,79.7623165 445.590913,65.0071076 512,65 L512,65 Z M832,64 L736,64 L736,160 L832,160 L832,64 Z M192,64 L128,64 L128,128 L192,128 L192,64 Z",yOffset:0,xOffset:0},yu=Rt(mu),wu={name:"MapMarkerIcon",height:512,width:384,svgPath:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0z",yOffset:0,xOffset:0},vu=Rt(wu),bu={name:"ProcessAutomationIcon",height:1024,width:1024,svgPath:"M1016,640.1 L724,640.1 L695.9,608.7 C701.8,597.3 706.7,585.2 710.5,572.7 L793.5,567.2 C799.9,566.3 804.9,559.9 804.9,553.5 L804.9,468.2 C804.8,461.7 800.2,456.2 793.8,454.4 L709.3,449.7 C705.5,437.7 700.5,426.1 694.7,415.1 L750.4,351.5 C754.3,346.3 753.3,338.3 748.8,333.8 L688.5,273.5 C684,269 676.8,268.3 671,271.6 L607.3,328.6 C596.4,322.9 585,318.2 573.2,314.5 L567.6,229.6 C566.7,223.2 560.3,218.2 553.9,218.2 L468.6,218.2 C462.2,218.2 456.7,222.8 454.9,229.2 L450.2,314.2 C438,317.9 426.3,322.8 415.2,328.6 L351.1,273.6 C345.9,269.7 337.9,270.7 333.4,275.2 L304.3,304.3 L240.6,240.6 C310.1,171.1 406.1,128 512,128 C718.3,128 887.2,291.6 895.6,495.9 C896,504.5 903.1,511.2 911.6,511.2 L1007.7,511.2 C1016.7,511.2 1024,503.7 1023.7,494.7 C1014.6,220.4 788.6,0 512.1,0 C370.9,0 242.9,57.5 150.2,150.1 L13.7,13.6 C8.6,8.6 0,12.2 0,19.3 L0,376.1 C0,380.5 3.6,384.1 8,384.1 L299.9,384.1 L328.1,414.6 C322,426 316.9,438 312.9,450.5 L230.1,456.9 C223.7,457.8 218.7,464.2 218.7,470.6 L218.7,555.9 C218.7,562.3 223.3,567.8 229.7,569.6 L312,572.9 C315.9,585.9 321,598.3 327.2,610.1 L274,672.1 C270.1,677.3 271.1,685.3 275.6,689.8 L335.9,750.1 C340.4,754.6 347.6,755.3 353.4,752 L413.3,696.7 C425.2,703.1 437.9,708.3 451,712.3 L457.2,793.1 C458.1,799.5 464.5,804.5 470.9,804.5 L556.2,804.5 C562.6,804.5 568.1,799.9 569.9,793.5 L573.1,711.7 C585.9,707.7 598.2,702.5 609.9,696.2 L671.4,750.1 C676.6,754 684.6,753 689.1,748.5 L718.9,718.7 L783.6,783.4 C714,852.9 618,896 512.1,896 C305.4,896 136.4,732.1 128.4,527.3 C128,518.7 121,512 112.4,512 L16.3,512 C7.3,512 0,519.5 0.3,528.5 C9,803.2 235.3,1024 512.1,1024 C653.2,1024 781.2,966.6 873.9,873.9 L1010.3,1010.4 C1015.4,1015.4 1024,1011.8 1024,1004.7 L1024,648 C1024,643.6 1020.4,640 1016,640.1 M511.1,640.9 C440.4,640.9 383.1,583.6 383.1,512.9 C383.1,442.2 440.4,384.9 511.1,384.9 C581.8,384.9 639.1,442.2 639.1,512.9 C639.1,583.6 581.8,640.9 511.1,640.9",yOffset:0,xOffset:0},xu=Rt(bu),Eu={name:"TableIcon",height:512,width:512,svgPath:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z",yOffset:0,xOffset:0},_u=Rt(Eu),Cu={name:"TaskIcon",height:1024,width:768,svgPath:"M640,432 C640,440.8 632.8,448 624,448 L143.985,447.572 C135.185,447.572 127.985,440.373 127.985,431.572 L127.985,399.572 C127.985,390.772 135.185,383.572 143.985,383.572 L624,384 C632.8,384 640,391.2 640,400 L640,432 Z M574.77,623.998 C574.77,632.799 567.57,639.998 558.77,639.998 L207.935,639.999 C199.135,639.999 191.935,632.799 191.935,623.999 L191.935,591.999 C191.935,583.199 199.135,575.999 207.935,575.999 L558.77,575.998 C567.57,575.998 574.77,583.198 574.77,591.998 L574.77,623.998 Z M510.833,815.998 C510.833,824.799 503.633,831.998 494.833,831.998 L271.719,831.999 C262.919,831.999 255.719,824.799 255.719,815.999 L255.719,783.999 C255.719,775.199 262.919,767.999 271.719,767.999 L494.833,767.998 C503.633,767.998 510.833,775.198 510.833,783.998 L510.833,815.998 Z M384,80 C410.6,80 432,101.4 432,128 C432,154.6 410.6,176 384,176 C357.4,176 336,154.6 336,128 C336,101.4 357.4,80 384,80 L384,80 Z M672,128 L512,128 C512,57.4 454.6,0 384,0 C313.4,0 256,57.4 256,128 L96,128 C43,128 0,171 0,224 L0,928 C0,981 43,1024 96,1024 L672,1024 C725,1024 768,981 768,928 L768,224 C768,171 725,128 672,128 L672,128 Z",yOffset:0,xOffset:0},Su=Rt(Cu),la=e=>{var{className:t,rowProps:n,row:r}=e,o=ko(e,["className","rowProps","row"]);const{"aria-level":s,"aria-posinset":i,"aria-setsize":a,isExpanded:l,isDetailsExpanded:u,isHidden:c}=r.props;return Re.createElement(ta,Object.assign({"aria-level":s,"aria-posinset":i,"aria-setsize":a,"aria-expanded":!!l,isHidden:c,className:Wt(t,l&&Nl.modifiers.expanded,u&&Sl.modifiers.treeViewDetailsExpanded)},o))};la.displayName="TreeRowWrapper";const Nu="_icon_1gmts_2",ku={icon:Nu},Mu=()=>{const{t:e}=_e();return O(Mo,{icon:O(kl,{className:ku.icon}),children:e("buildIn")})},Iu=({flow:e,toggleDialog:t})=>{const{adminClient:n}=mt(),{t:r}=_e(),{addAlert:o,addError:s}=Io(),i=Pn({mode:"onChange"}),{reset:a,handleSubmit:l}=i;oe(()=>a(e),[e]);const u=async c=>{try{await n.authenticationManagement.updateFlow({flowId:e.id},{...e,...c}),o(r("updateFlowSuccess"),We.success)}catch(d){s("updateFlowError",d)}t()};return O(nn,{title:r("editFlow"),onClose:t,variant:rn.small,actions:[O(ge,{"data-testid":"confirm",type:"submit",form:"edit-flow-form",children:r("edit")},"confirm"),O(ge,{"data-testid":"cancel",variant:Je.link,onClick:()=>t(),children:r("cancel")},"cancel")],isOpen:!0,children:O(Fn,{...i,children:O(on,{id:"edit-flow-form",onSubmit:l(u),isHorizontal:!0,children:O(iu,{})})})})},Lu=({list:e,setValue:t})=>O(na,{variant:"light",className:"pf-v5-u-py-lg",children:O(on,{isHorizontal:!0,children:e?.map(n=>O(Il,{id:n.id,name:"provider",label:n.displayName,"data-testid":n.id,description:n.description,onChange:()=>{t(n)}},n.id))})}),Lo=({name:e,type:t,onSelect:n})=>{const{adminClient:r}=mt(),{t:o}=_e(),[s,i]=re(),[a,l]=re(),[u,c]=re(10),[d,f]=re(0),[h,g]=re(""),v=su();Dt(async()=>{switch(t){case"client":return r.authenticationManagement.getClientAuthenticatorProviders();case"form":return r.authenticationManagement.getFormActionProviders();case"condition":return(await r.authenticationManagement.getAuthenticatorProviders()).filter($n);case"basic":default:return(await r.authenticationManagement.getAuthenticatorProviders()).filter(w=>!$n(w))}},m=>l(m),[]);const p=Ne(()=>{const m=h.trim().toLowerCase();return v(a??[],au("displayName")).filter(({displayName:w,description:x})=>w?.toLowerCase().includes(m)||x?.toLowerCase().includes(m)).slice(d,d+u+1)},[a,h,d,u]);return O(nn,{variant:rn.medium,isOpen:!0,title:t=="condition"?o("addConditionTo",{name:e}):o("addExecutionTo",{name:e}),onClose:()=>n(),actions:[O(ge,{id:"modal-add","data-testid":"modal-add",onClick:()=>n(s),children:o("add")},"add"),O(ge,{"data-testid":"cancel",id:"modal-cancel",variant:Je.link,onClick:()=>{n()},children:o("cancel")},"cancel")],children:a&&O(Ml,{count:p.length||0,first:d,max:u,onNextClick:f,onPreviousClick:f,onPerPageSelect:(m,w)=>{f(m),c(w)},inputGroupName:"search",inputGroupPlaceholder:o("search"),inputGroupOnEnter:g,children:O(Lu,{list:p.slice(0,u),setValue:i})})})},li=["basic-flow","form-flow"],Ao=({name:e,onConfirm:t,onCancel:n})=>{const{adminClient:r}=mt(),{t:o}=_e(),s=Pn(),[i,a]=re();return Dt(()=>r.authenticationManagement.getFormProviders(),a,[]),oe(()=>{i?.length===1&&s.setValue("provider",i[0].id)},[i]),O(nn,{variant:rn.medium,title:o("addSubFlowTo",{name:e}),onClose:n,actions:[O(ge,{"data-testid":"modal-add",type:"submit",form:"sub-flow-form",children:o("add")},"add"),O(ge,{"data-testid":"cancel",variant:Je.link,onClick:n,children:o("cancel")},"cancel")],isOpen:!0,children:O(on,{id:"sub-flow-form",onSubmit:s.handleSubmit(t),isHorizontal:!0,children:te(Fn,{...s,children:[O(_n,{name:"name",label:o("name"),labelIcon:o("clientIdHelp"),rules:{required:o("required")}}),O(_n,{name:"description",label:o("description"),labelIcon:o("flowNameDescriptionHelp")}),O(oi,{name:"type",menuAppendTo:"parent",label:o("flowType"),options:li.map(l=>({key:l,value:o(`flow-type.${l}`)})),controller:{defaultValue:li[0]}}),i&&i.length>1&&O(oi,{name:"provider",label:o("provider"),labelIcon:o("authenticationFlowTypeHelp"),options:i.map(l=>({key:l.id,value:l.displayName})),controller:{defaultValue:""}})]})})})},Au=["addExecution","addSubFlow"],Tu=({flow:e,onAddExecution:t,onAddFlow:n})=>{const{t:r}=_e(),[o,s]=re();return te(be,{children:[o==="addExecution"&&O(Lo,{name:e.alias,type:e.providerId==="client-flow"?"client":"basic",onSelect:i=>{i&&t(i),s(void 0)}}),o==="addSubFlow"&&O(Ao,{name:e.alias,onCancel:()=>s(void 0),onConfirm:i=>{n(i),s(void 0)}}),O(Ll,{message:r("emptyExecution"),instructions:r("emptyExecutionInstructions")}),O("div",{className:"keycloak__empty-execution-state__block",children:Au.map(i=>te(ii,{className:"keycloak__empty-execution-state__help",children:[te(si,{flex:{default:"flex_1"},children:[O(Al,{headingLevel:"h2",size:Tl.md,children:r(`${i}Title`)}),O("p",{children:r(i)})]}),O(ii,{alignSelf:{default:"alignSelfCenter"},children:O(si,{children:O(ge,{"data-testid":i,variant:"tertiary",onClick:()=>s(i),children:r(i)})})})]},i))})]})},ua=Ol("AuthenticationProviderContext",void 0),Ou=({children:e})=>{const{adminClient:t}=mt(),[n,r]=re();return Dt(async()=>Promise.all([t.authenticationManagement.getClientAuthenticatorProviders(),t.authenticationManagement.getFormActionProviders(),t.authenticationManagement.getAuthenticatorProviders()]),o=>r(o.flat()),[]),O(ua.Provider,{value:{providers:n},children:e})},Ru=()=>Rl(ua);function me(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=me(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var er={exports:{}},tr={},nr={exports:{}},rr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ui;function Du(){if(ui)return rr;ui=1;var e=F;function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,o=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function a(d,f){var h=f(),g=r({inst:{value:h,getSnapshot:f}}),v=g[0].inst,p=g[1];return s(function(){v.value=h,v.getSnapshot=f,l(v)&&p({inst:v})},[d,h,f]),o(function(){return l(v)&&p({inst:v}),d(function(){l(v)&&p({inst:v})})},[d]),i(h),h}function l(d){var f=d.getSnapshot;d=d.value;try{var h=f();return!n(d,h)}catch{return!0}}function u(d,f){return f()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:a;return rr.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:c,rr}var di;function $u(){return di||(di=1,nr.exports=Du()),nr.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fi;function Pu(){if(fi)return tr;fi=1;var e=F,t=$u();function n(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,a=e.useMemo,l=e.useDebugValue;return tr.useSyncExternalStoreWithSelector=function(u,c,d,f,h){var g=s(null);if(g.current===null){var v={hasValue:!1,value:null};g.current=v}else v=g.current;g=a(function(){function m(C){if(!w){if(w=!0,x=C,C=f(C),h!==void 0&&v.hasValue){var D=v.value;if(h(D,C))return b=D}return b=C}if(D=b,r(x,C))return D;var E=f(C);return h!==void 0&&h(D,E)?(x=C,D):(x=C,b=E)}var w=!1,x,b,S=d===void 0?null:d;return[function(){return m(c())},S===null?void 0:function(){return m(S())}]},[c,d,f,h]);var p=o(u,g[0],g[1]);return i(function(){v.hasValue=!0,v.value=p},[p]),l(p),p},tr}var hi;function Fu(){return hi||(hi=1,er.exports=Pu()),er.exports}var zu=Fu();const Hu=Dl(zu),Vu={},pi=e=>{let t;const n=new Set,r=(c,d)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(g=>g(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(Vu?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,o,l);return l},qu=e=>e?pi(e):pi,{useDebugValue:Bu}=F,{useSyncExternalStoreWithSelector:Gu}=Hu,ju=e=>e;function da(e,t=ju,n){const r=Gu(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Bu(r),r}const gi=(e,t)=>{const n=qu(e),r=(o,s=t)=>da(n,o,s);return Object.assign(r,n),r},Yu=(e,t)=>e?gi(e,t):gi;function pe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Wu={value:()=>{}};function Vn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new vn(n)}function vn(e){this._=e}function Xu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}vn.prototype=Vn.prototype={constructor:vn,on:function(e,t){var n=this._,r=Xu(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=Zu(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=mi(n[o],e.name,t);else if(t==null)for(o in n)n[o]=mi(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new vn(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function Zu(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function mi(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Wu,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var lo="http://www.w3.org/1999/xhtml";const yi={svg:"http://www.w3.org/2000/svg",xhtml:lo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),yi.hasOwnProperty(t)?{space:yi[t],local:e}:e}function Uu(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===lo&&t.documentElement.namespaceURI===lo?t.createElement(e):t.createElementNS(n,e)}}function Ku(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function fa(e){var t=qn(e);return(t.local?Ku:Uu)(t)}function Qu(){}function To(e){return e==null?Qu:function(){return this.querySelector(e)}}function Ju(e){typeof e!="function"&&(e=To(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),l,u,c=0;c<i;++c)(l=s[c])&&(u=e.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new Ee(r,this._parents)}function ed(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function td(){return[]}function ha(e){return e==null?td:function(){return this.querySelectorAll(e)}}function nd(e){return function(){return ed(e.apply(this,arguments))}}function rd(e){typeof e=="function"?e=nd(e):e=ha(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&(r.push(e.call(l,l.__data__,u,i)),o.push(l));return new Ee(r,o)}function pa(e){return function(){return this.matches(e)}}function ga(e){return function(t){return t.matches(e)}}var od=Array.prototype.find;function id(e){return function(){return od.call(this.children,e)}}function sd(){return this.firstElementChild}function ad(e){return this.select(e==null?sd:id(typeof e=="function"?e:ga(e)))}var cd=Array.prototype.filter;function ld(){return Array.from(this.children)}function ud(e){return function(){return cd.call(this.children,e)}}function dd(e){return this.selectAll(e==null?ld:ud(typeof e=="function"?e:ga(e)))}function fd(e){typeof e!="function"&&(e=pa(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new Ee(r,this._parents)}function ma(e){return new Array(e.length)}function hd(){return new Ee(this._enter||this._groups.map(ma),this._parents)}function Nn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Nn.prototype={constructor:Nn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function pd(e){return function(){return e}}function gd(e,t,n,r,o,s){for(var i=0,a,l=t.length,u=s.length;i<u;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new Nn(e,s[i]);for(;i<l;++i)(a=t[i])&&(o[i]=a)}function md(e,t,n,r,o,s,i){var a,l,u=new Map,c=t.length,d=s.length,f=new Array(c),h;for(a=0;a<c;++a)(l=t[a])&&(f[a]=h=i.call(l,l.__data__,a,t)+"",u.has(h)?o[a]=l:u.set(h,l));for(a=0;a<d;++a)h=i.call(e,s[a],a,s)+"",(l=u.get(h))?(r[a]=l,l.__data__=s[a],u.delete(h)):n[a]=new Nn(e,s[a]);for(a=0;a<c;++a)(l=t[a])&&u.get(f[a])===l&&(o[a]=l)}function yd(e){return e.__data__}function wd(e,t){if(!arguments.length)return Array.from(this,yd);var n=t?md:gd,r=this._parents,o=this._groups;typeof e!="function"&&(e=pd(e));for(var s=o.length,i=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var c=r[u],d=o[u],f=d.length,h=vd(e.call(c,c&&c.__data__,u,r)),g=h.length,v=a[u]=new Array(g),p=i[u]=new Array(g),m=l[u]=new Array(f);n(c,d,v,p,m,h,t);for(var w=0,x=0,b,S;w<g;++w)if(b=v[w]){for(w>=x&&(x=w+1);!(S=p[x])&&++x<g;);b._next=S||null}}return i=new Ee(i,r),i._enter=a,i._exit=l,i}function vd(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function bd(){return new Ee(this._exit||this._groups.map(ma),this._parents)}function xd(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function Ed(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),l=0;l<i;++l)for(var u=n[l],c=r[l],d=u.length,f=a[l]=new Array(d),h,g=0;g<d;++g)(h=u[g]||c[g])&&(f[g]=h);for(;l<o;++l)a[l]=n[l];return new Ee(a,this._parents)}function _d(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Cd(e){e||(e=Sd);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,l=o[s]=new Array(a),u,c=0;c<a;++c)(u=i[c])&&(l[c]=u);l.sort(t)}return new Ee(o,this._parents).order()}function Sd(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Nd(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function kd(){return Array.from(this)}function Md(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function Id(){let e=0;for(const t of this)++e;return e}function Ld(){return!this.node()}function Ad(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function Td(e){return function(){this.removeAttribute(e)}}function Od(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Rd(e,t){return function(){this.setAttribute(e,t)}}function Dd(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function $d(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Pd(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Fd(e,t){var n=qn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Od:Td:typeof t=="function"?n.local?Pd:$d:n.local?Dd:Rd)(n,t))}function ya(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function zd(e){return function(){this.style.removeProperty(e)}}function Hd(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Vd(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function qd(e,t,n){return arguments.length>1?this.each((t==null?zd:typeof t=="function"?Vd:Hd)(e,t,n??"")):At(this.node(),e)}function At(e,t){return e.style.getPropertyValue(t)||ya(e).getComputedStyle(e,null).getPropertyValue(t)}function Bd(e){return function(){delete this[e]}}function Gd(e,t){return function(){this[e]=t}}function jd(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Yd(e,t){return arguments.length>1?this.each((t==null?Bd:typeof t=="function"?jd:Gd)(e,t)):this.node()[e]}function wa(e){return e.trim().split(/^|\s+/)}function Oo(e){return e.classList||new va(e)}function va(e){this._node=e,this._names=wa(e.getAttribute("class")||"")}va.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ba(e,t){for(var n=Oo(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function xa(e,t){for(var n=Oo(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Wd(e){return function(){ba(this,e)}}function Xd(e){return function(){xa(this,e)}}function Zd(e,t){return function(){(t.apply(this,arguments)?ba:xa)(this,e)}}function Ud(e,t){var n=wa(e+"");if(arguments.length<2){for(var r=Oo(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Zd:t?Wd:Xd)(n,t))}function Kd(){this.textContent=""}function Qd(e){return function(){this.textContent=e}}function Jd(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ef(e){return arguments.length?this.each(e==null?Kd:(typeof e=="function"?Jd:Qd)(e)):this.node().textContent}function tf(){this.innerHTML=""}function nf(e){return function(){this.innerHTML=e}}function rf(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function of(e){return arguments.length?this.each(e==null?tf:(typeof e=="function"?rf:nf)(e)):this.node().innerHTML}function sf(){this.nextSibling&&this.parentNode.appendChild(this)}function af(){return this.each(sf)}function cf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lf(){return this.each(cf)}function uf(e){var t=typeof e=="function"?e:fa(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function df(){return null}function ff(e,t){var n=typeof e=="function"?e:fa(e),r=t==null?df:typeof t=="function"?t:To(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function hf(){var e=this.parentNode;e&&e.removeChild(this)}function pf(){return this.each(hf)}function gf(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function mf(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yf(e){return this.select(e?mf:gf)}function wf(e){return arguments.length?this.property("__data__",e):this.node().__data__}function vf(e){return function(t){e.call(this,t,this.__data__)}}function bf(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function xf(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Ef(e,t,n){return function(){var r=this.__on,o,s=vf(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function _f(e,t,n){var r=bf(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(o=0,c=a[l];o<s;++o)if((i=r[o]).type===c.type&&i.name===c.name)return c.value}return}for(a=t?Ef:xf,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function Ea(e,t,n){var r=ya(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Cf(e,t){return function(){return Ea(this,e,t)}}function Sf(e,t){return function(){return Ea(this,e,t.apply(this,arguments))}}function Nf(e,t){return this.each((typeof t=="function"?Sf:Cf)(e,t))}function*kf(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var _a=[null];function Ee(e,t){this._groups=e,this._parents=t}function sn(){return new Ee([[document.documentElement]],_a)}function Mf(){return this}Ee.prototype=sn.prototype={constructor:Ee,select:Ju,selectAll:rd,selectChild:ad,selectChildren:dd,filter:fd,data:wd,enter:hd,exit:bd,join:xd,merge:Ed,selection:Mf,order:_d,sort:Cd,call:Nd,nodes:kd,node:Md,size:Id,empty:Ld,each:Ad,attr:Fd,style:qd,property:Yd,classed:Ud,text:ef,html:of,raise:af,lower:lf,append:uf,insert:ff,remove:pf,clone:yf,datum:wf,on:_f,dispatch:Nf,[Symbol.iterator]:kf};function Ce(e){return typeof e=="string"?new Ee([[document.querySelector(e)]],[document.documentElement]):new Ee([[e]],_a)}function If(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ke(e,t){if(e=If(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Lf={passive:!1},Xt={capture:!0,passive:!1};function or(e){e.stopImmediatePropagation()}function Mt(e){e.preventDefault(),e.stopImmediatePropagation()}function Ca(e){var t=e.document.documentElement,n=Ce(e).on("dragstart.drag",Mt,Xt);"onselectstart"in t?n.on("selectstart.drag",Mt,Xt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Sa(e,t){var n=e.document.documentElement,r=Ce(e).on("dragstart.drag",null);t&&(r.on("click.drag",Mt,Xt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ln=e=>()=>e;function uo(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}uo.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Af(e){return!e.ctrlKey&&!e.button}function Tf(){return this.parentNode}function Of(e,t){return t??{x:e.x,y:e.y}}function Rf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Df(){var e=Af,t=Tf,n=Of,r=Rf,o={},s=Vn("start","drag","end"),i=0,a,l,u,c,d=0;function f(b){b.on("mousedown.drag",h).filter(r).on("touchstart.drag",p).on("touchmove.drag",m,Lf).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(b,S){if(!(c||!e.call(this,b,S))){var C=x(this,t.call(this,b,S),b,S,"mouse");C&&(Ce(b.view).on("mousemove.drag",g,Xt).on("mouseup.drag",v,Xt),Ca(b.view),or(b),u=!1,a=b.clientX,l=b.clientY,C("start",b))}}function g(b){if(Mt(b),!u){var S=b.clientX-a,C=b.clientY-l;u=S*S+C*C>d}o.mouse("drag",b)}function v(b){Ce(b.view).on("mousemove.drag mouseup.drag",null),Sa(b.view,u),Mt(b),o.mouse("end",b)}function p(b,S){if(e.call(this,b,S)){var C=b.changedTouches,D=t.call(this,b,S),E=C.length,_,N;for(_=0;_<E;++_)(N=x(this,D,b,S,C[_].identifier,C[_]))&&(or(b),N("start",b,C[_]))}}function m(b){var S=b.changedTouches,C=S.length,D,E;for(D=0;D<C;++D)(E=o[S[D].identifier])&&(Mt(b),E("drag",b,S[D]))}function w(b){var S=b.changedTouches,C=S.length,D,E;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),D=0;D<C;++D)(E=o[S[D].identifier])&&(or(b),E("end",b,S[D]))}function x(b,S,C,D,E,_){var N=s.copy(),M=ke(_||C,S),A,P,y;if((y=n.call(b,new uo("beforestart",{sourceEvent:C,target:f,identifier:E,active:i,x:M[0],y:M[1],dx:0,dy:0,dispatch:N}),D))!=null)return A=y.x-M[0]||0,P=y.y-M[1]||0,function T(I,z,G){var R=M,V;switch(I){case"start":o[E]=T,V=i++;break;case"end":delete o[E],--i;case"drag":M=ke(G||z,S),V=i;break}N.call(I,b,new uo(I,{sourceEvent:z,subject:y,target:f,identifier:E,active:V,x:M[0]+A,y:M[1]+P,dx:M[0]-R[0],dy:M[1]-R[1],dispatch:N}),D)}}return f.filter=function(b){return arguments.length?(e=typeof b=="function"?b:ln(!!b),f):e},f.container=function(b){return arguments.length?(t=typeof b=="function"?b:ln(b),f):t},f.subject=function(b){return arguments.length?(n=typeof b=="function"?b:ln(b),f):n},f.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:ln(!!b),f):r},f.on=function(){var b=s.on.apply(s,arguments);return b===s?f:b},f.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,f):Math.sqrt(d)},f}function Ro(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Na(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function an(){}var Zt=.7,kn=1/Zt,It="\\s*([+-]?\\d+)\\s*",Ut="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",De="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$f=/^#([0-9a-f]{3,8})$/,Pf=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),Ff=new RegExp(`^rgb\\(${De},${De},${De}\\)$`),zf=new RegExp(`^rgba\\(${It},${It},${It},${Ut}\\)$`),Hf=new RegExp(`^rgba\\(${De},${De},${De},${Ut}\\)$`),Vf=new RegExp(`^hsl\\(${Ut},${De},${De}\\)$`),qf=new RegExp(`^hsla\\(${Ut},${De},${De},${Ut}\\)$`),wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ro(an,Kt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:vi,formatHex:vi,formatHex8:Bf,formatHsl:Gf,formatRgb:bi,toString:bi});function vi(){return this.rgb().formatHex()}function Bf(){return this.rgb().formatHex8()}function Gf(){return ka(this).formatHsl()}function bi(){return this.rgb().formatRgb()}function Kt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=$f.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?xi(t):n===3?new xe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?un(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?un(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Pf.exec(e))?new xe(t[1],t[2],t[3],1):(t=Ff.exec(e))?new xe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=zf.exec(e))?un(t[1],t[2],t[3],t[4]):(t=Hf.exec(e))?un(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Vf.exec(e))?Ci(t[1],t[2]/100,t[3]/100,1):(t=qf.exec(e))?Ci(t[1],t[2]/100,t[3]/100,t[4]):wi.hasOwnProperty(e)?xi(wi[e]):e==="transparent"?new xe(NaN,NaN,NaN,0):null}function xi(e){return new xe(e>>16&255,e>>8&255,e&255,1)}function un(e,t,n,r){return r<=0&&(e=t=n=NaN),new xe(e,t,n,r)}function jf(e){return e instanceof an||(e=Kt(e)),e?(e=e.rgb(),new xe(e.r,e.g,e.b,e.opacity)):new xe}function fo(e,t,n,r){return arguments.length===1?jf(e):new xe(e,t,n,r??1)}function xe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ro(xe,fo,Na(an,{brighter(e){return e=e==null?kn:Math.pow(kn,e),new xe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zt:Math.pow(Zt,e),new xe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new xe(ft(this.r),ft(this.g),ft(this.b),Mn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ei,formatHex:Ei,formatHex8:Yf,formatRgb:_i,toString:_i}));function Ei(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}`}function Yf(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}${lt((isNaN(this.opacity)?1:this.opacity)*255)}`}function _i(){const e=Mn(this.opacity);return`${e===1?"rgb(":"rgba("}${ft(this.r)}, ${ft(this.g)}, ${ft(this.b)}${e===1?")":`, ${e})`}`}function Mn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ft(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function lt(e){return e=ft(e),(e<16?"0":"")+e.toString(16)}function Ci(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Me(e,t,n,r)}function ka(e){if(e instanceof Me)return new Me(e.h,e.s,e.l,e.opacity);if(e instanceof an||(e=Kt(e)),!e)return new Me;if(e instanceof Me)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,a=s-o,l=(s+o)/2;return a?(t===s?i=(n-r)/a+(n<r)*6:n===s?i=(r-t)/a+2:i=(t-n)/a+4,a/=l<.5?s+o:2-s-o,i*=60):a=l>0&&l<1?0:i,new Me(i,a,l,e.opacity)}function Wf(e,t,n,r){return arguments.length===1?ka(e):new Me(e,t,n,r??1)}function Me(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ro(Me,Wf,Na(an,{brighter(e){return e=e==null?kn:Math.pow(kn,e),new Me(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zt:Math.pow(Zt,e),new Me(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new xe(ir(e>=240?e-240:e+120,o,r),ir(e,o,r),ir(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Me(Si(this.h),dn(this.s),dn(this.l),Mn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Mn(this.opacity);return`${e===1?"hsl(":"hsla("}${Si(this.h)}, ${dn(this.s)*100}%, ${dn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Si(e){return e=(e||0)%360,e<0?e+360:e}function dn(e){return Math.max(0,Math.min(1,e||0))}function ir(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Ma=e=>()=>e;function Xf(e,t){return function(n){return e+n*t}}function Zf(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Uf(e){return(e=+e)==1?Ia:function(t,n){return n-t?Zf(t,n,e):Ma(isNaN(t)?n:t)}}function Ia(e,t){var n=t-e;return n?Xf(e,n):Ma(isNaN(e)?t:e)}const Ni=function e(t){var n=Uf(t);function r(o,s){var i=n((o=fo(o)).r,(s=fo(s)).r),a=n(o.g,s.g),l=n(o.b,s.b),u=Ia(o.opacity,s.opacity);return function(c){return o.r=i(c),o.g=a(c),o.b=l(c),o.opacity=u(c),o+""}}return r.gamma=e,r}(1);function Xe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ho=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sr=new RegExp(ho.source,"g");function Kf(e){return function(){return e}}function Qf(e){return function(t){return e(t)+""}}function Jf(e,t){var n=ho.lastIndex=sr.lastIndex=0,r,o,s,i=-1,a=[],l=[];for(e=e+"",t=t+"";(r=ho.exec(e))&&(o=sr.exec(t));)(s=o.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(r=r[0])===(o=o[0])?a[i]?a[i]+=o:a[++i]=o:(a[++i]=null,l.push({i,x:Xe(r,o)})),n=sr.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?l[0]?Qf(l[0].x):Kf(t):(t=l.length,function(u){for(var c=0,d;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}var ki=180/Math.PI,po={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function La(e,t,n,r,o,s){var i,a,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*ki,skewX:Math.atan(l)*ki,scaleX:i,scaleY:a}}var fn;function eh(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?po:La(t.a,t.b,t.c,t.d,t.e,t.f)}function th(e){return e==null||(fn||(fn=document.createElementNS("http://www.w3.org/2000/svg","g")),fn.setAttribute("transform",e),!(e=fn.transform.baseVal.consolidate()))?po:(e=e.matrix,La(e.a,e.b,e.c,e.d,e.e,e.f))}function Aa(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function s(u,c,d,f,h,g){if(u!==d||c!==f){var v=h.push("translate(",null,t,null,n);g.push({i:v-4,x:Xe(u,d)},{i:v-2,x:Xe(c,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function i(u,c,d,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:d.push(o(d)+"rotate(",null,r)-2,x:Xe(u,c)})):c&&d.push(o(d)+"rotate("+c+r)}function a(u,c,d,f){u!==c?f.push({i:d.push(o(d)+"skewX(",null,r)-2,x:Xe(u,c)}):c&&d.push(o(d)+"skewX("+c+r)}function l(u,c,d,f,h,g){if(u!==d||c!==f){var v=h.push(o(h)+"scale(",null,",",null,")");g.push({i:v-4,x:Xe(u,d)},{i:v-2,x:Xe(c,f)})}else(d!==1||f!==1)&&h.push(o(h)+"scale("+d+","+f+")")}return function(u,c){var d=[],f=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,d,f),i(u.rotate,c.rotate,d,f),a(u.skewX,c.skewX,d,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,f),u=c=null,function(h){for(var g=-1,v=f.length,p;++g<v;)d[(p=f[g]).i]=p.x(h);return d.join("")}}}var nh=Aa(eh,"px, ","px)","deg)"),rh=Aa(th,", ",")",")"),oh=1e-12;function Mi(e){return((e=Math.exp(e))+1/e)/2}function ih(e){return((e=Math.exp(e))-1/e)/2}function sh(e){return((e=Math.exp(2*e))-1)/(e+1)}const ah=function e(t,n,r){function o(s,i){var a=s[0],l=s[1],u=s[2],c=i[0],d=i[1],f=i[2],h=c-a,g=d-l,v=h*h+g*g,p,m;if(v<oh)m=Math.log(f/u)/t,p=function(D){return[a+D*h,l+D*g,u*Math.exp(t*D*m)]};else{var w=Math.sqrt(v),x=(f*f-u*u+r*v)/(2*u*n*w),b=(f*f-u*u-r*v)/(2*f*n*w),S=Math.log(Math.sqrt(x*x+1)-x),C=Math.log(Math.sqrt(b*b+1)-b);m=(C-S)/t,p=function(D){var E=D*m,_=Mi(S),N=u/(n*w)*(_*sh(t*E+S)-ih(S));return[a+N*h,l+N*g,u*_/Mi(t*E+S)]}}return p.duration=m*1e3*t/Math.SQRT2,p}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,l=a*a;return e(i,a,l)},o}(Math.SQRT2,2,4);var Tt=0,Gt=0,zt=0,Ta=1e3,In,jt,Ln=0,pt=0,Bn=0,Qt=typeof performance=="object"&&performance.now?performance:Date,Oa=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Do(){return pt||(Oa(ch),pt=Qt.now()+Bn)}function ch(){pt=0}function An(){this._call=this._time=this._next=null}An.prototype=Ra.prototype={constructor:An,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Do():+n)+(t==null?0:+t),!this._next&&jt!==this&&(jt?jt._next=this:In=this,jt=this),this._call=e,this._time=n,go()},stop:function(){this._call&&(this._call=null,this._time=1/0,go())}};function Ra(e,t,n){var r=new An;return r.restart(e,t,n),r}function lh(){Do(),++Tt;for(var e=In,t;e;)(t=pt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Tt}function Ii(){pt=(Ln=Qt.now())+Bn,Tt=Gt=0;try{lh()}finally{Tt=0,dh(),pt=0}}function uh(){var e=Qt.now(),t=e-Ln;t>Ta&&(Bn-=t,Ln=e)}function dh(){for(var e,t=In,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:In=n);jt=e,go(r)}function go(e){if(!Tt){Gt&&(Gt=clearTimeout(Gt));var t=e-pt;t>24?(e<1/0&&(Gt=setTimeout(Ii,e-Qt.now()-Bn)),zt&&(zt=clearInterval(zt))):(zt||(Ln=Qt.now(),zt=setInterval(uh,Ta)),Tt=1,Oa(Ii))}}function Li(e,t,n){var r=new An;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var fh=Vn("start","end","cancel","interrupt"),hh=[],Da=0,Ai=1,mo=2,bn=3,Ti=4,yo=5,xn=6;function Gn(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;ph(e,n,{name:t,index:r,group:o,on:fh,tween:hh,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Da})}function $o(e,t){var n=Ae(e,t);if(n.state>Da)throw new Error("too late; already scheduled");return n}function $e(e,t){var n=Ae(e,t);if(n.state>bn)throw new Error("too late; already running");return n}function Ae(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ph(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Ra(s,0,n.time);function s(u){n.state=Ai,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var c,d,f,h;if(n.state!==Ai)return l();for(c in r)if(h=r[c],h.name===n.name){if(h.state===bn)return Li(i);h.state===Ti?(h.state=xn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=xn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(Li(function(){n.state===bn&&(n.state=Ti,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=mo,n.on.call("start",e,e.__data__,n.index,n.group),n.state===mo){for(n.state=bn,o=new Array(f=n.tween.length),c=0,d=-1;c<f;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function a(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=yo,1),d=-1,f=o.length;++d<f;)o[d].call(e,c);n.state===yo&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=xn,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function En(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>mo&&r.state<yo,r.state=xn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function gh(e){return this.each(function(){En(this,e)})}function mh(e,t){var n,r;return function(){var o=$e(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function yh(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=$e(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},l=0,u=o.length;l<u;++l)if(o[l].name===t){o[l]=a;break}l===u&&o.push(a)}s.tween=o}}function wh(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ae(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?mh:yh)(n,e,t))}function Po(e,t,n){var r=e._id;return e.each(function(){var o=$e(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ae(o,r).value[t]}}function $a(e,t){var n;return(typeof t=="number"?Xe:t instanceof Kt?Ni:(n=Kt(t))?(t=n,Ni):Jf)(e,t)}function vh(e){return function(){this.removeAttribute(e)}}function bh(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xh(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function Eh(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function _h(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function Ch(e,t,n){var r,o,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),l=a+"",i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a)))}}function Sh(e,t){var n=qn(e),r=n==="transform"?rh:$a;return this.attrTween(e,typeof t=="function"?(n.local?Ch:_h)(n,r,Po(this,"attr."+e,t)):t==null?(n.local?bh:vh)(n):(n.local?Eh:xh)(n,r,t))}function Nh(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function kh(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Mh(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&kh(e,s)),n}return o._value=t,o}function Ih(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Nh(e,s)),n}return o._value=t,o}function Lh(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=qn(e);return this.tween(n,(r.local?Mh:Ih)(r,t))}function Ah(e,t){return function(){$o(this,e).delay=+t.apply(this,arguments)}}function Th(e,t){return t=+t,function(){$o(this,e).delay=t}}function Oh(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ah:Th)(t,e)):Ae(this.node(),t).delay}function Rh(e,t){return function(){$e(this,e).duration=+t.apply(this,arguments)}}function Dh(e,t){return t=+t,function(){$e(this,e).duration=t}}function $h(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Rh:Dh)(t,e)):Ae(this.node(),t).duration}function Ph(e,t){if(typeof t!="function")throw new Error;return function(){$e(this,e).ease=t}}function Fh(e){var t=this._id;return arguments.length?this.each(Ph(t,e)):Ae(this.node(),t).ease}function zh(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;$e(this,e).ease=n}}function Hh(e){if(typeof e!="function")throw new Error;return this.each(zh(this._id,e))}function Vh(e){typeof e!="function"&&(e=pa(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new Be(r,this._parents,this._name,this._id)}function qh(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var l=t[a],u=n[a],c=l.length,d=i[a]=new Array(c),f,h=0;h<c;++h)(f=l[h]||u[h])&&(d[h]=f);for(;a<r;++a)i[a]=t[a];return new Be(i,this._parents,this._name,this._id)}function Bh(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Gh(e,t,n){var r,o,s=Bh(t)?$o:$e;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function jh(e,t){var n=this._id;return arguments.length<2?Ae(this.node(),n).on.on(e):this.each(Gh(n,e,t))}function Yh(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Wh(){return this.on("end.remove",Yh(this._id))}function Xh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=To(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],l=a.length,u=s[i]=new Array(l),c,d,f=0;f<l;++f)(c=a[f])&&(d=e.call(c,c.__data__,f,a))&&("__data__"in c&&(d.__data__=c.__data__),u[f]=d,Gn(u[f],t,n,f,u,Ae(c,n)));return new Be(s,this._parents,t,n)}function Zh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ha(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var l=r[a],u=l.length,c,d=0;d<u;++d)if(c=l[d]){for(var f=e.call(c,c.__data__,d,l),h,g=Ae(c,n),v=0,p=f.length;v<p;++v)(h=f[v])&&Gn(h,t,n,v,f,g);s.push(f),i.push(c)}return new Be(s,i,t,n)}var Uh=sn.prototype.constructor;function Kh(){return new Uh(this._groups,this._parents)}function Qh(e,t){var n,r,o;return function(){var s=At(this,e),i=(this.style.removeProperty(e),At(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function Pa(e){return function(){this.style.removeProperty(e)}}function Jh(e,t,n){var r,o=n+"",s;return function(){var i=At(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function ep(e,t,n){var r,o,s;return function(){var i=At(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),At(this,e))),i===l?null:i===r&&l===o?s:(o=l,s=t(r=i,a))}}function tp(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var l=$e(this,e),u=l.on,c=l.value[s]==null?a||(a=Pa(t)):void 0;(u!==n||o!==c)&&(r=(n=u).copy()).on(i,o=c),l.on=r}}function np(e,t,n){var r=(e+="")=="transform"?nh:$a;return t==null?this.styleTween(e,Qh(e,r)).on("end.style."+e,Pa(e)):typeof t=="function"?this.styleTween(e,ep(e,r,Po(this,"style."+e,t))).each(tp(this._id,e)):this.styleTween(e,Jh(e,r,t),n).on("end.style."+e,null)}function rp(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function op(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&rp(e,i,n)),r}return s._value=t,s}function ip(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,op(e,t,n??""))}function sp(e){return function(){this.textContent=e}}function ap(e){return function(){var t=e(this);this.textContent=t??""}}function cp(e){return this.tween("text",typeof e=="function"?ap(Po(this,"text",e)):sp(e==null?"":e+""))}function lp(e){return function(t){this.textContent=e.call(this,t)}}function up(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&lp(o)),t}return r._value=e,r}function dp(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,up(e))}function fp(){for(var e=this._name,t=this._id,n=Fa(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,u=0;u<a;++u)if(l=i[u]){var c=Ae(l,t);Gn(l,e,n,u,i,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Be(r,this._parents,e,n)}function hp(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},l={value:function(){--o===0&&s()}};n.each(function(){var u=$e(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),o===0&&s()})}var pp=0;function Be(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Fa(){return++pp}var He=sn.prototype;Be.prototype={constructor:Be,select:Xh,selectAll:Zh,selectChild:He.selectChild,selectChildren:He.selectChildren,filter:Vh,merge:qh,selection:Kh,transition:fp,call:He.call,nodes:He.nodes,node:He.node,size:He.size,empty:He.empty,each:He.each,on:jh,attr:Sh,attrTween:Lh,style:np,styleTween:ip,text:cp,textTween:dp,remove:Wh,tween:wh,delay:Oh,duration:$h,ease:Fh,easeVarying:Hh,end:hp,[Symbol.iterator]:He[Symbol.iterator]};function gp(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var mp={time:null,delay:0,duration:250,ease:gp};function yp(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function wp(e){var t,n;e instanceof Be?(t=e._id,e=e._name):(t=Fa(),(n=mp).time=Do(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&Gn(l,e,t,u,i,n||yp(l,t));return new Be(r,this._parents,e,t)}sn.prototype.interrupt=gh;sn.prototype.transition=wp;const hn=e=>()=>e;function vp(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ve(e,t,n){this.k=e,this.x=t,this.y=n}Ve.prototype={constructor:Ve,scale:function(e){return e===1?this:new Ve(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ve(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var qe=new Ve(1,0,0);Ve.prototype;function ar(e){e.stopImmediatePropagation()}function Ht(e){e.preventDefault(),e.stopImmediatePropagation()}function bp(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function xp(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Oi(){return this.__zoom||qe}function Ep(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function _p(){return navigator.maxTouchPoints||"ontouchstart"in this}function Cp(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function za(){var e=bp,t=xp,n=Cp,r=Ep,o=_p,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=ah,u=Vn("start","zoom","end"),c,d,f,h=500,g=150,v=0,p=10;function m(y){y.property("__zoom",Oi).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",_).on("dblclick.zoom",N).filter(o).on("touchstart.zoom",M).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(y,T,I,z){var G=y.selection?y.selection():y;G.property("__zoom",Oi),y!==G?S(y,T,I,z):G.interrupt().each(function(){C(this,arguments).event(z).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},m.scaleBy=function(y,T,I,z){m.scaleTo(y,function(){var G=this.__zoom.k,R=typeof T=="function"?T.apply(this,arguments):T;return G*R},I,z)},m.scaleTo=function(y,T,I,z){m.transform(y,function(){var G=t.apply(this,arguments),R=this.__zoom,V=I==null?b(G):typeof I=="function"?I.apply(this,arguments):I,B=R.invert(V),Y=typeof T=="function"?T.apply(this,arguments):T;return n(x(w(R,Y),V,B),G,i)},I,z)},m.translateBy=function(y,T,I,z){m.transform(y,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),i)},null,z)},m.translateTo=function(y,T,I,z,G){m.transform(y,function(){var R=t.apply(this,arguments),V=this.__zoom,B=z==null?b(R):typeof z=="function"?z.apply(this,arguments):z;return n(qe.translate(B[0],B[1]).scale(V.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof I=="function"?-I.apply(this,arguments):-I),R,i)},z,G)};function w(y,T){return T=Math.max(s[0],Math.min(s[1],T)),T===y.k?y:new Ve(T,y.x,y.y)}function x(y,T,I){var z=T[0]-I[0]*y.k,G=T[1]-I[1]*y.k;return z===y.x&&G===y.y?y:new Ve(y.k,z,G)}function b(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function S(y,T,I,z){y.on("start.zoom",function(){C(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(z).end()}).tween("zoom",function(){var G=this,R=arguments,V=C(G,R).event(z),B=t.apply(G,R),Y=I==null?b(B):typeof I=="function"?I.apply(G,R):I,k=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),L=G.__zoom,$=typeof T=="function"?T.apply(G,R):T,q=l(L.invert(Y).concat(k/L.k),$.invert(Y).concat(k/$.k));return function(H){if(H===1)H=$;else{var j=q(H),W=k/j[2];H=new Ve(W,Y[0]-j[0]*W,Y[1]-j[1]*W)}V.zoom(null,H)}})}function C(y,T,I){return!I&&y.__zooming||new D(y,T)}function D(y,T){this.that=y,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(y,T),this.taps=0}D.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,T){return this.mouse&&y!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var T=Ce(this.that).datum();u.call(y,this.that,new vp(y,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:u}),T)}};function E(y,...T){if(!e.apply(this,arguments))return;var I=C(this,T).event(y),z=this.__zoom,G=Math.max(s[0],Math.min(s[1],z.k*Math.pow(2,r.apply(this,arguments)))),R=ke(y);if(I.wheel)(I.mouse[0][0]!==R[0]||I.mouse[0][1]!==R[1])&&(I.mouse[1]=z.invert(I.mouse[0]=R)),clearTimeout(I.wheel);else{if(z.k===G)return;I.mouse=[R,z.invert(R)],En(this),I.start()}Ht(y),I.wheel=setTimeout(V,g),I.zoom("mouse",n(x(w(z,G),I.mouse[0],I.mouse[1]),I.extent,i));function V(){I.wheel=null,I.end()}}function _(y,...T){if(f||!e.apply(this,arguments))return;var I=y.currentTarget,z=C(this,T,!0).event(y),G=Ce(y.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",k,!0),R=ke(y,I),V=y.clientX,B=y.clientY;Ca(y.view),ar(y),z.mouse=[R,this.__zoom.invert(R)],En(this),z.start();function Y(L){if(Ht(L),!z.moved){var $=L.clientX-V,q=L.clientY-B;z.moved=$*$+q*q>v}z.event(L).zoom("mouse",n(x(z.that.__zoom,z.mouse[0]=ke(L,I),z.mouse[1]),z.extent,i))}function k(L){G.on("mousemove.zoom mouseup.zoom",null),Sa(L.view,z.moved),Ht(L),z.event(L).end()}}function N(y,...T){if(e.apply(this,arguments)){var I=this.__zoom,z=ke(y.changedTouches?y.changedTouches[0]:y,this),G=I.invert(z),R=I.k*(y.shiftKey?.5:2),V=n(x(w(I,R),z,G),t.apply(this,T),i);Ht(y),a>0?Ce(this).transition().duration(a).call(S,V,z,y):Ce(this).call(m.transform,V,z,y)}}function M(y,...T){if(e.apply(this,arguments)){var I=y.touches,z=I.length,G=C(this,T,y.changedTouches.length===z).event(y),R,V,B,Y;for(ar(y),V=0;V<z;++V)B=I[V],Y=ke(B,this),Y=[Y,this.__zoom.invert(Y),B.identifier],G.touch0?!G.touch1&&G.touch0[2]!==Y[2]&&(G.touch1=Y,G.taps=0):(G.touch0=Y,R=!0,G.taps=1+!!c);c&&(c=clearTimeout(c)),R&&(G.taps<2&&(d=Y[0],c=setTimeout(function(){c=null},h)),En(this),G.start())}}function A(y,...T){if(this.__zooming){var I=C(this,T).event(y),z=y.changedTouches,G=z.length,R,V,B,Y;for(Ht(y),R=0;R<G;++R)V=z[R],B=ke(V,this),I.touch0&&I.touch0[2]===V.identifier?I.touch0[0]=B:I.touch1&&I.touch1[2]===V.identifier&&(I.touch1[0]=B);if(V=I.that.__zoom,I.touch1){var k=I.touch0[0],L=I.touch0[1],$=I.touch1[0],q=I.touch1[1],H=(H=$[0]-k[0])*H+(H=$[1]-k[1])*H,j=(j=q[0]-L[0])*j+(j=q[1]-L[1])*j;V=w(V,Math.sqrt(H/j)),B=[(k[0]+$[0])/2,(k[1]+$[1])/2],Y=[(L[0]+q[0])/2,(L[1]+q[1])/2]}else if(I.touch0)B=I.touch0[0],Y=I.touch0[1];else return;I.zoom("touch",n(x(V,B,Y),I.extent,i))}}function P(y,...T){if(this.__zooming){var I=C(this,T).event(y),z=y.changedTouches,G=z.length,R,V;for(ar(y),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),R=0;R<G;++R)V=z[R],I.touch0&&I.touch0[2]===V.identifier?delete I.touch0:I.touch1&&I.touch1[2]===V.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(V=ke(V,this),Math.hypot(d[0]-V[0],d[1]-V[1])<p)){var B=Ce(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return m.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:hn(+y),m):r},m.filter=function(y){return arguments.length?(e=typeof y=="function"?y:hn(!!y),m):e},m.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:hn(!!y),m):o},m.extent=function(y){return arguments.length?(t=typeof y=="function"?y:hn([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),m):t},m.scaleExtent=function(y){return arguments.length?(s[0]=+y[0],s[1]=+y[1],m):[s[0],s[1]]},m.translateExtent=function(y){return arguments.length?(i[0][0]=+y[0][0],i[1][0]=+y[1][0],i[0][1]=+y[0][1],i[1][1]=+y[1][1],m):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},m.constrain=function(y){return arguments.length?(n=y,m):n},m.duration=function(y){return arguments.length?(a=+y,m):a},m.interpolate=function(y){return arguments.length?(l=y,m):l},m.on=function(){var y=u.on.apply(u,arguments);return y===u?m:y},m.clickDistance=function(y){return arguments.length?(v=(y=+y)*y,m):Math.sqrt(v)},m.tapDistance=function(y){return arguments.length?(p=+y,m):p},m}const jn=sa(null),Sp=jn.Provider,Ge={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Ha=Ge.error001();function ce(e,t){const n=Hn(jn);if(n===null)throw new Error(Ha);return da(n,e,t)}const he=()=>{const e=Hn(jn);if(e===null)throw new Error(Ha);return Ne(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Np=e=>e.userSelectionActive?"none":"all";function Fo({position:e,children:t,className:n,style:r,...o}){const s=ce(Np),i=`${e}`.split("-");return F.createElement("div",{className:me(["react-flow__panel",n,...i]),style:{...r,pointerEvents:s},...o},t)}function kp({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:F.createElement(Fo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},F.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Mp=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:s={},labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...c})=>{const d=Q(null),[f,h]=re({x:0,y:0,width:0,height:0}),g=me(["react-flow__edge-textwrapper",u]);return oe(()=>{if(d.current){const v=d.current.getBBox();h({x:v.x,y:v.y,width:v.width,height:v.height})}},[n]),typeof n>"u"||!n?null:F.createElement("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:g,visibility:f.width?"visible":"hidden",...c},o&&F.createElement("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),F.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:d,style:r},n),l)};var Ip=ae(Mp);const zo=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ot=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ho=(e={x:0,y:0},t)=>({x:Ot(e.x,t[0][0],t[1][0]),y:Ot(e.y,t[0][1],t[1][1])}),Ri=(e,t,n)=>e<t?Ot(Math.abs(e-t),1,50)/50:e>n?-Ot(Math.abs(e-n),1,50)/50:0,Va=(e,t)=>{const n=Ri(e.x,35,t.width-35)*20,r=Ri(e.y,35,t.height-35)*20;return[n,r]},qa=e=>e.getRootNode?.()||window?.document,Ba=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Jt=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Ga=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Di=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Lp=(e,t)=>Ga(Ba(Jt(e),Jt(t))),wo=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Ap=e=>Se(e.width)&&Se(e.height)&&Se(e.x)&&Se(e.y),Se=e=>!isNaN(e)&&isFinite(e),ue=Symbol.for("internals"),ja=["Enter"," ","Escape"],Tp=(e,t)=>{},Op=e=>"nativeEvent"in e;function vo(e){const n=(Op(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const Ya=e=>"clientX"in e,Qe=(e,t)=>{const n=Ya(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},Tn=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,cn=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:f,interactionWidth:h=20})=>F.createElement(F.Fragment,null,F.createElement("path",{id:e,style:c,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:f}),h&&F.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),o&&Se(n)&&Se(r)?F.createElement(Ip,{x:n,y:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u}):null);cn.displayName="BaseEdge";const Rp=(e,t)=>typeof t<"u"&&t?`url(#${t})`:typeof e<"u"?`url(#react-flow__${e})`:"none";function Vt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(s=>s.id===e);o&&n(r,{...o})}}function Wa({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function Xa({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+o*.375+i*.375+n*.125,u=t*.125+s*.375+a*.375+r*.125,c=Math.abs(l-e),d=Math.abs(u-t);return[l,u,c,d]}var gt;(function(e){e.Strict="strict",e.Loose="loose"})(gt||(gt={}));var ut;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ut||(ut={}));var en;(function(e){e.Partial="partial",e.Full="full"})(en||(en={}));var Ue;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ue||(Ue={}));var On;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(On||(On={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));function $i({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===X.Left||e===X.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Za({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top}){const[i,a]=$i({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,u]=$i({pos:s,x1:r,y1:o,x2:e,y2:t}),[c,d,f,h]=Xa({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${i},${a} ${l},${u} ${r},${o}`,c,d,f,h]}const Vo=ae(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:s=X.Top,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:v})=>{const[p,m,w]=Za({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:s});return F.createElement(cn,{path:p,labelX:m,labelY:w,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:v})});Vo.displayName="SimpleBezierEdge";const Pi={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},Dp=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Fi=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function $p({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:r=X.Top,center:o,offset:s}){const i=Pi[t],a=Pi[r],l={x:e.x+i.x*s,y:e.y+i.y*s},u={x:n.x+a.x*s,y:n.y+a.y*s},c=Dp({source:l,sourcePosition:t,target:u}),d=c.x!==0?"x":"y",f=c[d];let h=[],g,v;const p={x:0,y:0},m={x:0,y:0},[w,x,b,S]=Wa({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*a[d]===-1){g=o.x??w,v=o.y??x;const D=[{x:g,y:l.y},{x:g,y:u.y}],E=[{x:l.x,y:v},{x:u.x,y:v}];i[d]===f?h=d==="x"?D:E:h=d==="x"?E:D}else{const D=[{x:l.x,y:u.y}],E=[{x:u.x,y:l.y}];if(d==="x"?h=i.x===f?E:D:h=i.y===f?D:E,t===r){const P=Math.abs(e[d]-n[d]);if(P<=s){const y=Math.min(s-1,s-P);i[d]===f?p[d]=(l[d]>e[d]?-1:1)*y:m[d]=(u[d]>n[d]?-1:1)*y}}if(t!==r){const P=d==="x"?"y":"x",y=i[d]===a[P],T=l[P]>u[P],I=l[P]<u[P];(i[d]===1&&(!y&&T||y&&I)||i[d]!==1&&(!y&&I||y&&T))&&(h=d==="x"?D:E)}const _={x:l.x+p.x,y:l.y+p.y},N={x:u.x+m.x,y:u.y+m.y},M=Math.max(Math.abs(_.x-h[0].x),Math.abs(N.x-h[0].x)),A=Math.max(Math.abs(_.y-h[0].y),Math.abs(N.y-h[0].y));M>=A?(g=(_.x+N.x)/2,v=h[0].y):(g=h[0].x,v=(_.y+N.y)/2)}return[[e,{x:l.x+p.x,y:l.y+p.y},...h,{x:u.x+m.x,y:u.y+m.y},n],g,v,b,S]}function Pp(e,t,n,r){const o=Math.min(Fi(e,t)/2,Fi(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const u=e.x<n.x?-1:1,c=e.y<n.y?1:-1;return`L ${s+o*u},${i}Q ${s},${i} ${s},${i+o*c}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+o*l}Q ${s},${i} ${s+o*a},${i}`}function bo({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top,borderRadius:i=5,centerX:a,centerY:l,offset:u=20}){const[c,d,f,h,g]=$p({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:l},offset:u});return[c.reduce((p,m,w)=>{let x="";return w>0&&w<c.length-1?x=Pp(c[w-1],m,c[w+1],i):x=`${w===0?"M":"L"}${m.x} ${m.y}`,p+=x,p},""),d,f,h,g]}const Yn=ae(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,sourcePosition:d=X.Bottom,targetPosition:f=X.Top,markerEnd:h,markerStart:g,pathOptions:v,interactionWidth:p})=>{const[m,w,x]=bo({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:f,borderRadius:v?.borderRadius,offset:v?.offset});return F.createElement(cn,{path:m,labelX:w,labelY:x,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:h,markerStart:g,interactionWidth:p})});Yn.displayName="SmoothStepEdge";const qo=ae(e=>F.createElement(Yn,{...e,pathOptions:Ne(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));qo.displayName="StepEdge";function Fp({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=Wa({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const Bo=ae(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:f,interactionWidth:h})=>{const[g,v,p]=Fp({sourceX:e,sourceY:t,targetX:n,targetY:r});return F.createElement(cn,{path:g,labelX:v,labelY:p,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:u,style:c,markerEnd:d,markerStart:f,interactionWidth:h})});Bo.displayName="StraightEdge";function pn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function zi({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case X.Left:return[t-pn(t-r,s),n];case X.Right:return[t+pn(r-t,s),n];case X.Top:return[t,n-pn(n-o,s)];case X.Bottom:return[t,n+pn(o-n,s)]}}function Go({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:s=X.Top,curvature:i=.25}){const[a,l]=zi({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[u,c]=zi({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[d,f,h,g]=Xa({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${e},${t} C${a},${l} ${u},${c} ${r},${o}`,d,f,h,g]}const Rn=ae(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:s=X.Top,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,pathOptions:v,interactionWidth:p})=>{const[m,w,x]=Go({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:s,curvature:v?.curvature});return F.createElement(cn,{path:m,labelX:w,labelY:x,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:p})});Rn.displayName="BezierEdge";const jo=sa(null),zp=jo.Provider;jo.Consumer;const Hp=()=>Hn(jo),Vp=e=>"id"in e&&"source"in e&&"target"in e,qp=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,xo=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Bp=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Gp=(e,t)=>{if(!e.source||!e.target)return t;let n;return Vp(e)?n={...e}:n={...e,id:qp(e)},Bp(n,t)?t:t.concat(n)},Eo=({x:e,y:t},[n,r,o],s,[i,a])=>{const l={x:(e-n)/o,y:(t-r)/o};return s?{x:i*Math.round(l.x/i),y:a*Math.round(l.y/a)}:l},Ua=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),ht=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},Wn=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:s,y:i}=ht(o,t).positionAbsolute;return Ba(r,Jt({x:s,y:i,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ga(n)},Ka=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1,a=[0,0])=>{const l={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(c=>{const{width:d,height:f,selectable:h=!0,hidden:g=!1}=c;if(i&&!h||g)return!1;const{positionAbsolute:v}=ht(c,a),p={x:v.x,y:v.y,width:d||0,height:f||0},m=wo(l,p),w=typeof d>"u"||typeof f>"u"||d===null||f===null,x=s&&m>0,b=(d||0)*(f||0);(w||x||m>=b||c.dragging)&&u.push(c)}),u},Qa=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Ja=(e,t,n,r,o,s=.1)=>{const i=t/(e.width*(1+s)),a=n/(e.height*(1+s)),l=Math.min(i,a),u=Ot(l,r,o),c=e.x+e.width/2,d=e.y+e.height/2,f=t/2-c*u,h=n/2-d*u;return{x:f,y:h,zoom:u}},at=(e,t=0)=>e.transition().duration(t);function Hi(e,t,n,r){return(t[n]||[]).reduce((o,s)=>(`${e.id}-${s.id}-${n}`!==r&&o.push({id:s.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+s.x+s.width/2,y:(e.positionAbsolute?.y??0)+s.y+s.height/2}),o),[])}function jp(e,t,n,r,o,s){const{x:i,y:a}=Qe(e),u=t.elementsFromPoint(i,a).find(g=>g.classList.contains("react-flow__handle"));if(u){const g=u.getAttribute("data-nodeid");if(g){const v=Yo(void 0,u),p=u.getAttribute("data-handleid"),m=s({nodeId:g,id:p,type:v});if(m){const w=o.find(x=>x.nodeId===g&&x.type===v&&x.id===p);return{handle:{id:p,type:v,nodeId:g,x:w?.x||n.x,y:w?.y||n.y},validHandleResult:m}}}}let c=[],d=1/0;if(o.forEach(g=>{const v=Math.sqrt((g.x-n.x)**2+(g.y-n.y)**2);if(v<=r){const p=s(g);v<=d&&(v<d?c=[{handle:g,validHandleResult:p}]:v===d&&c.push({handle:g,validHandleResult:p}),d=v)}}),!c.length)return{handle:null,validHandleResult:ec()};if(c.length===1)return c[0];const f=c.some(({validHandleResult:g})=>g.isValid),h=c.some(({handle:g})=>g.type==="target");return c.find(({handle:g,validHandleResult:v})=>h?g.type==="target":f?v.isValid:!0)||c[0]}const Yp={source:null,target:null,sourceHandle:null,targetHandle:null},ec=()=>({handleDomNode:null,isValid:!1,connection:Yp,endHandle:null});function tc(e,t,n,r,o,s,i){const a=o==="target",l=i.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...ec(),handleDomNode:l};if(l){const c=Yo(void 0,l),d=l.getAttribute("data-nodeid"),f=l.getAttribute("data-handleid"),h=l.classList.contains("connectable"),g=l.classList.contains("connectableend"),v={source:a?d:n,sourceHandle:a?f:r,target:a?n:d,targetHandle:a?r:f};u.connection=v,h&&g&&(t===gt.Strict?a&&c==="source"||!a&&c==="target":d!==n||f!==r)&&(u.endHandle={nodeId:d,handleId:f,type:c},u.isValid=s(v))}return u}function Wp({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,s)=>{if(s[ue]){const{handleBounds:i}=s[ue];let a=[],l=[];i&&(a=Hi(s,i,"source",`${t}-${n}-${r}`),l=Hi(s,i,"target",`${t}-${n}-${r}`)),o.push(...a,...l)}return o},[])}function Yo(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function cr(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Xp(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function nc({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:s,setState:i,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:u}){const c=qa(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:h,connectionRadius:g,onConnectStart:v,panBy:p,getNodes:m,cancelConnection:w}=s();let x=0,b;const{x:S,y:C}=Qe(e),D=c?.elementFromPoint(S,C),E=Yo(l,D),_=f?.getBoundingClientRect();if(!_||!E)return;let N,M=Qe(e,_),A=!1,P=null,y=!1,T=null;const I=Wp({nodes:m(),nodeId:n,handleId:t,handleType:E}),z=()=>{if(!h)return;const[V,B]=Va(M,_);p({x:V,y:B}),x=requestAnimationFrame(z)};i({connectionPosition:M,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:n,handleId:t,type:E},connectionEndHandle:null}),v?.(e,{nodeId:n,handleId:t,handleType:E});function G(V){const{transform:B}=s();M=Qe(V,_);const{handle:Y,validHandleResult:k}=jp(V,c,Eo(M,B,!1,[1,1]),g,I,L=>tc(L,d,n,t,o?"target":"source",a,c));if(b=Y,A||(z(),A=!0),T=k.handleDomNode,P=k.connection,y=k.isValid,i({connectionPosition:b&&y?Ua({x:b.x,y:b.y},B):M,connectionStatus:Xp(!!b,y),connectionEndHandle:k.endHandle}),!b&&!y&&!T)return cr(N);P.source!==P.target&&T&&(cr(N),N=T,T.classList.add("connecting","react-flow__handle-connecting"),T.classList.toggle("valid",y),T.classList.toggle("react-flow__handle-valid",y))}function R(V){(b||T)&&P&&y&&r?.(P),s().onConnectEnd?.(V),l&&u?.(V),cr(N),w(),cancelAnimationFrame(x),A=!1,y=!1,P=null,T=null,c.removeEventListener("mousemove",G),c.removeEventListener("mouseup",R),c.removeEventListener("touchmove",G),c.removeEventListener("touchend",R)}c.addEventListener("mousemove",G),c.addEventListener("mouseup",R),c.addEventListener("touchmove",G),c.addEventListener("touchend",R)}const Vi=()=>!0,Zp=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Up=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:s,connectionClickStartHandle:i}=r;return{connecting:o?.nodeId===e&&o?.handleId===t&&o?.type===n||s?.nodeId===e&&s?.handleId===t&&s?.type===n,clickConnecting:i?.nodeId===e&&i?.handleId===t&&i?.type===n}},rc=ia(({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:u,onMouseDown:c,onTouchStart:d,...f},h)=>{const g=i||null,v=e==="target",p=he(),m=Hp(),{connectOnClick:w,noPanClassName:x}=ce(Zp,pe),{connecting:b,clickConnecting:S}=ce(Up(m,g,e),pe);m||p.getState().onError?.("010",Ge.error010());const C=_=>{const{defaultEdgeOptions:N,onConnect:M,hasDefaultEdges:A}=p.getState(),P={...N,..._};if(A){const{edges:y,setEdges:T}=p.getState();T(Gp(P,y))}M?.(P),a?.(P)},D=_=>{if(!m)return;const N=Ya(_);o&&(N&&_.button===0||!N)&&nc({event:_,handleId:g,nodeId:m,onConnect:C,isTarget:v,getState:p.getState,setState:p.setState,isValidConnection:n||p.getState().isValidConnection||Vi}),N?c?.(_):d?.(_)},E=_=>{const{onClickConnectStart:N,onClickConnectEnd:M,connectionClickStartHandle:A,connectionMode:P,isValidConnection:y}=p.getState();if(!m||!A&&!o)return;if(!A){N?.(_,{nodeId:m,handleId:g,handleType:e}),p.setState({connectionClickStartHandle:{nodeId:m,type:e,handleId:g}});return}const T=qa(_.target),I=n||y||Vi,{connection:z,isValid:G}=tc({nodeId:m,id:g,type:e},P,A.nodeId,A.handleId||null,A.type,I,T);G&&C(z),M?.(_),p.setState({connectionClickStartHandle:null})};return F.createElement("div",{"data-handleid":g,"data-nodeid":m,"data-handlepos":t,"data-id":`${m}-${g}-${e}`,className:me(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",x,u,{source:!v,target:v,connectable:r,connectablestart:o,connectableend:s,connecting:S,connectionindicator:r&&(o&&!b||s&&b)}]),onMouseDown:D,onTouchStart:D,onClick:w?E:void 0,ref:h,...f},l)});rc.displayName="Handle";var et=ae(rc);const oc=({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:r=X.Bottom})=>F.createElement(F.Fragment,null,F.createElement(et,{type:"target",position:n,isConnectable:t}),e?.label,F.createElement(et,{type:"source",position:r,isConnectable:t}));oc.displayName="DefaultNode";var _o=ae(oc);const ic=({data:e,isConnectable:t,sourcePosition:n=X.Bottom})=>F.createElement(F.Fragment,null,e?.label,F.createElement(et,{type:"source",position:n,isConnectable:t}));ic.displayName="InputNode";var sc=ae(ic);const ac=({data:e,isConnectable:t,targetPosition:n=X.Top})=>F.createElement(F.Fragment,null,F.createElement(et,{type:"target",position:n,isConnectable:t}),e?.label);ac.displayName="OutputNode";var cc=ae(ac);const Wo=()=>null;Wo.displayName="GroupNode";const Kp=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),gn=e=>e.id;function Qp(e,t){return pe(e.selectedNodes.map(gn),t.selectedNodes.map(gn))&&pe(e.selectedEdges.map(gn),t.selectedEdges.map(gn))}const lc=ae(({onSelectionChange:e})=>{const t=he(),{selectedNodes:n,selectedEdges:r}=ce(Kp,Qp);return oe(()=>{const o={nodes:n,edges:r};e?.(o),t.getState().onSelectionChange.forEach(s=>s(o))},[n,r,e]),null});lc.displayName="SelectionListener";const Jp=e=>!!e.onSelectionChange;function eg({onSelectionChange:e}){const t=ce(Jp);return e||t?F.createElement(lc,{onSelectionChange:e}):null}const tg=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function _t(e,t){oe(()=>{typeof e<"u"&&t(e)},[e])}function J(e,t,n){oe(()=>{typeof t<"u"&&n({[e]:t})},[t])}const ng=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:s,onConnectEnd:i,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:c,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:h,elevateNodesOnSelect:g,minZoom:v,maxZoom:p,nodeExtent:m,onNodesChange:w,onEdgesChange:x,elementsSelectable:b,connectionMode:S,snapGrid:C,snapToGrid:D,translateExtent:E,connectOnClick:_,defaultEdgeOptions:N,fitView:M,fitViewOptions:A,onNodesDelete:P,onEdgesDelete:y,onNodeDrag:T,onNodeDragStart:I,onNodeDragStop:z,onSelectionDrag:G,onSelectionDragStart:R,onSelectionDragStop:V,noPanClassName:B,nodeOrigin:Y,rfId:k,autoPanOnConnect:L,autoPanOnNodeDrag:$,onError:q,connectionRadius:H,isValidConnection:j,nodeDragThreshold:W})=>{const{setNodes:Z,setEdges:ne,setDefaultNodesAndEdges:K,setMinZoom:ee,setMaxZoom:le,setTranslateExtent:se,setNodeExtent:ye,reset:ie}=ce(tg,pe),U=he();return oe(()=>{const ve=r?.map(Pe=>({...Pe,...N}));return K(n,ve),()=>{ie()}},[]),J("defaultEdgeOptions",N,U.setState),J("connectionMode",S,U.setState),J("onConnect",o,U.setState),J("onConnectStart",s,U.setState),J("onConnectEnd",i,U.setState),J("onClickConnectStart",a,U.setState),J("onClickConnectEnd",l,U.setState),J("nodesDraggable",u,U.setState),J("nodesConnectable",c,U.setState),J("nodesFocusable",d,U.setState),J("edgesFocusable",f,U.setState),J("edgesUpdatable",h,U.setState),J("elementsSelectable",b,U.setState),J("elevateNodesOnSelect",g,U.setState),J("snapToGrid",D,U.setState),J("snapGrid",C,U.setState),J("onNodesChange",w,U.setState),J("onEdgesChange",x,U.setState),J("connectOnClick",_,U.setState),J("fitViewOnInit",M,U.setState),J("fitViewOnInitOptions",A,U.setState),J("onNodesDelete",P,U.setState),J("onEdgesDelete",y,U.setState),J("onNodeDrag",T,U.setState),J("onNodeDragStart",I,U.setState),J("onNodeDragStop",z,U.setState),J("onSelectionDrag",G,U.setState),J("onSelectionDragStart",R,U.setState),J("onSelectionDragStop",V,U.setState),J("noPanClassName",B,U.setState),J("nodeOrigin",Y,U.setState),J("rfId",k,U.setState),J("autoPanOnConnect",L,U.setState),J("autoPanOnNodeDrag",$,U.setState),J("onError",q,U.setState),J("connectionRadius",H,U.setState),J("isValidConnection",j,U.setState),J("nodeDragThreshold",W,U.setState),_t(e,Z),_t(t,ne),_t(v,ee),_t(p,le),_t(E,se),_t(m,ye),null},qi={display:"none"},rg={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},uc="react-flow__node-desc",dc="react-flow__edge-desc",og="react-flow__aria-live",ig=e=>e.ariaLiveMessage;function sg({rfId:e}){const t=ce(ig);return F.createElement("div",{id:`${og}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:rg},t)}function ag({rfId:e,disableKeyboardA11y:t}){return F.createElement(F.Fragment,null,F.createElement("div",{id:`${uc}-${e}`,style:qi},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),F.createElement("div",{id:`${dc}-${e}`,style:qi},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&F.createElement(sg,{rfId:e}))}var tn=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=re(!1),o=Q(!1),s=Q(new Set([])),[i,a]=Ne(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),c=u.reduce((d,f)=>d.concat(...f),[]);return[u,c]}return[[],[]]},[e]);return oe(()=>{const l=typeof document<"u"?document:null,u=t?.target||l;if(e!==null){const c=h=>{if(o.current=h.ctrlKey||h.metaKey||h.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&vo(h))return!1;const v=Gi(h.code,a);s.current.add(h[v]),Bi(i,s.current,!1)&&(h.preventDefault(),r(!0))},d=h=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&vo(h))return!1;const v=Gi(h.code,a);Bi(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(h[v]),h.key==="Meta"&&s.current.clear(),o.current=!1},f=()=>{s.current.clear(),r(!1)};return u?.addEventListener("keydown",c),u?.addEventListener("keyup",d),window.addEventListener("blur",f),()=>{u?.removeEventListener("keydown",c),u?.removeEventListener("keyup",d),window.removeEventListener("blur",f)}}},[e,r]),n};function Bi(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Gi(e,t){return t.includes(e)?"code":"key"}function fc(e,t,n,r){const o=e.parentNode||e.parentId;if(!o)return n;const s=t.get(o),i=ht(s,r);return fc(s,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(s[ue]?.z??0)>(n.z??0)?s[ue]?.z??0:n.z??0},r)}function hc(e,t,n){e.forEach(r=>{const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n?.[r.id]){const{x:s,y:i,z:a}=fc(r,e,{...r.position,z:r[ue]?.z??0},t);r.positionAbsolute={x:s,y:i},r[ue].z=a,n?.[r.id]&&(r[ue].isParent=!0)}})}function lr(e,t,n,r){const o=new Map,s={},i=r?1e3:0;return e.forEach(a=>{const l=(Se(a.zIndex)?a.zIndex:0)+(a.selected?i:0),u=t.get(a.id),c={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(s[d]=!0);const f=u?.type&&u?.type!==a.type;Object.defineProperty(c,ue,{enumerable:!1,value:{handleBounds:f?void 0:u?.[ue]?.handleBounds,z:l}}),o.set(a.id,c)}),hc(o,n,s),o}function pc(e,t={}){const{getNodes:n,width:r,height:o,minZoom:s,maxZoom:i,d3Zoom:a,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:c,nodeOrigin:d}=e(),f=t.initial&&!u&&c;if(a&&l&&(f||!t.initial)){const g=n().filter(p=>{const m=t.includeHiddenNodes?p.width&&p.height:!p.hidden;return t.nodes?.length?m&&t.nodes.some(w=>w.id===p.id):m}),v=g.every(p=>p.width&&p.height);if(g.length>0&&v){const p=Wn(g,d),{x:m,y:w,zoom:x}=Ja(p,r,o,t.minZoom??s,t.maxZoom??i,t.padding??.1),b=qe.translate(m,w).scale(x);return typeof t.duration=="number"&&t.duration>0?a.transform(at(l,t.duration),b):a.transform(l,b),!0}}return!1}function cg(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[ue]:r[ue],selected:n.selected})}),new Map(t)}function lg(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function mn({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:s,onNodesChange:i,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:u}=n();e?.length&&(l&&r({nodeInternals:cg(e,o)}),i?.(e)),t?.length&&(u&&r({edges:lg(t,s)}),a?.(t))}const Ct=()=>{},ug={zoomIn:Ct,zoomOut:Ct,zoomTo:Ct,getZoom:()=>1,setViewport:Ct,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ct,fitBounds:Ct,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},dg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),fg=()=>{const e=he(),{d3Zoom:t,d3Selection:n}=ce(dg,pe);return Ne(()=>n&&t?{zoomIn:o=>t.scaleBy(at(n,o?.duration),1.2),zoomOut:o=>t.scaleBy(at(n,o?.duration),1/1.2),zoomTo:(o,s)=>t.scaleTo(at(n,s?.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,s)=>{const[i,a,l]=e.getState().transform,u=qe.translate(o.x??i,o.y??a).scale(o.zoom??l);t.transform(at(n,s?.duration),u)},getViewport:()=>{const[o,s,i]=e.getState().transform;return{x:o,y:s,zoom:i}},fitView:o=>pc(e.getState,o),setCenter:(o,s,i)=>{const{width:a,height:l,maxZoom:u}=e.getState(),c=typeof i?.zoom<"u"?i.zoom:u,d=a/2-o*c,f=l/2-s*c,h=qe.translate(d,f).scale(c);t.transform(at(n,i?.duration),h)},fitBounds:(o,s)=>{const{width:i,height:a,minZoom:l,maxZoom:u}=e.getState(),{x:c,y:d,zoom:f}=Ja(o,i,a,l,u,s?.padding??.1),h=qe.translate(c,d).scale(f);t.transform(at(n,s?.duration),h)},project:o=>{const{transform:s,snapToGrid:i,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Eo(o,s,i,a)},screenToFlowPosition:o=>{const{transform:s,snapToGrid:i,snapGrid:a,domNode:l}=e.getState();if(!l)return o;const{x:u,y:c}=l.getBoundingClientRect(),d={x:o.x-u,y:o.y-c};return Eo(d,s,i,a)},flowToScreenPosition:o=>{const{transform:s,domNode:i}=e.getState();if(!i)return o;const{x:a,y:l}=i.getBoundingClientRect(),u=Ua(o,s);return{x:u.x+a,y:u.y+l}},viewportInitialized:!0}:ug,[t,n])};function Xo(){const e=fg(),t=he(),n=de(()=>t.getState().getNodes().map(v=>({...v})),[]),r=de(v=>t.getState().nodeInternals.get(v),[]),o=de(()=>{const{edges:v=[]}=t.getState();return v.map(p=>({...p}))},[]),s=de(v=>{const{edges:p=[]}=t.getState();return p.find(m=>m.id===v)},[]),i=de(v=>{const{getNodes:p,setNodes:m,hasDefaultNodes:w,onNodesChange:x}=t.getState(),b=p(),S=typeof v=="function"?v(b):v;if(w)m(S);else if(x){const C=S.length===0?b.map(D=>({type:"remove",id:D.id})):S.map(D=>({item:D,type:"reset"}));x(C)}},[]),a=de(v=>{const{edges:p=[],setEdges:m,hasDefaultEdges:w,onEdgesChange:x}=t.getState(),b=typeof v=="function"?v(p):v;if(w)m(b);else if(x){const S=b.length===0?p.map(C=>({type:"remove",id:C.id})):b.map(C=>({item:C,type:"reset"}));x(S)}},[]),l=de(v=>{const p=Array.isArray(v)?v:[v],{getNodes:m,setNodes:w,hasDefaultNodes:x,onNodesChange:b}=t.getState();if(x){const C=[...m(),...p];w(C)}else if(b){const S=p.map(C=>({item:C,type:"add"}));b(S)}},[]),u=de(v=>{const p=Array.isArray(v)?v:[v],{edges:m=[],setEdges:w,hasDefaultEdges:x,onEdgesChange:b}=t.getState();if(x)w([...m,...p]);else if(b){const S=p.map(C=>({item:C,type:"add"}));b(S)}},[]),c=de(()=>{const{getNodes:v,edges:p=[],transform:m}=t.getState(),[w,x,b]=m;return{nodes:v().map(S=>({...S})),edges:p.map(S=>({...S})),viewport:{x:w,y:x,zoom:b}}},[]),d=de(({nodes:v,edges:p})=>{const{nodeInternals:m,getNodes:w,edges:x,hasDefaultNodes:b,hasDefaultEdges:S,onNodesDelete:C,onEdgesDelete:D,onNodesChange:E,onEdgesChange:_}=t.getState(),N=(v||[]).map(T=>T.id),M=(p||[]).map(T=>T.id),A=w().reduce((T,I)=>{const z=I.parentNode||I.parentId,G=!N.includes(I.id)&&z&&T.find(V=>V.id===z);return(typeof I.deletable=="boolean"?I.deletable:!0)&&(N.includes(I.id)||G)&&T.push(I),T},[]),P=x.filter(T=>typeof T.deletable=="boolean"?T.deletable:!0),y=P.filter(T=>M.includes(T.id));if(A||y){const T=Qa(A,P),I=[...y,...T],z=I.reduce((G,R)=>(G.includes(R.id)||G.push(R.id),G),[]);if((S||b)&&(S&&t.setState({edges:x.filter(G=>!z.includes(G.id))}),b&&(A.forEach(G=>{m.delete(G.id)}),t.setState({nodeInternals:new Map(m)}))),z.length>0&&(D?.(I),_&&_(z.map(G=>({id:G,type:"remove"})))),A.length>0&&(C?.(A),E)){const G=A.map(R=>({id:R.id,type:"remove"}));E(G)}}},[]),f=de(v=>{const p=Ap(v),m=p?null:t.getState().nodeInternals.get(v.id);return!p&&!m?[null,null,p]:[p?v:Di(m),m,p]},[]),h=de((v,p=!0,m)=>{const[w,x,b]=f(v);return w?(m||t.getState().getNodes()).filter(S=>{if(!b&&(S.id===x.id||!S.positionAbsolute))return!1;const C=Di(S),D=wo(C,w);return p&&D>0||D>=w.width*w.height}):[]},[]),g=de((v,p,m=!0)=>{const[w]=f(v);if(!w)return!1;const x=wo(w,p);return m&&x>0||x>=w.width*w.height},[]);return Ne(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:s,setNodes:i,setEdges:a,addNodes:l,addEdges:u,toObject:c,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:g}),[e,n,r,o,s,i,a,l,u,c,d,h,g])}const hg={actInsideInputWithModifier:!1};var pg=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=he(),{deleteElements:r}=Xo(),o=tn(e,hg),s=tn(t);oe(()=>{if(o){const{edges:i,getNodes:a}=n.getState(),l=a().filter(c=>c.selected),u=i.filter(c=>c.selected);r({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),oe(()=>{n.setState({multiSelectionActive:s})},[s])};function gg(e){const t=he();oe(()=>{let n;const r=()=>{if(!e.current)return;const o=zo(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",Ge.error004()),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Zo={position:"absolute",width:"100%",height:"100%",top:0,left:0},mg=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,yn=e=>({x:e.x,y:e.y,zoom:e.k}),St=(e,t)=>e.target.closest(`.${t}`),ji=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Yi=e=>{const t=e.ctrlKey&&Tn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},yg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),wg=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:s=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=ut.Free,zoomOnDoubleClick:u=!0,elementsSelectable:c,panOnDrag:d=!0,defaultViewport:f,translateExtent:h,minZoom:g,maxZoom:v,zoomActivationKeyCode:p,preventScrolling:m=!0,children:w,noWheelClassName:x,noPanClassName:b})=>{const S=Q(),C=he(),D=Q(!1),E=Q(!1),_=Q(null),N=Q({x:0,y:0,zoom:0}),{d3Zoom:M,d3Selection:A,d3ZoomHandler:P,userSelectionActive:y}=ce(yg,pe),T=tn(p),I=Q(0),z=Q(!1),G=Q();return gg(_),oe(()=>{if(_.current){const R=_.current.getBoundingClientRect(),V=za().scaleExtent([g,v]).translateExtent(h),B=Ce(_.current).call(V),Y=qe.translate(f.x,f.y).scale(Ot(f.zoom,g,v)),k=[[0,0],[R.width,R.height]],L=V.constrain()(Y,k,h);V.transform(B,L),V.wheelDelta(Yi),C.setState({d3Zoom:V,d3Selection:B,d3ZoomHandler:B.on("wheel.zoom"),transform:[L.x,L.y,L.k],domNode:_.current.closest(".react-flow")})}},[]),oe(()=>{A&&M&&(i&&!T&&!y?A.on("wheel.zoom",R=>{if(St(R,x))return!1;R.preventDefault(),R.stopImmediatePropagation();const V=A.property("__zoom").k||1;if(R.ctrlKey&&s){const j=ke(R),W=Yi(R),Z=V*Math.pow(2,W);M.scaleTo(A,Z,j,R);return}const B=R.deltaMode===1?20:1;let Y=l===ut.Vertical?0:R.deltaX*B,k=l===ut.Horizontal?0:R.deltaY*B;!Tn()&&R.shiftKey&&l!==ut.Vertical&&(Y=R.deltaY*B,k=0),M.translateBy(A,-(Y/V)*a,-(k/V)*a,{internal:!0});const L=yn(A.property("__zoom")),{onViewportChangeStart:$,onViewportChange:q,onViewportChangeEnd:H}=C.getState();clearTimeout(G.current),z.current||(z.current=!0,t?.(R,L),$?.(L)),z.current&&(e?.(R,L),q?.(L),G.current=setTimeout(()=>{n?.(R,L),H?.(L),z.current=!1},150))},{passive:!1}):typeof P<"u"&&A.on("wheel.zoom",function(R,V){if(!m&&R.type==="wheel"&&!R.ctrlKey||St(R,x))return null;R.preventDefault(),P.call(this,R,V)},{passive:!1}))},[y,i,l,A,M,P,T,s,m,x,t,e,n]),oe(()=>{M&&M.on("start",R=>{if(!R.sourceEvent||R.sourceEvent.internal)return null;I.current=R.sourceEvent?.button;const{onViewportChangeStart:V}=C.getState(),B=yn(R.transform);D.current=!0,N.current=B,R.sourceEvent?.type==="mousedown"&&C.setState({paneDragging:!0}),V?.(B),t?.(R.sourceEvent,B)})},[M,t]),oe(()=>{M&&(y&&!D.current?M.on("zoom",null):y||M.on("zoom",R=>{const{onViewportChange:V}=C.getState();if(C.setState({transform:[R.transform.x,R.transform.y,R.transform.k]}),E.current=!!(r&&ji(d,I.current??0)),(e||V)&&!R.sourceEvent?.internal){const B=yn(R.transform);V?.(B),e?.(R.sourceEvent,B)}}))},[y,M,e,d,r]),oe(()=>{M&&M.on("end",R=>{if(!R.sourceEvent||R.sourceEvent.internal)return null;const{onViewportChangeEnd:V}=C.getState();if(D.current=!1,C.setState({paneDragging:!1}),r&&ji(d,I.current??0)&&!E.current&&r(R.sourceEvent),E.current=!1,(n||V)&&mg(N.current,R.transform)){const B=yn(R.transform);N.current=B,clearTimeout(S.current),S.current=setTimeout(()=>{V?.(B),n?.(R.sourceEvent,B)},i?150:0)}})},[M,i,d,n,r]),oe(()=>{M&&M.filter(R=>{const V=T||o,B=s&&R.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&R.button===1&&R.type==="mousedown"&&(St(R,"react-flow__node")||St(R,"react-flow__edge")))return!0;if(!d&&!V&&!i&&!u&&!s||y||!u&&R.type==="dblclick"||St(R,x)&&R.type==="wheel"||St(R,b)&&(R.type!=="wheel"||i&&R.type==="wheel"&&!T)||!s&&R.ctrlKey&&R.type==="wheel"||!V&&!i&&!B&&R.type==="wheel"||!d&&(R.type==="mousedown"||R.type==="touchstart")||Array.isArray(d)&&!d.includes(R.button)&&R.type==="mousedown")return!1;const Y=Array.isArray(d)&&d.includes(R.button)||!R.button||R.button<=1;return(!R.ctrlKey||R.type==="wheel")&&Y})},[y,M,o,s,i,u,d,c,T]),F.createElement("div",{className:"react-flow__renderer",ref:_,style:Zo},w)},vg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function bg(){const{userSelectionActive:e,userSelectionRect:t}=ce(vg,pe);return e&&t?F.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Wi(e,t){const n=t.parentNode||t.parentId,r=e.find(o=>o.id===n);if(r){const o=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(o>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,o>0&&(r.style.width+=o),s>0&&(r.style.height+=s),t.position.x<0){const i=Math.abs(t.position.x);r.position.x=r.position.x-i,r.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);r.position.y=r.position.y-i,r.style.height+=i,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function gc(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const s=e.filter(a=>a.id===o.id);if(s.length===0)return r.push(o),r;const i={...o};for(const a of s)if(a)switch(a.type){case"select":{i.selected=a.selected;break}case"position":{typeof a.position<"u"&&(i.position=a.position),typeof a.positionAbsolute<"u"&&(i.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(i.dragging=a.dragging),i.expandParent&&Wi(r,i);break}case"dimensions":{typeof a.dimensions<"u"&&(i.width=a.dimensions.width,i.height=a.dimensions.height),typeof a.updateStyle<"u"&&(i.style={...i.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(i.resizing=a.resizing),i.expandParent&&Wi(r,i);break}case"remove":return r}return r.push(i),r},n)}function mc(e,t){return gc(e,t)}function xg(e,t){return gc(e,t)}const Ze=(e,t)=>({id:e,type:"select",selected:t});function kt(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(Ze(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(Ze(r.id,!1))),n},[])}const ur=(e,t)=>n=>{n.target===t.current&&e?.(n)},Eg=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),yc=ae(({isSelecting:e,selectionMode:t=en.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:s,onPaneContextMenu:i,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:c,children:d})=>{const f=Q(null),h=he(),g=Q(0),v=Q(0),p=Q(),{userSelectionActive:m,elementsSelectable:w,dragging:x}=ce(Eg,pe),b=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,v.current=0},S=P=>{s?.(P),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},C=P=>{if(Array.isArray(n)&&n?.includes(2)){P.preventDefault();return}i?.(P)},D=a?P=>a(P):void 0,E=P=>{const{resetSelectedElements:y,domNode:T}=h.getState();if(p.current=T?.getBoundingClientRect(),!w||!e||P.button!==0||P.target!==f.current||!p.current)return;const{x:I,y:z}=Qe(P,p.current);y(),h.setState({userSelectionRect:{width:0,height:0,startX:I,startY:z,x:I,y:z}}),r?.(P)},_=P=>{const{userSelectionRect:y,nodeInternals:T,edges:I,transform:z,onNodesChange:G,onEdgesChange:R,nodeOrigin:V,getNodes:B}=h.getState();if(!e||!p.current||!y)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const Y=Qe(P,p.current),k=y.startX??0,L=y.startY??0,$={...y,x:Y.x<k?Y.x:k,y:Y.y<L?Y.y:L,width:Math.abs(Y.x-k),height:Math.abs(Y.y-L)},q=B(),H=Ka(T,$,z,t===en.Partial,!0,V),j=Qa(H,I).map(Z=>Z.id),W=H.map(Z=>Z.id);if(g.current!==W.length){g.current=W.length;const Z=kt(q,W);Z.length&&G?.(Z)}if(v.current!==j.length){v.current=j.length;const Z=kt(I,j);Z.length&&R?.(Z)}h.setState({userSelectionRect:$})},N=P=>{if(P.button!==0)return;const{userSelectionRect:y}=h.getState();!m&&y&&P.target===f.current&&S?.(P),h.setState({nodesSelectionActive:g.current>0}),b(),o?.(P)},M=P=>{m&&(h.setState({nodesSelectionActive:g.current>0}),o?.(P)),b()},A=w&&(e||m);return F.createElement("div",{className:me(["react-flow__pane",{dragging:x,selection:e}]),onClick:A?void 0:ur(S,f),onContextMenu:ur(C,f),onWheel:ur(D,f),onMouseEnter:A?void 0:l,onMouseDown:A?E:void 0,onMouseMove:A?_:u,onMouseUp:A?N:void 0,onMouseLeave:A?M:c,ref:f,style:Zo},d,F.createElement(bg,null))});yc.displayName="Pane";function wc(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:wc(r,t):!1}function Xi(e,t,n){let r=e;do{if(r?.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function _g(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!wc(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>({id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(o.positionAbsolute?.x??0),y:n.y-(o.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}))}function Cg(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function vc(e,t,n,r,o=[0,0],s){const i=Cg(e,e.extent||r);let a=i;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:f,y:h}=ht(d,o).positionAbsolute;a=d&&Se(f)&&Se(h)&&Se(d.width)&&Se(d.height)?[[f+e.width*o[0],h+e.height*o[1]],[f+d.width-e.width+e.width*o[0],h+d.height-e.height+e.height*o[1]]]:a}else s?.("005",Ge.error005()),a=i;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:f,y:h}=ht(d,o).positionAbsolute;a=[[e.extent[0][0]+f,e.extent[0][1]+h],[e.extent[1][0]+f,e.extent[1][1]+h]]}let u={x:0,y:0};if(l){const d=n.get(l);u=ht(d,o).positionAbsolute}const c=a&&a!=="parent"?Ho(t,a):t;return{position:{x:c.x-u.x,y:c.y-u.y},positionAbsolute:c}}function dr({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Zi=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const s=Array.from(o),i=t.getBoundingClientRect(),a={x:i.width*r[0],y:i.height*r[1]};return s.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-i.left-a.x)/n,y:(u.top-i.top-a.y)/n,...zo(l)}})};function qt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Co({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeInternals:a,onError:l}=t.getState(),u=a.get(e);if(!u){l?.("012",Ge.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&i)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):o([e])}function Sg(){const e=he();return de(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:s}=e.getState(),i=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(i-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?o[0]*Math.round(l.x/o[0]):l.x,ySnapped:s?o[1]*Math.round(l.y/o[1]):l.y,...l}},[])}function fr(e){return(t,n,r)=>e?.(t,r)}function bc({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,selectNodesOnDrag:i}){const a=he(),[l,u]=re(!1),c=Q([]),d=Q({x:null,y:null}),f=Q(0),h=Q(null),g=Q({x:0,y:0}),v=Q(null),p=Q(!1),m=Q(!1),w=Q(!1),x=Sg();return oe(()=>{if(e?.current){const b=Ce(e.current),S=({x:E,y:_})=>{const{nodeInternals:N,onNodeDrag:M,onSelectionDrag:A,updateNodePositions:P,nodeExtent:y,snapGrid:T,snapToGrid:I,nodeOrigin:z,onError:G}=a.getState();d.current={x:E,y:_};let R=!1,V={x:0,y:0,x2:0,y2:0};if(c.current.length>1&&y){const Y=Wn(c.current,z);V=Jt(Y)}if(c.current=c.current.map(Y=>{const k={x:E-Y.distance.x,y:_-Y.distance.y};I&&(k.x=T[0]*Math.round(k.x/T[0]),k.y=T[1]*Math.round(k.y/T[1]));const L=[[y[0][0],y[0][1]],[y[1][0],y[1][1]]];c.current.length>1&&y&&!Y.extent&&(L[0][0]=Y.positionAbsolute.x-V.x+y[0][0],L[1][0]=Y.positionAbsolute.x+(Y.width??0)-V.x2+y[1][0],L[0][1]=Y.positionAbsolute.y-V.y+y[0][1],L[1][1]=Y.positionAbsolute.y+(Y.height??0)-V.y2+y[1][1]);const $=vc(Y,k,N,L,z,G);return R=R||Y.position.x!==$.position.x||Y.position.y!==$.position.y,Y.position=$.position,Y.positionAbsolute=$.positionAbsolute,Y}),!R)return;P(c.current,!0,!0),u(!0);const B=o?M:fr(A);if(B&&v.current){const[Y,k]=dr({nodeId:o,dragItems:c.current,nodeInternals:N});B(v.current,Y,k)}},C=()=>{if(!h.current)return;const[E,_]=Va(g.current,h.current);if(E!==0||_!==0){const{transform:N,panBy:M}=a.getState();d.current.x=(d.current.x??0)-E/N[2],d.current.y=(d.current.y??0)-_/N[2],M({x:E,y:_})&&S(d.current)}f.current=requestAnimationFrame(C)},D=E=>{const{nodeInternals:_,multiSelectionActive:N,nodesDraggable:M,unselectNodesAndEdges:A,onNodeDragStart:P,onSelectionDragStart:y}=a.getState();m.current=!0;const T=o?P:fr(y);(!i||!s)&&!N&&o&&(_.get(o)?.selected||A()),o&&s&&i&&Co({id:o,store:a,nodeRef:e});const I=x(E);if(d.current=I,c.current=_g(_,M,I,o),T&&c.current){const[z,G]=dr({nodeId:o,dragItems:c.current,nodeInternals:_});T(E.sourceEvent,z,G)}};if(t)b.on(".drag",null);else{const E=Df().on("start",_=>{const{domNode:N,nodeDragThreshold:M}=a.getState();M===0&&D(_),w.current=!1;const A=x(_);d.current=A,h.current=N?.getBoundingClientRect()||null,g.current=Qe(_.sourceEvent,h.current)}).on("drag",_=>{const N=x(_),{autoPanOnNodeDrag:M,nodeDragThreshold:A}=a.getState();if(_.sourceEvent.type==="touchmove"&&_.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!p.current&&m.current&&M&&(p.current=!0,C()),!m.current){const P=N.xSnapped-(d?.current?.x??0),y=N.ySnapped-(d?.current?.y??0);Math.sqrt(P*P+y*y)>A&&D(_)}(d.current.x!==N.xSnapped||d.current.y!==N.ySnapped)&&c.current&&m.current&&(v.current=_.sourceEvent,g.current=Qe(_.sourceEvent,h.current),S(N))}}).on("end",_=>{if(!(!m.current||w.current)&&(u(!1),p.current=!1,m.current=!1,cancelAnimationFrame(f.current),c.current)){const{updateNodePositions:N,nodeInternals:M,onNodeDragStop:A,onSelectionDragStop:P}=a.getState(),y=o?A:fr(P);if(N(c.current,!1,!1),y){const[T,I]=dr({nodeId:o,dragItems:c.current,nodeInternals:M});y(_.sourceEvent,T,I)}}}).filter(_=>{const N=_.target;return!_.button&&(!n||!Xi(N,`.${n}`,e))&&(!r||Xi(N,r,e))});return b.call(E),()=>{b.on(".drag",null)}}}},[e,t,n,r,s,a,o,i,x]),l}function xc(){const e=he();return de(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:s,getNodes:i,snapToGrid:a,snapGrid:l,onError:u,nodesDraggable:c}=e.getState(),d=i().filter(w=>w.selected&&(w.draggable||c&&typeof w.draggable>"u")),f=a?l[0]:5,h=a?l[1]:5,g=n.isShiftPressed?4:1,v=n.x*f*g,p=n.y*h*g,m=d.map(w=>{if(w.positionAbsolute){const x={x:w.positionAbsolute.x+v,y:w.positionAbsolute.y+p};a&&(x.x=l[0]*Math.round(x.x/l[0]),x.y=l[1]*Math.round(x.y/l[1]));const{positionAbsolute:b,position:S}=vc(w,x,r,o,void 0,u);w.position=S,w.positionAbsolute=b}return w});s(m,!0,!1)},[])}const Lt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Bt=e=>{const t=({id:n,type:r,data:o,xPos:s,yPos:i,xPosOrigin:a,yPosOrigin:l,selected:u,onClick:c,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,onContextMenu:g,onDoubleClick:v,style:p,className:m,isDraggable:w,isSelectable:x,isConnectable:b,isFocusable:S,selectNodesOnDrag:C,sourcePosition:D,targetPosition:E,hidden:_,resizeObserver:N,dragHandle:M,zIndex:A,isParent:P,noDragClassName:y,noPanClassName:T,initialized:I,disableKeyboardA11y:z,ariaLabel:G,rfId:R,hasHandleBounds:V})=>{const B=he(),Y=Q(null),k=Q(null),L=Q(D),$=Q(E),q=Q(r),H=x||w||c||d||f||h,j=xc(),W=qt(n,B.getState,d),Z=qt(n,B.getState,f),ne=qt(n,B.getState,h),K=qt(n,B.getState,g),ee=qt(n,B.getState,v),le=ie=>{const{nodeDragThreshold:U}=B.getState();if(x&&(!C||!w||U>0)&&Co({id:n,store:B,nodeRef:Y}),c){const ve=B.getState().nodeInternals.get(n);ve&&c(ie,{...ve})}},se=ie=>{if(!vo(ie)&&!z)if(ja.includes(ie.key)&&x){const U=ie.key==="Escape";Co({id:n,store:B,unselect:U,nodeRef:Y})}else w&&u&&Object.prototype.hasOwnProperty.call(Lt,ie.key)&&(B.setState({ariaLiveMessage:`Moved selected node ${ie.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~i}`}),j({x:Lt[ie.key].x,y:Lt[ie.key].y,isShiftPressed:ie.shiftKey}))};oe(()=>()=>{k.current&&(N?.unobserve(k.current),k.current=null)},[]),oe(()=>{if(Y.current&&!_){const ie=Y.current;(!I||!V||k.current!==ie)&&(k.current&&N?.unobserve(k.current),N?.observe(ie),k.current=ie)}},[_,I,V]),oe(()=>{const ie=q.current!==r,U=L.current!==D,ve=$.current!==E;Y.current&&(ie||U||ve)&&(ie&&(q.current=r),U&&(L.current=D),ve&&($.current=E),B.getState().updateNodeDimensions([{id:n,nodeElement:Y.current,forceUpdate:!0}]))},[n,r,D,E]);const ye=bc({nodeRef:Y,disabled:_||!w,noDragClassName:y,handleSelector:M,nodeId:n,isSelectable:x,selectNodesOnDrag:C});return _?null:F.createElement("div",{className:me(["react-flow__node",`react-flow__node-${r}`,{[T]:w},m,{selected:u,selectable:x,parent:P,dragging:ye}]),ref:Y,style:{zIndex:A,transform:`translate(${a}px,${l}px)`,pointerEvents:H?"all":"none",visibility:I?"visible":"hidden",...p},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:W,onMouseMove:Z,onMouseLeave:ne,onContextMenu:K,onClick:le,onDoubleClick:ee,onKeyDown:S?se:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":z?void 0:`${uc}-${R}`,"aria-label":G},F.createElement(zp,{value:n},F.createElement(e,{id:n,data:o,type:r,xPos:s,yPos:i,selected:u,isConnectable:b,sourcePosition:D,targetPosition:E,dragging:ye,dragHandle:M,zIndex:A})))};return t.displayName="NodeWrapper",ae(t)};const Ng=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Wn(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function kg({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=he(),{width:o,height:s,x:i,y:a,transformString:l,userSelectionActive:u}=ce(Ng,pe),c=xc(),d=Q(null);if(oe(()=>{n||d.current?.focus({preventScroll:!0})},[n]),bc({nodeRef:d}),u||!o||!s)return null;const f=e?g=>{const v=r.getState().getNodes().filter(p=>p.selected);e(g,v)}:void 0,h=g=>{Object.prototype.hasOwnProperty.call(Lt,g.key)&&c({x:Lt[g.key].x,y:Lt[g.key].y,isShiftPressed:g.shiftKey})};return F.createElement("div",{className:me(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},F.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:o,height:s,top:a,left:i}}))}var Mg=ae(kg);const Ig=e=>e.nodesSelectionActive,Ec=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,deleteKeyCode:a,onMove:l,onMoveStart:u,onMoveEnd:c,selectionKeyCode:d,selectionOnDrag:f,selectionMode:h,onSelectionStart:g,onSelectionEnd:v,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:w,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:S,panOnScroll:C,panOnScrollSpeed:D,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:N,defaultViewport:M,translateExtent:A,minZoom:P,maxZoom:y,preventScrolling:T,onSelectionContextMenu:I,noWheelClassName:z,noPanClassName:G,disableKeyboardA11y:R})=>{const V=ce(Ig),B=tn(d),Y=tn(m),k=Y||N,L=Y||C,$=B||f&&k!==!0;return pg({deleteKeyCode:a,multiSelectionKeyCode:p}),F.createElement(wg,{onMove:l,onMoveStart:u,onMoveEnd:c,onPaneContextMenu:s,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:S,panOnScroll:L,panOnScrollSpeed:D,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:!B&&k,defaultViewport:M,translateExtent:A,minZoom:P,maxZoom:y,zoomActivationKeyCode:w,preventScrolling:T,noWheelClassName:z,noPanClassName:G},F.createElement(yc,{onSelectionStart:g,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:k,isSelecting:!!$,selectionMode:h},e,V&&F.createElement(Mg,{onSelectionContextMenu:I,noPanClassName:G,disableKeyboardA11y:R})))};Ec.displayName="FlowRenderer";var Lg=ae(Ec);function Ag(e){return ce(de(n=>e?Ka(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Tg(e){const t={input:Bt(e.input||sc),default:Bt(e.default||_o),output:Bt(e.output||cc),group:Bt(e.group||Wo)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,s)=>(o[s]=Bt(e[s]||_o),o),n);return{...t,...r}}const Og=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Rg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),_c=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:s,onError:i}=ce(Rg,pe),a=Ag(e.onlyRenderVisibleElements),l=Q(),u=Ne(()=>{if(typeof ResizeObserver>"u")return null;const c=new ResizeObserver(d=>{const f=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(f)});return l.current=c,c},[]);return oe(()=>()=>{l?.current?.disconnect()},[]),F.createElement("div",{className:"react-flow__nodes",style:Zo},a.map(c=>{let d=c.type||"default";e.nodeTypes[d]||(i?.("003",Ge.error003(d)),d="default");const f=e.nodeTypes[d]||e.nodeTypes.default,h=!!(c.draggable||t&&typeof c.draggable>"u"),g=!!(c.selectable||o&&typeof c.selectable>"u"),v=!!(c.connectable||n&&typeof c.connectable>"u"),p=!!(c.focusable||r&&typeof c.focusable>"u"),m=e.nodeExtent?Ho(c.positionAbsolute,e.nodeExtent):c.positionAbsolute,w=m?.x??0,x=m?.y??0,b=Og({x:w,y:x,width:c.width??0,height:c.height??0,origin:e.nodeOrigin});return F.createElement(f,{key:c.id,id:c.id,className:c.className,style:c.style,type:d,data:c.data,sourcePosition:c.sourcePosition||X.Bottom,targetPosition:c.targetPosition||X.Top,hidden:c.hidden,xPos:w,yPos:x,xPosOrigin:b.x,yPosOrigin:b.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!c.selected,isDraggable:h,isSelectable:g,isConnectable:v,isFocusable:p,resizeObserver:u,dragHandle:c.dragHandle,zIndex:c[ue]?.z??0,isParent:!!c[ue]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!c.width&&!!c.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:c.ariaLabel,hasHandleBounds:!!c[ue]?.handleBounds})}))};_c.displayName="NodeRenderer";var Dg=ae(_c);const $g=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,Pg=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,Ui="react-flow__edgeupdater",Ki=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a})=>F.createElement("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:me([Ui,`${Ui}-${a}`]),cx:$g(t,r,e),cy:Pg(n,r,e),r,stroke:"transparent",fill:"transparent"}),Fg=()=>!0;var Nt=e=>{const t=({id:n,className:r,type:o,data:s,onClick:i,onEdgeDoubleClick:a,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:v,style:p,source:m,target:w,sourceX:x,sourceY:b,targetX:S,targetY:C,sourcePosition:D,targetPosition:E,elementsSelectable:_,hidden:N,sourceHandleId:M,targetHandleId:A,onContextMenu:P,onMouseEnter:y,onMouseMove:T,onMouseLeave:I,reconnectRadius:z,onReconnect:G,onReconnectStart:R,onReconnectEnd:V,markerEnd:B,markerStart:Y,rfId:k,ariaLabel:L,isFocusable:$,isReconnectable:q,pathOptions:H,interactionWidth:j,disableKeyboardA11y:W})=>{const Z=Q(null),[ne,K]=re(!1),[ee,le]=re(!1),se=he(),ye=Ne(()=>`url('#${xo(Y,k)}')`,[Y,k]),ie=Ne(()=>`url('#${xo(B,k)}')`,[B,k]);if(N)return null;const U=we=>{const{edges:Te,addSelectedEdges:rt,unselectNodesAndEdges:ot,multiSelectionActive:Et}=se.getState(),Oe=Te.find(it=>it.id===n);Oe&&(_&&(se.setState({nodesSelectionActive:!1}),Oe.selected&&Et?(ot({nodes:[],edges:[Oe]}),Z.current?.blur()):rt([n])),i&&i(we,Oe))},ve=Vt(n,se.getState,a),Pe=Vt(n,se.getState,P),$t=Vt(n,se.getState,y),yt=Vt(n,se.getState,T),wt=Vt(n,se.getState,I),Fe=(we,Te)=>{if(we.button!==0)return;const{edges:rt,isValidConnection:ot}=se.getState(),Et=Te?w:m,Oe=(Te?A:M)||null,it=Te?"target":"source",Zn=ot||Fg,Un=Te,Ft=rt.find(st=>st.id===n);le(!0),R?.(we,Ft,it);const Kn=st=>{le(!1),V?.(st,Ft,it)};nc({event:we,handleId:Oe,nodeId:Et,onConnect:st=>G?.(Ft,st),isTarget:Un,getState:se.getState,setState:se.setState,isValidConnection:Zn,edgeUpdaterType:it,onReconnectEnd:Kn})},vt=we=>Fe(we,!0),tt=we=>Fe(we,!1),nt=()=>K(!0),bt=()=>K(!1),xt=!_&&!i,Pt=we=>{if(!W&&ja.includes(we.key)&&_){const{unselectNodesAndEdges:Te,addSelectedEdges:rt,edges:ot}=se.getState();we.key==="Escape"?(Z.current?.blur(),Te({edges:[ot.find(Oe=>Oe.id===n)]})):rt([n])}};return F.createElement("g",{className:me(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:l,animated:u,inactive:xt,updating:ne}]),onClick:U,onDoubleClick:ve,onContextMenu:Pe,onMouseEnter:$t,onMouseMove:yt,onMouseLeave:wt,onKeyDown:$?Pt:void 0,tabIndex:$?0:void 0,role:$?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":L===null?void 0:L||`Edge from ${m} to ${w}`,"aria-describedby":$?`${dc}-${k}`:void 0,ref:Z},!ee&&F.createElement(e,{id:n,source:m,target:w,selected:l,animated:u,label:c,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:v,data:s,style:p,sourceX:x,sourceY:b,targetX:S,targetY:C,sourcePosition:D,targetPosition:E,sourceHandleId:M,targetHandleId:A,markerStart:ye,markerEnd:ie,pathOptions:H,interactionWidth:j}),q&&F.createElement(F.Fragment,null,(q==="source"||q===!0)&&F.createElement(Ki,{position:D,centerX:x,centerY:b,radius:z,onMouseDown:vt,onMouseEnter:nt,onMouseOut:bt,type:"source"}),(q==="target"||q===!0)&&F.createElement(Ki,{position:E,centerX:S,centerY:C,radius:z,onMouseDown:tt,onMouseEnter:nt,onMouseOut:bt,type:"target"})))};return t.displayName="EdgeWrapper",ae(t)};function zg(e){const t={default:Nt(e.default||Rn),straight:Nt(e.bezier||Bo),step:Nt(e.step||qo),smoothstep:Nt(e.step||Yn),simplebezier:Nt(e.simplebezier||Vo)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,s)=>(o[s]=Nt(e[s]||Rn),o),n);return{...t,...r}}function Qi(e,t,n=null){const r=(n?.x||0)+t.x,o=(n?.y||0)+t.y,s=n?.width||t.width,i=n?.height||t.height;switch(e){case X.Top:return{x:r+s/2,y:o};case X.Right:return{x:r+s,y:o+i/2};case X.Bottom:return{x:r+s/2,y:o+i};case X.Left:return{x:r,y:o+i/2}}}function Ji(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Hg=(e,t,n,r,o,s)=>{const i=Qi(n,e,t),a=Qi(s,r,o);return{sourceX:i.x,sourceY:i.y,targetX:a.x,targetY:a.y}};function Vg({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:s,width:i,height:a,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const c=Jt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:i/l[2],height:a/l[2]}),d=Math.max(0,Math.min(c.x2,u.x2)-Math.max(c.x,u.x)),f=Math.max(0,Math.min(c.y2,u.y2)-Math.max(c.y,u.y));return Math.ceil(d*f)>0}function es(e){const t=e?.[ue]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const qg=[{level:0,isMaxLevel:!0,edges:[]}];function Bg(e,t,n=!1){let r=-1;const o=e.reduce((i,a)=>{const l=Se(a.zIndex);let u=l?a.zIndex:0;if(n){const c=t.get(a.target),d=t.get(a.source),f=a.selected||c?.selected||d?.selected,h=Math.max(d?.[ue]?.z||0,c?.[ue]?.z||0,1e3);u=(l?a.zIndex:0)+(f?h:0)}return i[u]?i[u].push(a):i[u]=[a],r=u>r?u:r,i},{}),s=Object.entries(o).map(([i,a])=>{const l=+i;return{edges:a,level:l,isMaxLevel:l===r}});return s.length===0?qg:s}function Gg(e,t,n){const r=ce(de(o=>e?o.edges.filter(s=>{const i=t.get(s.source),a=t.get(s.target);return i?.width&&i?.height&&a?.width&&a?.height&&Vg({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return Bg(r,t,n)}const jg=({color:e="none",strokeWidth:t=1})=>F.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Yg=({color:e="none",strokeWidth:t=1})=>F.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ts={[On.Arrow]:jg,[On.ArrowClosed]:Yg};function Wg(e){const t=he();return Ne(()=>Object.prototype.hasOwnProperty.call(ts,e)?ts[e]:(t.getState().onError?.("009",Ge.error009(e)),null),[e])}const Xg=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=Wg(t);return l?F.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},F.createElement(l,{color:n,strokeWidth:i})):null},Zg=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,s)=>([s.markerStart,s.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const a=xo(i,t);r.includes(a)||(o.push({id:a,color:i.color||e,...i}),r.push(a))}}),o),[]).sort((o,s)=>o.id.localeCompare(s.id))},Cc=({defaultColor:e,rfId:t})=>{const n=ce(de(Zg({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((s,i)=>s.id!==o[i].id)));return F.createElement("defs",null,n.map(r=>F.createElement(Xg,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};Cc.displayName="MarkerDefinitions";var Ug=ae(Cc);const Kg=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Sc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:c,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:v,children:p,disableKeyboardA11y:m})=>{const{edgesFocusable:w,edgesUpdatable:x,elementsSelectable:b,width:S,height:C,connectionMode:D,nodeInternals:E,onError:_}=ce(Kg,pe),N=Gg(t,E,n);return S?F.createElement(F.Fragment,null,N.map(({level:M,edges:A,isMaxLevel:P})=>F.createElement("svg",{key:M,style:{zIndex:M},width:S,height:C,className:"react-flow__edges react-flow__container"},P&&F.createElement(Ug,{defaultColor:e,rfId:r}),F.createElement("g",null,A.map(y=>{const[T,I,z]=es(E.get(y.source)),[G,R,V]=es(E.get(y.target));if(!z||!V)return null;let B=y.type||"default";o[B]||(_?.("011",Ge.error011(B)),B="default");const Y=o[B]||o.default,k=D===gt.Strict?R.target:(R.target??[]).concat(R.source??[]),L=Ji(I.source,y.sourceHandle),$=Ji(k,y.targetHandle),q=L?.position||X.Bottom,H=$?.position||X.Top,j=!!(y.focusable||w&&typeof y.focusable>"u"),W=y.reconnectable||y.updatable,Z=typeof f<"u"&&(W||x&&typeof W>"u");if(!L||!$)return _?.("008",Ge.error008(L,y)),null;const{sourceX:ne,sourceY:K,targetX:ee,targetY:le}=Hg(T,L,q,G,$,H);return F.createElement(Y,{key:y.id,id:y.id,className:me([y.className,s]),type:B,data:y.data,selected:!!y.selected,animated:!!y.animated,hidden:!!y.hidden,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,style:y.style,source:y.source,target:y.target,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerEnd:y.markerEnd,markerStart:y.markerStart,sourceX:ne,sourceY:K,targetX:ee,targetY:le,sourcePosition:q,targetPosition:H,elementsSelectable:b,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:c,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:v,rfId:r,ariaLabel:y.ariaLabel,isFocusable:j,isReconnectable:Z,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth,disableKeyboardA11y:m})})))),p):null};Sc.displayName="EdgeRenderer";var Qg=ae(Sc);const Jg=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function em({children:e}){const t=ce(Jg);return F.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function tm(e){const t=Xo(),n=Q(!1);oe(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const nm={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top},Nc=({nodeId:e,handleType:t,style:n,type:r=Ue.Bezier,CustomComponent:o,connectionStatus:s})=>{const{fromNode:i,handleId:a,toX:l,toY:u,connectionMode:c}=ce(de(C=>({fromNode:C.nodeInternals.get(e),handleId:C.connectionHandleId,toX:(C.connectionPosition.x-C.transform[0])/C.transform[2],toY:(C.connectionPosition.y-C.transform[1])/C.transform[2],connectionMode:C.connectionMode}),[e]),pe),d=i?.[ue]?.handleBounds;let f=d?.[t];if(c===gt.Loose&&(f=f||d?.[t==="source"?"target":"source"]),!i||!f)return null;const h=a?f.find(C=>C.id===a):f[0],g=h?h.x+h.width/2:(i.width??0)/2,v=h?h.y+h.height/2:i.height??0,p=(i.positionAbsolute?.x??0)+g,m=(i.positionAbsolute?.y??0)+v,w=h?.position,x=w?nm[w]:null;if(!w||!x)return null;if(o)return F.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:i,fromHandle:h,fromX:p,fromY:m,toX:l,toY:u,fromPosition:w,toPosition:x,connectionStatus:s});let b="";const S={sourceX:p,sourceY:m,sourcePosition:w,targetX:l,targetY:u,targetPosition:x};return r===Ue.Bezier?[b]=Go(S):r===Ue.Step?[b]=bo({...S,borderRadius:0}):r===Ue.SmoothStep?[b]=bo(S):r===Ue.SimpleBezier?[b]=Za(S):b=`M${p},${m} ${l},${u}`,F.createElement("path",{d:b,fill:"none",className:"react-flow__connection-path",style:n})};Nc.displayName="ConnectionLine";const rm=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function om({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:s,nodesConnectable:i,width:a,height:l,connectionStatus:u}=ce(rm,pe);return!(o&&s&&a&&i)?null:F.createElement("svg",{style:e,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},F.createElement("g",{className:me(["react-flow__connection",u])},F.createElement(Nc,{nodeId:o,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function ns(e,t){return Q(null),he(),Ne(()=>t(e),[e])}const kc=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:s,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,onSelectionContextMenu:g,onSelectionStart:v,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:w,connectionLineComponent:x,connectionLineContainerStyle:b,selectionKeyCode:S,selectionOnDrag:C,selectionMode:D,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:N,deleteKeyCode:M,onlyRenderVisibleElements:A,elementsSelectable:P,selectNodesOnDrag:y,defaultViewport:T,translateExtent:I,minZoom:z,maxZoom:G,preventScrolling:R,defaultMarkerColor:V,zoomOnScroll:B,zoomOnPinch:Y,panOnScroll:k,panOnScrollSpeed:L,panOnScrollMode:$,zoomOnDoubleClick:q,panOnDrag:H,onPaneClick:j,onPaneMouseEnter:W,onPaneMouseMove:Z,onPaneMouseLeave:ne,onPaneScroll:K,onPaneContextMenu:ee,onEdgeContextMenu:le,onEdgeMouseEnter:se,onEdgeMouseMove:ye,onEdgeMouseLeave:ie,onReconnect:U,onReconnectStart:ve,onReconnectEnd:Pe,reconnectRadius:$t,noDragClassName:yt,noWheelClassName:wt,noPanClassName:Fe,elevateEdgesOnSelect:vt,disableKeyboardA11y:tt,nodeOrigin:nt,nodeExtent:bt,rfId:xt})=>{const Pt=ns(e,Tg),we=ns(t,zg);return tm(s),F.createElement(Lg,{onPaneClick:j,onPaneMouseEnter:W,onPaneMouseMove:Z,onPaneMouseLeave:ne,onPaneContextMenu:ee,onPaneScroll:K,deleteKeyCode:M,selectionKeyCode:S,selectionOnDrag:C,selectionMode:D,onSelectionStart:v,onSelectionEnd:p,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:N,elementsSelectable:P,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:B,zoomOnPinch:Y,zoomOnDoubleClick:q,panOnScroll:k,panOnScrollSpeed:L,panOnScrollMode:$,panOnDrag:H,defaultViewport:T,translateExtent:I,minZoom:z,maxZoom:G,onSelectionContextMenu:g,preventScrolling:R,noDragClassName:yt,noWheelClassName:wt,noPanClassName:Fe,disableKeyboardA11y:tt},F.createElement(em,null,F.createElement(Qg,{edgeTypes:we,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:A,onEdgeContextMenu:le,onEdgeMouseEnter:se,onEdgeMouseMove:ye,onEdgeMouseLeave:ie,onReconnect:U,onReconnectStart:ve,onReconnectEnd:Pe,reconnectRadius:$t,defaultMarkerColor:V,noPanClassName:Fe,elevateEdgesOnSelect:!!vt,disableKeyboardA11y:tt,rfId:xt},F.createElement(om,{style:w,type:m,component:x,containerStyle:b})),F.createElement("div",{className:"react-flow__edgelabel-renderer"}),F.createElement(Dg,{nodeTypes:Pt,onNodeClick:i,onNodeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,selectNodesOnDrag:y,onlyRenderVisibleElements:A,noPanClassName:Fe,noDragClassName:yt,disableKeyboardA11y:tt,nodeOrigin:nt,nodeExtent:bt,rfId:xt})))};kc.displayName="GraphView";var im=ae(kc);const So=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ye={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:So,nodeExtent:So,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:gt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Tp,isValidConnection:void 0},sm=()=>Yu((e,t)=>({...Ye,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:s}=t();e({nodeInternals:lr(n,r,o,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",s=typeof r<"u",i=o?lr(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:s?r:[],hasDefaultNodes:o,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:s,fitViewOnInitDone:i,fitViewOnInitOptions:a,domNode:l,nodeOrigin:u}=t(),c=l?.querySelector(".react-flow__viewport");if(!c)return;const d=window.getComputedStyle(c),{m22:f}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((v,p)=>{const m=o.get(p.id);if(m?.hidden)o.set(m.id,{...m,[ue]:{...m[ue],handleBounds:void 0}});else if(m){const w=zo(p.nodeElement);!!(w.width&&w.height&&(m.width!==w.width||m.height!==w.height||p.forceUpdate))&&(o.set(m.id,{...m,[ue]:{...m[ue],handleBounds:{source:Zi(".source",p.nodeElement,f,u),target:Zi(".target",p.nodeElement,f,u)}},...w}),v.push({id:m.id,type:"dimensions",dimensions:w}))}return v},[]);hc(o,u);const g=i||s&&!i&&pc(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:g}),h?.length>0&&r?.(h)},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:s}=t(),i=n.map(a=>{const l={id:a.id,type:"position",dragging:o};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});s(i)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:s,nodeOrigin:i,getNodes:a,elevateNodesOnSelect:l}=t();if(n?.length){if(s){const u=mc(n,a()),c=lr(u,o,i,l);e({nodeInternals:c})}r?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:s}=t();let i,a=null;r?i=n.map(l=>Ze(l,!0)):(i=kt(s(),n),a=kt(o,[])),mn({changedNodes:i,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:s}=t();let i,a=null;r?i=n.map(l=>Ze(l,!0)):(i=kt(o,n),a=kt(s(),[])),mn({changedNodes:a,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:s}=t(),i=n||s(),a=r||o,l=i.map(c=>(c.selected=!1,Ze(c.id,!1))),u=a.map(c=>Ze(c.id,!1));mn({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r?.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r?.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(a=>a.selected).map(a=>Ze(a.id,!1)),i=n.filter(a=>a.selected).map(a=>Ze(a.id,!1));mn({changedNodes:s,changedEdges:i,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=Ho(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:s,d3Zoom:i,d3Selection:a,translateExtent:l}=t();if(!i||!a||!n.x&&!n.y)return!1;const u=qe.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),c=[[0,0],[o,s]],d=i?.constrain()(u,c,l);return i.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Ye.connectionNodeId,connectionHandleId:Ye.connectionHandleId,connectionHandleType:Ye.connectionHandleType,connectionStatus:Ye.connectionStatus,connectionStartHandle:Ye.connectionStartHandle,connectionEndHandle:Ye.connectionEndHandle}),reset:()=>e({...Ye})}),Object.is),Mc=({children:e})=>{const t=Q(null);return t.current||(t.current=sm()),F.createElement(Sp,{value:t.current},e)};Mc.displayName="ReactFlowProvider";const Ic=({children:e})=>Hn(jn)?F.createElement(F.Fragment,null,e):F.createElement(Mc,null,e);Ic.displayName="ReactFlowWrapper";const am={input:sc,default:_o,output:cc,group:Wo},cm={default:Rn,straight:Bo,step:qo,smoothstep:Yn,simplebezier:Vo},lm=[0,0],um=[15,15],dm={x:0,y:0,zoom:1},fm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Lc=ia(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s=am,edgeTypes:i=cm,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:c,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:g,onConnectEnd:v,onClickConnectStart:p,onClickConnectEnd:m,onNodeMouseEnter:w,onNodeMouseMove:x,onNodeMouseLeave:b,onNodeContextMenu:S,onNodeDoubleClick:C,onNodeDragStart:D,onNodeDrag:E,onNodeDragStop:_,onNodesDelete:N,onEdgesDelete:M,onSelectionChange:A,onSelectionDragStart:P,onSelectionDrag:y,onSelectionDragStop:T,onSelectionContextMenu:I,onSelectionStart:z,onSelectionEnd:G,connectionMode:R=gt.Strict,connectionLineType:V=Ue.Bezier,connectionLineStyle:B,connectionLineComponent:Y,connectionLineContainerStyle:k,deleteKeyCode:L="Backspace",selectionKeyCode:$="Shift",selectionOnDrag:q=!1,selectionMode:H=en.Full,panActivationKeyCode:j="Space",multiSelectionKeyCode:W=Tn()?"Meta":"Control",zoomActivationKeyCode:Z=Tn()?"Meta":"Control",snapToGrid:ne=!1,snapGrid:K=um,onlyRenderVisibleElements:ee=!1,selectNodesOnDrag:le=!0,nodesDraggable:se,nodesConnectable:ye,nodesFocusable:ie,nodeOrigin:U=lm,edgesFocusable:ve,edgesUpdatable:Pe,elementsSelectable:$t,defaultViewport:yt=dm,minZoom:wt=.5,maxZoom:Fe=2,translateExtent:vt=So,preventScrolling:tt=!0,nodeExtent:nt,defaultMarkerColor:bt="#b1b1b7",zoomOnScroll:xt=!0,zoomOnPinch:Pt=!0,panOnScroll:we=!1,panOnScrollSpeed:Te=.5,panOnScrollMode:rt=ut.Free,zoomOnDoubleClick:ot=!0,panOnDrag:Et=!0,onPaneClick:Oe,onPaneMouseEnter:it,onPaneMouseMove:Zn,onPaneMouseLeave:Un,onPaneScroll:Ft,onPaneContextMenu:Kn,children:ei,onEdgeContextMenu:st,onEdgeDoubleClick:Yc,onEdgeMouseEnter:Wc,onEdgeMouseMove:Xc,onEdgeMouseLeave:Zc,onEdgeUpdate:Uc,onEdgeUpdateStart:Kc,onEdgeUpdateEnd:Qc,onReconnect:Jc,onReconnectStart:el,onReconnectEnd:tl,reconnectRadius:nl=10,edgeUpdaterRadius:rl=10,onNodesChange:ol,onEdgesChange:il,noDragClassName:sl="nodrag",noWheelClassName:al="nowheel",noPanClassName:ti="nopan",fitView:cl=!1,fitViewOptions:ll,connectOnClick:ul=!0,attributionPosition:dl,proOptions:fl,defaultEdgeOptions:hl,elevateNodesOnSelect:pl=!0,elevateEdgesOnSelect:gl=!1,disableKeyboardA11y:ni=!1,autoPanOnConnect:ml=!0,autoPanOnNodeDrag:yl=!0,connectionRadius:wl=20,isValidConnection:vl,onError:bl,style:xl,id:ri,nodeDragThreshold:El,..._l},Cl)=>{const Qn=ri||"1";return F.createElement("div",{..._l,style:{...xl,...fm},ref:Cl,className:me(["react-flow",o]),"data-testid":"rf__wrapper",id:ri},F.createElement(Ic,null,F.createElement(im,{onInit:u,onMove:c,onMoveStart:d,onMoveEnd:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:x,onNodeMouseLeave:b,onNodeContextMenu:S,onNodeDoubleClick:C,nodeTypes:s,edgeTypes:i,connectionLineType:V,connectionLineStyle:B,connectionLineComponent:Y,connectionLineContainerStyle:k,selectionKeyCode:$,selectionOnDrag:q,selectionMode:H,deleteKeyCode:L,multiSelectionKeyCode:W,panActivationKeyCode:j,zoomActivationKeyCode:Z,onlyRenderVisibleElements:ee,selectNodesOnDrag:le,defaultViewport:yt,translateExtent:vt,minZoom:wt,maxZoom:Fe,preventScrolling:tt,zoomOnScroll:xt,zoomOnPinch:Pt,zoomOnDoubleClick:ot,panOnScroll:we,panOnScrollSpeed:Te,panOnScrollMode:rt,panOnDrag:Et,onPaneClick:Oe,onPaneMouseEnter:it,onPaneMouseMove:Zn,onPaneMouseLeave:Un,onPaneScroll:Ft,onPaneContextMenu:Kn,onSelectionContextMenu:I,onSelectionStart:z,onSelectionEnd:G,onEdgeContextMenu:st,onEdgeDoubleClick:Yc,onEdgeMouseEnter:Wc,onEdgeMouseMove:Xc,onEdgeMouseLeave:Zc,onReconnect:Jc??Uc,onReconnectStart:el??Kc,onReconnectEnd:tl??Qc,reconnectRadius:nl??rl,defaultMarkerColor:bt,noDragClassName:sl,noWheelClassName:al,noPanClassName:ti,elevateEdgesOnSelect:gl,rfId:Qn,disableKeyboardA11y:ni,nodeOrigin:U,nodeExtent:nt}),F.createElement(ng,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:v,onClickConnectStart:p,onClickConnectEnd:m,nodesDraggable:se,nodesConnectable:ye,nodesFocusable:ie,edgesFocusable:ve,edgesUpdatable:Pe,elementsSelectable:$t,elevateNodesOnSelect:pl,minZoom:wt,maxZoom:Fe,nodeExtent:nt,onNodesChange:ol,onEdgesChange:il,snapToGrid:ne,snapGrid:K,connectionMode:R,translateExtent:vt,connectOnClick:ul,defaultEdgeOptions:hl,fitView:cl,fitViewOptions:ll,onNodesDelete:N,onEdgesDelete:M,onNodeDragStart:D,onNodeDrag:E,onNodeDragStop:_,onSelectionDrag:y,onSelectionDragStart:P,onSelectionDragStop:T,noPanClassName:ti,nodeOrigin:U,rfId:Qn,autoPanOnConnect:ml,autoPanOnNodeDrag:yl,onError:bl,connectionRadius:wl,isValidConnection:vl,nodeDragThreshold:El}),F.createElement(eg,{onSelectionChange:A}),ei,F.createElement(kp,{proOptions:fl,position:dl}),F.createElement(ag,{rfId:Qn,disableKeyboardA11y:ni})))});Lc.displayName="ReactFlow";function Ac(e){return t=>{const[n,r]=re(t),o=de(s=>r(i=>e(s,i)),[]);return[n,r,o]}}const hm=Ac(mc),pm=Ac(xg),Tc=({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:l,className:u,borderRadius:c,shapeRendering:d,onClick:f,selected:h})=>{const{background:g,backgroundColor:v}=s||{},p=i||g||v;return F.createElement("rect",{className:me(["react-flow__minimap-node",{selected:h},u]),x:t,y:n,rx:c,ry:c,width:r,height:o,fill:p,stroke:a,strokeWidth:l,shapeRendering:d,onClick:f?m=>f(m,e):void 0})};Tc.displayName="MiniMapNode";var gm=ae(Tc);const mm=e=>e.nodeOrigin,ym=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),hr=e=>e instanceof Function?e:()=>e;function wm({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o=2,nodeComponent:s=gm,onClick:i}){const a=ce(ym,pe),l=ce(mm),u=hr(t),c=hr(e),d=hr(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return F.createElement(F.Fragment,null,a.map(h=>{const{x:g,y:v}=ht(h,l).positionAbsolute;return F.createElement(s,{key:h.id,x:g,y:v,width:h.width,height:h.height,style:h.style,selected:h.selected,className:d(h),color:u(h),borderRadius:r,strokeColor:c(h),strokeWidth:o,shapeRendering:f,onClick:i,id:h.id})}))}var vm=ae(wm);const bm=200,xm=150,Em=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Lp(Wn(t,e.nodeOrigin),n):n,rfId:e.rfId}},_m="react-flow__minimap-desc";function Oc({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i=2,nodeComponent:a,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:c=1,position:d="bottom-right",onClick:f,onNodeClick:h,pannable:g=!1,zoomable:v=!1,ariaLabel:p="React Flow mini map",inversePan:m=!1,zoomStep:w=10,offsetScale:x=5}){const b=he(),S=Q(null),{boundingRect:C,viewBB:D,rfId:E}=ce(Em,pe),_=e?.width??bm,N=e?.height??xm,M=C.width/_,A=C.height/N,P=Math.max(M,A),y=P*_,T=P*N,I=x*P,z=C.x-(y-C.width)/2-I,G=C.y-(T-C.height)/2-I,R=y+I*2,V=T+I*2,B=`${_m}-${E}`,Y=Q(0);Y.current=P,oe(()=>{if(S.current){const $=Ce(S.current),q=W=>{const{transform:Z,d3Selection:ne,d3Zoom:K}=b.getState();if(W.sourceEvent.type!=="wheel"||!ne||!K)return;const ee=-W.sourceEvent.deltaY*(W.sourceEvent.deltaMode===1?.05:W.sourceEvent.deltaMode?1:.002)*w,le=Z[2]*Math.pow(2,ee);K.scaleTo(ne,le)},H=W=>{const{transform:Z,d3Selection:ne,d3Zoom:K,translateExtent:ee,width:le,height:se}=b.getState();if(W.sourceEvent.type!=="mousemove"||!ne||!K)return;const ye=Y.current*Math.max(1,Z[2])*(m?-1:1),ie={x:Z[0]-W.sourceEvent.movementX*ye,y:Z[1]-W.sourceEvent.movementY*ye},U=[[0,0],[le,se]],ve=qe.translate(ie.x,ie.y).scale(Z[2]),Pe=K.constrain()(ve,U,ee);K.transform(ne,Pe)},j=za().on("zoom",g?H:null).on("zoom.wheel",v?q:null);return $.call(j),()=>{$.on("zoom",null)}}},[g,v,m,w]);const k=f?$=>{const q=ke($);f($,{x:q[0],y:q[1]})}:void 0,L=h?($,q)=>{const H=b.getState().nodeInternals.get(q);h($,H)}:void 0;return F.createElement(Fo,{position:d,style:e,className:me(["react-flow__minimap",t]),"data-testid":"rf__minimap"},F.createElement("svg",{width:_,height:N,viewBox:`${z} ${G} ${R} ${V}`,role:"img","aria-labelledby":B,ref:S,onClick:k},p&&F.createElement("title",{id:B},p),F.createElement(vm,{onClick:L,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),F.createElement("path",{className:"react-flow__minimap-mask",d:`M${z-I},${G-I}h${R+I*2}v${V+I*2}h${-R-I*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fill:l,fillRule:"evenodd",stroke:u,strokeWidth:c,pointerEvents:"none"})))}Oc.displayName="MiniMap";var Cm=ae(Oc);function Sm(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},F.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Nm(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},F.createElement("path",{d:"M0 0h32v4.2H0z"}))}function km(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},F.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Mm(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},F.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Im(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},F.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Yt=({children:e,className:t,...n})=>F.createElement("button",{type:"button",className:me(["react-flow__controls-button",t]),...n},e);Yt.displayName="ControlButton";const Lm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Rc=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:u,children:c,position:d="bottom-left"})=>{const f=he(),[h,g]=re(!1),{isInteractive:v,minZoomReached:p,maxZoomReached:m}=ce(Lm,pe),{zoomIn:w,zoomOut:x,fitView:b}=Xo();if(oe(()=>{g(!0)},[]),!h)return null;const S=()=>{w(),s?.()},C=()=>{x(),i?.()},D=()=>{b(o),a?.()},E=()=>{f.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),l?.(!v)};return F.createElement(Fo,{className:me(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&F.createElement(F.Fragment,null,F.createElement(Yt,{onClick:S,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:m},F.createElement(Sm,null)),F.createElement(Yt,{onClick:C,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:p},F.createElement(Nm,null))),n&&F.createElement(Yt,{className:"react-flow__controls-fitview",onClick:D,title:"fit view","aria-label":"fit view"},F.createElement(km,null)),r&&F.createElement(Yt,{className:"react-flow__controls-interactive",onClick:E,title:"toggle interactivity","aria-label":"toggle interactivity"},v?F.createElement(Im,null):F.createElement(Mm,null)),c)};Rc.displayName="Controls";var Am=ae(Rc),Ie;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ie||(Ie={}));function Tm({color:e,dimensions:t,lineWidth:n}){return F.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Om({color:e,radius:t}){return F.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Rm={[Ie.Dots]:"#91919a",[Ie.Lines]:"#eee",[Ie.Cross]:"#e2e2e2"},Dm={[Ie.Dots]:1,[Ie.Lines]:1,[Ie.Cross]:6},$m=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Dc({id:e,variant:t=Ie.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=2,color:i,style:a,className:l}){const u=Q(null),{transform:c,patternId:d}=ce($m,pe),f=i||Rm[t],h=r||Dm[t],g=t===Ie.Dots,v=t===Ie.Cross,p=Array.isArray(n)?n:[n,n],m=[p[0]*c[2]||1,p[1]*c[2]||1],w=h*c[2],x=v?[w,w]:m,b=g?[w/s,w/s]:[x[0]/s,x[1]/s];return F.createElement("svg",{className:me(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},F.createElement("pattern",{id:d+e,x:c[0]%m[0],y:c[1]%m[1],width:m[0],height:m[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${b[0]},-${b[1]})`},g?F.createElement(Om,{color:f,radius:w/s}):F.createElement(Tm,{dimensions:x,color:f,lineWidth:o})),F.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}Dc.displayName="Background";var Pm=ae(Dc);function Fm(e,t){const n=Q(!1);oe(()=>{if(n.current)return e();n.current=!0},t)}var pr,rs;function Uo(){if(rs)return pr;rs=1;var e="\0",t="\0",n="";class r{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(c){c&&(this._isDirected=Object.hasOwn(c,"directed")?c.directed:!0,this._isMultigraph=Object.hasOwn(c,"multigraph")?c.multigraph:!1,this._isCompound=Object.hasOwn(c,"compound")?c.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[t]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(c){return this._label=c,this}graph(){return this._label}setDefaultNodeLabel(c){return this._defaultNodeLabelFn=c,typeof c!="function"&&(this._defaultNodeLabelFn=()=>c),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var c=this;return this.nodes().filter(d=>Object.keys(c._in[d]).length===0)}sinks(){var c=this;return this.nodes().filter(d=>Object.keys(c._out[d]).length===0)}setNodes(c,d){var f=arguments,h=this;return c.forEach(function(g){f.length>1?h.setNode(g,d):h.setNode(g)}),this}setNode(c,d){return Object.hasOwn(this._nodes,c)?(arguments.length>1&&(this._nodes[c]=d),this):(this._nodes[c]=arguments.length>1?d:this._defaultNodeLabelFn(c),this._isCompound&&(this._parent[c]=t,this._children[c]={},this._children[t][c]=!0),this._in[c]={},this._preds[c]={},this._out[c]={},this._sucs[c]={},++this._nodeCount,this)}node(c){return this._nodes[c]}hasNode(c){return Object.hasOwn(this._nodes,c)}removeNode(c){var d=this;if(Object.hasOwn(this._nodes,c)){var f=h=>d.removeEdge(d._edgeObjs[h]);delete this._nodes[c],this._isCompound&&(this._removeFromParentsChildList(c),delete this._parent[c],this.children(c).forEach(function(h){d.setParent(h)}),delete this._children[c]),Object.keys(this._in[c]).forEach(f),delete this._in[c],delete this._preds[c],Object.keys(this._out[c]).forEach(f),delete this._out[c],delete this._sucs[c],--this._nodeCount}return this}setParent(c,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(d===void 0)d=t;else{d+="";for(var f=d;f!==void 0;f=this.parent(f))if(f===c)throw new Error("Setting "+d+" as parent of "+c+" would create a cycle");this.setNode(d)}return this.setNode(c),this._removeFromParentsChildList(c),this._parent[c]=d,this._children[d][c]=!0,this}_removeFromParentsChildList(c){delete this._children[this._parent[c]][c]}parent(c){if(this._isCompound){var d=this._parent[c];if(d!==t)return d}}children(c=t){if(this._isCompound){var d=this._children[c];if(d)return Object.keys(d)}else{if(c===t)return this.nodes();if(this.hasNode(c))return[]}}predecessors(c){var d=this._preds[c];if(d)return Object.keys(d)}successors(c){var d=this._sucs[c];if(d)return Object.keys(d)}neighbors(c){var d=this.predecessors(c);if(d){const h=new Set(d);for(var f of this.successors(c))h.add(f);return Array.from(h.values())}}isLeaf(c){var d;return this.isDirected()?d=this.successors(c):d=this.neighbors(c),d.length===0}filterNodes(c){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([v,p]){c(v)&&d.setNode(v,p)}),Object.values(this._edgeObjs).forEach(function(v){d.hasNode(v.v)&&d.hasNode(v.w)&&d.setEdge(v,f.edge(v))});var h={};function g(v){var p=f.parent(v);return p===void 0||d.hasNode(p)?(h[v]=p,p):p in h?h[p]:g(p)}return this._isCompound&&d.nodes().forEach(v=>d.setParent(v,g(v))),d}setDefaultEdgeLabel(c){return this._defaultEdgeLabelFn=c,typeof c!="function"&&(this._defaultEdgeLabelFn=()=>c),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(c,d){var f=this,h=arguments;return c.reduce(function(g,v){return h.length>1?f.setEdge(g,v,d):f.setEdge(g,v),v}),this}setEdge(){var c,d,f,h,g=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(c=v.v,d=v.w,f=v.name,arguments.length===2&&(h=arguments[1],g=!0)):(c=v,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],g=!0)),c=""+c,d=""+d,f!==void 0&&(f=""+f);var p=i(this._isDirected,c,d,f);if(Object.hasOwn(this._edgeLabels,p))return g&&(this._edgeLabels[p]=h),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(d),this._edgeLabels[p]=g?h:this._defaultEdgeLabelFn(c,d,f);var m=a(this._isDirected,c,d,f);return c=m.v,d=m.w,Object.freeze(m),this._edgeObjs[p]=m,o(this._preds[d],c),o(this._sucs[c],d),this._in[d][p]=m,this._out[c][p]=m,this._edgeCount++,this}edge(c,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):i(this._isDirected,c,d,f);return this._edgeLabels[h]}edgeAsObj(){const c=this.edge(...arguments);return typeof c!="object"?{label:c}:c}hasEdge(c,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):i(this._isDirected,c,d,f);return Object.hasOwn(this._edgeLabels,h)}removeEdge(c,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):i(this._isDirected,c,d,f),g=this._edgeObjs[h];return g&&(c=g.v,d=g.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[d],c),s(this._sucs[c],d),delete this._in[d][h],delete this._out[c][h],this._edgeCount--),this}inEdges(c,d){var f=this._in[c];if(f){var h=Object.values(f);return d?h.filter(g=>g.v===d):h}}outEdges(c,d){var f=this._out[c];if(f){var h=Object.values(f);return d?h.filter(g=>g.w===d):h}}nodeEdges(c,d){var f=this.inEdges(c,d);if(f)return f.concat(this.outEdges(c,d))}}function o(u,c){u[c]?u[c]++:u[c]=1}function s(u,c){--u[c]||delete u[c]}function i(u,c,d,f){var h=""+c,g=""+d;if(!u&&h>g){var v=h;h=g,g=v}return h+n+g+n+(f===void 0?e:f)}function a(u,c,d,f){var h=""+c,g=""+d;if(!u&&h>g){var v=h;h=g,g=v}var p={v:h,w:g};return f&&(p.name=f),p}function l(u,c){return i(u,c.v,c.w,c.name)}return pr=r,pr}var gr,os;function zm(){return os||(os=1,gr="2.2.4"),gr}var mr,is;function Hm(){return is||(is=1,mr={Graph:Uo(),version:zm()}),mr}var yr,ss;function Vm(){if(ss)return yr;ss=1;var e=Uo();yr={write:t,read:o};function t(s){var i={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:r(s)};return s.graph()!==void 0&&(i.value=structuredClone(s.graph())),i}function n(s){return s.nodes().map(function(i){var a=s.node(i),l=s.parent(i),u={v:i};return a!==void 0&&(u.value=a),l!==void 0&&(u.parent=l),u})}function r(s){return s.edges().map(function(i){var a=s.edge(i),l={v:i.v,w:i.w};return i.name!==void 0&&(l.name=i.name),a!==void 0&&(l.value=a),l})}function o(s){var i=new e(s.options).setGraph(s.value);return s.nodes.forEach(function(a){i.setNode(a.v,a.value),a.parent&&i.setParent(a.v,a.parent)}),s.edges.forEach(function(a){i.setEdge({v:a.v,w:a.w,name:a.name},a.value)}),i}return yr}var wr,as;function qm(){if(as)return wr;as=1,wr=e;function e(t){var n={},r=[],o;function s(i){Object.hasOwn(n,i)||(n[i]=!0,o.push(i),t.successors(i).forEach(s),t.predecessors(i).forEach(s))}return t.nodes().forEach(function(i){o=[],s(i),o.length&&r.push(o)}),r}return wr}var vr,cs;function $c(){if(cs)return vr;cs=1;class e{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(n){return n.key})}has(n){return Object.hasOwn(this._keyIndices,n)}priority(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(n,r){var o=this._keyIndices;if(n=String(n),!Object.hasOwn(o,n)){var s=this._arr,i=s.length;return o[n]=i,s.push({key:n,priority:r}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key}decrease(n,r){var o=this._keyIndices[n];if(r>this._arr[o].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[o].priority+" New: "+r);this._arr[o].priority=r,this._decrease(o)}_heapify(n){var r=this._arr,o=2*n,s=o+1,i=n;o<r.length&&(i=r[o].priority<r[i].priority?o:i,s<r.length&&(i=r[s].priority<r[i].priority?s:i),i!==n&&(this._swap(n,i),this._heapify(i)))}_decrease(n){for(var r=this._arr,o=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<o));)this._swap(n,s),n=s}_swap(n,r){var o=this._arr,s=this._keyIndices,i=o[n],a=o[r];o[n]=a,o[r]=i,s[a.key]=n,s[i.key]=r}}return vr=e,vr}var br,ls;function Pc(){if(ls)return br;ls=1;var e=$c();br=n;var t=()=>1;function n(o,s,i,a){return r(o,String(s),i||t,a||function(l){return o.outEdges(l)})}function r(o,s,i,a){var l={},u=new e,c,d,f=function(h){var g=h.v!==c?h.v:h.w,v=l[g],p=i(h),m=d.distance+p;if(p<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+h+" Weight: "+p);m<v.distance&&(v.distance=m,v.predecessor=c,u.decrease(g,m))};for(o.nodes().forEach(function(h){var g=h===s?0:Number.POSITIVE_INFINITY;l[h]={distance:g},u.add(h,g)});u.size()>0&&(c=u.removeMin(),d=l[c],d.distance!==Number.POSITIVE_INFINITY);)a(c).forEach(f);return l}return br}var xr,us;function Bm(){if(us)return xr;us=1;var e=Pc();xr=t;function t(n,r,o){return n.nodes().reduce(function(s,i){return s[i]=e(n,i,r,o),s},{})}return xr}var Er,ds;function Fc(){if(ds)return Er;ds=1,Er=e;function e(t){var n=0,r=[],o={},s=[];function i(a){var l=o[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),t.successors(a).forEach(function(d){Object.hasOwn(o,d)?o[d].onStack&&(l.lowlink=Math.min(l.lowlink,o[d].index)):(i(d),l.lowlink=Math.min(l.lowlink,o[d].lowlink))}),l.lowlink===l.index){var u=[],c;do c=r.pop(),o[c].onStack=!1,u.push(c);while(a!==c);s.push(u)}}return t.nodes().forEach(function(a){Object.hasOwn(o,a)||i(a)}),s}return Er}var _r,fs;function Gm(){if(fs)return _r;fs=1;var e=Fc();_r=t;function t(n){return e(n).filter(function(r){return r.length>1||r.length===1&&n.hasEdge(r[0],r[0])})}return _r}var Cr,hs;function jm(){if(hs)return Cr;hs=1,Cr=t;var e=()=>1;function t(r,o,s){return n(r,o||e,s||function(i){return r.outEdges(i)})}function n(r,o,s){var i={},a=r.nodes();return a.forEach(function(l){i[l]={},i[l][l]={distance:0},a.forEach(function(u){l!==u&&(i[l][u]={distance:Number.POSITIVE_INFINITY})}),s(l).forEach(function(u){var c=u.v===l?u.w:u.v,d=o(u);i[l][c]={distance:d,predecessor:l}})}),a.forEach(function(l){var u=i[l];a.forEach(function(c){var d=i[c];a.forEach(function(f){var h=d[l],g=u[f],v=d[f],p=h.distance+g.distance;p<v.distance&&(v.distance=p,v.predecessor=g.predecessor)})})}),i}return Cr}var Sr,ps;function zc(){if(ps)return Sr;ps=1;function e(n){var r={},o={},s=[];function i(a){if(Object.hasOwn(o,a))throw new t;Object.hasOwn(r,a)||(o[a]=!0,r[a]=!0,n.predecessors(a).forEach(i),delete o[a],s.push(a))}if(n.sinks().forEach(i),Object.keys(r).length!==n.nodeCount())throw new t;return s}class t extends Error{constructor(){super(...arguments)}}return Sr=e,e.CycleException=t,Sr}var Nr,gs;function Ym(){if(gs)return Nr;gs=1;var e=zc();Nr=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Nr}var kr,ms;function Hc(){if(ms)return kr;ms=1,kr=e;function e(o,s,i){Array.isArray(s)||(s=[s]);var a=o.isDirected()?d=>o.successors(d):d=>o.neighbors(d),l=i==="post"?t:n,u=[],c={};return s.forEach(d=>{if(!o.hasNode(d))throw new Error("Graph does not have node: "+d);l(d,a,c,u)}),u}function t(o,s,i,a){for(var l=[[o,!1]];l.length>0;){var u=l.pop();u[1]?a.push(u[0]):Object.hasOwn(i,u[0])||(i[u[0]]=!0,l.push([u[0],!0]),r(s(u[0]),c=>l.push([c,!1])))}}function n(o,s,i,a){for(var l=[o];l.length>0;){var u=l.pop();Object.hasOwn(i,u)||(i[u]=!0,a.push(u),r(s(u),c=>l.push(c)))}}function r(o,s){for(var i=o.length;i--;)s(o[i],i,o);return o}return kr}var Mr,ys;function Wm(){if(ys)return Mr;ys=1;var e=Hc();Mr=t;function t(n,r){return e(n,r,"post")}return Mr}var Ir,ws;function Xm(){if(ws)return Ir;ws=1;var e=Hc();Ir=t;function t(n,r){return e(n,r,"pre")}return Ir}var Lr,vs;function Zm(){if(vs)return Lr;vs=1;var e=Uo(),t=$c();Lr=n;function n(r,o){var s=new e,i={},a=new t,l;function u(d){var f=d.v===l?d.w:d.v,h=a.priority(f);if(h!==void 0){var g=o(d);g<h&&(i[f]=l,a.decrease(f,g))}}if(r.nodeCount()===0)return s;r.nodes().forEach(function(d){a.add(d,Number.POSITIVE_INFINITY),s.setNode(d)}),a.decrease(r.nodes()[0],0);for(var c=!1;a.size()>0;){if(l=a.removeMin(),Object.hasOwn(i,l))s.setEdge(l,i[l]);else{if(c)throw new Error("Input graph is not connected: "+r);c=!0}r.nodeEdges(l).forEach(u)}return s}return Lr}var Ar,bs;function Um(){return bs||(bs=1,Ar={components:qm(),dijkstra:Pc(),dijkstraAll:Bm(),findCycles:Gm(),floydWarshall:jm(),isAcyclic:Ym(),postorder:Wm(),preorder:Xm(),prim:Zm(),tarjan:Fc(),topsort:zc()}),Ar}var Tr,xs;function Le(){if(xs)return Tr;xs=1;var e=Hm();return Tr={Graph:e.Graph,json:Vm(),alg:Um(),version:e.version},Tr}var Or,Es;function Km(){if(Es)return Or;Es=1;class e{constructor(){let o={};o._next=o._prev=o,this._sentinel=o}dequeue(){let o=this._sentinel,s=o._prev;if(s!==o)return t(s),s}enqueue(o){let s=this._sentinel;o._prev&&o._next&&t(o),o._next=s._next,s._next._prev=o,s._next=o,o._prev=s}toString(){let o=[],s=this._sentinel,i=s._prev;for(;i!==s;)o.push(JSON.stringify(i,n)),i=i._prev;return"["+o.join(", ")+"]"}}function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function n(r,o){if(r!=="_next"&&r!=="_prev")return o}return Or=e,Or}var Rr,_s;function Qm(){if(_s)return Rr;_s=1;let e=Le().Graph,t=Km();Rr=r;let n=()=>1;function r(u,c){if(u.nodeCount()<=1)return[];let d=i(u,c||n);return o(d.graph,d.buckets,d.zeroIdx).flatMap(h=>u.outEdges(h.v,h.w))}function o(u,c,d){let f=[],h=c[c.length-1],g=c[0],v;for(;u.nodeCount();){for(;v=g.dequeue();)s(u,c,d,v);for(;v=h.dequeue();)s(u,c,d,v);if(u.nodeCount()){for(let p=c.length-2;p>0;--p)if(v=c[p].dequeue(),v){f=f.concat(s(u,c,d,v,!0));break}}}return f}function s(u,c,d,f,h){let g=h?[]:void 0;return u.inEdges(f.v).forEach(v=>{let p=u.edge(v),m=u.node(v.v);h&&g.push({v:v.v,w:v.w}),m.out-=p,a(c,d,m)}),u.outEdges(f.v).forEach(v=>{let p=u.edge(v),m=v.w,w=u.node(m);w.in-=p,a(c,d,w)}),u.removeNode(f.v),g}function i(u,c){let d=new e,f=0,h=0;u.nodes().forEach(p=>{d.setNode(p,{v:p,in:0,out:0})}),u.edges().forEach(p=>{let m=d.edge(p.v,p.w)||0,w=c(p),x=m+w;d.setEdge(p.v,p.w,x),h=Math.max(h,d.node(p.v).out+=w),f=Math.max(f,d.node(p.w).in+=w)});let g=l(h+f+3).map(()=>new t),v=f+1;return d.nodes().forEach(p=>{a(g,v,d.node(p))}),{graph:d,buckets:g,zeroIdx:v}}function a(u,c,d){d.out?d.in?u[d.out-d.in+c].enqueue(d):u[u.length-1].enqueue(d):u[0].enqueue(d)}function l(u){const c=[];for(let d=0;d<u;d++)c.push(d);return c}return Rr}var Dr,Cs;function fe(){if(Cs)return Dr;Cs=1;let e=Le().Graph;Dr={addBorderNode:c,addDummyNode:t,applyWithChunking:h,asNonCompoundGraph:r,buildLayerMatrix:a,intersectRect:i,mapValues:C,maxRank:g,normalizeRanks:l,notime:m,partition:v,pick:S,predecessorWeights:s,range:b,removeEmptyRanks:u,simplify:n,successorWeights:o,time:p,uniqueId:x,zipObject:D};function t(E,_,N,M){let A;do A=x(M);while(E.hasNode(A));return N.dummy=_,E.setNode(A,N),A}function n(E){let _=new e().setGraph(E.graph());return E.nodes().forEach(N=>_.setNode(N,E.node(N))),E.edges().forEach(N=>{let M=_.edge(N.v,N.w)||{weight:0,minlen:1},A=E.edge(N);_.setEdge(N.v,N.w,{weight:M.weight+A.weight,minlen:Math.max(M.minlen,A.minlen)})}),_}function r(E){let _=new e({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(N=>{E.children(N).length||_.setNode(N,E.node(N))}),E.edges().forEach(N=>{_.setEdge(N,E.edge(N))}),_}function o(E){let _=E.nodes().map(N=>{let M={};return E.outEdges(N).forEach(A=>{M[A.w]=(M[A.w]||0)+E.edge(A).weight}),M});return D(E.nodes(),_)}function s(E){let _=E.nodes().map(N=>{let M={};return E.inEdges(N).forEach(A=>{M[A.v]=(M[A.v]||0)+E.edge(A).weight}),M});return D(E.nodes(),_)}function i(E,_){let N=E.x,M=E.y,A=_.x-N,P=_.y-M,y=E.width/2,T=E.height/2;if(!A&&!P)throw new Error("Not possible to find intersection inside of the rectangle");let I,z;return Math.abs(P)*y>Math.abs(A)*T?(P<0&&(T=-T),I=T*A/P,z=T):(A<0&&(y=-y),I=y,z=y*P/A),{x:N+I,y:M+z}}function a(E){let _=b(g(E)+1).map(()=>[]);return E.nodes().forEach(N=>{let M=E.node(N),A=M.rank;A!==void 0&&(_[A][M.order]=N)}),_}function l(E){let _=E.nodes().map(M=>{let A=E.node(M).rank;return A===void 0?Number.MAX_VALUE:A}),N=h(Math.min,_);E.nodes().forEach(M=>{let A=E.node(M);Object.hasOwn(A,"rank")&&(A.rank-=N)})}function u(E){let _=E.nodes().map(y=>E.node(y).rank),N=h(Math.min,_),M=[];E.nodes().forEach(y=>{let T=E.node(y).rank-N;M[T]||(M[T]=[]),M[T].push(y)});let A=0,P=E.graph().nodeRankFactor;Array.from(M).forEach((y,T)=>{y===void 0&&T%P!==0?--A:y!==void 0&&A&&y.forEach(I=>E.node(I).rank+=A)})}function c(E,_,N,M){let A={width:0,height:0};return arguments.length>=4&&(A.rank=N,A.order=M),t(E,"border",A,_)}function d(E,_=f){const N=[];for(let M=0;M<E.length;M+=_){const A=E.slice(M,M+_);N.push(A)}return N}const f=65535;function h(E,_){if(_.length>f){const N=d(_);return E.apply(null,N.map(M=>E.apply(null,M)))}else return E.apply(null,_)}function g(E){const N=E.nodes().map(M=>{let A=E.node(M).rank;return A===void 0?Number.MIN_VALUE:A});return h(Math.max,N)}function v(E,_){let N={lhs:[],rhs:[]};return E.forEach(M=>{_(M)?N.lhs.push(M):N.rhs.push(M)}),N}function p(E,_){let N=Date.now();try{return _()}finally{console.log(E+" time: "+(Date.now()-N)+"ms")}}function m(E,_){return _()}let w=0;function x(E){var _=++w;return toString(E)+_}function b(E,_,N=1){_==null&&(_=E,E=0);let M=P=>P<_;N<0&&(M=P=>_<P);const A=[];for(let P=E;M(P);P+=N)A.push(P);return A}function S(E,_){const N={};for(const M of _)E[M]!==void 0&&(N[M]=E[M]);return N}function C(E,_){let N=_;return typeof _=="string"&&(N=M=>M[_]),Object.entries(E).reduce((M,[A,P])=>(M[A]=N(P,A),M),{})}function D(E,_){return E.reduce((N,M,A)=>(N[M]=_[A],N),{})}return Dr}var $r,Ss;function Jm(){if(Ss)return $r;Ss=1;let e=Qm(),t=fe().uniqueId;$r={run:n,undo:o};function n(s){(s.graph().acyclicer==="greedy"?e(s,a(s)):r(s)).forEach(l=>{let u=s.edge(l);s.removeEdge(l),u.forwardName=l.name,u.reversed=!0,s.setEdge(l.w,l.v,u,t("rev"))});function a(l){return u=>l.edge(u).weight}}function r(s){let i=[],a={},l={};function u(c){Object.hasOwn(l,c)||(l[c]=!0,a[c]=!0,s.outEdges(c).forEach(d=>{Object.hasOwn(a,d.w)?i.push(d):u(d.w)}),delete a[c])}return s.nodes().forEach(u),i}function o(s){s.edges().forEach(i=>{let a=s.edge(i);if(a.reversed){s.removeEdge(i);let l=a.forwardName;delete a.reversed,delete a.forwardName,s.setEdge(i.w,i.v,a,l)}})}return $r}var Pr,Ns;function e0(){if(Ns)return Pr;Ns=1;let e=fe();Pr={run:t,undo:r};function t(o){o.graph().dummyChains=[],o.edges().forEach(s=>n(o,s))}function n(o,s){let i=s.v,a=o.node(i).rank,l=s.w,u=o.node(l).rank,c=s.name,d=o.edge(s),f=d.labelRank;if(u===a+1)return;o.removeEdge(s);let h,g,v;for(v=0,++a;a<u;++v,++a)d.points=[],g={width:0,height:0,edgeLabel:d,edgeObj:s,rank:a},h=e.addDummyNode(o,"edge",g,"_d"),a===f&&(g.width=d.width,g.height=d.height,g.dummy="edge-label",g.labelpos=d.labelpos),o.setEdge(i,h,{weight:d.weight},c),v===0&&o.graph().dummyChains.push(h),i=h;o.setEdge(i,l,{weight:d.weight},c)}function r(o){o.graph().dummyChains.forEach(s=>{let i=o.node(s),a=i.edgeLabel,l;for(o.setEdge(i.edgeObj,a);i.dummy;)l=o.successors(s)[0],o.removeNode(s),a.points.push({x:i.x,y:i.y}),i.dummy==="edge-label"&&(a.x=i.x,a.y=i.y,a.width=i.width,a.height=i.height),s=l,i=o.node(s)})}return Pr}var Fr,ks;function Dn(){if(ks)return Fr;ks=1;const{applyWithChunking:e}=fe();Fr={longestPath:t,slack:n};function t(r){var o={};function s(i){var a=r.node(i);if(Object.hasOwn(o,i))return a.rank;o[i]=!0;let l=r.outEdges(i).map(c=>c==null?Number.POSITIVE_INFINITY:s(c.w)-r.edge(c).minlen);var u=e(Math.min,l);return u===Number.POSITIVE_INFINITY&&(u=0),a.rank=u}r.sources().forEach(s)}function n(r,o){return r.node(o.w).rank-r.node(o.v).rank-r.edge(o).minlen}return Fr}var zr,Ms;function Vc(){if(Ms)return zr;Ms=1;var e=Le().Graph,t=Dn().slack;zr=n;function n(i){var a=new e({directed:!1}),l=i.nodes()[0],u=i.nodeCount();a.setNode(l,{});for(var c,d;r(a,i)<u;)c=o(a,i),d=a.hasNode(c.v)?t(i,c):-t(i,c),s(a,i,d);return a}function r(i,a){function l(u){a.nodeEdges(u).forEach(c=>{var d=c.v,f=u===d?c.w:d;!i.hasNode(f)&&!t(a,c)&&(i.setNode(f,{}),i.setEdge(u,f,{}),l(f))})}return i.nodes().forEach(l),i.nodeCount()}function o(i,a){return a.edges().reduce((u,c)=>{let d=Number.POSITIVE_INFINITY;return i.hasNode(c.v)!==i.hasNode(c.w)&&(d=t(a,c)),d<u[0]?[d,c]:u},[Number.POSITIVE_INFINITY,null])[1]}function s(i,a,l){i.nodes().forEach(u=>a.node(u).rank+=l)}return zr}var Hr,Is;function t0(){if(Is)return Hr;Is=1;var e=Vc(),t=Dn().slack,n=Dn().longestPath,r=Le().alg.preorder,o=Le().alg.postorder,s=fe().simplify;Hr=i,i.initLowLimValues=c,i.initCutValues=a,i.calcCutValue=u,i.leaveEdge=f,i.enterEdge=h,i.exchangeEdges=g;function i(w){w=s(w),n(w);var x=e(w);c(x),a(x,w);for(var b,S;b=f(x);)S=h(x,w,b),g(x,w,b,S)}function a(w,x){var b=o(w,w.nodes());b=b.slice(0,b.length-1),b.forEach(S=>l(w,x,S))}function l(w,x,b){var S=w.node(b),C=S.parent;w.edge(b,C).cutvalue=u(w,x,b)}function u(w,x,b){var S=w.node(b),C=S.parent,D=!0,E=x.edge(b,C),_=0;return E||(D=!1,E=x.edge(C,b)),_=E.weight,x.nodeEdges(b).forEach(N=>{var M=N.v===b,A=M?N.w:N.v;if(A!==C){var P=M===D,y=x.edge(N).weight;if(_+=P?y:-y,p(w,b,A)){var T=w.edge(b,A).cutvalue;_+=P?-T:T}}}),_}function c(w,x){arguments.length<2&&(x=w.nodes()[0]),d(w,{},1,x)}function d(w,x,b,S,C){var D=b,E=w.node(S);return x[S]=!0,w.neighbors(S).forEach(_=>{Object.hasOwn(x,_)||(b=d(w,x,b,_,S))}),E.low=D,E.lim=b++,C?E.parent=C:delete E.parent,b}function f(w){return w.edges().find(x=>w.edge(x).cutvalue<0)}function h(w,x,b){var S=b.v,C=b.w;x.hasEdge(S,C)||(S=b.w,C=b.v);var D=w.node(S),E=w.node(C),_=D,N=!1;D.lim>E.lim&&(_=E,N=!0);var M=x.edges().filter(A=>N===m(w,w.node(A.v),_)&&N!==m(w,w.node(A.w),_));return M.reduce((A,P)=>t(x,P)<t(x,A)?P:A)}function g(w,x,b,S){var C=b.v,D=b.w;w.removeEdge(C,D),w.setEdge(S.v,S.w,{}),c(w),a(w,x),v(w,x)}function v(w,x){var b=w.nodes().find(C=>!x.node(C).parent),S=r(w,b);S=S.slice(1),S.forEach(C=>{var D=w.node(C).parent,E=x.edge(C,D),_=!1;E||(E=x.edge(D,C),_=!0),x.node(C).rank=x.node(D).rank+(_?E.minlen:-E.minlen)})}function p(w,x,b){return w.hasEdge(x,b)}function m(w,x,b){return b.low<=x.lim&&x.lim<=b.lim}return Hr}var Vr,Ls;function n0(){if(Ls)return Vr;Ls=1;var e=Dn(),t=e.longestPath,n=Vc(),r=t0();Vr=o;function o(l){switch(l.graph().ranker){case"network-simplex":a(l);break;case"tight-tree":i(l);break;case"longest-path":s(l);break;default:a(l)}}var s=t;function i(l){t(l),n(l)}function a(l){r(l)}return Vr}var qr,As;function r0(){if(As)return qr;As=1,qr=e;function e(r){let o=n(r);r.graph().dummyChains.forEach(s=>{let i=r.node(s),a=i.edgeObj,l=t(r,o,a.v,a.w),u=l.path,c=l.lca,d=0,f=u[d],h=!0;for(;s!==a.w;){if(i=r.node(s),h){for(;(f=u[d])!==c&&r.node(f).maxRank<i.rank;)d++;f===c&&(h=!1)}if(!h){for(;d<u.length-1&&r.node(f=u[d+1]).minRank<=i.rank;)d++;f=u[d]}r.setParent(s,f),s=r.successors(s)[0]}})}function t(r,o,s,i){let a=[],l=[],u=Math.min(o[s].low,o[i].low),c=Math.max(o[s].lim,o[i].lim),d,f;d=s;do d=r.parent(d),a.push(d);while(d&&(o[d].low>u||c>o[d].lim));for(f=d,d=i;(d=r.parent(d))!==f;)l.push(d);return{path:a.concat(l.reverse()),lca:f}}function n(r){let o={},s=0;function i(a){let l=s;r.children(a).forEach(i),o[a]={low:l,lim:s++}}return r.children().forEach(i),o}return qr}var Br,Ts;function o0(){if(Ts)return Br;Ts=1;let e=fe();Br={run:t,cleanup:s};function t(i){let a=e.addDummyNode(i,"root",{},"_root"),l=r(i),u=Object.values(l),c=e.applyWithChunking(Math.max,u)-1,d=2*c+1;i.graph().nestingRoot=a,i.edges().forEach(h=>i.edge(h).minlen*=d);let f=o(i)+1;i.children().forEach(h=>n(i,a,d,f,c,l,h)),i.graph().nodeRankFactor=d}function n(i,a,l,u,c,d,f){let h=i.children(f);if(!h.length){f!==a&&i.setEdge(a,f,{weight:0,minlen:l});return}let g=e.addBorderNode(i,"_bt"),v=e.addBorderNode(i,"_bb"),p=i.node(f);i.setParent(g,f),p.borderTop=g,i.setParent(v,f),p.borderBottom=v,h.forEach(m=>{n(i,a,l,u,c,d,m);let w=i.node(m),x=w.borderTop?w.borderTop:m,b=w.borderBottom?w.borderBottom:m,S=w.borderTop?u:2*u,C=x!==b?1:c-d[f]+1;i.setEdge(g,x,{weight:S,minlen:C,nestingEdge:!0}),i.setEdge(b,v,{weight:S,minlen:C,nestingEdge:!0})}),i.parent(f)||i.setEdge(a,g,{weight:0,minlen:c+d[f]})}function r(i){var a={};function l(u,c){var d=i.children(u);d&&d.length&&d.forEach(f=>l(f,c+1)),a[u]=c}return i.children().forEach(u=>l(u,1)),a}function o(i){return i.edges().reduce((a,l)=>a+i.edge(l).weight,0)}function s(i){var a=i.graph();i.removeNode(a.nestingRoot),delete a.nestingRoot,i.edges().forEach(l=>{var u=i.edge(l);u.nestingEdge&&i.removeEdge(l)})}return Br}var Gr,Os;function i0(){if(Os)return Gr;Os=1;let e=fe();Gr=t;function t(r){function o(s){let i=r.children(s),a=r.node(s);if(i.length&&i.forEach(o),Object.hasOwn(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(let l=a.minRank,u=a.maxRank+1;l<u;++l)n(r,"borderLeft","_bl",s,a,l),n(r,"borderRight","_br",s,a,l)}}r.children().forEach(o)}function n(r,o,s,i,a,l){let u={width:0,height:0,rank:l,borderType:o},c=a[o][l-1],d=e.addDummyNode(r,"border",u,s);a[o][l]=d,r.setParent(d,i),c&&r.setEdge(c,d,{weight:1})}return Gr}var jr,Rs;function s0(){if(Rs)return jr;Rs=1,jr={adjust:e,undo:t};function e(l){let u=l.graph().rankdir.toLowerCase();(u==="lr"||u==="rl")&&n(l)}function t(l){let u=l.graph().rankdir.toLowerCase();(u==="bt"||u==="rl")&&o(l),(u==="lr"||u==="rl")&&(i(l),n(l))}function n(l){l.nodes().forEach(u=>r(l.node(u))),l.edges().forEach(u=>r(l.edge(u)))}function r(l){let u=l.width;l.width=l.height,l.height=u}function o(l){l.nodes().forEach(u=>s(l.node(u))),l.edges().forEach(u=>{let c=l.edge(u);c.points.forEach(s),Object.hasOwn(c,"y")&&s(c)})}function s(l){l.y=-l.y}function i(l){l.nodes().forEach(u=>a(l.node(u))),l.edges().forEach(u=>{let c=l.edge(u);c.points.forEach(a),Object.hasOwn(c,"x")&&a(c)})}function a(l){let u=l.x;l.x=l.y,l.y=u}return jr}var Yr,Ds;function a0(){if(Ds)return Yr;Ds=1;let e=fe();Yr=t;function t(n){let r={},o=n.nodes().filter(c=>!n.children(c).length),s=o.map(c=>n.node(c).rank),i=e.applyWithChunking(Math.max,s),a=e.range(i+1).map(()=>[]);function l(c){if(r[c])return;r[c]=!0;let d=n.node(c);a[d.rank].push(c),n.successors(c).forEach(l)}return o.sort((c,d)=>n.node(c).rank-n.node(d).rank).forEach(l),a}return Yr}var Wr,$s;function c0(){if($s)return Wr;$s=1;let e=fe().zipObject;Wr=t;function t(r,o){let s=0;for(let i=1;i<o.length;++i)s+=n(r,o[i-1],o[i]);return s}function n(r,o,s){let i=e(s,s.map((f,h)=>h)),a=o.flatMap(f=>r.outEdges(f).map(h=>({pos:i[h.w],weight:r.edge(h).weight})).sort((h,g)=>h.pos-g.pos)),l=1;for(;l<s.length;)l<<=1;let u=2*l-1;l-=1;let c=new Array(u).fill(0),d=0;return a.forEach(f=>{let h=f.pos+l;c[h]+=f.weight;let g=0;for(;h>0;)h%2&&(g+=c[h+1]),h=h-1>>1,c[h]+=f.weight;d+=f.weight*g}),d}return Wr}var Xr,Ps;function l0(){if(Ps)return Xr;Ps=1,Xr=e;function e(t,n=[]){return n.map(r=>{let o=t.inEdges(r);if(o.length){let s=o.reduce((i,a)=>{let l=t.edge(a),u=t.node(a.v);return{sum:i.sum+l.weight*u.order,weight:i.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}return Xr}var Zr,Fs;function u0(){if(Fs)return Zr;Fs=1;let e=fe();Zr=t;function t(o,s){let i={};o.forEach((l,u)=>{let c=i[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:u};l.barycenter!==void 0&&(c.barycenter=l.barycenter,c.weight=l.weight)}),s.edges().forEach(l=>{let u=i[l.v],c=i[l.w];u!==void 0&&c!==void 0&&(c.indegree++,u.out.push(i[l.w]))});let a=Object.values(i).filter(l=>!l.indegree);return n(a)}function n(o){let s=[];function i(l){return u=>{u.merged||(u.barycenter===void 0||l.barycenter===void 0||u.barycenter>=l.barycenter)&&r(l,u)}}function a(l){return u=>{u.in.push(l),--u.indegree===0&&o.push(u)}}for(;o.length;){let l=o.pop();s.push(l),l.in.reverse().forEach(i(l)),l.out.forEach(a(l))}return s.filter(l=>!l.merged).map(l=>e.pick(l,["vs","i","barycenter","weight"]))}function r(o,s){let i=0,a=0;o.weight&&(i+=o.barycenter*o.weight,a+=o.weight),s.weight&&(i+=s.barycenter*s.weight,a+=s.weight),o.vs=s.vs.concat(o.vs),o.barycenter=i/a,o.weight=a,o.i=Math.min(s.i,o.i),s.merged=!0}return Zr}var Ur,zs;function d0(){if(zs)return Ur;zs=1;let e=fe();Ur=t;function t(o,s){let i=e.partition(o,g=>Object.hasOwn(g,"barycenter")),a=i.lhs,l=i.rhs.sort((g,v)=>v.i-g.i),u=[],c=0,d=0,f=0;a.sort(r(!!s)),f=n(u,l,f),a.forEach(g=>{f+=g.vs.length,u.push(g.vs),c+=g.barycenter*g.weight,d+=g.weight,f=n(u,l,f)});let h={vs:u.flat(!0)};return d&&(h.barycenter=c/d,h.weight=d),h}function n(o,s,i){let a;for(;s.length&&(a=s[s.length-1]).i<=i;)s.pop(),o.push(a.vs),i++;return i}function r(o){return(s,i)=>s.barycenter<i.barycenter?-1:s.barycenter>i.barycenter?1:o?i.i-s.i:s.i-i.i}return Ur}var Kr,Hs;function f0(){if(Hs)return Kr;Hs=1;let e=l0(),t=u0(),n=d0();Kr=r;function r(i,a,l,u){let c=i.children(a),d=i.node(a),f=d?d.borderLeft:void 0,h=d?d.borderRight:void 0,g={};f&&(c=c.filter(w=>w!==f&&w!==h));let v=e(i,c);v.forEach(w=>{if(i.children(w.v).length){let x=r(i,w.v,l,u);g[w.v]=x,Object.hasOwn(x,"barycenter")&&s(w,x)}});let p=t(v,l);o(p,g);let m=n(p,u);if(f&&(m.vs=[f,m.vs,h].flat(!0),i.predecessors(f).length)){let w=i.node(i.predecessors(f)[0]),x=i.node(i.predecessors(h)[0]);Object.hasOwn(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+w.order+x.order)/(m.weight+2),m.weight+=2}return m}function o(i,a){i.forEach(l=>{l.vs=l.vs.flatMap(u=>a[u]?a[u].vs:u)})}function s(i,a){i.barycenter!==void 0?(i.barycenter=(i.barycenter*i.weight+a.barycenter*a.weight)/(i.weight+a.weight),i.weight+=a.weight):(i.barycenter=a.barycenter,i.weight=a.weight)}return Kr}var Qr,Vs;function h0(){if(Vs)return Qr;Vs=1;let e=Le().Graph,t=fe();Qr=n;function n(o,s,i){let a=r(o),l=new e({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(u=>o.node(u));return o.nodes().forEach(u=>{let c=o.node(u),d=o.parent(u);(c.rank===s||c.minRank<=s&&s<=c.maxRank)&&(l.setNode(u),l.setParent(u,d||a),o[i](u).forEach(f=>{let h=f.v===u?f.w:f.v,g=l.edge(h,u),v=g!==void 0?g.weight:0;l.setEdge(h,u,{weight:o.edge(f).weight+v})}),Object.hasOwn(c,"minRank")&&l.setNode(u,{borderLeft:c.borderLeft[s],borderRight:c.borderRight[s]}))}),l}function r(o){for(var s;o.hasNode(s=t.uniqueId("_root")););return s}return Qr}var Jr,qs;function p0(){if(qs)return Jr;qs=1,Jr=e;function e(t,n,r){let o={},s;r.forEach(i=>{let a=t.parent(i),l,u;for(;a;){if(l=t.parent(a),l?(u=o[l],o[l]=a):(u=s,s=a),u&&u!==a){n.setEdge(u,a);return}a=l}})}return Jr}var eo,Bs;function g0(){if(Bs)return eo;Bs=1;let e=a0(),t=c0(),n=f0(),r=h0(),o=p0(),s=Le().Graph,i=fe();eo=a;function a(d,f){if(f&&typeof f.customOrder=="function"){f.customOrder(d,a);return}let h=i.maxRank(d),g=l(d,i.range(1,h+1),"inEdges"),v=l(d,i.range(h-1,-1,-1),"outEdges"),p=e(d);if(c(d,p),f&&f.disableOptimalOrderHeuristic)return;let m=Number.POSITIVE_INFINITY,w;for(let x=0,b=0;b<4;++x,++b){u(x%2?g:v,x%4>=2),p=i.buildLayerMatrix(d);let S=t(d,p);S<m&&(b=0,w=Object.assign({},p),m=S)}c(d,w)}function l(d,f,h){return f.map(function(g){return r(d,g,h)})}function u(d,f){let h=new s;d.forEach(function(g){let v=g.graph().root,p=n(g,v,h,f);p.vs.forEach((m,w)=>g.node(m).order=w),o(g,h,p.vs)})}function c(d,f){Object.values(f).forEach(h=>h.forEach((g,v)=>d.node(g).order=v))}return eo}var to,Gs;function m0(){if(Gs)return to;Gs=1;let e=Le().Graph,t=fe();to={positionX:h,findType1Conflicts:n,findType2Conflicts:r,addConflict:s,hasConflict:i,verticalAlignment:a,horizontalCompaction:l,alignCoordinates:d,findSmallestWidthAlignment:c,balance:f};function n(p,m){let w={};function x(b,S){let C=0,D=0,E=b.length,_=S[S.length-1];return S.forEach((N,M)=>{let A=o(p,N),P=A?p.node(A).order:E;(A||N===_)&&(S.slice(D,M+1).forEach(y=>{p.predecessors(y).forEach(T=>{let I=p.node(T),z=I.order;(z<C||P<z)&&!(I.dummy&&p.node(y).dummy)&&s(w,T,y)})}),D=M+1,C=P)}),S}return m.length&&m.reduce(x),w}function r(p,m){let w={};function x(S,C,D,E,_){let N;t.range(C,D).forEach(M=>{N=S[M],p.node(N).dummy&&p.predecessors(N).forEach(A=>{let P=p.node(A);P.dummy&&(P.order<E||P.order>_)&&s(w,A,N)})})}function b(S,C){let D=-1,E,_=0;return C.forEach((N,M)=>{if(p.node(N).dummy==="border"){let A=p.predecessors(N);A.length&&(E=p.node(A[0]).order,x(C,_,M,D,E),_=M,D=E)}x(C,_,C.length,E,S.length)}),C}return m.length&&m.reduce(b),w}function o(p,m){if(p.node(m).dummy)return p.predecessors(m).find(w=>p.node(w).dummy)}function s(p,m,w){if(m>w){let b=m;m=w,w=b}let x=p[m];x||(p[m]=x={}),x[w]=!0}function i(p,m,w){if(m>w){let x=m;m=w,w=x}return!!p[m]&&Object.hasOwn(p[m],w)}function a(p,m,w,x){let b={},S={},C={};return m.forEach(D=>{D.forEach((E,_)=>{b[E]=E,S[E]=E,C[E]=_})}),m.forEach(D=>{let E=-1;D.forEach(_=>{let N=x(_);if(N.length){N=N.sort((A,P)=>C[A]-C[P]);let M=(N.length-1)/2;for(let A=Math.floor(M),P=Math.ceil(M);A<=P;++A){let y=N[A];S[_]===_&&E<C[y]&&!i(w,_,y)&&(S[y]=_,S[_]=b[_]=b[y],E=C[y])}}})}),{root:b,align:S}}function l(p,m,w,x,b){let S={},C=u(p,m,w,b),D=b?"borderLeft":"borderRight";function E(M,A){let P=C.nodes(),y=P.pop(),T={};for(;y;)T[y]?M(y):(T[y]=!0,P.push(y),P=P.concat(A(y))),y=P.pop()}function _(M){S[M]=C.inEdges(M).reduce((A,P)=>Math.max(A,S[P.v]+C.edge(P)),0)}function N(M){let A=C.outEdges(M).reduce((y,T)=>Math.min(y,S[T.w]-C.edge(T)),Number.POSITIVE_INFINITY),P=p.node(M);A!==Number.POSITIVE_INFINITY&&P.borderType!==D&&(S[M]=Math.max(S[M],A))}return E(_,C.predecessors.bind(C)),E(N,C.successors.bind(C)),Object.keys(x).forEach(M=>S[M]=S[w[M]]),S}function u(p,m,w,x){let b=new e,S=p.graph(),C=g(S.nodesep,S.edgesep,x);return m.forEach(D=>{let E;D.forEach(_=>{let N=w[_];if(b.setNode(N),E){var M=w[E],A=b.edge(M,N);b.setEdge(M,N,Math.max(C(p,_,E),A||0))}E=_})}),b}function c(p,m){return Object.values(m).reduce((w,x)=>{let b=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY;Object.entries(x).forEach(([D,E])=>{let _=v(p,D)/2;b=Math.max(E+_,b),S=Math.min(E-_,S)});const C=b-S;return C<w[0]&&(w=[C,x]),w},[Number.POSITIVE_INFINITY,null])[1]}function d(p,m){let w=Object.values(m),x=t.applyWithChunking(Math.min,w),b=t.applyWithChunking(Math.max,w);["u","d"].forEach(S=>{["l","r"].forEach(C=>{let D=S+C,E=p[D];if(E===m)return;let _=Object.values(E),N=x-t.applyWithChunking(Math.min,_);C!=="l"&&(N=b-t.applyWithChunking(Math.max,_)),N&&(p[D]=t.mapValues(E,M=>M+N))})})}function f(p,m){return t.mapValues(p.ul,(w,x)=>{if(m)return p[m.toLowerCase()][x];{let b=Object.values(p).map(S=>S[x]).sort((S,C)=>S-C);return(b[1]+b[2])/2}})}function h(p){let m=t.buildLayerMatrix(p),w=Object.assign(n(p,m),r(p,m)),x={},b;["u","d"].forEach(C=>{b=C==="u"?m:Object.values(m).reverse(),["l","r"].forEach(D=>{D==="r"&&(b=b.map(M=>Object.values(M).reverse()));let E=(C==="u"?p.predecessors:p.successors).bind(p),_=a(p,b,w,E),N=l(p,b,_.root,_.align,D==="r");D==="r"&&(N=t.mapValues(N,M=>-M)),x[C+D]=N})});let S=c(p,x);return d(x,S),f(x,p.graph().align)}function g(p,m,w){return(x,b,S)=>{let C=x.node(b),D=x.node(S),E=0,_;if(E+=C.width/2,Object.hasOwn(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":_=-C.width/2;break;case"r":_=C.width/2;break}if(_&&(E+=w?_:-_),_=0,E+=(C.dummy?m:p)/2,E+=(D.dummy?m:p)/2,E+=D.width/2,Object.hasOwn(D,"labelpos"))switch(D.labelpos.toLowerCase()){case"l":_=D.width/2;break;case"r":_=-D.width/2;break}return _&&(E+=w?_:-_),_=0,E}}function v(p,m){return p.node(m).width}return to}var no,js;function y0(){if(js)return no;js=1;let e=fe(),t=m0().positionX;no=n;function n(o){o=e.asNonCompoundGraph(o),r(o),Object.entries(t(o)).forEach(([s,i])=>o.node(s).x=i)}function r(o){let s=e.buildLayerMatrix(o),i=o.graph().ranksep,a=0;s.forEach(l=>{const u=l.reduce((c,d)=>{const f=o.node(d).height;return c>f?c:f},0);l.forEach(c=>o.node(c).y=a+u/2),a+=u+i})}return no}var ro,Ys;function w0(){if(Ys)return ro;Ys=1;let e=Jm(),t=e0(),n=n0(),r=fe().normalizeRanks,o=r0(),s=fe().removeEmptyRanks,i=o0(),a=i0(),l=s0(),u=g0(),c=y0(),d=fe(),f=Le().Graph;ro=h;function h(k,L){let $=L&&L.debugTiming?d.time:d.notime;$("layout",()=>{let q=$("  buildLayoutGraph",()=>E(k));$("  runLayout",()=>g(q,$,L)),$("  updateInputGraph",()=>v(k,q))})}function g(k,L,$){L("    makeSpaceForEdgeLabels",()=>_(k)),L("    removeSelfEdges",()=>G(k)),L("    acyclic",()=>e.run(k)),L("    nestingGraph.run",()=>i.run(k)),L("    rank",()=>n(d.asNonCompoundGraph(k))),L("    injectEdgeLabelProxies",()=>N(k)),L("    removeEmptyRanks",()=>s(k)),L("    nestingGraph.cleanup",()=>i.cleanup(k)),L("    normalizeRanks",()=>r(k)),L("    assignRankMinMax",()=>M(k)),L("    removeEdgeLabelProxies",()=>A(k)),L("    normalize.run",()=>t.run(k)),L("    parentDummyChains",()=>o(k)),L("    addBorderSegments",()=>a(k)),L("    order",()=>u(k,$)),L("    insertSelfEdges",()=>R(k)),L("    adjustCoordinateSystem",()=>l.adjust(k)),L("    position",()=>c(k)),L("    positionSelfEdges",()=>V(k)),L("    removeBorderNodes",()=>z(k)),L("    normalize.undo",()=>t.undo(k)),L("    fixupEdgeLabelCoords",()=>T(k)),L("    undoCoordinateSystem",()=>l.undo(k)),L("    translateGraph",()=>P(k)),L("    assignNodeIntersects",()=>y(k)),L("    reversePoints",()=>I(k)),L("    acyclic.undo",()=>e.undo(k))}function v(k,L){k.nodes().forEach($=>{let q=k.node($),H=L.node($);q&&(q.x=H.x,q.y=H.y,q.rank=H.rank,L.children($).length&&(q.width=H.width,q.height=H.height))}),k.edges().forEach($=>{let q=k.edge($),H=L.edge($);q.points=H.points,Object.hasOwn(H,"x")&&(q.x=H.x,q.y=H.y)}),k.graph().width=L.graph().width,k.graph().height=L.graph().height}let p=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],x=["width","height"],b={width:0,height:0},S=["minlen","weight","width","height","labeloffset"],C={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},D=["labelpos"];function E(k){let L=new f({multigraph:!0,compound:!0}),$=Y(k.graph());return L.setGraph(Object.assign({},m,B($,p),d.pick($,w))),k.nodes().forEach(q=>{let H=Y(k.node(q));const j=B(H,x);Object.keys(b).forEach(W=>{j[W]===void 0&&(j[W]=b[W])}),L.setNode(q,j),L.setParent(q,k.parent(q))}),k.edges().forEach(q=>{let H=Y(k.edge(q));L.setEdge(q,Object.assign({},C,B(H,S),d.pick(H,D)))}),L}function _(k){let L=k.graph();L.ranksep/=2,k.edges().forEach($=>{let q=k.edge($);q.minlen*=2,q.labelpos.toLowerCase()!=="c"&&(L.rankdir==="TB"||L.rankdir==="BT"?q.width+=q.labeloffset:q.height+=q.labeloffset)})}function N(k){k.edges().forEach(L=>{let $=k.edge(L);if($.width&&$.height){let q=k.node(L.v),j={rank:(k.node(L.w).rank-q.rank)/2+q.rank,e:L};d.addDummyNode(k,"edge-proxy",j,"_ep")}})}function M(k){let L=0;k.nodes().forEach($=>{let q=k.node($);q.borderTop&&(q.minRank=k.node(q.borderTop).rank,q.maxRank=k.node(q.borderBottom).rank,L=Math.max(L,q.maxRank))}),k.graph().maxRank=L}function A(k){k.nodes().forEach(L=>{let $=k.node(L);$.dummy==="edge-proxy"&&(k.edge($.e).labelRank=$.rank,k.removeNode(L))})}function P(k){let L=Number.POSITIVE_INFINITY,$=0,q=Number.POSITIVE_INFINITY,H=0,j=k.graph(),W=j.marginx||0,Z=j.marginy||0;function ne(K){let ee=K.x,le=K.y,se=K.width,ye=K.height;L=Math.min(L,ee-se/2),$=Math.max($,ee+se/2),q=Math.min(q,le-ye/2),H=Math.max(H,le+ye/2)}k.nodes().forEach(K=>ne(k.node(K))),k.edges().forEach(K=>{let ee=k.edge(K);Object.hasOwn(ee,"x")&&ne(ee)}),L-=W,q-=Z,k.nodes().forEach(K=>{let ee=k.node(K);ee.x-=L,ee.y-=q}),k.edges().forEach(K=>{let ee=k.edge(K);ee.points.forEach(le=>{le.x-=L,le.y-=q}),Object.hasOwn(ee,"x")&&(ee.x-=L),Object.hasOwn(ee,"y")&&(ee.y-=q)}),j.width=$-L+W,j.height=H-q+Z}function y(k){k.edges().forEach(L=>{let $=k.edge(L),q=k.node(L.v),H=k.node(L.w),j,W;$.points?(j=$.points[0],W=$.points[$.points.length-1]):($.points=[],j=H,W=q),$.points.unshift(d.intersectRect(q,j)),$.points.push(d.intersectRect(H,W))})}function T(k){k.edges().forEach(L=>{let $=k.edge(L);if(Object.hasOwn($,"x"))switch(($.labelpos==="l"||$.labelpos==="r")&&($.width-=$.labeloffset),$.labelpos){case"l":$.x-=$.width/2+$.labeloffset;break;case"r":$.x+=$.width/2+$.labeloffset;break}})}function I(k){k.edges().forEach(L=>{let $=k.edge(L);$.reversed&&$.points.reverse()})}function z(k){k.nodes().forEach(L=>{if(k.children(L).length){let $=k.node(L),q=k.node($.borderTop),H=k.node($.borderBottom),j=k.node($.borderLeft[$.borderLeft.length-1]),W=k.node($.borderRight[$.borderRight.length-1]);$.width=Math.abs(W.x-j.x),$.height=Math.abs(H.y-q.y),$.x=j.x+$.width/2,$.y=q.y+$.height/2}}),k.nodes().forEach(L=>{k.node(L).dummy==="border"&&k.removeNode(L)})}function G(k){k.edges().forEach(L=>{if(L.v===L.w){var $=k.node(L.v);$.selfEdges||($.selfEdges=[]),$.selfEdges.push({e:L,label:k.edge(L)}),k.removeEdge(L)}})}function R(k){var L=d.buildLayerMatrix(k);L.forEach($=>{var q=0;$.forEach((H,j)=>{var W=k.node(H);W.order=j+q,(W.selfEdges||[]).forEach(Z=>{d.addDummyNode(k,"selfedge",{width:Z.label.width,height:Z.label.height,rank:W.rank,order:j+ ++q,e:Z.e,label:Z.label},"_se")}),delete W.selfEdges})})}function V(k){k.nodes().forEach(L=>{var $=k.node(L);if($.dummy==="selfedge"){var q=k.node($.e.v),H=q.x+q.width/2,j=q.y,W=$.x-H,Z=q.height/2;k.setEdge($.e,$.label),k.removeNode(L),$.label.points=[{x:H+2*W/3,y:j-Z},{x:H+5*W/6,y:j-Z},{x:H+W,y:j},{x:H+5*W/6,y:j+Z},{x:H+2*W/3,y:j+Z}],$.label.x=$.x,$.label.y=$.y}})}function B(k,L){return d.mapValues(d.pick(k,L),Number)}function Y(k){var L={};return k&&Object.entries(k).forEach(([$,q])=>{typeof $=="string"&&($=$.toLowerCase()),L[$]=q}),L}return ro}var oo,Ws;function v0(){if(Ws)return oo;Ws=1;let e=fe(),t=Le().Graph;oo={debugOrdering:n};function n(r){let o=e.buildLayerMatrix(r),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.nodes().forEach(i=>{s.setNode(i,{label:i}),s.setParent(i,"layer"+r.node(i).rank)}),r.edges().forEach(i=>s.setEdge(i.v,i.w,{},i.name)),o.forEach((i,a)=>{let l="layer"+a;s.setNode(l,{rank:"same"}),i.reduce((u,c)=>(s.setEdge(u,c,{style:"invis"}),c))}),s}return oo}var io,Xs;function b0(){return Xs||(Xs=1,io="1.1.4"),io}var so,Zs;function x0(){return Zs||(Zs=1,so={graphlib:Le(),layout:w0(),debug:v0(),util:{time:fe().time,notime:fe().notime},version:b0()}),so}var Ko=x0();const Ke=new Ko.graphlib.Graph;Ke.setDefaultEdgeLabel(()=>({}));const Us=130,Ks=40,E0=130,_0=(e,t="LR")=>{const n=t==="LR";return Ke.setGraph({rankdir:t}),e.forEach((r,o)=>{const s=o>0?e[o-1]:void 0;Ke.setNode(r.id,{width:Us,height:s?.type==="conditional"?E0:Ks})}),Ko.layout(Ke),e.map(r=>{const o=Ke.node(r.id);return r.targetPosition=n?X.Left:X.Top,r.sourcePosition=n?X.Right:X.Bottom,r.position={x:o.x-Us/2,y:o.y-Ks/2},r})},C0=(e,t="LR")=>(Ke.setGraph({rankdir:t}),e.forEach(n=>{Ke.setEdge(n.source,n.target)}),Ko.layout(Ke),e),wn=33,S0=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:o,sourcePosition:s,targetPosition:i,label:a,style:l={},markerType:u,markerEndId:c,selected:d,data:{onEdgeClick:f}})=>{const[h,g,v]=Go({sourceX:t,sourceY:n,sourcePosition:s,targetX:r,targetY:o,targetPosition:i}),p=Rp(u,c);return te(be,{children:[O("path",{id:e,style:l,className:"react-flow__edge-path",d:h,markerEnd:p}),!d&&O("text",{children:O("textPath",{href:`#${e}`,style:{fontSize:"11px"},startOffset:"50%",textAnchor:"middle",children:a})}),d&&O("foreignObject",{width:wn,height:wn,x:g-wn/2,y:v-wn/2,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:O("button",{className:"edgebutton",onClick:m=>f(m,e),children:O(ra,{})})})]})},N0=({data:e,selected:t})=>te(be,{children:[O(et,{position:X.Right,type:"source"}),O("div",{className:`react-flow__node-default keycloak__authentication__conditional_node ${t?"selected":""}`,children:O("div",{children:e.label})}),O(et,{position:X.Left,type:"target"})]}),k0=ae(N0),M0=({data:{label:e},prefix:t,selected:n})=>te(be,{children:[O(et,{position:X.Right,type:"source"}),O("div",{className:`react-flow__node-default keycloak__authentication__subflow_node ${n?"selected":""}`,children:te("div",{children:[t," ",e]})}),O(et,{position:X.Left,type:"target"})]}),qc=ae(M0),I0=({...e})=>O(qc,{...e,prefix:"Start"}),L0=({...e})=>O(qc,{...e,prefix:"End"}),A0={conditional:k0,startSubFlow:I0,endSubFlow:L0},T0=new Map([["input","keycloak__authentication__input_node"],["output","keycloak__authentication__output_node"]]);function O0(e,t){const n=[];for(let r=0;r<t.length-1;r++)n.push(e(t[r],t[r+1]));return n}const R0=e=>e.requirement==="ALTERNATIVE"||e.requirement==="CONDITIONAL",Xn=(e,t,n)=>({id:`edge-${e}-to-${t}`,type:"buttonEdge",source:e,target:t,label:n,data:{onEdgeClick:(r,o)=>{r.stopPropagation(),alert(`hello ${o}`)}}}),No=(e,t)=>({id:e.id,type:t,sourcePosition:t==="output"?void 0:X.Right,targetPosition:t==="input"?void 0:X.Left,data:{label:e.displayName},position:{x:0,y:0},className:T0.get(t||"")}),D0=e=>{const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(!R0(r))break;t.push(r)}return t},Qs=(e,t=!0)=>({startId:e.id,nodes:[e],edges:[],nextLinkFns:t?[n=>Xn(e.id,n)]:[]}),$0=e=>{if(!e.executionList)throw new Error("Execution list is required for subflow");const t=Bc(Qo(e.executionList));return t.nextLinkFns.push(...e.executionList.filter(n=>$n(n)).map(n=>r=>Xn(n.id,r,"false"))),t},P0=e=>{const t=D0(e);return t.length>0?t:[e[0]]},F0=e=>e.length===0?[]:P0(e).map(n=>{if(n.executionList)return $0(n);const r=$n(n),o=(()=>{if(r)return"true";if(n.requirement==="ALTERNATIVE")return"success"})();return{startId:n.id,nodes:[No(n,r?"conditional":void 0)],edges:[],nextLinkFns:[s=>Xn(n.id,s,o)]}}),Qo=e=>{if(e.length===0)return[];const t=F0(e);return[t,...Qo(e.slice(t.length))]},Bc=e=>{const t=[],n=[];let r=[];for(const o of e)t.push(...o.flatMap(s=>s.nodes)),n.push(...o.flatMap(s=>s.edges),...r.map(s=>s(o[0].startId)),...O0((s,i)=>Xn(s.startId,i.startId,"attempted"),o)),r=o.flatMap(s=>s.nextLinkFns);return{startId:e[0][0].startId,nodes:t,edges:n,nextLinkFns:r}},z0={buttonEdge:S0};function Js(e){const t=e.filter(s=>s.requirement!=="DISABLED"),n=[[Qs(No({id:"start",displayName:"Start"},"input"))],...Qo(t),[Qs(No({id:"end",displayName:"End"},"output"),!1)]],{nodes:r,edges:o}=Bc(n);return[_0(r),C0(o)]}const H0=({executionList:{expandableList:e}})=>{const[t,n]=re(!1),[r,o]=Ne(()=>Js(e),[]),[s,i,a]=hm(r),[l,u,c]=pm(o);return Fm(()=>{const[h,g]=Js(e);i(h),u(g)},[e]),te(Lc,{nodes:s,edges:l,onNodesChange:a,onEdgesChange:c,onInit:h=>h.fitView({duration:100}),nodeTypes:A0,edgeTypes:z0,onNodeClick:()=>{n(!t)},nodesConnectable:!1,children:[O(Cm,{}),O(Am,{}),O(Pm,{})]})},V0=()=>{const{t:e}=_e();return te(ta,{"aria-labelledby":"headerName",id:"header",children:[te(je,{children:[O(cu,{className:"keycloak__authentication__header-drag-button","aria-label":e("disabled")}),O(je,{screenReaderText:e("expandRow")})]}),O(je,{children:e("steps")}),O(je,{children:e("requirement")}),O(je,{screenReaderText:e("config")}),O(je,{screenReaderText:e("config")}),O(je,{screenReaderText:e("config")}),O(je,{screenReaderText:e("config")})]})},q0=({execution:e,onAddExecution:t,onAddFlow:n})=>{const{adminClient:r}=mt(),{t:o}=_e(),[s,i]=re(!1),[a,l]=re(),[u,c]=re();return Dt(()=>r.authenticationManagement.getFlow({flowId:e.flowId}),({providerId:d})=>c(d),[]),O(zn,{content:o("add"),children:te(be,{children:[O($l,{popperProps:{position:"right"},isOpen:s,onOpenChange:d=>i(d),toggle:d=>O(oa,{ref:d,variant:"plain",onClick:()=>i(!s),"aria-label":o("add"),"data-testid":`${e.displayName}-edit-dropdown`,children:O(ra,{})}),onSelect:()=>i(!1),children:te(Pl,{children:[O(ct,{onClick:()=>l(u==="form-flow"?"form":"basic"),children:o("addExecution")},"addStep"),O(ct,{onClick:()=>l("condition"),children:o("addCondition")},"addCondition"),O(ct,{onClick:()=>l("subFlow"),children:o("addSubFlow")},"addSubFlow")]})}),a&&a!=="subFlow"&&O(Lo,{name:e.displayName,type:a,onSelect:d=>{d&&t(e,d),l(void 0)}}),a==="subFlow"&&O(Ao,{name:e.displayName,onCancel:()=>l(void 0),onConfirm:d=>{n(e,d),l(void 0)}})]})})},B0=({execution:e,onRowChange:t})=>{const{t:n}=_e(),r=Pn({mode:"onChange",defaultValues:e}),[o,s]=ao();oe(()=>r.reset(e),[e]);const i=a=>{t({...e,...a}),s()};return te(be,{children:[O(zn,{content:n("edit"),children:O(ge,{variant:"plain","data-testid":`${e.id}-edit`,"aria-label":n("edit"),onClick:s,children:O(fu,{})})}),o&&O(nn,{title:n("editFlow"),onClose:s,variant:rn.small,actions:[O(ge,{"data-testid":"confirm",type:"submit",form:"edit-flow-form",isDisabled:!r.formState.isValid,children:n("edit")},"confirm"),O(ge,{"data-testid":"cancel",variant:Je.link,onClick:s,children:n("cancel")},"cancel")],isOpen:!0,children:O(on,{id:"edit-flow-form",onSubmit:r.handleSubmit(i),isHorizontal:!0,children:te(Fn,{...r,children:[O(_n,{name:"displayName",label:n("name"),labelIcon:n("flowNameHelp"),rules:{required:n("required")}}),O(Fl,{name:"description",label:n("description"),labelIcon:n("flowDescriptionHelp"),rules:{maxLength:{value:255,message:n("maxLength",{length:255})}}})]})})})]})},G0=({execution:e})=>{const{adminClient:t}=mt(),{t:n}=_e(),{addAlert:r,addError:o}=Io(),[s,i]=re(!1),[a,l]=re(),[u,c]=re(),d=Pn(),{setValue:f,handleSubmit:h}=d,g=e.authenticationFlow?[]:[{helpText:n("authenticatorRefConfig.value.help"),label:n("authenticatorRefConfig.value.label"),name:"default.reference.value",readOnly:!1,secret:!1,type:"String"},{helpText:n("authenticatorRefConfig.maxAge.help"),label:n("authenticatorRefConfig.maxAge.label"),name:"default.reference.maxAge",readOnly:!1,secret:!1,type:"String"}],v=m=>{Hl(m||{},f)};Dt(async()=>{let m;const w=e.configurable?await t.authenticationManagement.getConfigDescription({providerId:e.providerId}):{name:e.displayName,properties:[]};return e.authenticationConfig&&(m=await t.authenticationManagement.getConfig({id:e.authenticationConfig})),w.properties=[...g,...w.properties],{configDescription:w,config:m}},({configDescription:m,config:w})=>{c(m),l(w)},[]),oe(()=>{a&&v(a)},[a]);const p=async m=>{const w=Vl(m);try{if(a){const x={id:a.id,alias:a.alias,config:w.config};await t.authenticationManagement.updateConfig(x),l({...x})}else{const x={id:e.id,alias:w.alias,config:w.config},{id:b}=await t.authenticationManagement.createConfig(x);l({...x.config,id:b,alias:x.alias})}r(n("configSaveSuccess"),We.success),i(!1)}catch(x){o("configSaveError",x)}};return te(be,{children:[O(zn,{content:n("settings"),children:O(ge,{variant:"plain","aria-label":n("settings"),onClick:()=>i(!0),children:O(nu,{})})}),u&&O(nn,{variant:rn.small,isOpen:s,title:n("executionConfig",{name:u.name}),onClose:()=>i(!1),children:te(on,{id:"execution-config-form",onSubmit:h(p),children:[te(Fn,{...d,children:[O(_n,{name:"alias",label:n("alias"),labelIcon:n("authenticationAliasHelp"),rules:{required:n("required")},isDisabled:!!a}),O(hu,{stringify:!0,properties:u.properties||[]})]}),te(zl,{children:[O(ge,{"data-testid":"save",variant:"primary",type:"submit",children:n("save")}),O(ge,{"data-testid":"cancel",variant:Je.link,onClick:()=>{i(!1)},children:n("cancel")}),a&&te(ge,{className:"pf-v5-u-ml-4xl","data-testid":"clear",variant:Je.link,onClick:async()=>{await t.authenticationManagement.delConfig({id:a.id}),l(void 0),i(!1)},children:[n("clear")," ",O(aa,{})]})]})]})})]})},j0=({flow:e,onChange:t})=>{const{t:n}=_e(),[r,o]=re(!1),s=e.requirementChoices.map((i,a)=>O(ql,{value:i,children:n(`requirements.${i}`)},a));return te(be,{children:[e.requirementChoices&&e.requirementChoices.length>1&&O(Bl,{onOpenChange:i=>o(i),onSelect:(i,a)=>{e.requirement=a?.toString(),t(e),o(!1)},selected:e.requirement,isOpen:r,toggle:i=>O(oa,{className:"keycloak__authentication__requirement-dropdown",ref:i,onClick:()=>o(!r),isExpanded:r,children:n(`requirements.${e.requirement}`)}),children:O(Gl,{children:s})}),(!e.requirementChoices||e.requirementChoices.length<=1)&&O(be,{children:n(`requirements.${e.requirement}`)})]})},Y0=({type:e})=>{switch(e){case"condition":return O(Su,{});case"flow":return O(gu,{});case"execution":return O(xu,{});case"step":return O(vu,{});default:return}};function W0(e){switch(e){case"condition":return"purple";case"flow":return"green";case"execution":return"blue";case"step":return"cyan";default:return"grey"}}const X0=({id:e,type:t,title:n,subtitle:r,providerId:o})=>{const{t:s}=_e(),{providers:i}=Ru(),a=i?.find(l=>l.id===o)?.description||r;return O("div",{"data-testid":n,children:te("span",{"data-id":e,id:`title-id-${e}`,children:[O(Mo,{icon:O(Y0,{type:t}),color:W0(t),children:s(t)})," ",n," ",a&&O(jl,{helpText:a,fieldLabelId:e})]})})},Z0=e=>e.authenticationFlow?"flow":e.displayName.startsWith("Condition -")?"condition":e.level===0?"execution":"step",Gc=({builtIn:e,execution:t,onRowClick:n,onRowChange:r,onAddExecution:o,onAddFlow:s,onDelete:i})=>{const{t:a}=_e(),l=!!t.executionList?.length,u={onCollapse:()=>n(t),props:{isExpanded:!t.isCollapsed,isDetailsExpanded:!t.isCollapsed,"aria-level":t.level+1,"aria-labelledby":t.id,"aria-setsize":l?t.executionList.length:0}};return te(be,{children:[O(lu,{hasNoWrapper:!0,children:te(la,{row:{props:u.props},className:"keycloak__authentication__flow-row",children:[O(ze,{draggableRow:{id:t.id}}),O(ze,{treeRow:u,children:O(X0,{id:t.id,type:Z0(t),subtitle:(t.authenticationFlow?t.description:t.alias)||"",providerId:t.providerId,title:t.displayName},t.id)}),O(ze,{children:O(j0,{flow:t,onChange:r})}),(!t.authenticationFlow||e)&&te(be,{children:[O(ze,{isActionCell:!0}),O(ze,{isActionCell:!0})]}),O(ze,{isActionCell:!0,children:O(G0,{execution:t})}),t.authenticationFlow&&!e&&te(be,{children:[O(ze,{isActionCell:!0,children:O(q0,{execution:t,onAddExecution:o,onAddFlow:s})}),O(ze,{isActionCell:!0,children:O(B0,{execution:t,onRowChange:r})})]}),O(ze,{isActionCell:!0,children:!e&&O(zn,{content:a("delete"),children:O(ge,{variant:"plain","data-testid":`${t.displayName}-delete`,"aria-label":a("delete"),onClick:()=>i(t),children:O(aa,{})})})})]})},`draggable-${t.id}`),!t.isCollapsed&&l&&t.executionList?.map(c=>O(Gc,{builtIn:e,execution:c,onRowClick:n,onRowChange:r,onAddExecution:o,onAddFlow:s,onDelete:i},c.id))]})};class jc{oldIndex;newIndex;constructor(t,n){this.oldIndex=t,this.newIndex=n}}class ea extends jc{parent;constructor(t,n,r){super(t,n),this.parent=r}}class Jo{#e;expandableList;constructor(t){this.#e=t;const n={executionList:[],isCollapsed:!1};this.#t(0,-1,n),this.expandableList=n.executionList}#t(t,n,r){for(let o=t;o<this.#e.length;o++){const s=this.#e[o],i=s.level||0;if(i<=n)return o-1;const a=this.#e[o+1]?.level||0;if(i<a){const u={...s,executionList:[],isCollapsed:!1};o=this.#t(o+1,i,u),r.executionList?.push(u)}else r.executionList?.push(s)}return this.#e.length}order(t){let n=[];for(const r of t||this.expandableList)n.push(r),r.executionList&&!r.isCollapsed&&(n=n.concat(this.order(r.executionList)));return n}findExecution(t,n={index:0},r){const o=r||this.expandableList;for(let s=0;s<o.length;s++){const i=o[s];if(n.index===t)return i;if(n.index++,i.executionList&&!i.isCollapsed){const a=this.findExecution(t,n,i.executionList);if(a)return a}}}#n(t,n){let r;for(let o=0;o<n;o++){const s=this.#e[o];t-1===s.level&&(r=s)}return r}getChange(t,n){const r=this.order(),o=n.findIndex(c=>c===t.id),s=r.findIndex(c=>c.id===t.id),i=r[s],a=r[o],l=this.#n(i.level,s),u=this.#n(a.level,o);return l?.id!==u?.id?a.level>0?new ea(u?.executionList?.length||0,a.index,u):new ea(this.expandableList.length,a.index):new jc(i.index,a.index)}clone(){const t=new Jo([]);return t.#e=this.#e,t.expandableList=this.expandableList,t}}const $n=e=>e.displayName?.startsWith("Condition ");function by(){const{adminClient:e}=mt(),{t}=_e(),{realm:n}=Yl(),{addAlert:r,addError:o}=Io(),{id:s,usedBy:i,builtIn:a}=Wl(),l=Xl(),[u,c]=re(0),d=()=>c(new Date().getTime()),[f,h]=re(!0),[g,v]=re(),[p,m]=re(),[w,x]=re(""),[b,S]=re(),[C,D]=re(),[E,_]=re(),[N,M,A]=ao(),[P,y]=re(!1),[T,I]=ao();Dt(async()=>{const j=(await e.authenticationManagement.getFlows()).find(Z=>Z.id===s);if(!j)throw new Error(t("notFound"));const W=await e.authenticationManagement.getExecutions({flow:j.alias});return{flow:j,executions:W}},({flow:H,executions:j})=>{v(H),m(new Jo(j))},[u]);const z=async(H,j)=>{try{let W=H.id;if("parent"in j){let ne={};"authenticationConfig"in H&&(ne=await e.authenticationManagement.getConfig({id:H.authenticationConfig}));try{await e.authenticationManagement.delExecution({id:W})}catch{}if("authenticationFlow"in H){const K=H,ee=await e.authenticationManagement.addFlowToFlow({flow:j.parent?.displayName||g?.alias,alias:K.displayName,description:K.description,provider:H.providerId,type:"basic-flow"});W=ee.id,H.executionList?.forEach((le,se)=>z(le,{parent:{...H,id:ee.id},newIndex:se,oldIndex:se}))}else{const K=await e.authenticationManagement.addExecutionToFlow({flow:j.parent?.displayName||g?.alias,provider:H.providerId});if(ne.id){const ee={id:K.id,alias:ne.alias,config:ne.config};await e.authenticationManagement.createConfig(ee)}W=K.id}}const Z=j.newIndex-j.oldIndex;for(let ne=0;ne<Math.abs(Z);ne++)Z>0?await e.authenticationManagement.lowerPriorityExecution({id:W}):await e.authenticationManagement.raisePriorityExecution({id:W});d(),r(t("updateFlowSuccess"),We.success)}catch(W){o("updateFlowError",W)}},G=async H=>{const{executionList:j,isCollapsed:W,...Z}=H;try{await e.authenticationManagement.updateExecution({flow:g?.alias},Z),d(),r(t("updateFlowSuccess"),We.success)}catch(ne){o("updateFlowError",ne)}},R=async(H,j)=>{try{await e.authenticationManagement.addExecutionToFlow({flow:H,provider:j.id}),d(),r(t("updateFlowSuccess"),We.success)}catch(W){o("updateFlowError",W)}},V=async(H,{name:j,description:W="",type:Z,provider:ne})=>{try{await e.authenticationManagement.addFlowToFlow({flow:H,alias:j,description:W,provider:ne,type:Z}),d(),r(t("updateFlowSuccess"),We.success)}catch(K){o("updateFlowError",K)}},[B,Y]=ai({titleKey:t("deleteConfirmExecution",{name:E?.displayName}),children:te(ci,{i18nKey:"deleteConfirmExecutionMessage",children:[" ",O("strong",{children:{name:E?.displayName}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:Je.danger,onConfirm:async()=>{try{await e.authenticationManagement.delExecution({id:E?.id}),r(t("deleteExecutionSuccess"),We.success),d()}catch(H){o("deleteExecutionError",H)}}}),[k,L]=ai({titleKey:"deleteConfirmFlow",children:te(ci,{i18nKey:"deleteConfirmFlowMessage",children:[" ",O("strong",{children:{flow:g?.alias||""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:Je.danger,onConfirm:async()=>{try{await e.authenticationManagement.deleteFlow({flowId:g.id}),l(Zl({realm:n})),r(t("deleteFlowSuccess"),We.success)}catch(H){o("deleteFlowError",H)}}}),$=p?.expandableList.length!==0,q=[...i!=="DEFAULT"?[O(ct,{"data-testid":"set-as-default",onClick:I,children:t("bindFlow")},"default")]:[],O(ct,{onClick:()=>A(!0),children:t("duplicate")},"duplicate"),...a?[]:[O(ct,{"data-testid":"edit-flow",onClick:()=>y(!0),children:t("editInfo")},"edit")],...!a&&!i?[O(ct,{"data-testid":"delete-flow",onClick:()=>k(),children:t("delete")},"delete")]:[]];return te(Ou,{children:[T&&O(ru,{flowAlias:g?.alias,onClose:H=>{I(),l(Ul({realm:n,id:s,usedBy:H?"DEFAULT":"notInUse",builtIn:a?"builtIn":void 0}))}}),N&&O(ou,{name:g?.alias,description:g?.description,toggleDialog:M,onComplete:()=>{d(),A(!1)}}),P&&O(Iu,{flow:g,toggleDialog:()=>{y(!P),d()}}),O(L,{}),O(tu,{titleKey:g?.alias||"",badges:[{text:O(Mo,{children:t(`used.${i}`)})},a?{text:O(Mu,{}),id:"builtIn"}:{}],dropdownItems:q}),te(na,{variant:"light",children:[p&&$&&te(be,{children:[O(Kl,{id:"toolbar",children:te(Ql,{children:[O(Jn,{children:te(ca,{children:[O(Sn,{icon:O(_u,{}),"aria-label":t("tableView"),buttonId:"tableView",isSelected:f,onChange:()=>h(!0)}),O(Sn,{icon:O(yu,{}),"aria-label":t("diagramView"),buttonId:"diagramView",isSelected:!f,onChange:()=>h(!1)})]})}),O(Jn,{children:O(ge,{"data-testid":"addStep",variant:"secondary",onClick:()=>S(!0),children:t("addExecution")})}),O(Jn,{children:O(ge,{"data-testid":"addSubFlow",variant:"secondary",onClick:()=>D(!0),children:t("addSubFlow")})})]})}),O(Y,{}),f&&O(uu,{onDrag:({index:H})=>{const j=p.findExecution(H);return x(t("onDragStart",{item:j.displayName})),j.isCollapsed||(j.isCollapsed=!0,m(p.clone())),!0},onDragMove:({index:H})=>{const j=p.findExecution(H);x(t("onDragMove",{item:j?.displayName}))},onDrop:(H,j)=>{if(j){const W=p.findExecution(H.index),Z=p.order().map(ee=>ee.id);x(t("onDragFinish",{list:W.displayName}));const[ne]=Z.splice(H.index,1);Z.splice(j.index,0,ne);const K=p.getChange(W,Z);return z(W,K),!0}else return x(t("onDragCancel")),!1},children:O(du,{hasNoWrapper:!0,children:te(Jl,{"aria-label":t("flows"),isTreeTable:!0,children:[O(V0,{}),O(be,{children:p.expandableList.map(H=>O(eu,{draggable:!0,children:O(Gc,{builtIn:!!a,execution:H,onRowClick:j=>{j.isCollapsed=!j.isCollapsed,m(p.clone())},onRowChange:G,onAddExecution:(j,W)=>R(j.displayName,W),onAddFlow:(j,W)=>V(j.displayName,W),onDelete:j=>{_(j),B()}})},H.id))})]})})}),g&&te(be,{children:[b&&O(Lo,{name:g.alias,type:g.providerId==="client-flow"?"client":"basic",onSelect:H=>{H&&R(g.alias,H),S(!1)}}),C&&O(Ao,{name:g.alias,onCancel:()=>D(!1),onConfirm:H=>{V(g.alias,H),D(!1)}})]}),O("div",{className:"pf-v5-screen-reader","aria-live":"assertive",children:w})]}),!f&&p?.expandableList&&O(H0,{executionList:p}),!p?.expandableList||g&&!$&&O(Tu,{flow:g,onAddExecution:H=>R(g.alias,H),onAddFlow:H=>V(g.alias,H)})]})]})}export{by as default,$n as providerConditionFilter};
//# sourceMappingURL=FlowDetails-BhrCoPG1.js.map
