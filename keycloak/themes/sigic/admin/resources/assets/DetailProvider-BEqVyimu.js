import{jsx as e,jsxs as d,Fragment as I}from"react/jsx-runtime";import{u as k,a as B,b as F,l as T,d as j,V as E,j as K,J as x,B as H,bb as v,y as L,D as N,P as O,n as q,Y as P,A as U,h as b,L as Y,bc as $}from"./main-Dml5vH_M.js";import{useState as z}from"react";import{u as G}from"./ConfirmDialog-BN0phSta.js";import{D as J}from"./DynamicComponents-Cxsqsl9R.js";import{F as W}from"./FormAccess-Dgk035ov.js";import{V as M}from"./ViewHeader-CnGpO8mW.js";import{u as Q}from"./useParams-Cmi1OAEj.js";import"react-dom";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./DataListItemRow-B3J1tfyO.js";import"./KeySelect-Ba6sDuzD.js";import"./MultiLineInput-BnUu5qtj.js";import"./AddRoleMappingModal-FlNvMd3n.js";import"./translationFormatter-DtFomvax.js";import"./useLocaleSort-DeXbTEE9.js";import"./filter-icon-BO7Evf9d.js";import"./CodeEditor-C7HQ48Ys.js";function ve(){const{adminClient:n}=k(),{t}=B(),{id:r,providerId:s,subTab:c}=Q(),m=F(),p=T({defaultValues:{providerId:s}}),{control:h,handleSubmit:C,reset:D}=p,{realm:l,realmRepresentation:R}=j(),{addAlert:u,addError:y}=E(),[f,V]=z();K(async()=>await Promise.all([n.realms.getClientRegistrationPolicyProviders({realm:l}),r?n.components.findOne({id:r}):Promise.resolve()]),([i,o])=>{V(i.find(a=>a.id===s)),D(o||{providerId:s})},[]);const g=x({control:h,defaultValue:"",name:"name"}),w=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:c,parentId:R?.id,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:s};if(r)await n.components.update({id:r},o);else{const{id:a}=await n.components.create(o);m($({id:a,realm:l,subTab:c,providerId:s}))}u(t(`provider${r?"Updated":"Create"}Success`))}catch(o){y(`provider${r?"Updated":"Create"}Error`,o)}},[A,S]=G({titleKey:"clientRegisterPolicyDeleteConfirmTitle",messageKey:t("clientRegisterPolicyDeleteConfirm",{name:g}),continueButtonLabel:"delete",continueButtonVariant:H.danger,onConfirm:async()=>{try{await n.components.del({realm:l,id:r}),u(t("clientRegisterPolicyDeleteSuccess")),m(v({realm:l,subTab:c}))}catch(i){y("clientRegisterPolicyDeleteError",i)}}});return f?d(I,{children:[e(M,{titleKey:r?g:"createPolicy",subKey:r,dropdownItems:r?[e(N,{"data-testid":"delete",onClick:A,children:t("delete")},"delete")]:void 0}),e(S,{}),e(O,{variant:"light",children:e(q,{...p,children:d(W,{role:"manage-clients",isHorizontal:!0,onSubmit:C(w),children:[e(P,{name:"providerId",label:t("provider"),readOnly:!0}),e(P,{name:"name",label:t("name"),labelIcon:t("clientPolicyNameHelp"),rules:{required:t("required")}}),e(J,{properties:f.properties}),d(U,{children:[e(b,{"data-testid":"save",type:"submit",children:t("save")}),e(b,{"data-testid":"cancel",variant:"link",component:i=>e(Y,{...i,to:v({realm:l,subTab:c})}),children:t("cancel")})]})]})})})]}):e(L,{})}export{ve as default};
//# sourceMappingURL=DetailProvider-BEqVyimu.js.map
