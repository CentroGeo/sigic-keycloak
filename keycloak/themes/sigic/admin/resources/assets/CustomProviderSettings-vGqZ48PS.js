import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,Z as E,n as U,K as v,N as b,S as P,O as C,Y as f,u as H,b as O,l as j,V as D,d as _,e as L,j as q,o as z,y as G,P as R,A as Y,h as k,L as B,eJ as F,p as J,q as K}from"./main-Dml5vH_M.js";import{D as W}from"./DynamicComponents-Cxsqsl9R.js";import{F as Z}from"./FormAccess-Dgk035ov.js";import{u as M}from"./useParams-Cmi1OAEj.js";import{E as Q}from"./ExtendedHeader-CU_lK8qQ.js";import{S as X}from"./SettingsCache-BwAe_-Fz.js";import{useState as $}from"react";import"react-dom";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./DataListItemRow-B3J1tfyO.js";import"./KeySelect-Ba6sDuzD.js";import"./MultiLineInput-BnUu5qtj.js";import"./AddRoleMappingModal-FlNvMd3n.js";import"./translationFormatter-DtFomvax.js";import"./useLocaleSort-DeXbTEE9.js";import"./ConfirmDialog-BN0phSta.js";import"./filter-icon-BO7Evf9d.js";import"./CodeEditor-C7HQ48Ys.js";import"./ViewHeader-CnGpO8mW.js";import"./isEqual-xoTijI-C.js";const ee=()=>{const{t:r}=I(),a=E(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(v,{label:r("periodicFullSync"),labelIcon:e(C,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(P,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(v,{label:r("periodicChangedUsersSync"),labelIcon:e(C,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(P,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function Fe(){const{adminClient:r}=H(),{t:a}=I(),{id:o,providerId:t}=M(),d=O(),c=j({mode:"onChange"}),{reset:i,setValue:m,handleSubmit:s,formState:{isDirty:V}}=c,{addAlert:w,addError:N}=D(),{realm:y,realmRepresentation:T}=_(),[A,x]=$(!0),g=(L().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(n=>n.id===t);q(async()=>{if(o)return await r.components.findOne({id:o})},n=>{if(n)z(n,m);else if(o)throw new Error(a("notFound"));x(!1)},[]);const h=async n=>{const S=J({...n,config:Object.fromEntries(Object.entries(n.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:T?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(F({realm:y}))),i({...n}),w(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),K.success)}catch(p){N(o?"userProviderSaveError":"createUserProviderError",p)}};return A?e(G,{}):l(U,{...c,children:[e(Q,{provider:t,save:()=>s(h)()}),e(R,{variant:"light",children:l(Z,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(h),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(W,{properties:g?.properties||[]}),g?.metadata.synchronizable&&e(ee,{}),e(X,{form:c,unWrap:!0}),l(Y,{children:[e(k,{isDisabled:!V,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(k,{variant:"link",component:n=>e(B,{...n,to:F({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{Fe as default};
//# sourceMappingURL=CustomProviderSettings-vGqZ48PS.js.map
