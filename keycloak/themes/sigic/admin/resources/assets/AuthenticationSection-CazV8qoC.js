import{jsx as e,jsxs as h,Fragment as E}from"react/jsx-runtime";import{u as _,a as C,V as H,l as U,j as ae,M as we,m as ve,F as Me,n as K,A as B,h as w,B as D,o as ie,p as ne,q as O,d as k,y as le,S as Q,r as re,s as Ie,v as Ce,x as Se,z as J,C as Te,w as Re,E as Ee,G as Z,H as Ve,I as $e,P as V,$ as Y,Y as z,J as Le,K as q,N as ee,R as ce,O as M,Q as de,U as Ue,W as Ke,X as _e,Z as Be,_ as Ge,a0 as ue,a1 as je,a2 as me,a3 as Ye,a4 as ze,a5 as We,e as ke,a6 as Xe,a7 as Qe,T as Ne,a8 as Je,a9 as Ze,aa as et,ab as tt,ac as at,ad as it,ae as nt,af as lt,ag as ot,ah as st,ai as rt,aj as ct,ak as dt,al as ut,am as pe,f as mt,L as xe,an as pt,ao as ht,ap as bt}from"./main-Dml5vH_M.js";import{useState as R,useEffect as oe,useMemo as Oe}from"react";import{u as yt}from"./ConfirmDialog-BN0phSta.js";import{u as ft,R as At}from"./RoutableTabs-D0MTj5jQ.js";import{V as gt}from"./ViewHeader-CnGpO8mW.js";import{u as De,m as Pt}from"./useLocaleSort-DeXbTEE9.js";import{C as wt,R as vt,D as It,B as Ct}from"./DuplicateFlowModal-DimyBdGI.js";import{D as St}from"./DraggableTable-BE0KF6sy.js";import{D as Tt}from"./DynamicComponents-Cxsqsl9R.js";import{T as Rt}from"./trash-icon-sFYD2cXL.js";import{f as Et}from"./AddRoleMappingModal-FlNvMd3n.js";import{F as W}from"./FormAccess-Dgk035ov.js";import{T as He}from"./TimeSelectorControl-DHH4w5Wh.js";import{M as he}from"./MultiLineInput-BnUu5qtj.js";import{Q as _t}from"./question-circle-icon-CcYP0FMt.js";import{T as kt,a as N,b as x}from"./Tabs-swfKYDgo.js";import{T as Nt}from"./Trans-BHLWmjXF.js";import{s as xt}from"./sortBy-D3c44bb2.js";import"react-dom";import"./PageHandler-BQ1_55gR.js";import"./useParams-Cmi1OAEj.js";import"./constants-BclHbWtx.js";import"./NameDescription-J_2q-E71.js";import"./DataListItemRow-B3J1tfyO.js";import"./ClientSelect-DJq4F1jh.js";import"./FileUpload-B3CkDAbJ.js";import"./GroupPickerDialog-eQJqBPQt.js";import"./KeySelect-Ba6sDuzD.js";import"./CodeEditor-C7HQ48Ys.js";import"./translationFormatter-DtFomvax.js";import"./filter-icon-BO7Evf9d.js";import"./TimeSelector-jOZGz2AQ.js";import"./_baseFlatten-BhRqdSvr.js";const Ot=({requiredAction:n,onClose:i})=>{const{adminClient:l}=_(),{t}=C(),{addAlert:a,addError:s}=H(),[u,r]=R(),b=U(),{setValue:f,handleSubmit:p}=b,g=m=>{ie(m||{},f)};ae(async()=>{const m=await l.authenticationManagement.getRequiredActionConfigDescription({alias:n.alias}),y=await l.authenticationManagement.getRequiredActionConfig({alias:n.alias});return m.properties=[...m.properties],{configDescription:m,config:y}},({configDescription:m,config:y})=>{r(m),g(y)},[]);const v=async m=>{const y=ne(m);try{await l.authenticationManagement.updateRequiredActionConfig({alias:n.alias},y),g(y),a(t("configSaveSuccess"),O.success),i()}catch(I){s("configSaveError",I)}};return e(we,{variant:ve.small,isOpen:!0,title:t("requiredActionConfig",{name:n.name}),onClose:i,children:h(Me,{id:"required-action-config-form",onSubmit:p(v),children:[e(K,{...b,children:e(Tt,{stringify:!0,properties:u?.properties||[]})}),h(B,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",children:t("save")}),e(w,{"data-testid":"cancel",variant:D.link,onClick:i,children:t("cancel")}),h(w,{className:"pf-v5-u-ml-3xl","data-testid":"clear",variant:D.link,onClick:async()=>{await l.authenticationManagement.removeRequiredActionConfig({alias:n.alias}),b.reset({}),i()},children:[t("clear")," ",e(Rt,{})]})]})]})})},Dt=()=>{const{adminClient:n}=_(),{t:i}=C(),{addAlert:l,addError:t}=H(),[a,s]=R(),[u,r]=R(),[b,f]=R(0),p=()=>f(b+1),{realm:g}=k(),v=async()=>await(await Ie(`${Se(n.baseUrl)}admin/realms/${g}/ui-ext/authentication-management/required-actions`,{method:"GET",headers:Ce(await n.getAccessToken())})).json();ae(async()=>{const[o,A]=await Promise.all([v(),n.authenticationManagement.getUnregisteredRequiredActions()]);return[...o.map(d=>({name:d.name,enabled:d.enabled,defaultAction:d.defaultAction,data:d})),...A.map(d=>({name:d.name,enabled:!1,defaultAction:!1,data:d}))]},o=>s(o),[b]);const m=o=>!("alias"in o),y=async(o,A)=>{try{A in o?(o[A]=!o[A],delete o.configurable,await n.authenticationManagement.updateRequiredAction({alias:o.alias},o)):m(o)&&await n.authenticationManagement.registerRequiredAction({name:o.name,providerId:o.providerId}),p(),l(i("updatedRequiredActionSuccess"),O.success)}catch(d){t("updatedRequiredActionError",d)}},I=async(o,A)=>{try{const d=o.alias;for(let c=0;c<Math.abs(A);c++)A>0?await n.authenticationManagement.lowerRequiredActionPriority({alias:d}):await n.authenticationManagement.raiseRequiredActionPriority({alias:d});p(),l(i("updatedRequiredActionSuccess"),O.success)}catch(d){t("updatedRequiredActionError",d)}};return a?h(E,{children:[u&&e(Ot,{requiredAction:u,onClose:()=>r(void 0)}),e(St,{keyField:"name",onDragFinish:async(o,A)=>{const d=a.map(P=>P.name),c=A.indexOf(o),S=d.indexOf(o),T=a[S].data;if(!T.alias)return;const $=c-S;I(T,$)},columns:[{name:"name",displayKey:"action",width:50},{name:"enabled",displayKey:"enabled",cellRenderer:o=>e(Q,{id:`enable-${re(o.name||"")}`,label:i("on"),labelOff:i("off"),isChecked:o.enabled,onChange:()=>{y(o.data,"enabled")},"aria-label":o.name}),width:20},{name:"default",displayKey:"setAsDefaultAction",thTooltipText:"authDefaultActionTooltip",cellRenderer:o=>e(Q,{id:`default-${re(o.name||"")}`,label:i("on"),isDisabled:!o.enabled,labelOff:o.enabled?i("off"):i("disabledOff"),isChecked:o.defaultAction,onChange:()=>{y(o.data,"defaultAction")},"aria-label":o.name}),width:20},{name:"config",displayKey:"configure",cellRenderer:o=>o.data.configurable?e(w,{variant:"plain","aria-label":i("settings"),onClick:()=>r(o.data),children:e(wt,{})}):void 0,width:10}],data:a})]}):e(le,{})},Ht="_label_1u2bs_1",te={label:Ht},X=({label:n})=>h(E,{children:[e($e,{className:te.label})," ",n]}),Ft=({id:n,isSpecificClient:i,onClose:l})=>{const{adminClient:t}=_(),{t:a}=C(),s=async(u,r,b)=>(await Et(t,{id:n,type:i?"clients":"idp",first:u||0,max:r||10,search:b})).map(p=>({name:p}));return e(we,{header:h(Ee,{children:[e(Z,{component:Ve.h1,children:a("flowUsedBy")}),e(Z,{children:a("flowUsedByDescription",{value:a(i?"clients":"identiyProviders")})})]}),variant:ve.medium,isOpen:!0,onClose:l,actions:[e(w,{"data-testid":"cancel",id:"modal-cancel",onClick:l,children:a("close")},"cancel")],children:e(Re,{loader:s,isPaginated:!0,ariaLabelKey:"usedBy",searchPlaceholderKey:"search",columns:[{name:"name"}]})})},qt=({authType:{id:n,usedBy:i}})=>{const{t:l}=C(),{realmRepresentation:t}=k(),[a,s]=J(),u=Object.entries(t).find(r=>r[1]===i?.values[0])?.[0];return h(E,{children:[a&&e(Ft,{id:n,onClose:s,isSpecificClient:i?.type==="SPECIFIC_CLIENTS"}),(i?.type==="SPECIFIC_PROVIDERS"||i?.type==="SPECIFIC_CLIENTS")&&(i.values.length<=8?e(Te,{"aria-label":l("usedBy"),bodyContent:h("div",{children:[l("appliedBy"+(i.type==="SPECIFIC_CLIENTS"?"Clients":"Providers"))," ",i.values.map((r,b)=>h(E,{children:[e("strong",{children:r}),b<i.values.length-1?", ":""]}))]},`usedBy-${n}-${i.values}`),children:e(w,{variant:"link",className:te.label,children:e(X,{label:l(`used.${i.type}`)})})},n):e(w,{variant:"link",className:te.label,onClick:s,children:e(X,{label:l(`used.${i.type}`)})})),i?.type==="DEFAULT"&&e(X,{label:l(`flow.${vt.get(u)}`)}),!i?.type&&l("used.notInUse")]})},Mt=["poll","ping"],G=10,j=600,be=0,ye=600,Vt=({realm:n,realmUpdated:i})=>{const{adminClient:l}=_(),{t}=C(),a=U({mode:"onChange"}),{realm:s}=k(),{addAlert:u,addError:r}=H(),b=p=>ie(p,a.setValue);oe(()=>b(n),[]);const f=async p=>{try{await l.realms.update({realm:s},ne(p));const g=await l.realms.findOne({realm:s});i(g),b(g),u(t("updateCibaSuccess"),O.success)}catch(g){r("updateCibaError",g)}};return e(V,{variant:"light",children:h(W,{role:"manage-realm",isHorizontal:!0,onSubmit:a.handleSubmit(f),children:[h(K,{...a,children:[e(Y,{name:"attributes.cibaBackchannelTokenDeliveryMode",label:t("cibaBackchannelTokenDeliveryMode"),labelIcon:t("cibaBackchannelTokenDeliveryModeHelp"),options:Mt.map(p=>({key:p,value:t(`cibaBackhannelTokenDeliveryModes.${p}`)})),controller:{defaultValue:""}}),e(z,{name:"attributes.cibaExpiresIn",type:"number",min:G,max:j,label:t("cibaExpiresIn"),labelIcon:t("cibaExpiresInHelp"),rules:{min:{value:G,message:t("greaterThan",{value:G})},max:{value:j,message:t("lessThan",{value:j})},required:t("required")}}),e(z,{name:"attributes.cibaInterval",type:"number",min:G,max:j,label:t("cibaInterval"),labelIcon:t("cibaIntervalHelp"),rules:{min:{value:be,message:t("greaterThan",{value:be})},max:{value:ye,message:t("lessThan",{value:ye})},required:t("required")}}),e(Y,{name:"attributes.cibaAuthRequestedUserHint",label:t("cibaAuthRequestedUserHint"),labelIcon:t("cibaAuthRequestedUserHintHelp"),options:["login_hint","id_token_hint","login_hint_token"],controller:{defaultValue:""},isDisabled:!0})]}),h(B,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!a.formState.isValid||!a.formState.isDirty,children:t("save")}),e(w,{"data-testid":"reload",variant:D.link,onClick:()=>b({...n}),children:t("reload")})]})]})})},F=["totp","hotp"],fe=["SHA1","SHA256","SHA512"],Ae=[6,8],$t=({realm:n,realmUpdated:i})=>{const{adminClient:l}=_(),{t}=C(),a=U({mode:"onChange"}),{control:s,reset:u,handleSubmit:r,formState:{isValid:b,isDirty:f}}=a,{realm:p}=k(),{addAlert:g,addError:v}=H(),m=De(),y=Le({name:"otpPolicyType",control:s,defaultValue:F[0]}),I=d=>u(d),o=Oe(()=>{const d=(n.otpSupportedApplications??[]).map(c=>t(`otpSupportedApplications.${c}`));return m(d,c=>c)},[n.otpSupportedApplications]);return e(V,{variant:"light",children:e(W,{role:"manage-realm",isHorizontal:!0,onSubmit:r(async d=>{try{await l.realms.update({realm:p},d);const c=await l.realms.findOne({realm:p});i(c),I(c),g(t("updateOtpSuccess"),O.success)}catch(c){v("updateOtpError",c)}}),className:"keycloak__otp_policies_authentication__form",children:h(K,{...a,children:[e(q,{label:t("otpType"),labelIcon:e(M,{helpText:t("otpTypeHelp"),fieldLabelId:"otpType"}),hasNoPaddingTop:!0,children:e(ee,{name:"otpPolicyType","data-testid":"otpPolicyType",defaultValue:F[0],control:s,render:({field:d})=>e(E,{children:F.map(c=>e(ce,{id:c,"data-testid":c,isChecked:d.value===c,name:"otpPolicyType",onChange:()=>d.onChange(c),label:t(`policyType.${c}`),className:"keycloak__otp_policies_authentication__policy-type"},c))})})}),e(Y,{name:"otpPolicyAlgorithm",label:t("otpHashAlgorithm"),labelIcon:t("otpHashAlgorithmHelp"),options:fe.map(d=>({key:`Hmac${d}`,value:d})),controller:{defaultValue:`Hmac${fe[0]}`}}),e(q,{label:t("otpPolicyDigits"),labelIcon:e(M,{helpText:t("otpPolicyDigitsHelp"),fieldLabelId:"otpPolicyDigits"}),hasNoPaddingTop:!0,children:e(ee,{name:"otpPolicyDigits","data-testid":"otpPolicyDigits",defaultValue:Ae[0],control:s,render:({field:d})=>e(E,{children:Ae.map(c=>e(ce,{id:`digit-${c}`,"data-testid":`digit-${c}`,isChecked:d.value===c,name:"otpPolicyDigits",onChange:()=>d.onChange(c),label:c,className:"keycloak__otp_policies_authentication__number-of-digits"},c))})})}),e(de,{name:"otpPolicyLookAheadWindow",label:t("lookAround"),labelIcon:t("lookAroundHelp"),controller:{defaultValue:1,rules:{min:0}}}),y===F[0]&&e(He,{name:"otpPolicyPeriod",label:t("otpPolicyPeriod"),labelIcon:t("otpPolicyPeriodHelp"),units:["second","minute"],controller:{defaultValue:30,rules:{min:1,max:{value:120,message:t("maxLength",{length:"2 "+t("minutes")})}}}}),y===F[1]&&e(de,{name:"otpPolicyInitialCounter",label:t("initialCounter"),labelIcon:t("initialCounterHelp"),controller:{defaultValue:30,rules:{min:1,max:120}}}),e(q,{label:t("supportedApplications"),labelIcon:e(M,{helpText:t("supportedApplicationsHelp"),fieldLabelId:"supportedApplications"}),children:e("span",{"data-testid":"supportedApplications",children:e(Ue,{children:o.map(d=>e(Ke,{isReadOnly:!0,children:d},d))})})}),y===F[0]&&e(_e,{name:"otpPolicyCodeReusable",label:t("otpPolicyCodeReusable"),labelIcon:t("otpPolicyCodeReusableHelp"),labelOn:t("on"),labelOff:t("off")}),h(B,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!b||!f,children:t("save")}),e(w,{"data-testid":"reload",variant:D.link,onClick:()=>u({...n}),children:t("reload")})]})]})})})},Lt=({policy:{id:n,configType:i,defaultValue:l,displayName:t},onRemove:a})=>{const{t:s}=C(),{control:u,register:r,formState:{errors:b}}=Be(),f=b[n];return h(q,{label:t,fieldId:n,isRequired:!0,labelIcon:e(M,{helpText:s(`passwordPoliciesHelp.${n}`),fieldLabelId:n}),children:[h(Ge,{children:[h(ue,{isFilled:!0,children:[i&&i!=="int"&&e(je,{id:n,"data-testid":n,...r(n,{required:!0}),defaultValue:l,validated:f?me.error:me.default}),i==="int"&&e(ee,{name:n,defaultValue:Number.parseInt(l||"0"),control:u,render:({field:p})=>{const v=y=>p.onChange(Math.max(y,0)),m=Number(p.value);return e(Ye,{id:n,value:m,min:0,onPlus:()=>v(m+1),onMinus:()=>v(m-1),onChange:y=>{const I=Number(y.currentTarget.value);v(isNaN(I)?0:I)},className:"keycloak__policies_authentication__number-field"})}}),!i&&e(Q,{id:n,label:s("on"),labelOff:s("off"),isChecked:!0,isDisabled:!0,"aria-label":t})]}),e(ue,{children:e(w,{"data-testid":`remove-${n}`,variant:"link",className:"keycloak__policies_authentication__minus-icon",onClick:()=>a(n),"aria-label":s("remove"),children:e(ze,{})})})]}),f&&e(We,{message:s("required")})]})},Fe=" and ",Ut=(n,i)=>n.map(l=>`${l.id}(${i[l.id]})`).join(Fe),Kt=(n,i)=>n.split(Fe).map(Bt).reduce((l,{id:t,value:a})=>{const s=i.find(u=>u.id===t);return s?l.concat({...s,value:a}):l},[]);function Bt(n){const i=n.indexOf("(");if(i===-1)return{id:n.trim()};const l=n.substring(0,i).trim(),t=n.lastIndexOf(")");if(t===-1)return{id:l};const a=n.substring(i+1,t).trim();return{id:l,value:a}}const ge=({onSelect:n,selectedPolicies:i})=>{const{t:l}=C(),{passwordPolicies:t}=ke(),[a,s]=R(!1),u=Oe(()=>t?.filter(r=>i.find(b=>b.id===r.id)===void 0),[i]);return e(ot,{onSelect:(r,b)=>{n(b),s(!1)},toggle:r=>e(ct,{ref:r,onClick:()=>s(!a),isExpanded:a,isDisabled:u?.length===0,style:{width:"300px"},"data-testid":"add-policy",children:l("addPolicy")}),isOpen:a,children:e(st,{children:u?.map(r=>e(rt,{value:r,children:r.displayName},r.id))})})},Gt=({realm:n,realmUpdated:i})=>{const{adminClient:l}=_(),{t}=C(),{passwordPolicies:a}=ke(),{addAlert:s,addError:u}=H(),{realm:r,refresh:b}=k(),[f,p]=R([]),g=c=>{p([...f,c]),y(c.id,c.defaultValue,{shouldDirty:!0})},v=U({defaultValues:{}}),{handleSubmit:m,setValue:y,reset:I,formState:{isDirty:o}}=v,A=c=>{I();const S=Kt(c.passwordPolicy||"",a);S.forEach(T=>{y(T.id,T.value)}),p(S)};oe(()=>A(n),[]);const d=async c=>{const S={...n,passwordPolicy:Ut(f,c)};try{await l.realms.update({realm:r},S),i(S),A(S),b(),s(t("updatePasswordPolicySuccess"),O.success)}catch(T){u("updatePasswordPolicyError",T)}};return h(V,{variant:"light",className:"pf-v5-u-p-0",children:[(f.length!==0||n.passwordPolicy)&&h(E,{children:[e(Xe,{children:e(Qe,{children:e(Ne,{children:e(ge,{onSelect:g,selectedPolicies:f})})})}),e(Je,{}),e(V,{variant:"light",children:e(K,{...v,children:h(W,{className:"keycloak__policies_authentication__form",role:"manage-realm",isHorizontal:!0,onSubmit:m(d),children:[f.map((c,S)=>e(Lt,{policy:c,onRemove:T=>{p(f.filter($=>$.id!==T)),y(c.id,"",{shouldDirty:!0})}},`${c.id}-${S}`)),h(B,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!o,children:t("save")}),e(w,{"data-testid":"reload",variant:D.link,onClick:()=>A(n),children:t("reload")})]})]})})})]}),!f.length&&!n.passwordPolicy&&h(Ze,{"data-testid":"empty-state",variant:"lg",children:[e(et,{titleText:e(E,{children:t("noPasswordPolicies")}),icon:e(tt,{icon:at}),headingLevel:"h1"}),e(it,{children:t("noPasswordPoliciesInstructions")}),e(nt,{children:e(lt,{children:e(ge,{onSelect:g,selectedPolicies:[]})})})]})]})},jt=["ES256","ES384","ES512","RS256","RS384","RS512","Ed25519","RS1"],Yt=["not specified","none","indirect","direct"],zt=["not specified","platform","cross-platform"],Wt=["not specified","Yes","No"],Xt=["not specified","required","preferred","discouraged"],L=({name:n,label:i,labelIcon:l,options:t,labelPrefix:a,isMultiSelect:s=!1})=>{const{t:u}=C();return e(Y,{name:n,label:i,labelIcon:l,variant:s?"typeaheadMulti":"single",controller:{defaultValue:t[0]},options:t.map(r=>({key:r,value:a?u(`${a}.${r}`):r}))})},Pe=({realm:n,realmUpdated:i,isPasswordLess:l=!1})=>{const{adminClient:t}=_(),{t:a}=C(),{addAlert:s,addError:u}=H(),{realm:r}=k(),{enabled:b}=dt(),f=U({mode:"onChange"}),{setValue:p,handleSubmit:g,formState:{isDirty:v}}=f,m=l?"webAuthnPolicyPasswordless":"webAuthnPolicy",y=o=>ie(o,p);oe(()=>y(n),[]);const I=async o=>{const A=ne(o);try{await t.realms.update({realm:r},A),i(A),y(A),s(a("webAuthnUpdateSuccess"),O.success)}catch(d){u("webAuthnUpdateError",d)}};return h(V,{variant:"light",children:[b&&e(Te,{bodyContent:a(`${m}FormHelp`),children:e(Ee,{className:"keycloak__section_intro__help",children:h(Z,{children:[e(_t,{})," ",a("webauthnIntro")]})})}),h(W,{role:"manage-realm",isHorizontal:!0,onSubmit:g(I),className:"keycloak__webauthn_policies_authentication__form",children:[h(K,{...f,children:[e(z,{name:`${m}RpEntityName`,label:a("webAuthnPolicyRpEntityName"),labelIcon:a("webAuthnPolicyRpEntityNameHelp"),rules:{required:a("required")}}),e(L,{name:`${m}SignatureAlgorithms`,label:a("webAuthnPolicySignatureAlgorithms"),labelIcon:a("webAuthnPolicySignatureAlgorithmsHelp"),options:jt,isMultiSelect:!0}),e(z,{name:`${m}RpId`,label:a("webAuthnPolicyRpId"),labelIcon:a("webAuthnPolicyRpIdHelp")}),e(L,{name:`${m}AttestationConveyancePreference`,label:a("webAuthnPolicyAttestationConveyancePreference"),labelIcon:a("webAuthnPolicyAttestationConveyancePreferenceHelp"),options:Yt,labelPrefix:"attestationPreference"}),e(L,{name:`${m}AuthenticatorAttachment`,label:a("webAuthnPolicyAuthenticatorAttachment"),labelIcon:a("webAuthnPolicyAuthenticatorAttachmentHelp"),options:zt,labelPrefix:"authenticatorAttachment"}),e(L,{name:`${m}RequireResidentKey`,label:a("webAuthnPolicyRequireResidentKey"),labelIcon:a("webAuthnPolicyRequireResidentKeyHelp"),options:Wt,labelPrefix:"residentKey"}),e(L,{name:`${m}UserVerificationRequirement`,label:a("webAuthnPolicyUserVerificationRequirement"),labelIcon:a("webAuthnPolicyUserVerificationRequirementHelp"),options:Xt,labelPrefix:"userVerify"}),e(He,{name:`${m}CreateTimeout`,label:a("webAuthnPolicyCreateTimeout"),labelIcon:a("webAuthnPolicyCreateTimeoutHelp"),units:["second","minute","hour"],controller:{defaultValue:0,rules:{min:0,max:{value:31536,message:a("webAuthnPolicyCreateTimeoutHint")}}}}),e(_e,{name:`${m}AvoidSameAuthenticatorRegister`,label:a("webAuthnPolicyAvoidSameAuthenticatorRegister"),labelIcon:a("webAuthnPolicyAvoidSameAuthenticatorRegisterHelp"),labelOn:a("on"),labelOff:a("off")}),e(q,{label:a("webAuthnPolicyAcceptableAaguids"),fieldId:"webAuthnPolicyAcceptableAaguids",labelIcon:e(M,{helpText:a("webAuthnPolicyAcceptableAaguidsHelp"),fieldLabelId:"webAuthnPolicyAcceptableAaguids"}),children:e(he,{name:`${m}AcceptableAaguids`,"aria-label":a("webAuthnPolicyAcceptableAaguids"),addButtonLabel:"addAaguids"})}),e(q,{label:a("webAuthnPolicyExtraOrigins"),fieldId:"webAuthnPolicyExtraOrigins",labelIcon:e(M,{helpText:a("webAuthnPolicyExtraOriginsHelp"),fieldLabelId:"webAuthnPolicyExtraOrigins"}),children:e(he,{name:`${m}ExtraOrigins`,"aria-label":a("webAuthnPolicyExtraOrigins"),addButtonLabel:"addOrigins"})})]}),h(B,{children:[e(w,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!v,children:a("save")}),e(w,{"data-testid":"reload",variant:D.link,onClick:()=>y(n),children:a("reload")})]})]})]})},Qt=()=>{const{adminClient:n}=_(),{t:i}=C(),[l,t]=R(1),{realm:a}=k(),[s,u]=R();return ae(async()=>{const r=await n.realms.findOne({realm:a});if(!r)throw new Error(i("notFound"));return r},r=>{u(r)},[]),s?h(kt,{activeKey:l,onSelect:(r,b)=>t(b),mountOnEnter:!0,unmountOnExit:!0,children:[e(N,{id:"passwordPolicy","data-testid":"passwordPolicy",eventKey:1,title:e(x,{children:i("passwordPolicy")}),children:e(Gt,{realm:s,realmUpdated:u})}),e(N,{id:"otpPolicy","data-testid":"otpPolicy",eventKey:2,title:e(x,{children:i("otpPolicy")}),children:e($t,{realm:s,realmUpdated:u})}),e(N,{id:"webauthnPolicy","data-testid":"webauthnPolicy",eventKey:3,title:e(x,{children:i("webauthnPolicy")}),children:e(Pe,{realm:s,realmUpdated:u})}),e(N,{id:"webauthnPasswordlessPolicy","data-testid":"webauthnPasswordlessPolicy",eventKey:4,title:e(x,{children:i("webauthnPasswordlessPolicy")}),children:e(Pe,{realm:s,realmUpdated:u,isPasswordLess:!0})}),e(N,{"data-testid":"tab-ciba-policy",eventKey:5,title:e(x,{children:i("cibaPolicy")}),children:e(Vt,{realm:s,realmUpdated:u})})]}):e(le,{})},Jt=({id:n,alias:i,usedBy:l,builtIn:t})=>{const{t:a}=C(),{realm:s}=k();return h(E,{children:[e(xe,{to:ht({realm:s,id:n,usedBy:l?.type||"notInUse",builtIn:t?"builtIn":void 0}),children:i},`link-${n}`)," ",t&&e(bt,{children:a("buildIn")},`label-${n}`)]})};function Oa(){const{adminClient:n}=_(),{t:i}=C(),{realm:l,realmRepresentation:t}=k(),[a,s]=R(0),u=()=>s(a+1),{addAlert:r,addError:b}=H(),f=De(),[p,g]=R(),[v,m]=J(),[y,I]=J(),o=async()=>{const se=await(await Ie(`${Se(n.baseUrl)}admin/realms/${l}/ui-ext/authentication-management/flows`,{method:"GET",headers:Ce(await n.getAccessToken())})).json();return se?xt(f(se,Pt("alias")),qe=>qe.usedBy?.type):[]},A=P=>ft(pe({realm:l,tab:P})),d=A("flows"),c=A("required-actions"),S=A("policies"),[T,$]=yt({titleKey:"deleteConfirmFlow",children:h(Nt,{i18nKey:"deleteConfirmFlowMessage",children:[" ",e("strong",{children:{flow:p?p.alias:""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:D.danger,onConfirm:async()=>{try{await n.authenticationManagement.deleteFlow({flowId:p.id}),u(),r(i("deleteFlowSuccess"),O.success)}catch(P){b("deleteFlowError",P)}}});return t?h(E,{children:[e($,{}),v&&e(It,{name:p?p.alias:"",description:p?.description,toggleDialog:m,onComplete:()=>{u(),m()}}),y&&e(Ct,{onClose:()=>{I(),u()},flowAlias:p?.alias}),e(gt,{titleKey:"titleAuthentication",subKey:"authenticationExplain",helpUrl:ut.authenticationUrl,divider:!1}),e(V,{variant:"light",className:"pf-v5-u-p-0",children:h(At,{isBox:!0,defaultLocation:pe({realm:l,tab:"flows"}),children:[e(N,{"data-testid":"flows",title:e(x,{children:i("flows")}),...d,children:e(Re,{loader:o,ariaLabelKey:"titleAuthentication",searchPlaceholderKey:"searchForFlow",toolbarItem:e(Ne,{children:e(w,{component:P=>e(xe,{...P,to:pt({realm:l})}),children:i("createFlow")})}),actionResolver:({data:P})=>[{title:i("duplicate"),onClick:()=>{m(),g(P)}},...P.usedBy?.type!=="DEFAULT"?[{title:i("bindFlow"),onClick:()=>{I(),g(P)}}]:[],...!P.builtIn&&!P.usedBy?[{title:i("delete"),onClick:()=>{g(P),T()}}]:[]],columns:[{name:"alias",displayKey:"flowName",cellRenderer:P=>e(Jt,{...P})},{name:"usedBy",displayKey:"usedBy",cellRenderer:P=>e(qt,{authType:P})},{name:"description",displayKey:"description"}],emptyState:e(mt,{message:i("emptyEvents"),instructions:i("emptyEventsInstructions")})},a)}),e(N,{"data-testid":"requiredActions",title:e(x,{children:i("requiredActions")}),...c,children:e(Dt,{})}),e(N,{"data-testid":"policies",title:e(x,{children:i("policies")}),...S,children:e(Qt,{})})]})})]}):e(le,{})}export{Oa as default};
//# sourceMappingURL=AuthenticationSection-CazV8qoC.js.map
