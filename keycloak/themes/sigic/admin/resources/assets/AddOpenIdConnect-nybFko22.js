import{jsxs as d,Fragment as v,jsx as e}from"react/jsx-runtime";import{u as h,a as g,Z as F,aA as P,K as S,a5 as b,O as k,b as D,cu as E,l as O,V as A,d as x,P as V,n as w,A as L,h as f,L as U,cH as H,q as K,cI as T}from"./main-Dml5vH_M.js";import{F as j}from"./FormAccess-Dgk035ov.js";import{V as G}from"./ViewHeader-CnGpO8mW.js";import{D as J,O as N,a as _}from"./OIDCGeneralSettings-CzsQFNx1.js";import{J as q}from"./JsonFileUpload-BQS_emFV.js";import{D as z}from"./DiscoveryEndpointField-CNI2Maam.js";import"react";import"react-dom";import"./SwitchControl-DVIXTwQM.js";/* empty css                           */import"./ExpandableSection-CRQBD4mp.js";import"./ClientIdSecret-CkCa_19T.js";import"./RedirectUrl-D3h2eZTv.js";import"./FileUploadForm-C-SwY-TA.js";import"./CodeEditor-C7HQ48Ys.js";import"./FileUpload-B3CkDAbJ.js";const B=()=>{const{adminClient:l}=h(),{t}=g(),m="oidc",{setValue:p,setError:c,clearErrors:n,formState:{errors:o}}=F(),u=r=>{Object.keys(r).map(i=>p(`config.${i}`,r[i]))},y=async r=>{if(n("discoveryError"),!r)return;const i=new FormData;i.append("providerId",m),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await l.identityProviders.importFromUrl(i);u(a)}catch(a){c("discoveryError",{type:"manual",message:a.message})}};return d(v,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(z,{id:"oidc",fileUpload:d(S,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(k,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(q,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>y(r)}),o.discoveryError&&e(b,{message:o.discoveryError.message})]}),children:r=>e(J,{readOnly:r})})]})};function ce(){const{adminClient:l}=h(),{t}=g(),m=D(),{pathname:p}=E(),c=p.includes("keycloak-oidc"),n=`${c?"keycloak-":""}oidc`,o=O({defaultValues:{alias:n},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:y}}=o,{addAlert:r,addError:i}=A(),{realm:a}=x(),I=async s=>{delete s.discoveryEndpoint;try{await l.identityProviders.create({...s,providerId:n}),r(t("createIdentityProviderSuccess"),K.success),m(T({realm:a,providerId:n,alias:s.alias,tab:"settings"}))}catch(C){i("createIdentityProviderError",C)}};return d(v,{children:[e(G,{titleKey:t(c?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(V,{variant:"light",children:e(w,{...o,children:d(j,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(I),children:[e(N,{}),e(B,{}),e(_,{}),d(L,{children:[e(f,{isDisabled:!y,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:s=>e(U,{...s,to:H({realm:a})}),children:t("cancel")})]})]})})})]})}export{ce as default};
//# sourceMappingURL=AddOpenIdConnect-nybFko22.js.map
