import{jsx as e,jsxs as H,Fragment as ye}from"react/jsx-runtime";import{as as bn,ar as vn,es as yn,et as kn,eu as _n,ev as wn,ew as Cn,de as Tn,dE as Va,dF as Sn,cp as xn,dd as In,ex as En,dH as An,ey as Ln,cr as Pn,u as Se,cX as Pt,j as et,a as ue,V as Oe,l as He,z as ct,J as We,P as Ce,n as $e,bN as ze,Y as Ae,ez as ea,K as se,N as fe,ca as Wt,X as Ha,R as gt,bK as Ca,aS as dt,eA as Rn,L as Fe,bR as Dn,A as Ue,h as oe,q as Ee,d as Te,y as tt,b$ as ma,a$ as Yt,b0 as pt,a5 as On,b1 as Ft,$ as Me,O as he,c0 as Zt,x as ta,o as Rt,S as Re,M as ut,m as bt,E as yt,G as Ge,F as kt,B as Ie,bf as zn,bd as vt,a8 as at,bn as Ze,w as nt,ai as Le,ap as qt,b as _t,ay as Xt,az as Ve,aA as Ka,em as Nn,T as Be,eB as Ta,f as qe,el as ca,eC as Fn,ep as Bn,Z as wt,eD as Bt,aE as Un,eE as Mn,a1 as Dt,eF as Vn,eG as Hn,bu as ja,bv as da,e as ht,eH as Ut,eI as Sa,bY as Ga,bh as Kn,bo as Qe,a3 as xa,dX as jn,dC as Gn,dD as Wn,H as pa,ef as Mt,ak as Zn,aO as ga,C as qn,eJ as Ia,aI as Wa,aJ as Za,D as At,aj as qa,aW as $a,bk as $n,aT as it,aU as Vt,eK as ua,eL as ba,a6 as Ja,bt as Jn,bw as Ya,eM as Yn,U as xt,W as ft,eg as Xe,ek as je,ei as aa,ax as Xn,aM as Qn,bm as er,au as Ea,aG as Ht,aN as tr,aL as Kt,eN as ar,di as nr,dt as rr,bU as Aa,Q as na,eO as La,eP as ir,a7 as sr,cz as or,eQ as lr,eR as Pa,ee as Ra,cj as ra,aH as Da,ce as cr,al as dr,p as ur,s as hr,v as fr}from"./main-Dml5vH_M.js";import mr,{useState as J,useEffect as rt,useMemo as ot}from"react";import{u as De}from"./ConfirmDialog-BN0phSta.js";import{u as lt,R as Lt}from"./RoutableTabs-D0MTj5jQ.js";import{V as pr}from"./ViewHeader-CnGpO8mW.js";import{u as va}from"./useLocale-mdrT38Tm.js";import{F as _e,C as gr,S as Xa,a as Ye,b as Qa}from"./FormAccess-Dgk035ov.js";/* empty css                               */import{a as ia}from"./KeySelect-Ba6sDuzD.js";import{U as It}from"./userProfileMetadata-CFgHgJ2w.js";import{D as mt}from"./SwitchControl-DVIXTwQM.js";import{K as br}from"./KeyValueInput-CataZRq4.js";import{b as vr}from"./SamlSignature-CjZJlgs8.js";import{J as yr}from"./JsonFileUpload-BQS_emFV.js";import{D as en,a as tn,b as an,c as nn,d as ha}from"./DataListItemRow-B3J1tfyO.js";import{a as ya}from"./CodeEditor-C7HQ48Ys.js";import{t as rn}from"./translationFormatter-DtFomvax.js";import{b as kr}from"./_baseSlice-F8doVSIJ.js";import{b as _r}from"./_baseFlatten-BhRqdSvr.js";import{T as ke,t as wr}from"./TimeSelector-jOZGz2AQ.js";import{F as Cr}from"./FileUpload-B3CkDAbJ.js";import{T as Ot,a as me,b as pe}from"./Tabs-swfKYDgo.js";import{R as Tr}from"./AddRoleMappingModal-FlNvMd3n.js";import{G as Sr}from"./GroupPickerDialog-eQJqBPQt.js";import{T as $t}from"./Trans-BHLWmjXF.js";import{Q as xr}from"./question-circle-icon-CcYP0FMt.js";import{T as sn}from"./TimeSelectorControl-DHH4w5Wh.js";import{i as on}from"./isEqual-xoTijI-C.js";import{u as Ir}from"./useFormatDate-Puc65BKQ.js";import{F as ln}from"./filter-icon-BO7Evf9d.js";import{D as cn}from"./DraggableTable-BE0KF6sy.js";import{KeyProviderForm as Er}from"./KeyProviderForm-CjAOpode.js";import{D as Ar}from"./DropdownPanel-CdQAMxBj.js";import{u as Lr,m as Pr}from"./useLocaleSort-DeXbTEE9.js";import{p as Rr}from"./pickBy-BQkB_pck.js";import{M as Dr}from"./MenuGroup-DKiCuHRE.js";import{P as Or}from"./pencil-alt-icon-B3dGJCA1.js";import{u as ka,U as zr}from"./UserProfileContext-CAK45ckM.js";import"react-dom";import"./PageHandler-BQ1_55gR.js";import"./DynamicComponents-Cxsqsl9R.js";import"./ClientSelect-DJq4F1jh.js";import"./MultiLineInput-BnUu5qtj.js";import"./useParams-Cmi1OAEj.js";import"./constants-BclHbWtx.js";import"./FileUploadForm-C-SwY-TA.js";const fa=T=>{var{children:x,className:t,label:n}=T,u=bn(T,["children","className","label"]);return mr.createElement(Dr,Object.assign({className:vn(t),label:n},u),x)};fa.displayName="SelectGroup";function Nr(T){var x=T==null?0:T.length;return x?_r(T):[]}function Fr(T){return yn(kn(T,void 0,Nr),T+"")}var Br="[object Object]",Ur=Function.prototype,Mr=Object.prototype,dn=Ur.toString,Vr=Mr.hasOwnProperty,Hr=dn.call(Object);function Kr(T){if(!_n(T)||wn(T)!=Br)return!1;var x=Cn(T);if(x===null)return!0;var t=Vr.call(x,"constructor")&&x.constructor;return typeof t=="function"&&t instanceof t&&dn.call(t)==Hr}function jr(T,x){return x.length<2?T:Tn(T,kr(x,0,-1))}function Gr(T,x){return x=Va(x,T),T=jr(T,x),T==null||delete T[Sn(xn(x))]}function Wr(T){return Kr(T)?void 0:T}var Zr=1,qr=2,$r=4,un=Fr(function(T,x){var t={};if(T==null)return t;var n=!1;x=In(x,function(r){return r=Va(r,T),n||(n=r.length>1),r}),En(T,An(T),t),n&&(t=Ln(t,Zr|qr|$r,Wr));for(var u=x.length;u--;)Gr(t,x[u]);return t});function Jr(T,x){return x=typeof x=="function"?x:void 0,T&&T.length?Pn(T,void 0,x):[]}function Yr(){const{adminClient:T}=Se(),{whoAmI:x}=Pt(),[t,n]=J(),u=x.getUserId();return et(()=>T.users.findOne({id:u}),n,[u]),{...t,realm:x.getRealm()}}const Xr=({realm:T,save:x})=>{const{adminClient:t}=Se(),{t:n}=ue(),{addAlert:u,addError:r}=Oe(),d=Yr(),i=He({defaultValues:T}),{control:c,handleSubmit:m,watch:_,reset:k,getValues:y}=i,h=()=>k(T),p=_("smtpServer.from",""),s=_("smtpServer.host",""),[f,o]=ct(),g=We({control:c,name:"smtpServer.auth",defaultValue:T.smtpServer?.auth||"false"}),w=We({control:c,name:"smtpServer.authType",defaultValue:T.smtpServer?.authType||"basic"}),I=async()=>{const S=P=>Number(P),L=P=>P==="true",A=new Map([["port",S],["ssl",L],["starttls",L],["auth",L]]),O={...y().smtpServer};for(const[P,R]of A.entries())O[P]=R(O[P]);O.port===0&&(O.port=null);try{o(),await t.realms.testSMTPConnection({realm:T.realm},O),u(n("testConnectionSuccess"),Ee.success)}catch(P){r("testConnectionError",P)}o()};return e(Ce,{variant:"light",children:H($e,{...i,children:[e(ze,{title:n("template"),className:"kc-email-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:m(x),children:[e(Ae,{name:"smtpServer.from",label:n("from"),type:"email",placeholder:n("smtpFromPlaceholder"),rules:{pattern:{value:ea,message:n("emailInvalid")},required:n("required")}}),e(Ae,{name:"smtpServer.fromDisplayName",label:n("fromDisplayName"),labelIcon:n("fromDisplayNameHelp"),placeholder:n("smtpFromDisplayPlaceholder")}),e(Ae,{name:"smtpServer.replyTo",label:n("replyTo"),type:"email",placeholder:n("replyToEmailPlaceholder"),rules:{pattern:{value:ea,message:n("emailInvalid")}}}),e(Ae,{name:"smtpServer.replyToDisplayName",label:n("replyToDisplayName"),labelIcon:n("replyToDisplayNameHelp"),placeholder:n("replyToDisplayPlaceholder")}),e(Ae,{name:"smtpServer.envelopeFrom",label:n("envelopeFrom"),labelIcon:n("envelopeFromHelp"),placeholder:n("senderEnvelopePlaceholder")})]})}),e(ze,{className:"kc-email-connection",title:n("connectionAndAuthentication"),children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:m(x),children:[e(Ae,{name:"smtpServer.host",label:n("host"),rules:{required:n("required")}}),e(Ae,{name:"smtpServer.port",label:n("port"),placeholder:n("smtpPortPlaceholder")}),H(se,{label:n("encryption"),fieldId:"kc-html-display-name",children:[e(fe,{name:"smtpServer.ssl",control:c,defaultValue:"false",render:({field:S})=>e(Wt,{id:"kc-enable-ssl","data-testid":"enable-ssl",label:n("enableSSL"),isChecked:S.value==="true",onChange:(L,A)=>S.onChange(""+A)})}),e(fe,{name:"smtpServer.starttls",control:c,defaultValue:"false",render:({field:S})=>e(Wt,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",label:n("enableStartTLS"),isChecked:S.value==="true",onChange:(L,A)=>S.onChange(""+A)})})]}),e(Ha,{name:"smtpServer.auth",label:n("authentication"),"data-testid":"smtpServer.auth",defaultValue:"",labelOn:n("enabled"),labelOff:n("disabled"),stringify:!0}),g==="true"&&H(ye,{children:[e(Ae,{name:"smtpServer.user",label:n("username"),placeholder:n("loginUsernamePlaceholder"),rules:{required:n("required")}}),e(se,{label:n("authenticationType"),fieldId:"authType",children:e(fe,{name:"smtpServer.authType",control:c,defaultValue:"basic",render:({field:S})=>H(ye,{children:[e(gt,{id:"basicAuth",name:"smtpServer.authType","data-testid":"smtpServer.authType.basic",label:n("authenticationTypeBasicAuth"),value:"basic",isChecked:S.value==="basic",onChange:()=>S.onChange("basic")}),e(gt,{id:"tokenAuth",name:"smtpServer.authType","data-testid":"smtpServer.authType.token",label:n("authenticationTypeTokenAuth"),value:"token",isChecked:S.value==="token",onChange:()=>S.onChange("token")})]})})}),w==="basic"&&e(Ca,{name:"smtpServer.password",label:n("password"),labelIcon:n("passwordHelp"),rules:{required:n("required")}}),w==="token"&&H(ye,{children:[e(Ae,{name:"smtpServer.authTokenUrl",label:n("authTokenUrl"),helperText:n("tokenTokenUrlHelp"),rules:{required:n("required")}}),e(Ae,{name:"smtpServer.authTokenScope",label:n("authTokenScope"),helperText:n("authTokenScopeHelp"),rules:{required:n("required")}}),e(Ae,{name:"smtpServer.authTokenClientId",label:n("authTokenClientId"),helperText:n("authTokenClientIdHelp"),rules:{required:n("required")}}),e(Ca,{name:"smtpServer.authTokenClientSecret",label:n("authTokenClientSecret"),labelIcon:n("authTokenClientSecretHelp"),rules:{required:n("required")}})]})]}),e(fe,{name:"smtpServer.debug",control:c,defaultValue:"false",render:({field:S})=>e(Wt,{id:"kc-enable-debug","data-testid":"enable-debug",label:n("enableDebugSMTP"),isChecked:S.value==="true",onChange:(L,A)=>S.onChange(""+A)})}),d&&e(se,{id:"descriptionTestConnection",children:d.email?e(dt,{variant:"info",component:"h2",isInline:!0,title:n("testConnectionHint.withEmail",{email:d.email})}):e(dt,{variant:"warning",component:"h2",isInline:!0,title:n("testConnectionHint.withoutEmail",{userName:d.username}),actionLinks:e(Rn,{component:S=>e(Fe,{...S,to:Dn({realm:d.realm,id:d.id,tab:"settings"})}),children:n("testConnectionHint.withoutEmailAction")})})}),H(Ue,{children:[e(ia,{children:e(oe,{variant:"primary",type:"submit","data-testid":"email-tab-save",children:n("save")})}),e(ia,{children:e(oe,{variant:"secondary",onClick:()=>I(),"data-testid":"test-connection-button",isDisabled:!(ea.test(p)&&s)||!d?.email,"aria-describedby":"descriptionTestConnection",isLoading:f,spinnerAriaValueText:n("testingConnection"),children:n("testConnection")})}),e(ia,{children:e(oe,{variant:"link",onClick:h,"data-testid":"email-tab-revert",children:n("revert")})})]})]})})]})})},Qr=({realm:T,save:x})=>{const{adminClient:t}=Se(),{realm:n}=Te(),[u,r]=J();return et(()=>t.users.getProfile({realm:n}),d=>r(d),[]),u?e(ti,{realm:T,save:x,userProfileConfig:u}):e(tt,{})},ei=["all","external","none"],sa=[It.Disabled,It.Enabled,It.AdminView,It.AdminEdit];function ti({realm:T,save:x,userProfileConfig:t}){const{environment:{serverBaseUrl:n}}=ma(),{t:u}=ue(),{realm:r}=Te(),d=He(),{control:i,handleSubmit:c,setValue:m,formState:{errors:_}}=d,k=Yt(),y=k(pt.Organizations),h=k(pt.AdminFineGrainedAuthzV2),p=k(pt.OpenId4VCI),s=()=>{if(Rt(T,m),m("unmanagedAttributePolicy",t.unmanagedAttributePolicy||sa[0]),T.attributes?.["acr.loa.map"]){const o=Object.entries(JSON.parse(T.attributes["acr.loa.map"])).flatMap(([g,w])=>({key:g,value:w}));o.concat({key:"",value:""}),m(Ft("attributes.acr.loa.map"),o)}};rt(s,[]);const f=c(async({unmanagedAttributePolicy:o,...g})=>{const w={...t};o===It.Disabled?delete w.unmanagedAttributePolicy:w.unmanagedAttributePolicy=o,await x({...g,upConfig:w})});return e(Ce,{variant:"light",children:e($e,{...d,children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-u-mt-lg",onSubmit:f,children:[H(se,{label:u("realmName"),fieldId:"kc-realm-id",isRequired:!0,children:[e(fe,{name:"realm",control:i,rules:{required:{value:!0,message:u("required")}},defaultValue:"",render:({field:o})=>e(gr,{"data-testid":"realmName",onChange:o.onChange,children:o.value})}),_.realm&&e(On,{"data-testid":"realm-id-error",message:_.realm.message})]}),e(Ae,{name:"displayName",label:u("displayName")}),e(Ae,{name:"displayNameHtml",label:u("htmlDisplayName")}),e(Ae,{name:Ft("attributes.frontendUrl"),type:"url",label:u("frontendUrl"),labelIcon:u("frontendUrlHelp")}),e(Me,{name:"sslRequired",label:u("requireSsl"),labelIcon:u("requireSslHelp"),controller:{defaultValue:"none"},options:ei.map(o=>({key:o,value:u(`sslType.${o}`)}))}),e(se,{label:u("acrToLoAMapping"),fieldId:"acrToLoAMapping",labelIcon:e(he,{helpText:u("acrToLoAMappingHelp"),fieldLabelId:"acrToLoAMapping"}),children:e(br,{label:u("acrToLoAMapping"),name:Ft("attributes.acr.loa.map")})}),e(mt,{name:"userManagedAccessAllowed",label:u("userManagedAccess"),labelIcon:u("userManagedAccessHelp")}),y&&e(mt,{name:"organizationsEnabled",label:u("organizationsEnabled"),labelIcon:u("organizationsEnabledHelp")}),h&&e(mt,{name:"adminPermissionsEnabled",label:u("adminPermissionsEnabled"),labelIcon:u("adminPermissionsEnabledHelp")}),p&&e(mt,{name:"verifiableCredentialsEnabled",label:u("verifiableCredentialsEnabled"),labelIcon:u("verifiableCredentialsEnabledHelp")}),e(Me,{name:"unmanagedAttributePolicy",label:u("unmanagedAttributes"),labelIcon:u("unmanagedAttributesHelpText"),controller:{defaultValue:sa[0]},options:sa.map(o=>({key:o,value:u(`unmanagedAttributePolicy.${o}`)}))}),e(Me,{name:Ft("attributes.saml.signature.algorithm"),label:u("signatureAlgorithmIdentityProviderMetadata"),labelIcon:u("signatureAlgorithmIdentityProviderMetadataHelp"),controller:{defaultValue:""},options:[{key:"",value:u("choose")},...vr.map(o=>({key:o,value:o}))]}),e(se,{label:u("endpoints"),labelIcon:e(he,{helpText:u("endpointsHelp"),fieldLabelId:"endpoints"}),fieldId:"kc-endpoints",children:H(Xa,{children:[e(Ye,{children:e(Zt,{href:`${ta(n)}realms/${r}/.well-known/openid-configuration`,title:u("openIDEndpointConfiguration")})}),e(Ye,{children:e(Zt,{href:`${ta(n)}realms/${r}/protocol/saml/descriptor`,title:u("samlIdentityProviderMetadata")})}),p&&T.verifiableCredentialsEnabled&&e(Ye,{children:e(Zt,{href:`${ta(n)}realms/${r}/.well-known/openid-credential-issuer`,title:u("oid4vcIssuerMetadata")})})]})}),e(Qa,{name:"realmSettingsGeneralTab",reset:s,isSubmit:!0})]})})})}const ai=({realm:T,refresh:x})=>{const{adminClient:t}=Se(),{t:n}=ue(),{addAlert:u,addError:r}=Oe(),{realm:d}=Te(),i=async c=>{const m=Array.isArray(c)?Object.keys(c[0])[0]:Object.keys(c)[0];try{await t.realms.update({realm:d},Array.isArray(c)?c.reduce((_,k)=>Object.assign(_,k),T):Object.assign(T,c)),u(n("enableSwitchSuccess",{switch:n(m)})),x()}catch(_){r("enableSwitchError",_)}};return H(Ce,{variant:"light",children:[e(ze,{className:"kc-login-screen",title:n("loginScreenCustomization"),children:H(_e,{isHorizontal:!0,role:"manage-realm",children:[e(se,{label:n("registrationAllowed"),fieldId:"kc-user-reg",labelIcon:e(he,{helpText:n("userRegistrationHelpText"),fieldLabelId:"registrationAllowed"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-user-reg-switch","data-testid":"user-reg-switch",value:T.registrationAllowed?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.registrationAllowed,onChange:(c,m)=>{i({registrationAllowed:m})},"aria-label":n("registrationAllowed")})}),e(se,{label:n("resetPasswordAllowed"),fieldId:"kc-forgot-pw",labelIcon:e(he,{helpText:n("forgotPasswordHelpText"),fieldLabelId:"resetPasswordAllowed"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-forgot-pw-switch","data-testid":"forgot-pw-switch",name:"resetPasswordAllowed",value:T.resetPasswordAllowed?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.resetPasswordAllowed,onChange:(c,m)=>{i({resetPasswordAllowed:m})},"aria-label":n("resetPasswordAllowed")})}),e(se,{label:n("rememberMe"),fieldId:"kc-remember-me",labelIcon:e(he,{helpText:n("rememberMeHelpText"),fieldLabelId:"rememberMe"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-remember-me-switch","data-testid":"remember-me-switch",value:T.rememberMe?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.rememberMe,onChange:(c,m)=>{i({rememberMe:m})},"aria-label":n("rememberMe")})})]})}),e(ze,{className:"kc-email-settings",title:n("emailSettings"),children:H(_e,{isHorizontal:!0,role:"manage-realm",children:[e(se,{label:n("registrationEmailAsUsername"),fieldId:"kc-email-as-username",labelIcon:e(he,{helpText:n("emailAsUsernameHelpText"),fieldLabelId:"registrationEmailAsUsername"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-email-as-username-switch","data-testid":"email-as-username-switch",value:T.registrationEmailAsUsername?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.registrationEmailAsUsername,onChange:(c,m)=>{i([{registrationEmailAsUsername:m},{duplicateEmailsAllowed:!1}])},"aria-label":n("registrationEmailAsUsername")})}),e(se,{label:n("loginWithEmailAllowed"),fieldId:"kc-login-with-email",labelIcon:e(he,{helpText:n("loginWithEmailHelpText"),fieldLabelId:"loginWithEmailAllowed"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-login-with-email-switch","data-testid":"login-with-email-switch",value:T.loginWithEmailAllowed?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.loginWithEmailAllowed,onChange:(c,m)=>{i([{loginWithEmailAllowed:m},{duplicateEmailsAllowed:!1}])},"aria-label":n("loginWithEmailAllowed")})}),e(se,{label:n("duplicateEmailsAllowed"),fieldId:"kc-duplicate-emails",labelIcon:e(he,{helpText:n("duplicateEmailsHelpText"),fieldLabelId:"duplicateEmailsAllowed"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-duplicate-emails-switch","data-testid":"duplicate-emails-switch",label:n("on"),labelOff:n("off"),isChecked:T.duplicateEmailsAllowed,onChange:(c,m)=>{i({duplicateEmailsAllowed:m})},isDisabled:T.loginWithEmailAllowed||T.registrationEmailAsUsername,"aria-label":n("duplicateEmailsAllowed")})}),e(se,{label:n("verifyEmail"),fieldId:"kc-verify-email",labelIcon:e(he,{helpText:n("verifyEmailHelpText"),fieldLabelId:"verifyEmail"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-verify-email-switch","data-testid":"verify-email-switch",name:"verifyEmail",value:T.verifyEmail?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.verifyEmail,onChange:(c,m)=>{i({verifyEmail:m})},"aria-label":n("verifyEmail")})})]})}),e(ze,{className:"kc-user-info-settings",title:n("userInfoSettings"),children:e(_e,{isHorizontal:!0,role:"manage-realm",children:e(se,{label:n("editUsernameAllowed"),fieldId:"kc-edit-username",labelIcon:e(he,{helpText:n("editUsernameHelp"),fieldLabelId:"editUsernameAllowed"}),hasNoPaddingTop:!0,children:e(Re,{id:"kc-edit-username-switch","data-testid":"edit-username-switch",value:T.editUsernameAllowed?"on":"off",label:n("on"),labelOff:n("off"),isChecked:T.editUsernameAllowed,onChange:(c,m)=>{i({editUsernameAllowed:m})},"aria-label":n("editUsernameAllowed")})})})})]})},ni=({isOpen:T,onClose:x})=>{const{adminClient:t}=Se(),{t:n}=ue(),{realm:u}=Te(),{addAlert:r,addError:d}=Oe(),[i,c]=J(!1),[m,_]=J(!1),[k,y]=J(!1),h=i||m;async function p(){y(!0);try{const s=await t.realms.export({realm:u,exportClients:m,exportGroupsAndRoles:i});zn.saveAs(new Blob([vt(s)],{type:"application/json"}),"realm-export.json"),r(n("exportSuccess"),Ee.success),x()}catch(s){d("exportFail",s)}y(!1)}return H(ut,{variant:bt.small,title:n("partialExport"),isOpen:T,onClose:x,actions:[e(oe,{"data-testid":"confirm",isDisabled:k,onClick:p,children:n("export")},"export"),e(oe,{"data-testid":"cancel",variant:Ie.link,onClick:x,children:n("cancel")},"cancel")],children:[e(yt,{children:e(Ge,{children:n("partialExportHeaderText")})}),H(kt,{isHorizontal:!0,className:"keycloak__realm-settings__partial-import_form",children:[e(se,{label:n("includeGroupsAndRoles"),fieldId:"include-groups-and-roles-check",hasNoPaddingTop:!0,children:e(Re,{id:"include-groups-and-roles-check","data-testid":"include-groups-and-roles-check",isChecked:i,onChange:(s,f)=>c(f),label:n("on"),labelOff:n("off"),"aria-label":n("includeGroupsAndRoles")})}),e(se,{label:n("includeClients"),fieldId:"include-clients-check",hasNoPaddingTop:!0,children:e(Re,{id:"include-clients-check","data-testid":"include-clients-check",onChange:(s,f)=>_(f),isChecked:m,label:n("on"),labelOff:n("off"),"aria-label":n("includeClients")})})]}),h&&e(dt,{"data-testid":"warning-message",variant:"warning",component:"p",title:n("exportWarningTitle"),isInline:!0,children:n("exportWarningDescription")})]})},Oa={users:!1,clients:!1,groups:!1,identityProviders:!1,realmRoles:!1,clientRoles:!1},ri=T=>{const{adminClient:x}=Se(),{t}=ue(),{realm:n}=Te(),[u,r]=J(),d=!!u,[i,c]=J(!1),[m,_]=J(!1),[k,y]=J(!1),[h,p]=J("FAIL"),[s,f]=J({}),[o,g]=J(),{addError:w}=Oe(),[I,S]=J(Oa),L=Object.values(I).some(Y=>Y),A=()=>{S(Oa)},O=()=>{r(void 0),f({}),p("FAIL"),A()};rt(()=>{y(!1),g(void 0),O()},[T.open]);const P=Y=>{O(),r(Y),Array.isArray(Y)?Y.length>0&&f(Y[0]):f(Y)},R=Y=>{f(Y),c(!1),A()},G=(Y,de)=>{const xe=de.currentTarget.name;S({...I,[xe]:Y})},C=Y=>Y.map(de=>e(Le,{value:de,"data-testid":de.id+"-select-option",children:de.realm||de.id},de.id)),F=Y=>{p(Y),_(!1)},l=()=>[e(Le,{value:"FAIL",children:t("FAIL")},"fail"),e(Le,{value:"SKIP",children:t("SKIP")},"skip"),e(Le,{value:"OVERWRITE",children:t("OVERWRITE")},"overwrite")],B=()=>ee("users")||ee("groups")||ee("clients")||ee("identityProviders")||W()||ie(),ee=Y=>{const de=s[Y];return de!==void 0&&de.length>0},W=()=>{const Y=s.roles?.realm;return Y!==void 0&&Y.length>0},ie=()=>{const Y=s.roles?.client;return Y!==void 0&&Object.keys(Y).length>0},q=Y=>d?Y==="realmRoles"?s.roles?.realm?.length??0:Y==="clientRoles"?ie()?ne(s.roles.client):0:s[Y]?.length??0:0,ne=Y=>Object.values(Y).reduce((de,xe)=>de+xe.length,0),N=(Y,de)=>e(tn,{"aria-labelledby":`${Y}-list-item`,children:e(an,{children:e(nn,{dataListCells:[e(ha,{children:e(Wt,{id:`${Y}-checkbox`,label:`${q(Y)} ${de}`,"aria-labelledby":`${Y}-checkbox`,name:Y,isChecked:I[Y],onChange:(xe,Pe)=>G(Pe,xe),"data-testid":Y+"-checkbox"})},Y)]})})}),D=()=>{const Y={ifResourceExists:h,id:s.id,realm:s.realm};return I.users&&(Y.users=s.users),I.groups&&(Y.groups=s.groups),I.identityProviders&&(Y.identityProviders=s.identityProviders),I.clients&&(Y.clients=s.clients),(I.realmRoles||I.clientRoles)&&(Y.roles=s.roles,I.realmRoles||delete Y.roles?.realm,I.clientRoles||delete Y.roles?.client),Y};async function K(){if(!k){y(!0);try{const Y=await x.realms.partialImport({realm:n,rep:D()});g(Y)}catch(Y){w("importFail",Y)}y(!1)}}const M=()=>e(ut,{variant:bt.medium,title:t("partialImport"),isOpen:T.open,onClose:T.toggleDialog,actions:[e(oe,{id:"modal-import","data-testid":"confirm",isDisabled:!L,onClick:()=>{K()},children:t("import")},"import"),e(oe,{id:"modal-cancel","data-testid":"cancel",variant:Ie.link,onClick:()=>{T.toggleDialog()},children:t("cancel")},"cancel")],children:H(Xa,{hasGutter:!0,children:[e(Ye,{children:e(yt,{children:e(Ge,{children:t("partialImportHeaderText")})})}),e(Ye,{children:e(yr,{id:"partial-import-file",allowEditingUploadedText:!0,onChange:P})}),d&&B()&&H(ye,{children:[e(Ye,{children:e(at,{})}),Array.isArray(u)&&u.length>1&&H(Ye,{children:[H(Ge,{children:[t("selectRealm"),":"]}),e(Ze,{toggleId:"realm-selector",isOpen:i,typeAheadAriaLabel:t("realmSelector"),"aria-label":t("realmSelector"),onToggle:()=>c(!i),selections:s.id,onSelect:Y=>R(Y),placeholderText:s.realm||s.id,children:C(u)})]}),H(Ye,{children:[H(Ge,{children:[t("chooseResources"),":"]}),H(en,{"aria-label":t("resourcesToImport"),isCompact:!0,children:[ee("users")&&N("users",t("users")),ee("groups")&&N("groups",t("groups")),ee("clients")&&N("clients",t("clients")),ee("identityProviders")&&N("identityProviders",t("identityProviders")),W()&&N("realmRoles",t("realmRoles")),ie()&&N("clientRoles",t("clientRoles"))]})]}),H(Ye,{children:[H(Ge,{children:[t("selectIfResourceExists"),":"]}),e(Ze,{isOpen:m,direction:"up",onToggle:()=>{_(!m)},selections:h,onSelect:F,placeholderText:t(h),children:l()})]})]})]})}),$=()=>`${t("importAdded",{count:o?.added})}  ${t("importSkipped",{count:o?.skipped})} ${t("importOverwritten",{count:o?.overwritten})}`,ae=async(Y=0,de=15)=>{if(!o)return[];const xe=Math.min(Y+de,o.results.length);return o.results.slice(Y,xe)},be=Y=>{switch(Y.action){case"ADDED":return e(qt,{color:"green",children:t("added")},Y.id);case"SKIPPED":return e(qt,{color:"orange",children:t("skipped")},Y.id);case"OVERWRITTEN":return e(qt,{color:"purple",children:t("overwritten")},Y.id);default:return""}},re=Y=>{const de=new Map([["CLIENT",t("clients")],["REALM_ROLE",t("realmRoles")],["USER",t("users")],["CLIENT_ROLE",t("clientRoles")],["IDP",t("identityProviders")],["GROUP",t("groups")]]);return e("span",{children:de.get(Y.resourceType)})},ce=()=>H(ut,{variant:bt.medium,title:t("partialImport"),isOpen:T.open,onClose:T.toggleDialog,actions:[e(oe,{id:"modal-close","data-testid":"close-button",variant:Ie.primary,onClick:()=>{T.toggleDialog()},children:t("close")},"close")],children:[e(dt,{variant:"success",component:"p",isInline:!0,title:$()}),e(nt,{loader:ae,isPaginated:!0,ariaLabelKey:"partialImport",columns:[{name:"action",displayKey:"action",cellRenderer:be},{name:"resourceType",displayKey:"type",cellRenderer:re},{name:"resourceName",displayKey:"name"},{name:"id",displayKey:"id"}]})]});return o?ce():M()},ii=()=>{const{adminClient:T}=Se(),{t:x}=ue(),{addAlert:t,addError:n}=Oe(),{realm:u}=Te(),r=_t(),[d,i]=J(!1),[c,m]=J(),[_,k]=J(),[y,h]=J(0),[p,s]=J(),[f,o]=J(),g=()=>h(y+1),w=He({mode:"onChange"});et(()=>T.clientPolicies.listPolicies({includeGlobalPolicies:!0}),R=>{const G=R.globalPolicies?.map(l=>({...l,global:!0})),C=R.policies?.map(l=>({...l,global:!1})),F=G?.concat(C??[]);m(F),o(F||[]),s(vt(F))},[y]);const I=async()=>c??[],S=async()=>{const R=w.getValues(),G=c?.filter(C=>!C.global).map(C=>{const F=R[C.name],l={...C,enabled:F};return delete l.global,l});try{await T.clientPolicies.updatePolicy({policies:G}),r(ca({realm:u,tab:"policies"})),t(x("updateClientPolicySuccess"),Ee.success)}catch(C){n("updateClientPolicyError",C)}},L=R=>un(R,"global"),A=async()=>{if(p)try{const R=JSON.parse(p),G=R.filter(F=>!F.global).map(F=>L(F)),C=R.filter(F=>F.global).map(F=>L(F));try{await T.clientPolicies.updatePolicy({policies:G,globalPolicies:C}),t(x("updateClientPoliciesSuccess"),Ee.success),g()}catch(F){n("updateClientPoliciesError",F)}}catch(R){console.warn("Invalid json, ignoring value using {}"),n("invalidJsonClientPoliciesError",R)}},[O,P]=De({titleKey:x("deleteClientPolicyConfirmTitle"),messageKey:x("deleteClientPolicyConfirm",{policyName:_?.name}),continueButtonLabel:x("delete"),continueButtonVariant:Ie.danger,onConfirm:async()=>{const R=c?.filter(G=>!G.global&&G.name!==_?.name).map(G=>{const C={...G};return delete C.global,C});try{await T.clientPolicies.updatePolicy({policies:R}),t(x("deleteClientPolicySuccess"),Ee.success),g()}catch(G){n("deleteClientPolicyError",G)}}});return c?H(ye,{children:[e(P,{}),e(Ce,{children:H(Xt,{className:"kc-policies-config-section",children:[e(Ve,{children:e(Ka,{headingLevel:"h1",size:"md",children:x("policiesConfigType")})}),e(Ve,{children:e(gt,{isChecked:!d,name:"policiesView",onChange:()=>i(!1),label:x("policiesConfigTypes.formView"),id:"formView-policiesView","data-testid":"formView-policiesView",className:"kc-form-radio-btn pf-v5-u-mr-sm pf-v5-u-ml-sm"})}),e(Ve,{children:e(gt,{isChecked:d,name:"policiesView",onChange:()=>i(!0),label:x("policiesConfigTypes.jsonEditor"),id:"jsonEditor-policiesView","data-testid":"jsonEditor-policiesView",className:"kc-editor-radio-btn"})})]})}),e(at,{}),d?H(ye,{children:[e("div",{className:"pf-v5-u-mt-md pf-v5-u-ml-lg",children:e(ya,{value:p,language:"json",onChange:R=>s(R),height:480})}),H("div",{className:"pf-v5-u-mt-md",children:[e(oe,{variant:Ie.primary,className:"pf-v5-u-mr-md pf-v5-u-ml-lg","data-testid":"jsonEditor-policies-saveBtn",onClick:A,children:x("save")}),e(oe,{variant:Ie.link,"data-testid":"jsonEditor-reloadBtn",onClick:()=>{s(vt(f))},children:x("reload")})]})]}):e(nt,{emptyState:e(qe,{message:x("noClientPolicies"),instructions:x("noClientPoliciesInstructions"),primaryActionText:x("createClientPolicy"),onPrimaryAction:()=>r(Ta({realm:u}))}),ariaLabelKey:"clientPolicies",searchPlaceholderKey:"clientPolicySearch",loader:I,toolbarItem:e(Be,{children:e(oe,{id:"createPolicy",component:R=>e(Fe,{...R,to:Ta({realm:u})}),"data-testid":"createPolicy",children:x("createClientPolicy")})}),isRowDisabled:R=>!!R.global,actions:[{title:x("delete"),onRowClick:R=>{O(),k(R)}}],columns:[{name:"name",cellRenderer:({name:R})=>e(Fe,{to:Nn({realm:u,policyName:R}),children:R})},{name:"enabled",displayKey:"status",cellRenderer:R=>e(si,{clientPolicy:R,form:w,saveStatus:S,onConfirm:()=>{w.setValue(R.name,!1),S()}})},{name:"description",cellFormatters:[rn(x)]}]},c.length)]}):e(tt,{})},si=({clientPolicy:T,form:x,saveStatus:t,onConfirm:n})=>{const{t:u}=ue(),[r,d]=De({titleKey:"disablePolicyConfirmTitle",messageKey:"disablePolicyConfirm",continueButtonLabel:"disable",onConfirm:n});return H(ye,{children:[e(d,{}),e(fe,{name:T.name,"data-testid":`${T.name}-switch`,defaultValue:T.enabled,control:x.control,render:({field:i})=>e(Re,{label:u("enabled"),labelOff:u("disabled"),isChecked:i.value,isDisabled:T.global,onChange:(c,m)=>{m?(i.onChange(m),t()):r()},"aria-label":T.name})})]})};function oi(){const{adminClient:T}=Se(),{t:x}=ue(),{realm:t}=Te(),{addAlert:n,addError:u}=Oe(),[r,d]=J(),[i,c]=J(),[m,_]=J(),[k,y]=J(!1),[h,p]=J(),[s,f]=J(0);et(()=>T.clientPolicies.listProfiles({includeGlobalProfiles:!0}),A=>{c(A.globalProfiles);const O=A.globalProfiles?.map(G=>({...G,global:!0})),P=A.profiles?.map(G=>({...G,global:!1})),R=O?.concat(P??[]);d(R||[]),p(JSON.stringify(R,null,2))},[s]);const o=async()=>r??[],g=A=>un(A,"global"),[w,I]=De({titleKey:x("deleteClientProfileConfirmTitle"),messageKey:x("deleteClientProfileConfirm",{profileName:m?.name}),continueButtonLabel:x("delete"),continueButtonVariant:Ie.danger,onConfirm:async()=>{const A=r?.filter(O=>O.name!==m?.name&&!O.global).map(O=>g(O));try{await T.clientPolicies.createProfiles({profiles:A,globalProfiles:i}),n(x("deleteClientSuccess"),Ee.success),f(s+1)}catch(O){u("deleteClientError",O)}}}),S=A=>H(Fe,{to:Bn({realm:t,profileName:A.name}),children:[A.name," ",A.global&&e(qt,{color:"blue",children:x("global")})]},A.name);if(!r)return e(tt,{});const L=async()=>{if(h)try{const A=JSON.parse(h),O=A.filter(R=>!R.global).map(R=>g(R)),P=A.filter(R=>R.global).map(R=>g(R));try{await T.clientPolicies.createProfiles({profiles:O,globalProfiles:P}),n(x("updateClientProfilesSuccess"),Ee.success),f(s+1)}catch(R){u("updateClientProfilesError",R)}}catch(A){u("invalidJsonClientProfilesError",A)}};return H(ye,{children:[e(I,{}),e(Ce,{children:H(Xt,{className:"kc-profiles-config-section",children:[e(Ve,{children:e(Ka,{headingLevel:"h1",size:"md",children:x("profilesConfigType")})}),e(Ve,{children:e(gt,{isChecked:!k,name:"profilesView",onChange:()=>y(!1),label:x("profilesConfigTypes.formView"),id:"formView-profilesView",className:"kc-form-radio-btn pf-v5-u-mr-sm pf-v5-u-ml-sm","data-testid":"formView-profilesView"})}),e(Ve,{children:e(gt,{isChecked:k,name:"profilesView",onChange:()=>y(!0),label:x("profilesConfigTypes.jsonEditor"),id:"jsonEditor-profilesView",className:"kc-editor-radio-btn","data-testid":"jsonEditor-profilesView"})})]})}),e(at,{}),k?H(se,{fieldId:"jsonEditor",children:[e("div",{className:"pf-v5-u-mt-md pf-v5-u-ml-lg",children:e(ya,{value:h,language:"json",onChange:A=>p(A??""),height:480})}),e(Ue,{children:H("div",{className:"pf-v5-u-mt-md",children:[e(oe,{variant:Ie.primary,className:"pf-v5-u-mr-md pf-v5-u-ml-lg",onClick:L,"data-testid":"jsonEditor-saveBtn",children:x("save")}),e(oe,{variant:Ie.link,onClick:()=>{p(vt(r))},"data-testid":"jsonEditor-reloadBtn",children:x("reload")})]})})]}):e(nt,{ariaLabelKey:"profiles",searchPlaceholderKey:"clientProfileSearch",loader:o,toolbarItem:e(Be,{children:e(oe,{id:"createProfile",component:A=>e(Fe,{...A,to:Fn({realm:t,tab:"profiles"})}),"data-testid":"createProfile",children:x("createClientProfile")})}),isRowDisabled:A=>A.global,actions:[{title:x("delete"),onRowClick:A=>{_(A),w()}}],columns:[{name:"name",displayKey:x("name"),cellRenderer:S},{name:"description",displayKey:x("clientProfileDescription")}],emptyState:e(qe,{message:x("emptyClientProfiles"),instructions:x("emptyClientProfilesInstructions")})},r.length)]})}const li=({realm:T,save:x})=>{const{t}=ue(),{control:n,handleSubmit:u,formState:r,reset:d}=wt(),i=We({control:n,name:"offlineSessionMaxLifespanEnabled"});return H(Ce,{variant:"light",children:[e(ze,{title:t("SSOSessionSettings"),className:"kc-sso-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",onSubmit:u(x),children:[e(se,{label:t("SSOSessionIdle"),fieldId:"SSOSessionIdle",labelIcon:e(he,{helpText:t("ssoSessionIdle"),fieldLabelId:"SSOSessionIdle"}),children:e(fe,{name:"ssoSessionIdleTimeout",defaultValue:T.ssoSessionIdleTimeout,control:n,render:({field:c})=>e(ke,{className:"kc-sso-session-idle","data-testid":"sso-session-idle-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("SSOSessionMax"),fieldId:"SSOSessionMax",labelIcon:e(he,{helpText:t("ssoSessionMax"),fieldLabelId:"SSOSessionMax"}),children:e(fe,{name:"ssoSessionMaxLifespan",control:n,render:({field:c})=>e(ke,{className:"kc-sso-session-max","data-testid":"sso-session-max-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("SSOSessionIdleRememberMe"),fieldId:"SSOSessionIdleRememberMe",labelIcon:e(he,{helpText:t("ssoSessionIdleRememberMe"),fieldLabelId:"SSOSessionIdleRememberMe"}),children:e(fe,{name:"ssoSessionIdleTimeoutRememberMe",control:n,render:({field:c})=>e(ke,{className:"kc-sso-session-idle-remember-me","data-testid":"sso-session-idle-remember-me-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("SSOSessionMaxRememberMe"),fieldId:"SSOSessionMaxRememberMe",labelIcon:e(he,{helpText:t("ssoSessionMaxRememberMe"),fieldLabelId:"SSOSessionMaxRememberMe"}),children:e(fe,{name:"ssoSessionMaxLifespanRememberMe",control:n,render:({field:c})=>e(ke,{className:"kc-sso-session-max-remember-me","data-testid":"sso-session-max-remember-me-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})})]})}),e(ze,{title:t("clientSessionSettings"),className:"kc-client-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:u(x),children:[e(se,{label:t("clientSessionIdle"),fieldId:"clientSessionIdle",labelIcon:e(he,{helpText:t("clientSessionIdleHelp"),fieldLabelId:"clientSessionIdle"}),children:e(fe,{name:"clientSessionIdleTimeout",control:n,render:({field:c})=>e(ke,{className:"kc-client-session-idle","data-testid":"client-session-idle-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("clientSessionMax"),fieldId:"clientSessionMax",labelIcon:e(he,{helpText:t("clientSessionMaxHelp"),fieldLabelId:"clientSessionMax"}),children:e(fe,{name:"clientSessionMaxLifespan",control:n,render:({field:c})=>e(ke,{className:"kc-client-session-max","data-testid":"client-session-max-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})})]})}),e(ze,{title:t("offlineSessionSettings"),className:"kc-offline-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:u(x),children:[e(se,{label:t("offlineSessionIdle"),fieldId:"offlineSessionIdle",labelIcon:e(he,{helpText:t("offlineSessionIdleHelp"),fieldLabelId:"offlineSessionIdle"}),children:e(fe,{name:"offlineSessionIdleTimeout",control:n,render:({field:c})=>e(ke,{className:"kc-offline-session-idle","data-testid":"offline-session-idle-input","aria-label":"offline-session-idle-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{hasNoPaddingTop:!0,label:t("offlineSessionMaxLimited"),fieldId:"kc-offlineSessionMaxLimited",labelIcon:e(he,{helpText:t("offlineSessionMaxLimitedHelp"),fieldLabelId:"offlineSessionMaxLimited"}),children:e(fe,{name:"offlineSessionMaxLifespanEnabled",control:n,defaultValue:!1,render:({field:c})=>e(Re,{id:"kc-offline-session-max","data-testid":"offline-session-max-switch","aria-label":t("offlineSessionMaxLimited"),label:t("enabled"),labelOff:t("disabled"),isChecked:c.value,onChange:c.onChange})})}),i&&e(se,{label:t("offlineSessionMax"),fieldId:"offlineSessionMax",id:"offline-session-max-label",labelIcon:e(he,{helpText:t("offlineSessionMaxHelp"),fieldLabelId:"offlineSessionMax"}),children:e(fe,{name:"offlineSessionMaxLifespan",control:n,render:({field:c})=>e(ke,{className:"kc-offline-session-max","data-testid":"offline-session-max-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})})]})}),e(ze,{className:"kc-login-settings-template",title:t("loginSettings"),children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:u(x),children:[e(se,{label:t("loginTimeout"),id:"kc-login-timeout-label",fieldId:"offlineSessionIdle",labelIcon:e(he,{helpText:t("loginTimeoutHelp"),fieldLabelId:"loginTimeout"}),children:e(fe,{name:"accessCodeLifespanLogin",control:n,render:({field:c})=>e(ke,{className:"kc-login-timeout","data-testid":"login-timeout-input","aria-label":"login-timeout-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("loginActionTimeout"),fieldId:"loginActionTimeout",id:"login-action-timeout-label",labelIcon:e(he,{helpText:t("loginActionTimeoutHelp"),fieldLabelId:"loginActionTimeout"}),children:e(fe,{name:"accessCodeLifespanUserAction",control:n,render:({field:c})=>e(ke,{className:"kc-login-action-timeout","data-testid":"login-action-timeout-input",value:c.value,onChange:c.onChange,units:["minute","hour","day"]})})}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"sessions-tab-save",isDisabled:!r.isDirty,children:t("save")}),e(oe,{variant:"link",onClick:()=>d(T),children:t("revert")})]})]})})]})};function jt(T){throw new Error('Could not dynamically require "'+T+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oa={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var za;function ci(){return za||(za=1,function(T,x){(function(t){T.exports=t()})(function(){return function t(n,u,r){function d(m,_){if(!u[m]){if(!n[m]){var k=typeof jt=="function"&&jt;if(!_&&k)return k(m,!0);if(i)return i(m,!0);var y=new Error("Cannot find module '"+m+"'");throw y.code="MODULE_NOT_FOUND",y}var h=u[m]={exports:{}};n[m][0].call(h.exports,function(p){var s=n[m][1][p];return d(s||p)},h,h.exports,t,n,u,r)}return u[m].exports}for(var i=typeof jt=="function"&&jt,c=0;c<r.length;c++)d(r[c]);return d}({1:[function(t,n,u){var r=t("./utils"),d=t("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u.encode=function(c){for(var m,_,k,y,h,p,s,f=[],o=0,g=c.length,w=g,I=r.getTypeOf(c)!=="string";o<c.length;)w=g-o,k=I?(m=c[o++],_=o<g?c[o++]:0,o<g?c[o++]:0):(m=c.charCodeAt(o++),_=o<g?c.charCodeAt(o++):0,o<g?c.charCodeAt(o++):0),y=m>>2,h=(3&m)<<4|_>>4,p=1<w?(15&_)<<2|k>>6:64,s=2<w?63&k:64,f.push(i.charAt(y)+i.charAt(h)+i.charAt(p)+i.charAt(s));return f.join("")},u.decode=function(c){var m,_,k,y,h,p,s=0,f=0,o="data:";if(c.substr(0,o.length)===o)throw new Error("Invalid base64 input, it looks like a data url.");var g,w=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===i.charAt(64)&&w--,c.charAt(c.length-2)===i.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=d.uint8array?new Uint8Array(0|w):new Array(0|w);s<c.length;)m=i.indexOf(c.charAt(s++))<<2|(y=i.indexOf(c.charAt(s++)))>>4,_=(15&y)<<4|(h=i.indexOf(c.charAt(s++)))>>2,k=(3&h)<<6|(p=i.indexOf(c.charAt(s++))),g[f++]=m,h!==64&&(g[f++]=_),p!==64&&(g[f++]=k);return g}},{"./support":30,"./utils":32}],2:[function(t,n,u){var r=t("./external"),d=t("./stream/DataWorker"),i=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function m(_,k,y,h,p){this.compressedSize=_,this.uncompressedSize=k,this.crc32=y,this.compression=h,this.compressedContent=p}m.prototype={getContentWorker:function(){var _=new d(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),k=this;return _.on("end",function(){if(this.streamInfo.data_length!==k.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new d(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(_,k,y){return _.pipe(new i).pipe(new c("uncompressedSize")).pipe(k.compressWorker(y)).pipe(new c("compressedSize")).withStreamInfo("compression",k)},n.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,u){var r=t("./stream/GenericWorker");u.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},u.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,u){var r=t("./utils"),d=function(){for(var i,c=[],m=0;m<256;m++){i=m;for(var _=0;_<8;_++)i=1&i?3988292384^i>>>1:i>>>1;c[m]=i}return c}();n.exports=function(i,c){return i!==void 0&&i.length?r.getTypeOf(i)!=="string"?function(m,_,k,y){var h=d,p=y+k;m^=-1;for(var s=y;s<p;s++)m=m>>>8^h[255&(m^_[s])];return-1^m}(0|c,i,i.length,0):function(m,_,k,y){var h=d,p=y+k;m^=-1;for(var s=y;s<p;s++)m=m>>>8^h[255&(m^_.charCodeAt(s))];return-1^m}(0|c,i,i.length,0):0}},{"./utils":32}],5:[function(t,n,u){u.base64=!1,u.binary=!1,u.dir=!1,u.createFolders=!0,u.date=null,u.compression=null,u.compressionOptions=null,u.comment=null,u.unixPermissions=null,u.dosPermissions=null},{}],6:[function(t,n,u){var r=null;r=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:r}},{lie:37}],7:[function(t,n,u){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=t("pako"),i=t("./utils"),c=t("./stream/GenericWorker"),m=r?"uint8array":"array";function _(k,y){c.call(this,"FlateWorker/"+k),this._pako=null,this._pakoAction=k,this._pakoOptions=y,this.meta={}}u.magic="\b\0",i.inherits(_,c),_.prototype.processChunk=function(k){this.meta=k.meta,this._pako===null&&this._createPako(),this._pako.push(i.transformTo(m,k.data),!1)},_.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var k=this;this._pako.onData=function(y){k.push({data:y,meta:k.meta})}},u.compressWorker=function(k){return new _("Deflate",k)},u.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,u){function r(h,p){var s,f="";for(s=0;s<p;s++)f+=String.fromCharCode(255&h),h>>>=8;return f}function d(h,p,s,f,o,g){var w,I,S=h.file,L=h.compression,A=g!==m.utf8encode,O=i.transformTo("string",g(S.name)),P=i.transformTo("string",m.utf8encode(S.name)),R=S.comment,G=i.transformTo("string",g(R)),C=i.transformTo("string",m.utf8encode(R)),F=P.length!==S.name.length,l=C.length!==R.length,B="",ee="",W="",ie=S.dir,q=S.date,ne={crc32:0,compressedSize:0,uncompressedSize:0};p&&!s||(ne.crc32=h.crc32,ne.compressedSize=h.compressedSize,ne.uncompressedSize=h.uncompressedSize);var N=0;p&&(N|=8),A||!F&&!l||(N|=2048);var D=0,K=0;ie&&(D|=16),o==="UNIX"?(K=798,D|=function($,ae){var be=$;return $||(be=ae?16893:33204),(65535&be)<<16}(S.unixPermissions,ie)):(K=20,D|=function($){return 63&($||0)}(S.dosPermissions)),w=q.getUTCHours(),w<<=6,w|=q.getUTCMinutes(),w<<=5,w|=q.getUTCSeconds()/2,I=q.getUTCFullYear()-1980,I<<=4,I|=q.getUTCMonth()+1,I<<=5,I|=q.getUTCDate(),F&&(ee=r(1,1)+r(_(O),4)+P,B+="up"+r(ee.length,2)+ee),l&&(W=r(1,1)+r(_(G),4)+C,B+="uc"+r(W.length,2)+W);var M="";return M+=`
\0`,M+=r(N,2),M+=L.magic,M+=r(w,2),M+=r(I,2),M+=r(ne.crc32,4),M+=r(ne.compressedSize,4),M+=r(ne.uncompressedSize,4),M+=r(O.length,2),M+=r(B.length,2),{fileRecord:k.LOCAL_FILE_HEADER+M+O+B,dirRecord:k.CENTRAL_FILE_HEADER+r(K,2)+M+r(G.length,2)+"\0\0\0\0"+r(D,4)+r(f,4)+O+B+G}}var i=t("../utils"),c=t("../stream/GenericWorker"),m=t("../utf8"),_=t("../crc32"),k=t("../signature");function y(h,p,s,f){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=s,this.encodeFileName=f,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(y,c),y.prototype.push=function(h){var p=h.meta.percent||0,s=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:s?(p+100*(s-f-1))/s:100}}))},y.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var p=this.streamFiles&&!h.file.dir;if(p){var s=d(h,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:s.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(h){this.accumulate=!1;var p=this.streamFiles&&!h.file.dir,s=d(h,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),p)this.push({data:function(f){return k.DATA_DESCRIPTOR+r(f.crc32,4)+r(f.compressedSize,4)+r(f.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var h=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var s=this.bytesWritten-h,f=function(o,g,w,I,S){var L=i.transformTo("string",S(I));return k.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(o,2)+r(o,2)+r(g,4)+r(w,4)+r(L.length,2)+L}(this.dirRecords.length,s,h,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(h){this._sources.push(h);var p=this;return h.on("data",function(s){p.processChunk(s)}),h.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),h.on("error",function(s){p.error(s)}),this},y.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(h){var p=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var s=0;s<p.length;s++)try{p[s].error(h)}catch{}return!0},y.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,p=0;p<h.length;p++)h[p].lock()},n.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,u){var r=t("../compressions"),d=t("./ZipFileWorker");u.generateWorker=function(i,c,m){var _=new d(c.streamFiles,m,c.platform,c.encodeFileName),k=0;try{i.forEach(function(y,h){k++;var p=function(g,w){var I=g||w,S=r[I];if(!S)throw new Error(I+" is not a valid compression method !");return S}(h.options.compression,c.compression),s=h.options.compressionOptions||c.compressionOptions||{},f=h.dir,o=h.date;h._compressWorker(p,s).withStreamInfo("file",{name:y,dir:f,date:o,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(_)}),_.entriesCount=k}catch(y){_.error(y)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,u){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new r;for(var i in this)typeof this[i]!="function"&&(d[i]=this[i]);return d}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(d,i){return new r().loadAsync(d,i)},r.external=t("./external"),n.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,u){var r=t("./utils"),d=t("./external"),i=t("./utf8"),c=t("./zipEntries"),m=t("./stream/Crc32Probe"),_=t("./nodejsUtils");function k(y){return new d.Promise(function(h,p){var s=y.decompressed.getContentWorker().pipe(new m);s.on("error",function(f){p(f)}).on("end",function(){s.streamInfo.crc32!==y.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(y,h){var p=this;return h=r.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),_.isNode&&_.isStream(y)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",y,!0,h.optimizedBinaryString,h.base64).then(function(s){var f=new c(h);return f.load(s),f}).then(function(s){var f=[d.Promise.resolve(s)],o=s.files;if(h.checkCRC32)for(var g=0;g<o.length;g++)f.push(k(o[g]));return d.Promise.all(f)}).then(function(s){for(var f=s.shift(),o=f.files,g=0;g<o.length;g++){var w=o[g],I=w.fileNameStr,S=r.resolve(w.fileNameStr);p.file(S,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:h.createFolders}),w.dir||(p.file(S).unsafeOriginalName=I)}return f.zipComment.length&&(p.comment=f.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,u){var r=t("../utils"),d=t("../stream/GenericWorker");function i(c,m){d.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(m)}r.inherits(i,d),i.prototype._bindStream=function(c){var m=this;(this._stream=c).pause(),c.on("data",function(_){m.push({data:_,meta:{percent:0}})}).on("error",function(_){m.isPaused?this.generatedError=_:m.error(_)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},i.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,u){var r=t("readable-stream").Readable;function d(i,c,m){r.call(this,c),this._helper=i;var _=this;i.on("data",function(k,y){_.push(k)||_._helper.pause(),m&&m(y)}).on("error",function(k){_.emit("error",k)}).on("end",function(){_.push(null)})}t("../utils").inherits(d,r),d.prototype._read=function(){this._helper.resume()},n.exports=d},{"../utils":32,"readable-stream":16}],14:[function(t,n,u){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,d);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,d)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var d=new Buffer(r);return d.fill(0),d},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,n,u){function r(S,L,A){var O,P=i.getTypeOf(L),R=i.extend(A||{},_);R.date=R.date||new Date,R.compression!==null&&(R.compression=R.compression.toUpperCase()),typeof R.unixPermissions=="string"&&(R.unixPermissions=parseInt(R.unixPermissions,8)),R.unixPermissions&&16384&R.unixPermissions&&(R.dir=!0),R.dosPermissions&&16&R.dosPermissions&&(R.dir=!0),R.dir&&(S=o(S)),R.createFolders&&(O=f(S))&&g.call(this,O,!0);var G=P==="string"&&R.binary===!1&&R.base64===!1;A&&A.binary!==void 0||(R.binary=!G),(L instanceof k&&L.uncompressedSize===0||R.dir||!L||L.length===0)&&(R.base64=!1,R.binary=!0,L="",R.compression="STORE",P="string");var C=null;C=L instanceof k||L instanceof c?L:p.isNode&&p.isStream(L)?new s(S,L):i.prepareContent(S,L,R.binary,R.optimizedBinaryString,R.base64);var F=new y(S,C,R);this.files[S]=F}var d=t("./utf8"),i=t("./utils"),c=t("./stream/GenericWorker"),m=t("./stream/StreamHelper"),_=t("./defaults"),k=t("./compressedObject"),y=t("./zipObject"),h=t("./generate"),p=t("./nodejsUtils"),s=t("./nodejs/NodejsStreamInputAdapter"),f=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var L=S.lastIndexOf("/");return 0<L?S.substring(0,L):""},o=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},g=function(S,L){return L=L!==void 0?L:_.createFolders,S=o(S),this.files[S]||r.call(this,S,null,{dir:!0,createFolders:L}),this.files[S]};function w(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var L,A,O;for(L in this.files)O=this.files[L],(A=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&S(A,O)},filter:function(S){var L=[];return this.forEach(function(A,O){S(A,O)&&L.push(O)}),L},file:function(S,L,A){if(arguments.length!==1)return S=this.root+S,r.call(this,S,L,A),this;if(w(S)){var O=S;return this.filter(function(R,G){return!G.dir&&O.test(R)})}var P=this.files[this.root+S];return P&&!P.dir?P:null},folder:function(S){if(!S)return this;if(w(S))return this.filter(function(P,R){return R.dir&&S.test(P)});var L=this.root+S,A=g.call(this,L),O=this.clone();return O.root=A.name,O},remove:function(S){S=this.root+S;var L=this.files[S];if(L||(S.slice(-1)!=="/"&&(S+="/"),L=this.files[S]),L&&!L.dir)delete this.files[S];else for(var A=this.filter(function(P,R){return R.name.slice(0,S.length)===S}),O=0;O<A.length;O++)delete this.files[A[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var L,A={};try{if((A=i.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");i.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var O=A.comment||this.comment||"";L=h.generateWorker(this,A,O)}catch(P){(L=new c("error")).error(P)}return new m(L,A.type||"string",A.mimeType)},generateAsync:function(S,L){return this.generateInternalStream(S).accumulate(L)},generateNodeStream:function(S,L){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(L)}};n.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,u){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,u){var r=t("./DataReader");function d(i){r.call(this,i);for(var c=0;c<this.data.length;c++)i[c]=255&i[c]}t("../utils").inherits(d,r),d.prototype.byteAt=function(i){return this.data[this.zero+i]},d.prototype.lastIndexOfSignature=function(i){for(var c=i.charCodeAt(0),m=i.charCodeAt(1),_=i.charCodeAt(2),k=i.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===c&&this.data[y+1]===m&&this.data[y+2]===_&&this.data[y+3]===k)return y-this.zero;return-1},d.prototype.readAndCheckSignature=function(i){var c=i.charCodeAt(0),m=i.charCodeAt(1),_=i.charCodeAt(2),k=i.charCodeAt(3),y=this.readData(4);return c===y[0]&&m===y[1]&&_===y[2]&&k===y[3]},d.prototype.readData=function(i){if(this.checkOffset(i),i===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,c},n.exports=d},{"../utils":32,"./DataReader":18}],18:[function(t,n,u){var r=t("../utils");function d(i){this.data=i,this.length=i.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(i){this.checkIndex(this.index+i)},checkIndex:function(i){if(this.length<this.zero+i||i<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+i+"). Corrupted zip ?")},setIndex:function(i){this.checkIndex(i),this.index=i},skip:function(i){this.setIndex(this.index+i)},byteAt:function(){},readInt:function(i){var c,m=0;for(this.checkOffset(i),c=this.index+i-1;c>=this.index;c--)m=(m<<8)+this.byteAt(c);return this.index+=i,m},readString:function(i){return r.transformTo("string",this.readData(i))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var i=this.readInt(4);return new Date(Date.UTC(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1))}},n.exports=d},{"../utils":32}],19:[function(t,n,u){var r=t("./Uint8ArrayReader");function d(i){r.call(this,i)}t("../utils").inherits(d,r),d.prototype.readData=function(i){this.checkOffset(i);var c=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,c},n.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,u){var r=t("./DataReader");function d(i){r.call(this,i)}t("../utils").inherits(d,r),d.prototype.byteAt=function(i){return this.data.charCodeAt(this.zero+i)},d.prototype.lastIndexOfSignature=function(i){return this.data.lastIndexOf(i)-this.zero},d.prototype.readAndCheckSignature=function(i){return i===this.readData(4)},d.prototype.readData=function(i){this.checkOffset(i);var c=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,c},n.exports=d},{"../utils":32,"./DataReader":18}],21:[function(t,n,u){var r=t("./ArrayReader");function d(i){r.call(this,i)}t("../utils").inherits(d,r),d.prototype.readData=function(i){if(this.checkOffset(i),i===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+i);return this.index+=i,c},n.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,u){var r=t("../utils"),d=t("../support"),i=t("./ArrayReader"),c=t("./StringReader"),m=t("./NodeBufferReader"),_=t("./Uint8ArrayReader");n.exports=function(k){var y=r.getTypeOf(k);return r.checkSupport(y),y!=="string"||d.uint8array?y==="nodebuffer"?new m(k):d.uint8array?new _(r.transformTo("uint8array",k)):new i(r.transformTo("array",k)):new c(k)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,u){u.LOCAL_FILE_HEADER="PK",u.CENTRAL_FILE_HEADER="PK",u.CENTRAL_DIRECTORY_END="PK",u.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",u.ZIP64_CENTRAL_DIRECTORY_END="PK",u.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,u){var r=t("./GenericWorker"),d=t("../utils");function i(c){r.call(this,"ConvertWorker to "+c),this.destType=c}d.inherits(i,r),i.prototype.processChunk=function(c){this.push({data:d.transformTo(this.destType,c.data),meta:c.meta})},n.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,u){var r=t("./GenericWorker"),d=t("../crc32");function i(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(i,r),i.prototype.processChunk=function(c){this.streamInfo.crc32=d(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,u){var r=t("../utils"),d=t("./GenericWorker");function i(c){d.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}r.inherits(i,d),i.prototype.processChunk=function(c){if(c){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+c.data.length}d.prototype.processChunk.call(this,c)},n.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,u){var r=t("../utils"),d=t("./GenericWorker");function i(c){d.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(_){m.dataIsReady=!0,m.data=_,m.max=_&&_.length||0,m.type=r.getTypeOf(_),m.isPaused||m._tickAndRepeat()},function(_){m.error(_)})}r.inherits(i,d),i.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,m);break;case"uint8array":c=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":c=this.data.slice(this.index,m)}return this.index=m,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,u){function r(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,i){return this._listeners[d].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,i){if(this._listeners[d])for(var c=0;c<this._listeners[d].length;c++)this._listeners[d][c].call(this,i)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var i=this;return d.on("data",function(c){i.processChunk(c)}),d.on("end",function(){i.end()}),d.on("error",function(c){i.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,i){return this.extraStreamInfo[d]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},n.exports=r},{}],29:[function(t,n,u){var r=t("../utils"),d=t("./ConvertWorker"),i=t("./GenericWorker"),c=t("../base64"),m=t("../support"),_=t("../external"),k=null;if(m.nodestream)try{k=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(p,s){return new _.Promise(function(f,o){var g=[],w=p._internalType,I=p._outputType,S=p._mimeType;p.on("data",function(L,A){g.push(L),s&&s(A)}).on("error",function(L){g=[],o(L)}).on("end",function(){try{var L=function(A,O,P){switch(A){case"blob":return r.newBlob(r.transformTo("arraybuffer",O),P);case"base64":return c.encode(O);default:return r.transformTo(A,O)}}(I,function(A,O){var P,R=0,G=null,C=0;for(P=0;P<O.length;P++)C+=O[P].length;switch(A){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(G=new Uint8Array(C),P=0;P<O.length;P++)G.set(O[P],R),R+=O[P].length;return G;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+A+"'")}}(w,g),S);f(L)}catch(A){o(A)}g=[]}).resume()})}function h(p,s,f){var o=s;switch(s){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=s,this._mimeType=f,r.checkSupport(o),this._worker=p.pipe(new d(o)),p.lock()}catch(g){this._worker=new i("error"),this._worker.error(g)}}h.prototype={accumulate:function(p){return y(this,p)},on:function(p,s){var f=this;return p==="data"?this._worker.on(p,function(o){s.call(f,o.data,o.meta)}):this._worker.on(p,function(){r.delay(s,arguments,f)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new k(this,{objectMode:this._outputType!=="nodebuffer"},p)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,u){if(u.base64=!0,u.array=!0,u.string=!0,u.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",u.nodebuffer=typeof Buffer<"u",u.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")u.blob=!1;else{var r=new ArrayBuffer(0);try{u.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(r),u.blob=d.getBlob("application/zip").size===0}catch{u.blob=!1}}}try{u.nodestream=!!t("readable-stream").Readable}catch{u.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,u){for(var r=t("./utils"),d=t("./support"),i=t("./nodejsUtils"),c=t("./stream/GenericWorker"),m=new Array(256),_=0;_<256;_++)m[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;m[254]=m[254]=1;function k(){c.call(this,"utf-8 decode"),this.leftOver=null}function y(){c.call(this,"utf-8 encode")}u.utf8encode=function(h){return d.nodebuffer?i.newBufferFrom(h,"utf-8"):function(p){var s,f,o,g,w,I=p.length,S=0;for(g=0;g<I;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<I&&(64512&(o=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(o-56320),g++),S+=f<128?1:f<2048?2:f<65536?3:4;for(s=d.uint8array?new Uint8Array(S):new Array(S),g=w=0;w<S;g++)(64512&(f=p.charCodeAt(g)))==55296&&g+1<I&&(64512&(o=p.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(o-56320),g++),f<128?s[w++]=f:(f<2048?s[w++]=192|f>>>6:(f<65536?s[w++]=224|f>>>12:(s[w++]=240|f>>>18,s[w++]=128|f>>>12&63),s[w++]=128|f>>>6&63),s[w++]=128|63&f);return s}(h)},u.utf8decode=function(h){return d.nodebuffer?r.transformTo("nodebuffer",h).toString("utf-8"):function(p){var s,f,o,g,w=p.length,I=new Array(2*w);for(s=f=0;s<w;)if((o=p[s++])<128)I[f++]=o;else if(4<(g=m[o]))I[f++]=65533,s+=g-1;else{for(o&=g===2?31:g===3?15:7;1<g&&s<w;)o=o<<6|63&p[s++],g--;1<g?I[f++]=65533:o<65536?I[f++]=o:(o-=65536,I[f++]=55296|o>>10&1023,I[f++]=56320|1023&o)}return I.length!==f&&(I.subarray?I=I.subarray(0,f):I.length=f),r.applyFromCharCode(I)}(h=r.transformTo(d.uint8array?"uint8array":"array",h))},r.inherits(k,c),k.prototype.processChunk=function(h){var p=r.transformTo(d.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var s=p;(p=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),p.set(s,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var f=function(g,w){var I;for((w=w||g.length)>g.length&&(w=g.length),I=w-1;0<=I&&(192&g[I])==128;)I--;return I<0||I===0?w:I+m[g[I]]>w?I:w}(p),o=p;f!==p.length&&(d.uint8array?(o=p.subarray(0,f),this.leftOver=p.subarray(f,p.length)):(o=p.slice(0,f),this.leftOver=p.slice(f,p.length))),this.push({data:u.utf8decode(o),meta:h.meta})},k.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:u.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},u.Utf8DecodeWorker=k,r.inherits(y,c),y.prototype.processChunk=function(h){this.push({data:u.utf8encode(h.data),meta:h.meta})},u.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,u){var r=t("./support"),d=t("./base64"),i=t("./nodejsUtils"),c=t("./external");function m(s){return s}function _(s,f){for(var o=0;o<s.length;++o)f[o]=255&s.charCodeAt(o);return f}t("setimmediate"),u.newBlob=function(s,f){u.checkSupport("blob");try{return new Blob([s],{type:f})}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return o.append(s),o.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var k={stringifyByChunk:function(s,f,o){var g=[],w=0,I=s.length;if(I<=o)return String.fromCharCode.apply(null,s);for(;w<I;)f==="array"||f==="nodebuffer"?g.push(String.fromCharCode.apply(null,s.slice(w,Math.min(w+o,I)))):g.push(String.fromCharCode.apply(null,s.subarray(w,Math.min(w+o,I)))),w+=o;return g.join("")},stringifyByChar:function(s){for(var f="",o=0;o<s.length;o++)f+=String.fromCharCode(s[o]);return f},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,i.allocBuffer(1)).length===1}catch{return!1}}()}};function y(s){var f=65536,o=u.getTypeOf(s),g=!0;if(o==="uint8array"?g=k.applyCanBeUsed.uint8array:o==="nodebuffer"&&(g=k.applyCanBeUsed.nodebuffer),g)for(;1<f;)try{return k.stringifyByChunk(s,o,f)}catch{f=Math.floor(f/2)}return k.stringifyByChar(s)}function h(s,f){for(var o=0;o<s.length;o++)f[o]=s[o];return f}u.applyFromCharCode=y;var p={};p.string={string:m,array:function(s){return _(s,new Array(s.length))},arraybuffer:function(s){return p.string.uint8array(s).buffer},uint8array:function(s){return _(s,new Uint8Array(s.length))},nodebuffer:function(s){return _(s,i.allocBuffer(s.length))}},p.array={string:y,array:m,arraybuffer:function(s){return new Uint8Array(s).buffer},uint8array:function(s){return new Uint8Array(s)},nodebuffer:function(s){return i.newBufferFrom(s)}},p.arraybuffer={string:function(s){return y(new Uint8Array(s))},array:function(s){return h(new Uint8Array(s),new Array(s.byteLength))},arraybuffer:m,uint8array:function(s){return new Uint8Array(s)},nodebuffer:function(s){return i.newBufferFrom(new Uint8Array(s))}},p.uint8array={string:y,array:function(s){return h(s,new Array(s.length))},arraybuffer:function(s){return s.buffer},uint8array:m,nodebuffer:function(s){return i.newBufferFrom(s)}},p.nodebuffer={string:y,array:function(s){return h(s,new Array(s.length))},arraybuffer:function(s){return p.nodebuffer.uint8array(s).buffer},uint8array:function(s){return h(s,new Uint8Array(s.length))},nodebuffer:m},u.transformTo=function(s,f){if(f=f||"",!s)return f;u.checkSupport(s);var o=u.getTypeOf(f);return p[o][s](f)},u.resolve=function(s){for(var f=s.split("/"),o=[],g=0;g<f.length;g++){var w=f[g];w==="."||w===""&&g!==0&&g!==f.length-1||(w===".."?o.pop():o.push(w))}return o.join("/")},u.getTypeOf=function(s){return typeof s=="string"?"string":Object.prototype.toString.call(s)==="[object Array]"?"array":r.nodebuffer&&i.isBuffer(s)?"nodebuffer":r.uint8array&&s instanceof Uint8Array?"uint8array":r.arraybuffer&&s instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(s){if(!r[s.toLowerCase()])throw new Error(s+" is not supported by this platform")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(s){var f,o,g="";for(o=0;o<(s||"").length;o++)g+="\\x"+((f=s.charCodeAt(o))<16?"0":"")+f.toString(16).toUpperCase();return g},u.delay=function(s,f,o){setImmediate(function(){s.apply(o||null,f||[])})},u.inherits=function(s,f){function o(){}o.prototype=f.prototype,s.prototype=new o},u.extend=function(){var s,f,o={};for(s=0;s<arguments.length;s++)for(f in arguments[s])Object.prototype.hasOwnProperty.call(arguments[s],f)&&o[f]===void 0&&(o[f]=arguments[s][f]);return o},u.prepareContent=function(s,f,o,g,w){return c.Promise.resolve(f).then(function(I){return r.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new c.Promise(function(S,L){var A=new FileReader;A.onload=function(O){S(O.target.result)},A.onerror=function(O){L(O.target.error)},A.readAsArrayBuffer(I)}):I}).then(function(I){var S=u.getTypeOf(I);return S?(S==="arraybuffer"?I=u.transformTo("uint8array",I):S==="string"&&(w?I=d.decode(I):o&&g!==!0&&(I=function(L){return _(L,r.uint8array?new Uint8Array(L.length):new Array(L.length))}(I))),I):c.Promise.reject(new Error("Can't read the data of '"+s+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,u){var r=t("./reader/readerFor"),d=t("./utils"),i=t("./signature"),c=t("./zipEntry"),m=t("./support");function _(k){this.files=[],this.loadOptions=k}_.prototype={checkSignature:function(k){if(!this.reader.readAndCheckSignature(k)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(y)+", expected "+d.pretty(k)+")")}},isSignature:function(k,y){var h=this.reader.index;this.reader.setIndex(k);var p=this.reader.readString(4)===y;return this.reader.setIndex(h),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var k=this.reader.readData(this.zipCommentLength),y=m.uint8array?"uint8array":"array",h=d.transformTo(y,k);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var k,y,h,p=this.zip64EndOfCentralSize-44;0<p;)k=this.reader.readInt(2),y=this.reader.readInt(4),h=this.reader.readData(y),this.zip64ExtensibleData[k]={id:k,length:y,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var k,y;for(k=0;k<this.files.length;k++)y=this.files[k],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var k;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(k=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(k);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var k=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(k<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(k);var y=k;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(k=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(k),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var p=y-h;if(0<p)this.isSignature(y,i.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(k){this.reader=r(k)},load:function(k){this.prepareReader(k),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,u){var r=t("./reader/readerFor"),d=t("./utils"),i=t("./compressedObject"),c=t("./crc32"),m=t("./utf8"),_=t("./compressions"),k=t("./support");function y(h,p){this.options=h,this.loadOptions=p}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var p,s;if(h.skip(22),this.fileNameLength=h.readInt(2),s=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(s),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(f){for(var o in _)if(Object.prototype.hasOwnProperty.call(_,o)&&_[o].magic===f)return _[o];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,p,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var p=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(p),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=r(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var p,s,f,o=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<o;)p=h.readInt(2),s=h.readInt(2),f=h.readData(s),this.extraFields[p]={id:p,length:s,value:f};h.setIndex(o)},handleUTF8:function(){var h=k.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var s=d.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(s)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var o=d.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var p=r(h.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:m.utf8decode(p.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var p=r(h.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:m.utf8decode(p.readData(h.length-5))}return null}},n.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,u){function r(p,s,f){this.name=p,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=s,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var d=t("./stream/StreamHelper"),i=t("./stream/DataWorker"),c=t("./utf8"),m=t("./compressedObject"),_=t("./stream/GenericWorker");r.prototype={internalStream:function(p){var s=null,f="string";try{if(!p)throw new Error("No output type specified.");var o=(f=p.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),s=this._decompressWorker();var g=!this._dataBinary;g&&!o&&(s=s.pipe(new c.Utf8EncodeWorker)),!g&&o&&(s=s.pipe(new c.Utf8DecodeWorker))}catch(w){(s=new _("error")).error(w)}return new d(s,f,"")},async:function(p,s){return this.internalStream(p).accumulate(s)},nodeStream:function(p,s){return this.internalStream(p||"nodebuffer").toNodejsStream(s)},_compressWorker:function(p,s){if(this._data instanceof m&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new c.Utf8EncodeWorker)),m.createWorkerFrom(f,p,s)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof _?this._data:new i(this._data)}};for(var k=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<k.length;h++)r.prototype[k[h]]=y;n.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,u){(function(r){var d,i,c=r.MutationObserver||r.WebKitMutationObserver;if(c){var m=0,_=new c(p),k=r.document.createTextNode("");_.observe(k,{characterData:!0}),d=function(){k.data=m=++m%2}}else if(r.setImmediate||r.MessageChannel===void 0)d="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var s=r.document.createElement("script");s.onreadystatechange=function(){p(),s.onreadystatechange=null,s.parentNode.removeChild(s),s=null},r.document.documentElement.appendChild(s)}:function(){setTimeout(p,0)};else{var y=new r.MessageChannel;y.port1.onmessage=p,d=function(){y.port2.postMessage(0)}}var h=[];function p(){var s,f;i=!0;for(var o=h.length;o;){for(f=h,h=[],s=-1;++s<o;)f[s]();o=h.length}i=!1}n.exports=function(s){h.push(s)!==1||i||d()}}).call(this,typeof Bt<"u"?Bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,u){var r=t("immediate");function d(){}var i={},c=["REJECTED"],m=["FULFILLED"],_=["PENDING"];function k(o){if(typeof o!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,o!==d&&s(this,o)}function y(o,g,w){this.promise=o,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function h(o,g,w){r(function(){var I;try{I=g(w)}catch(S){return i.reject(o,S)}I===o?i.reject(o,new TypeError("Cannot resolve promise with itself")):i.resolve(o,I)})}function p(o){var g=o&&o.then;if(o&&(typeof o=="object"||typeof o=="function")&&typeof g=="function")return function(){g.apply(o,arguments)}}function s(o,g){var w=!1;function I(A){w||(w=!0,i.reject(o,A))}function S(A){w||(w=!0,i.resolve(o,A))}var L=f(function(){g(S,I)});L.status==="error"&&I(L.value)}function f(o,g){var w={};try{w.value=o(g),w.status="success"}catch(I){w.status="error",w.value=I}return w}(n.exports=k).prototype.finally=function(o){if(typeof o!="function")return this;var g=this.constructor;return this.then(function(w){return g.resolve(o()).then(function(){return w})},function(w){return g.resolve(o()).then(function(){throw w})})},k.prototype.catch=function(o){return this.then(null,o)},k.prototype.then=function(o,g){if(typeof o!="function"&&this.state===m||typeof g!="function"&&this.state===c)return this;var w=new this.constructor(d);return this.state!==_?h(w,this.state===m?o:g,this.outcome):this.queue.push(new y(w,o,g)),w},y.prototype.callFulfilled=function(o){i.resolve(this.promise,o)},y.prototype.otherCallFulfilled=function(o){h(this.promise,this.onFulfilled,o)},y.prototype.callRejected=function(o){i.reject(this.promise,o)},y.prototype.otherCallRejected=function(o){h(this.promise,this.onRejected,o)},i.resolve=function(o,g){var w=f(p,g);if(w.status==="error")return i.reject(o,w.value);var I=w.value;if(I)s(o,I);else{o.state=m,o.outcome=g;for(var S=-1,L=o.queue.length;++S<L;)o.queue[S].callFulfilled(g)}return o},i.reject=function(o,g){o.state=c,o.outcome=g;for(var w=-1,I=o.queue.length;++w<I;)o.queue[w].callRejected(g);return o},k.resolve=function(o){return o instanceof this?o:i.resolve(new this(d),o)},k.reject=function(o){var g=new this(d);return i.reject(g,o)},k.all=function(o){var g=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=o.length,I=!1;if(!w)return this.resolve([]);for(var S=new Array(w),L=0,A=-1,O=new this(d);++A<w;)P(o[A],A);return O;function P(R,G){g.resolve(R).then(function(C){S[G]=C,++L!==w||I||(I=!0,i.resolve(O,S))},function(C){I||(I=!0,i.reject(O,C))})}},k.race=function(o){var g=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=o.length,I=!1;if(!w)return this.resolve([]);for(var S=-1,L=new this(d);++S<w;)A=o[S],g.resolve(A).then(function(O){I||(I=!0,i.resolve(L,O))},function(O){I||(I=!0,i.reject(L,O))});var A;return L}},{immediate:36}],38:[function(t,n,u){var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,u){var r=t("./zlib/deflate"),d=t("./utils/common"),i=t("./utils/strings"),c=t("./zlib/messages"),m=t("./zlib/zstream"),_=Object.prototype.toString,k=0,y=-1,h=0,p=8;function s(o){if(!(this instanceof s))return new s(o);this.options=d.assign({level:y,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},o||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var w=r.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(w!==k)throw new Error(c[w]);if(g.header&&r.deflateSetHeader(this.strm,g.header),g.dictionary){var I;if(I=typeof g.dictionary=="string"?i.string2buf(g.dictionary):_.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(w=r.deflateSetDictionary(this.strm,I))!==k)throw new Error(c[w]);this._dict_set=!0}}function f(o,g){var w=new s(g);if(w.push(o,!0),w.err)throw w.msg||c[w.err];return w.result}s.prototype.push=function(o,g){var w,I,S=this.strm,L=this.options.chunkSize;if(this.ended)return!1;I=g===~~g?g:g===!0?4:0,typeof o=="string"?S.input=i.string2buf(o):_.call(o)==="[object ArrayBuffer]"?S.input=new Uint8Array(o):S.input=o,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new d.Buf8(L),S.next_out=0,S.avail_out=L),(w=r.deflate(S,I))!==1&&w!==k)return this.onEnd(w),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(i.buf2binstring(d.shrinkBuf(S.output,S.next_out))):this.onData(d.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&w!==1);return I===4?(w=r.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===k):I!==2||(this.onEnd(k),!(S.avail_out=0))},s.prototype.onData=function(o){this.chunks.push(o)},s.prototype.onEnd=function(o){o===k&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},u.Deflate=s,u.deflate=f,u.deflateRaw=function(o,g){return(g=g||{}).raw=!0,f(o,g)},u.gzip=function(o,g){return(g=g||{}).gzip=!0,f(o,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,u){var r=t("./zlib/inflate"),d=t("./utils/common"),i=t("./utils/strings"),c=t("./zlib/constants"),m=t("./zlib/messages"),_=t("./zlib/zstream"),k=t("./zlib/gzheader"),y=Object.prototype.toString;function h(s){if(!(this instanceof h))return new h(s);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},s||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||s&&s.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var o=r.inflateInit2(this.strm,f.windowBits);if(o!==c.Z_OK)throw new Error(m[o]);this.header=new k,r.inflateGetHeader(this.strm,this.header)}function p(s,f){var o=new h(f);if(o.push(s,!0),o.err)throw o.msg||m[o.err];return o.result}h.prototype.push=function(s,f){var o,g,w,I,S,L,A=this.strm,O=this.options.chunkSize,P=this.options.dictionary,R=!1;if(this.ended)return!1;g=f===~~f?f:f===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof s=="string"?A.input=i.binstring2buf(s):y.call(s)==="[object ArrayBuffer]"?A.input=new Uint8Array(s):A.input=s,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new d.Buf8(O),A.next_out=0,A.avail_out=O),(o=r.inflate(A,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&P&&(L=typeof P=="string"?i.string2buf(P):y.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,o=r.inflateSetDictionary(this.strm,L)),o===c.Z_BUF_ERROR&&R===!0&&(o=c.Z_OK,R=!1),o!==c.Z_STREAM_END&&o!==c.Z_OK)return this.onEnd(o),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&o!==c.Z_STREAM_END&&(A.avail_in!==0||g!==c.Z_FINISH&&g!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=i.utf8border(A.output,A.next_out),I=A.next_out-w,S=i.buf2string(A.output,w),A.next_out=I,A.avail_out=O-I,I&&d.arraySet(A.output,A.output,w,I,0),this.onData(S)):this.onData(d.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(R=!0)}while((0<A.avail_in||A.avail_out===0)&&o!==c.Z_STREAM_END);return o===c.Z_STREAM_END&&(g=c.Z_FINISH),g===c.Z_FINISH?(o=r.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===c.Z_OK):g!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(A.avail_out=0))},h.prototype.onData=function(s){this.chunks.push(s)},h.prototype.onEnd=function(s){s===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg},u.Inflate=h,u.inflate=p,u.inflateRaw=function(s,f){return(f=f||{}).raw=!0,p(s,f)},u.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,u){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";u.assign=function(c){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var _=m.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var k in _)_.hasOwnProperty(k)&&(c[k]=_[k])}}return c},u.shrinkBuf=function(c,m){return c.length===m?c:c.subarray?c.subarray(0,m):(c.length=m,c)};var d={arraySet:function(c,m,_,k,y){if(m.subarray&&c.subarray)c.set(m.subarray(_,_+k),y);else for(var h=0;h<k;h++)c[y+h]=m[_+h]},flattenChunks:function(c){var m,_,k,y,h,p;for(m=k=0,_=c.length;m<_;m++)k+=c[m].length;for(p=new Uint8Array(k),m=y=0,_=c.length;m<_;m++)h=c[m],p.set(h,y),y+=h.length;return p}},i={arraySet:function(c,m,_,k,y){for(var h=0;h<k;h++)c[y+h]=m[_+h]},flattenChunks:function(c){return[].concat.apply([],c)}};u.setTyped=function(c){c?(u.Buf8=Uint8Array,u.Buf16=Uint16Array,u.Buf32=Int32Array,u.assign(u,d)):(u.Buf8=Array,u.Buf16=Array,u.Buf32=Array,u.assign(u,i))},u.setTyped(r)},{}],42:[function(t,n,u){var r=t("./common"),d=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{i=!1}for(var c=new r.Buf8(256),m=0;m<256;m++)c[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function _(k,y){if(y<65537&&(k.subarray&&i||!k.subarray&&d))return String.fromCharCode.apply(null,r.shrinkBuf(k,y));for(var h="",p=0;p<y;p++)h+=String.fromCharCode(k[p]);return h}c[254]=c[254]=1,u.string2buf=function(k){var y,h,p,s,f,o=k.length,g=0;for(s=0;s<o;s++)(64512&(h=k.charCodeAt(s)))==55296&&s+1<o&&(64512&(p=k.charCodeAt(s+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),s++),g+=h<128?1:h<2048?2:h<65536?3:4;for(y=new r.Buf8(g),s=f=0;f<g;s++)(64512&(h=k.charCodeAt(s)))==55296&&s+1<o&&(64512&(p=k.charCodeAt(s+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),s++),h<128?y[f++]=h:(h<2048?y[f++]=192|h>>>6:(h<65536?y[f++]=224|h>>>12:(y[f++]=240|h>>>18,y[f++]=128|h>>>12&63),y[f++]=128|h>>>6&63),y[f++]=128|63&h);return y},u.buf2binstring=function(k){return _(k,k.length)},u.binstring2buf=function(k){for(var y=new r.Buf8(k.length),h=0,p=y.length;h<p;h++)y[h]=k.charCodeAt(h);return y},u.buf2string=function(k,y){var h,p,s,f,o=y||k.length,g=new Array(2*o);for(h=p=0;h<o;)if((s=k[h++])<128)g[p++]=s;else if(4<(f=c[s]))g[p++]=65533,h+=f-1;else{for(s&=f===2?31:f===3?15:7;1<f&&h<o;)s=s<<6|63&k[h++],f--;1<f?g[p++]=65533:s<65536?g[p++]=s:(s-=65536,g[p++]=55296|s>>10&1023,g[p++]=56320|1023&s)}return _(g,p)},u.utf8border=function(k,y){var h;for((y=y||k.length)>k.length&&(y=k.length),h=y-1;0<=h&&(192&k[h])==128;)h--;return h<0||h===0?y:h+c[k[h]]>y?h:y}},{"./common":41}],43:[function(t,n,u){n.exports=function(r,d,i,c){for(var m=65535&r|0,_=r>>>16&65535|0,k=0;i!==0;){for(i-=k=2e3<i?2e3:i;_=_+(m=m+d[c++]|0)|0,--k;);m%=65521,_%=65521}return m|_<<16|0}},{}],44:[function(t,n,u){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,u){var r=function(){for(var d,i=[],c=0;c<256;c++){d=c;for(var m=0;m<8;m++)d=1&d?3988292384^d>>>1:d>>>1;i[c]=d}return i}();n.exports=function(d,i,c,m){var _=r,k=m+c;d^=-1;for(var y=m;y<k;y++)d=d>>>8^_[255&(d^i[y])];return-1^d}},{}],46:[function(t,n,u){var r,d=t("../utils/common"),i=t("./trees"),c=t("./adler32"),m=t("./crc32"),_=t("./messages"),k=0,y=4,h=0,p=-2,s=-1,f=4,o=2,g=8,w=9,I=286,S=30,L=19,A=2*I+1,O=15,P=3,R=258,G=R+P+1,C=42,F=113,l=1,B=2,ee=3,W=4;function ie(a,j){return a.msg=_[j],j}function q(a){return(a<<1)-(4<a?9:0)}function ne(a){for(var j=a.length;0<=--j;)a[j]=0}function N(a){var j=a.state,U=j.pending;U>a.avail_out&&(U=a.avail_out),U!==0&&(d.arraySet(a.output,j.pending_buf,j.pending_out,U,a.next_out),a.next_out+=U,j.pending_out+=U,a.total_out+=U,a.avail_out-=U,j.pending-=U,j.pending===0&&(j.pending_out=0))}function D(a,j){i._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,j),a.block_start=a.strstart,N(a.strm)}function K(a,j){a.pending_buf[a.pending++]=j}function M(a,j){a.pending_buf[a.pending++]=j>>>8&255,a.pending_buf[a.pending++]=255&j}function $(a,j){var U,v,b=a.max_chain_length,E=a.strstart,V=a.prev_length,Z=a.nice_match,z=a.strstart>a.w_size-G?a.strstart-(a.w_size-G):0,X=a.window,te=a.w_mask,Q=a.prev,le=a.strstart+R,ve=X[E+V-1],ge=X[E+V];a.prev_length>=a.good_match&&(b>>=2),Z>a.lookahead&&(Z=a.lookahead);do if(X[(U=j)+V]===ge&&X[U+V-1]===ve&&X[U]===X[E]&&X[++U]===X[E+1]){E+=2,U++;do;while(X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&X[++E]===X[++U]&&E<le);if(v=R-(le-E),E=le-R,V<v){if(a.match_start=j,Z<=(V=v))break;ve=X[E+V-1],ge=X[E+V]}}while((j=Q[j&te])>z&&--b!=0);return V<=a.lookahead?V:a.lookahead}function ae(a){var j,U,v,b,E,V,Z,z,X,te,Q=a.w_size;do{if(b=a.window_size-a.lookahead-a.strstart,a.strstart>=Q+(Q-G)){for(d.arraySet(a.window,a.window,Q,Q,0),a.match_start-=Q,a.strstart-=Q,a.block_start-=Q,j=U=a.hash_size;v=a.head[--j],a.head[j]=Q<=v?v-Q:0,--U;);for(j=U=Q;v=a.prev[--j],a.prev[j]=Q<=v?v-Q:0,--U;);b+=Q}if(a.strm.avail_in===0)break;if(V=a.strm,Z=a.window,z=a.strstart+a.lookahead,X=b,te=void 0,te=V.avail_in,X<te&&(te=X),U=te===0?0:(V.avail_in-=te,d.arraySet(Z,V.input,V.next_in,te,z),V.state.wrap===1?V.adler=c(V.adler,Z,te,z):V.state.wrap===2&&(V.adler=m(V.adler,Z,te,z)),V.next_in+=te,V.total_in+=te,te),a.lookahead+=U,a.lookahead+a.insert>=P)for(E=a.strstart-a.insert,a.ins_h=a.window[E],a.ins_h=(a.ins_h<<a.hash_shift^a.window[E+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[E+P-1])&a.hash_mask,a.prev[E&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=E,E++,a.insert--,!(a.lookahead+a.insert<P)););}while(a.lookahead<G&&a.strm.avail_in!==0)}function be(a,j){for(var U,v;;){if(a.lookahead<G){if(ae(a),a.lookahead<G&&j===k)return l;if(a.lookahead===0)break}if(U=0,a.lookahead>=P&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+P-1])&a.hash_mask,U=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),U!==0&&a.strstart-U<=a.w_size-G&&(a.match_length=$(a,U)),a.match_length>=P)if(v=i._tr_tally(a,a.strstart-a.match_start,a.match_length-P),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=P){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+P-1])&a.hash_mask,U=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else v=i._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(v&&(D(a,!1),a.strm.avail_out===0))return l}return a.insert=a.strstart<P-1?a.strstart:P-1,j===y?(D(a,!0),a.strm.avail_out===0?ee:W):a.last_lit&&(D(a,!1),a.strm.avail_out===0)?l:B}function re(a,j){for(var U,v,b;;){if(a.lookahead<G){if(ae(a),a.lookahead<G&&j===k)return l;if(a.lookahead===0)break}if(U=0,a.lookahead>=P&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+P-1])&a.hash_mask,U=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=P-1,U!==0&&a.prev_length<a.max_lazy_match&&a.strstart-U<=a.w_size-G&&(a.match_length=$(a,U),a.match_length<=5&&(a.strategy===1||a.match_length===P&&4096<a.strstart-a.match_start)&&(a.match_length=P-1)),a.prev_length>=P&&a.match_length<=a.prev_length){for(b=a.strstart+a.lookahead-P,v=i._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-P),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=b&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+P-1])&a.hash_mask,U=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=P-1,a.strstart++,v&&(D(a,!1),a.strm.avail_out===0))return l}else if(a.match_available){if((v=i._tr_tally(a,0,a.window[a.strstart-1]))&&D(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return l}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(v=i._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<P-1?a.strstart:P-1,j===y?(D(a,!0),a.strm.avail_out===0?ee:W):a.last_lit&&(D(a,!1),a.strm.avail_out===0)?l:B}function ce(a,j,U,v,b){this.good_length=a,this.max_lazy=j,this.nice_length=U,this.max_chain=v,this.func=b}function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*A),this.dyn_dtree=new d.Buf16(2*(2*S+1)),this.bl_tree=new d.Buf16(2*(2*L+1)),ne(this.dyn_ltree),ne(this.dyn_dtree),ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(O+1),this.heap=new d.Buf16(2*I+1),ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*I+1),ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function de(a){var j;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=o,(j=a.state).pending=0,j.pending_out=0,j.wrap<0&&(j.wrap=-j.wrap),j.status=j.wrap?C:F,a.adler=j.wrap===2?0:1,j.last_flush=k,i._tr_init(j),h):ie(a,p)}function xe(a){var j=de(a);return j===h&&function(U){U.window_size=2*U.w_size,ne(U.head),U.max_lazy_match=r[U.level].max_lazy,U.good_match=r[U.level].good_length,U.nice_match=r[U.level].nice_length,U.max_chain_length=r[U.level].max_chain,U.strstart=0,U.block_start=0,U.lookahead=0,U.insert=0,U.match_length=U.prev_length=P-1,U.match_available=0,U.ins_h=0}(a.state),j}function Pe(a,j,U,v,b,E){if(!a)return p;var V=1;if(j===s&&(j=6),v<0?(V=0,v=-v):15<v&&(V=2,v-=16),b<1||w<b||U!==g||v<8||15<v||j<0||9<j||E<0||f<E)return ie(a,p);v===8&&(v=9);var Z=new Y;return(a.state=Z).strm=a,Z.wrap=V,Z.gzhead=null,Z.w_bits=v,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=b+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+P-1)/P),Z.window=new d.Buf8(2*Z.w_size),Z.head=new d.Buf16(Z.hash_size),Z.prev=new d.Buf16(Z.w_size),Z.lit_bufsize=1<<b+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new d.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=j,Z.strategy=E,Z.method=U,xe(a)}r=[new ce(0,0,0,0,function(a,j){var U=65535;for(U>a.pending_buf_size-5&&(U=a.pending_buf_size-5);;){if(a.lookahead<=1){if(ae(a),a.lookahead===0&&j===k)return l;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var v=a.block_start+U;if((a.strstart===0||a.strstart>=v)&&(a.lookahead=a.strstart-v,a.strstart=v,D(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-G&&(D(a,!1),a.strm.avail_out===0))return l}return a.insert=0,j===y?(D(a,!0),a.strm.avail_out===0?ee:W):(a.strstart>a.block_start&&(D(a,!1),a.strm.avail_out),l)}),new ce(4,4,8,4,be),new ce(4,5,16,8,be),new ce(4,6,32,32,be),new ce(4,4,16,16,re),new ce(8,16,32,32,re),new ce(8,16,128,128,re),new ce(8,32,128,256,re),new ce(32,128,258,1024,re),new ce(32,258,258,4096,re)],u.deflateInit=function(a,j){return Pe(a,j,g,15,8,0)},u.deflateInit2=Pe,u.deflateReset=xe,u.deflateResetKeep=de,u.deflateSetHeader=function(a,j){return a&&a.state?a.state.wrap!==2?p:(a.state.gzhead=j,h):p},u.deflate=function(a,j){var U,v,b,E;if(!a||!a.state||5<j||j<0)return a?ie(a,p):p;if(v=a.state,!a.output||!a.input&&a.avail_in!==0||v.status===666&&j!==y)return ie(a,a.avail_out===0?-5:p);if(v.strm=a,U=v.last_flush,v.last_flush=j,v.status===C)if(v.wrap===2)a.adler=0,K(v,31),K(v,139),K(v,8),v.gzhead?(K(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),K(v,255&v.gzhead.time),K(v,v.gzhead.time>>8&255),K(v,v.gzhead.time>>16&255),K(v,v.gzhead.time>>24&255),K(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),K(v,255&v.gzhead.os),v.gzhead.extra&&v.gzhead.extra.length&&(K(v,255&v.gzhead.extra.length),K(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(a.adler=m(a.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=69):(K(v,0),K(v,0),K(v,0),K(v,0),K(v,0),K(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),K(v,3),v.status=F);else{var V=g+(v.w_bits-8<<4)<<8;V|=(2<=v.strategy||v.level<2?0:v.level<6?1:v.level===6?2:3)<<6,v.strstart!==0&&(V|=32),V+=31-V%31,v.status=F,M(v,V),v.strstart!==0&&(M(v,a.adler>>>16),M(v,65535&a.adler)),a.adler=1}if(v.status===69)if(v.gzhead.extra){for(b=v.pending;v.gzindex<(65535&v.gzhead.extra.length)&&(v.pending!==v.pending_buf_size||(v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),N(a),b=v.pending,v.pending!==v.pending_buf_size));)K(v,255&v.gzhead.extra[v.gzindex]),v.gzindex++;v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=73)}else v.status=73;if(v.status===73)if(v.gzhead.name){b=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),N(a),b=v.pending,v.pending===v.pending_buf_size)){E=1;break}E=v.gzindex<v.gzhead.name.length?255&v.gzhead.name.charCodeAt(v.gzindex++):0,K(v,E)}while(E!==0);v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),E===0&&(v.gzindex=0,v.status=91)}else v.status=91;if(v.status===91)if(v.gzhead.comment){b=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),N(a),b=v.pending,v.pending===v.pending_buf_size)){E=1;break}E=v.gzindex<v.gzhead.comment.length?255&v.gzhead.comment.charCodeAt(v.gzindex++):0,K(v,E)}while(E!==0);v.gzhead.hcrc&&v.pending>b&&(a.adler=m(a.adler,v.pending_buf,v.pending-b,b)),E===0&&(v.status=103)}else v.status=103;if(v.status===103&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&N(a),v.pending+2<=v.pending_buf_size&&(K(v,255&a.adler),K(v,a.adler>>8&255),a.adler=0,v.status=F)):v.status=F),v.pending!==0){if(N(a),a.avail_out===0)return v.last_flush=-1,h}else if(a.avail_in===0&&q(j)<=q(U)&&j!==y)return ie(a,-5);if(v.status===666&&a.avail_in!==0)return ie(a,-5);if(a.avail_in!==0||v.lookahead!==0||j!==k&&v.status!==666){var Z=v.strategy===2?function(z,X){for(var te;;){if(z.lookahead===0&&(ae(z),z.lookahead===0)){if(X===k)return l;break}if(z.match_length=0,te=i._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,te&&(D(z,!1),z.strm.avail_out===0))return l}return z.insert=0,X===y?(D(z,!0),z.strm.avail_out===0?ee:W):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?l:B}(v,j):v.strategy===3?function(z,X){for(var te,Q,le,ve,ge=z.window;;){if(z.lookahead<=R){if(ae(z),z.lookahead<=R&&X===k)return l;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=P&&0<z.strstart&&(Q=ge[le=z.strstart-1])===ge[++le]&&Q===ge[++le]&&Q===ge[++le]){ve=z.strstart+R;do;while(Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&Q===ge[++le]&&le<ve);z.match_length=R-(ve-le),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=P?(te=i._tr_tally(z,1,z.match_length-P),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(te=i._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),te&&(D(z,!1),z.strm.avail_out===0))return l}return z.insert=0,X===y?(D(z,!0),z.strm.avail_out===0?ee:W):z.last_lit&&(D(z,!1),z.strm.avail_out===0)?l:B}(v,j):r[v.level].func(v,j);if(Z!==ee&&Z!==W||(v.status=666),Z===l||Z===ee)return a.avail_out===0&&(v.last_flush=-1),h;if(Z===B&&(j===1?i._tr_align(v):j!==5&&(i._tr_stored_block(v,0,0,!1),j===3&&(ne(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),N(a),a.avail_out===0))return v.last_flush=-1,h}return j!==y?h:v.wrap<=0?1:(v.wrap===2?(K(v,255&a.adler),K(v,a.adler>>8&255),K(v,a.adler>>16&255),K(v,a.adler>>24&255),K(v,255&a.total_in),K(v,a.total_in>>8&255),K(v,a.total_in>>16&255),K(v,a.total_in>>24&255)):(M(v,a.adler>>>16),M(v,65535&a.adler)),N(a),0<v.wrap&&(v.wrap=-v.wrap),v.pending!==0?h:1)},u.deflateEnd=function(a){var j;return a&&a.state?(j=a.state.status)!==C&&j!==69&&j!==73&&j!==91&&j!==103&&j!==F&&j!==666?ie(a,p):(a.state=null,j===F?ie(a,-3):h):p},u.deflateSetDictionary=function(a,j){var U,v,b,E,V,Z,z,X,te=j.length;if(!a||!a.state||(E=(U=a.state).wrap)===2||E===1&&U.status!==C||U.lookahead)return p;for(E===1&&(a.adler=c(a.adler,j,te,0)),U.wrap=0,te>=U.w_size&&(E===0&&(ne(U.head),U.strstart=0,U.block_start=0,U.insert=0),X=new d.Buf8(U.w_size),d.arraySet(X,j,te-U.w_size,U.w_size,0),j=X,te=U.w_size),V=a.avail_in,Z=a.next_in,z=a.input,a.avail_in=te,a.next_in=0,a.input=j,ae(U);U.lookahead>=P;){for(v=U.strstart,b=U.lookahead-(P-1);U.ins_h=(U.ins_h<<U.hash_shift^U.window[v+P-1])&U.hash_mask,U.prev[v&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=v,v++,--b;);U.strstart=v,U.lookahead=P-1,ae(U)}return U.strstart+=U.lookahead,U.block_start=U.strstart,U.insert=U.lookahead,U.lookahead=0,U.match_length=U.prev_length=P-1,U.match_available=0,a.next_in=Z,a.input=z,a.avail_in=V,U.wrap=E,h},u.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,u){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,u){n.exports=function(r,d){var i,c,m,_,k,y,h,p,s,f,o,g,w,I,S,L,A,O,P,R,G,C,F,l,B;i=r.state,c=r.next_in,l=r.input,m=c+(r.avail_in-5),_=r.next_out,B=r.output,k=_-(d-r.avail_out),y=_+(r.avail_out-257),h=i.dmax,p=i.wsize,s=i.whave,f=i.wnext,o=i.window,g=i.hold,w=i.bits,I=i.lencode,S=i.distcode,L=(1<<i.lenbits)-1,A=(1<<i.distbits)-1;e:do{w<15&&(g+=l[c++]<<w,w+=8,g+=l[c++]<<w,w+=8),O=I[g&L];t:for(;;){if(g>>>=P=O>>>24,w-=P,(P=O>>>16&255)===0)B[_++]=65535&O;else{if(!(16&P)){if((64&P)==0){O=I[(65535&O)+(g&(1<<P)-1)];continue t}if(32&P){i.mode=12;break e}r.msg="invalid literal/length code",i.mode=30;break e}R=65535&O,(P&=15)&&(w<P&&(g+=l[c++]<<w,w+=8),R+=g&(1<<P)-1,g>>>=P,w-=P),w<15&&(g+=l[c++]<<w,w+=8,g+=l[c++]<<w,w+=8),O=S[g&A];a:for(;;){if(g>>>=P=O>>>24,w-=P,!(16&(P=O>>>16&255))){if((64&P)==0){O=S[(65535&O)+(g&(1<<P)-1)];continue a}r.msg="invalid distance code",i.mode=30;break e}if(G=65535&O,w<(P&=15)&&(g+=l[c++]<<w,(w+=8)<P&&(g+=l[c++]<<w,w+=8)),h<(G+=g&(1<<P)-1)){r.msg="invalid distance too far back",i.mode=30;break e}if(g>>>=P,w-=P,(P=_-k)<G){if(s<(P=G-P)&&i.sane){r.msg="invalid distance too far back",i.mode=30;break e}if(F=o,(C=0)===f){if(C+=p-P,P<R){for(R-=P;B[_++]=o[C++],--P;);C=_-G,F=B}}else if(f<P){if(C+=p+f-P,(P-=f)<R){for(R-=P;B[_++]=o[C++],--P;);if(C=0,f<R){for(R-=P=f;B[_++]=o[C++],--P;);C=_-G,F=B}}}else if(C+=f-P,P<R){for(R-=P;B[_++]=o[C++],--P;);C=_-G,F=B}for(;2<R;)B[_++]=F[C++],B[_++]=F[C++],B[_++]=F[C++],R-=3;R&&(B[_++]=F[C++],1<R&&(B[_++]=F[C++]))}else{for(C=_-G;B[_++]=B[C++],B[_++]=B[C++],B[_++]=B[C++],2<(R-=3););R&&(B[_++]=B[C++],1<R&&(B[_++]=B[C++]))}break}}break}}while(c<m&&_<y);c-=R=w>>3,g&=(1<<(w-=R<<3))-1,r.next_in=c,r.next_out=_,r.avail_in=c<m?m-c+5:5-(c-m),r.avail_out=_<y?y-_+257:257-(_-y),i.hold=g,i.bits=w}},{}],49:[function(t,n,u){var r=t("../utils/common"),d=t("./adler32"),i=t("./crc32"),c=t("./inffast"),m=t("./inftrees"),_=1,k=2,y=0,h=-2,p=1,s=852,f=592;function o(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(C){var F;return C&&C.state?(F=C.state,C.total_in=C.total_out=F.total=0,C.msg="",F.wrap&&(C.adler=1&F.wrap),F.mode=p,F.last=0,F.havedict=0,F.dmax=32768,F.head=null,F.hold=0,F.bits=0,F.lencode=F.lendyn=new r.Buf32(s),F.distcode=F.distdyn=new r.Buf32(f),F.sane=1,F.back=-1,y):h}function I(C){var F;return C&&C.state?((F=C.state).wsize=0,F.whave=0,F.wnext=0,w(C)):h}function S(C,F){var l,B;return C&&C.state?(B=C.state,F<0?(l=0,F=-F):(l=1+(F>>4),F<48&&(F&=15)),F&&(F<8||15<F)?h:(B.window!==null&&B.wbits!==F&&(B.window=null),B.wrap=l,B.wbits=F,I(C))):h}function L(C,F){var l,B;return C?(B=new g,(C.state=B).window=null,(l=S(C,F))!==y&&(C.state=null),l):h}var A,O,P=!0;function R(C){if(P){var F;for(A=new r.Buf32(512),O=new r.Buf32(32),F=0;F<144;)C.lens[F++]=8;for(;F<256;)C.lens[F++]=9;for(;F<280;)C.lens[F++]=7;for(;F<288;)C.lens[F++]=8;for(m(_,C.lens,0,288,A,0,C.work,{bits:9}),F=0;F<32;)C.lens[F++]=5;m(k,C.lens,0,32,O,0,C.work,{bits:5}),P=!1}C.lencode=A,C.lenbits=9,C.distcode=O,C.distbits=5}function G(C,F,l,B){var ee,W=C.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new r.Buf8(W.wsize)),B>=W.wsize?(r.arraySet(W.window,F,l-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(B<(ee=W.wsize-W.wnext)&&(ee=B),r.arraySet(W.window,F,l-B,ee,W.wnext),(B-=ee)?(r.arraySet(W.window,F,l-B,B,0),W.wnext=B,W.whave=W.wsize):(W.wnext+=ee,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=ee))),0}u.inflateReset=I,u.inflateReset2=S,u.inflateResetKeep=w,u.inflateInit=function(C){return L(C,15)},u.inflateInit2=L,u.inflate=function(C,F){var l,B,ee,W,ie,q,ne,N,D,K,M,$,ae,be,re,ce,Y,de,xe,Pe,a,j,U,v,b=0,E=new r.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return h;(l=C.state).mode===12&&(l.mode=13),ie=C.next_out,ee=C.output,ne=C.avail_out,W=C.next_in,B=C.input,q=C.avail_in,N=l.hold,D=l.bits,K=q,M=ne,j=y;e:for(;;)switch(l.mode){case p:if(l.wrap===0){l.mode=13;break}for(;D<16;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(2&l.wrap&&N===35615){E[l.check=0]=255&N,E[1]=N>>>8&255,l.check=i(l.check,E,2,0),D=N=0,l.mode=2;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&N)<<8)+(N>>8))%31){C.msg="incorrect header check",l.mode=30;break}if((15&N)!=8){C.msg="unknown compression method",l.mode=30;break}if(D-=4,a=8+(15&(N>>>=4)),l.wbits===0)l.wbits=a;else if(a>l.wbits){C.msg="invalid window size",l.mode=30;break}l.dmax=1<<a,C.adler=l.check=1,l.mode=512&N?10:12,D=N=0;break;case 2:for(;D<16;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(l.flags=N,(255&l.flags)!=8){C.msg="unknown compression method",l.mode=30;break}if(57344&l.flags){C.msg="unknown header flags set",l.mode=30;break}l.head&&(l.head.text=N>>8&1),512&l.flags&&(E[0]=255&N,E[1]=N>>>8&255,l.check=i(l.check,E,2,0)),D=N=0,l.mode=3;case 3:for(;D<32;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.head&&(l.head.time=N),512&l.flags&&(E[0]=255&N,E[1]=N>>>8&255,E[2]=N>>>16&255,E[3]=N>>>24&255,l.check=i(l.check,E,4,0)),D=N=0,l.mode=4;case 4:for(;D<16;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.head&&(l.head.xflags=255&N,l.head.os=N>>8),512&l.flags&&(E[0]=255&N,E[1]=N>>>8&255,l.check=i(l.check,E,2,0)),D=N=0,l.mode=5;case 5:if(1024&l.flags){for(;D<16;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.length=N,l.head&&(l.head.extra_len=N),512&l.flags&&(E[0]=255&N,E[1]=N>>>8&255,l.check=i(l.check,E,2,0)),D=N=0}else l.head&&(l.head.extra=null);l.mode=6;case 6:if(1024&l.flags&&(q<($=l.length)&&($=q),$&&(l.head&&(a=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),r.arraySet(l.head.extra,B,W,$,a)),512&l.flags&&(l.check=i(l.check,B,$,W)),q-=$,W+=$,l.length-=$),l.length))break e;l.length=0,l.mode=7;case 7:if(2048&l.flags){if(q===0)break e;for($=0;a=B[W+$++],l.head&&a&&l.length<65536&&(l.head.name+=String.fromCharCode(a)),a&&$<q;);if(512&l.flags&&(l.check=i(l.check,B,$,W)),q-=$,W+=$,a)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=8;case 8:if(4096&l.flags){if(q===0)break e;for($=0;a=B[W+$++],l.head&&a&&l.length<65536&&(l.head.comment+=String.fromCharCode(a)),a&&$<q;);if(512&l.flags&&(l.check=i(l.check,B,$,W)),q-=$,W+=$,a)break e}else l.head&&(l.head.comment=null);l.mode=9;case 9:if(512&l.flags){for(;D<16;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(N!==(65535&l.check)){C.msg="header crc mismatch",l.mode=30;break}D=N=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),C.adler=l.check=0,l.mode=12;break;case 10:for(;D<32;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}C.adler=l.check=o(N),D=N=0,l.mode=11;case 11:if(l.havedict===0)return C.next_out=ie,C.avail_out=ne,C.next_in=W,C.avail_in=q,l.hold=N,l.bits=D,2;C.adler=l.check=1,l.mode=12;case 12:if(F===5||F===6)break e;case 13:if(l.last){N>>>=7&D,D-=7&D,l.mode=27;break}for(;D<3;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}switch(l.last=1&N,D-=1,3&(N>>>=1)){case 0:l.mode=14;break;case 1:if(R(l),l.mode=20,F!==6)break;N>>>=2,D-=2;break e;case 2:l.mode=17;break;case 3:C.msg="invalid block type",l.mode=30}N>>>=2,D-=2;break;case 14:for(N>>>=7&D,D-=7&D;D<32;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if((65535&N)!=(N>>>16^65535)){C.msg="invalid stored block lengths",l.mode=30;break}if(l.length=65535&N,D=N=0,l.mode=15,F===6)break e;case 15:l.mode=16;case 16:if($=l.length){if(q<$&&($=q),ne<$&&($=ne),$===0)break e;r.arraySet(ee,B,W,$,ie),q-=$,W+=$,ne-=$,ie+=$,l.length-=$;break}l.mode=12;break;case 17:for(;D<14;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(l.nlen=257+(31&N),N>>>=5,D-=5,l.ndist=1+(31&N),N>>>=5,D-=5,l.ncode=4+(15&N),N>>>=4,D-=4,286<l.nlen||30<l.ndist){C.msg="too many length or distance symbols",l.mode=30;break}l.have=0,l.mode=18;case 18:for(;l.have<l.ncode;){for(;D<3;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.lens[V[l.have++]]=7&N,N>>>=3,D-=3}for(;l.have<19;)l.lens[V[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,U={bits:l.lenbits},j=m(0,l.lens,0,19,l.lencode,0,l.work,U),l.lenbits=U.bits,j){C.msg="invalid code lengths set",l.mode=30;break}l.have=0,l.mode=19;case 19:for(;l.have<l.nlen+l.ndist;){for(;ce=(b=l.lencode[N&(1<<l.lenbits)-1])>>>16&255,Y=65535&b,!((re=b>>>24)<=D);){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(Y<16)N>>>=re,D-=re,l.lens[l.have++]=Y;else{if(Y===16){for(v=re+2;D<v;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(N>>>=re,D-=re,l.have===0){C.msg="invalid bit length repeat",l.mode=30;break}a=l.lens[l.have-1],$=3+(3&N),N>>>=2,D-=2}else if(Y===17){for(v=re+3;D<v;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}D-=re,a=0,$=3+(7&(N>>>=re)),N>>>=3,D-=3}else{for(v=re+7;D<v;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}D-=re,a=0,$=11+(127&(N>>>=re)),N>>>=7,D-=7}if(l.have+$>l.nlen+l.ndist){C.msg="invalid bit length repeat",l.mode=30;break}for(;$--;)l.lens[l.have++]=a}}if(l.mode===30)break;if(l.lens[256]===0){C.msg="invalid code -- missing end-of-block",l.mode=30;break}if(l.lenbits=9,U={bits:l.lenbits},j=m(_,l.lens,0,l.nlen,l.lencode,0,l.work,U),l.lenbits=U.bits,j){C.msg="invalid literal/lengths set",l.mode=30;break}if(l.distbits=6,l.distcode=l.distdyn,U={bits:l.distbits},j=m(k,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,U),l.distbits=U.bits,j){C.msg="invalid distances set",l.mode=30;break}if(l.mode=20,F===6)break e;case 20:l.mode=21;case 21:if(6<=q&&258<=ne){C.next_out=ie,C.avail_out=ne,C.next_in=W,C.avail_in=q,l.hold=N,l.bits=D,c(C,M),ie=C.next_out,ee=C.output,ne=C.avail_out,W=C.next_in,B=C.input,q=C.avail_in,N=l.hold,D=l.bits,l.mode===12&&(l.back=-1);break}for(l.back=0;ce=(b=l.lencode[N&(1<<l.lenbits)-1])>>>16&255,Y=65535&b,!((re=b>>>24)<=D);){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(ce&&(240&ce)==0){for(de=re,xe=ce,Pe=Y;ce=(b=l.lencode[Pe+((N&(1<<de+xe)-1)>>de)])>>>16&255,Y=65535&b,!(de+(re=b>>>24)<=D);){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}N>>>=de,D-=de,l.back+=de}if(N>>>=re,D-=re,l.back+=re,l.length=Y,ce===0){l.mode=26;break}if(32&ce){l.back=-1,l.mode=12;break}if(64&ce){C.msg="invalid literal/length code",l.mode=30;break}l.extra=15&ce,l.mode=22;case 22:if(l.extra){for(v=l.extra;D<v;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.length+=N&(1<<l.extra)-1,N>>>=l.extra,D-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=23;case 23:for(;ce=(b=l.distcode[N&(1<<l.distbits)-1])>>>16&255,Y=65535&b,!((re=b>>>24)<=D);){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if((240&ce)==0){for(de=re,xe=ce,Pe=Y;ce=(b=l.distcode[Pe+((N&(1<<de+xe)-1)>>de)])>>>16&255,Y=65535&b,!(de+(re=b>>>24)<=D);){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}N>>>=de,D-=de,l.back+=de}if(N>>>=re,D-=re,l.back+=re,64&ce){C.msg="invalid distance code",l.mode=30;break}l.offset=Y,l.extra=15&ce,l.mode=24;case 24:if(l.extra){for(v=l.extra;D<v;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}l.offset+=N&(1<<l.extra)-1,N>>>=l.extra,D-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){C.msg="invalid distance too far back",l.mode=30;break}l.mode=25;case 25:if(ne===0)break e;if($=M-ne,l.offset>$){if(($=l.offset-$)>l.whave&&l.sane){C.msg="invalid distance too far back",l.mode=30;break}ae=$>l.wnext?($-=l.wnext,l.wsize-$):l.wnext-$,$>l.length&&($=l.length),be=l.window}else be=ee,ae=ie-l.offset,$=l.length;for(ne<$&&($=ne),ne-=$,l.length-=$;ee[ie++]=be[ae++],--$;);l.length===0&&(l.mode=21);break;case 26:if(ne===0)break e;ee[ie++]=l.length,ne--,l.mode=21;break;case 27:if(l.wrap){for(;D<32;){if(q===0)break e;q--,N|=B[W++]<<D,D+=8}if(M-=ne,C.total_out+=M,l.total+=M,M&&(C.adler=l.check=l.flags?i(l.check,ee,M,ie-M):d(l.check,ee,M,ie-M)),M=ne,(l.flags?N:o(N))!==l.check){C.msg="incorrect data check",l.mode=30;break}D=N=0}l.mode=28;case 28:if(l.wrap&&l.flags){for(;D<32;){if(q===0)break e;q--,N+=B[W++]<<D,D+=8}if(N!==(4294967295&l.total)){C.msg="incorrect length check",l.mode=30;break}D=N=0}l.mode=29;case 29:j=1;break e;case 30:j=-3;break e;case 31:return-4;case 32:default:return h}return C.next_out=ie,C.avail_out=ne,C.next_in=W,C.avail_in=q,l.hold=N,l.bits=D,(l.wsize||M!==C.avail_out&&l.mode<30&&(l.mode<27||F!==4))&&G(C,C.output,C.next_out,M-C.avail_out)?(l.mode=31,-4):(K-=C.avail_in,M-=C.avail_out,C.total_in+=K,C.total_out+=M,l.total+=M,l.wrap&&M&&(C.adler=l.check=l.flags?i(l.check,ee,M,C.next_out-M):d(l.check,ee,M,C.next_out-M)),C.data_type=l.bits+(l.last?64:0)+(l.mode===12?128:0)+(l.mode===20||l.mode===15?256:0),(K==0&&M===0||F===4)&&j===y&&(j=-5),j)},u.inflateEnd=function(C){if(!C||!C.state)return h;var F=C.state;return F.window&&(F.window=null),C.state=null,y},u.inflateGetHeader=function(C,F){var l;return C&&C.state?(2&(l=C.state).wrap)==0?h:((l.head=F).done=!1,y):h},u.inflateSetDictionary=function(C,F){var l,B=F.length;return C&&C.state?(l=C.state).wrap!==0&&l.mode!==11?h:l.mode===11&&d(1,F,B,0)!==l.check?-3:G(C,F,B,B)?(l.mode=31,-4):(l.havedict=1,y):h},u.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,u){var r=t("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(_,k,y,h,p,s,f,o){var g,w,I,S,L,A,O,P,R,G=o.bits,C=0,F=0,l=0,B=0,ee=0,W=0,ie=0,q=0,ne=0,N=0,D=null,K=0,M=new r.Buf16(16),$=new r.Buf16(16),ae=null,be=0;for(C=0;C<=15;C++)M[C]=0;for(F=0;F<h;F++)M[k[y+F]]++;for(ee=G,B=15;1<=B&&M[B]===0;B--);if(B<ee&&(ee=B),B===0)return p[s++]=20971520,p[s++]=20971520,o.bits=1,0;for(l=1;l<B&&M[l]===0;l++);for(ee<l&&(ee=l),C=q=1;C<=15;C++)if(q<<=1,(q-=M[C])<0)return-1;if(0<q&&(_===0||B!==1))return-1;for($[1]=0,C=1;C<15;C++)$[C+1]=$[C]+M[C];for(F=0;F<h;F++)k[y+F]!==0&&(f[$[k[y+F]]++]=F);if(A=_===0?(D=ae=f,19):_===1?(D=d,K-=257,ae=i,be-=257,256):(D=c,ae=m,-1),C=l,L=s,ie=F=N=0,I=-1,S=(ne=1<<(W=ee))-1,_===1&&852<ne||_===2&&592<ne)return 1;for(;;){for(O=C-ie,R=f[F]<A?(P=0,f[F]):f[F]>A?(P=ae[be+f[F]],D[K+f[F]]):(P=96,0),g=1<<C-ie,l=w=1<<W;p[L+(N>>ie)+(w-=g)]=O<<24|P<<16|R|0,w!==0;);for(g=1<<C-1;N&g;)g>>=1;if(g!==0?(N&=g-1,N+=g):N=0,F++,--M[C]==0){if(C===B)break;C=k[y+f[F]]}if(ee<C&&(N&S)!==I){for(ie===0&&(ie=ee),L+=l,q=1<<(W=C-ie);W+ie<B&&!((q-=M[W+ie])<=0);)W++,q<<=1;if(ne+=1<<W,_===1&&852<ne||_===2&&592<ne)return 1;p[I=N&S]=ee<<24|W<<16|L-s|0}}return N!==0&&(p[L+N]=C-ie<<24|64<<16|0),o.bits=ee,0}},{"../utils/common":41}],51:[function(t,n,u){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,u){var r=t("../utils/common"),d=0,i=1;function c(b){for(var E=b.length;0<=--E;)b[E]=0}var m=0,_=29,k=256,y=k+1+_,h=30,p=19,s=2*y+1,f=15,o=16,g=7,w=256,I=16,S=17,L=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(y+2));c(G);var C=new Array(2*h);c(C);var F=new Array(512);c(F);var l=new Array(256);c(l);var B=new Array(_);c(B);var ee,W,ie,q=new Array(h);function ne(b,E,V,Z,z){this.static_tree=b,this.extra_bits=E,this.extra_base=V,this.elems=Z,this.max_length=z,this.has_stree=b&&b.length}function N(b,E){this.dyn_tree=b,this.max_code=0,this.stat_desc=E}function D(b){return b<256?F[b]:F[256+(b>>>7)]}function K(b,E){b.pending_buf[b.pending++]=255&E,b.pending_buf[b.pending++]=E>>>8&255}function M(b,E,V){b.bi_valid>o-V?(b.bi_buf|=E<<b.bi_valid&65535,K(b,b.bi_buf),b.bi_buf=E>>o-b.bi_valid,b.bi_valid+=V-o):(b.bi_buf|=E<<b.bi_valid&65535,b.bi_valid+=V)}function $(b,E,V){M(b,V[2*E],V[2*E+1])}function ae(b,E){for(var V=0;V|=1&b,b>>>=1,V<<=1,0<--E;);return V>>>1}function be(b,E,V){var Z,z,X=new Array(f+1),te=0;for(Z=1;Z<=f;Z++)X[Z]=te=te+V[Z-1]<<1;for(z=0;z<=E;z++){var Q=b[2*z+1];Q!==0&&(b[2*z]=ae(X[Q]++,Q))}}function re(b){var E;for(E=0;E<y;E++)b.dyn_ltree[2*E]=0;for(E=0;E<h;E++)b.dyn_dtree[2*E]=0;for(E=0;E<p;E++)b.bl_tree[2*E]=0;b.dyn_ltree[2*w]=1,b.opt_len=b.static_len=0,b.last_lit=b.matches=0}function ce(b){8<b.bi_valid?K(b,b.bi_buf):0<b.bi_valid&&(b.pending_buf[b.pending++]=b.bi_buf),b.bi_buf=0,b.bi_valid=0}function Y(b,E,V,Z){var z=2*E,X=2*V;return b[z]<b[X]||b[z]===b[X]&&Z[E]<=Z[V]}function de(b,E,V){for(var Z=b.heap[V],z=V<<1;z<=b.heap_len&&(z<b.heap_len&&Y(E,b.heap[z+1],b.heap[z],b.depth)&&z++,!Y(E,Z,b.heap[z],b.depth));)b.heap[V]=b.heap[z],V=z,z<<=1;b.heap[V]=Z}function xe(b,E,V){var Z,z,X,te,Q=0;if(b.last_lit!==0)for(;Z=b.pending_buf[b.d_buf+2*Q]<<8|b.pending_buf[b.d_buf+2*Q+1],z=b.pending_buf[b.l_buf+Q],Q++,Z===0?$(b,z,E):($(b,(X=l[z])+k+1,E),(te=A[X])!==0&&M(b,z-=B[X],te),$(b,X=D(--Z),V),(te=O[X])!==0&&M(b,Z-=q[X],te)),Q<b.last_lit;);$(b,w,E)}function Pe(b,E){var V,Z,z,X=E.dyn_tree,te=E.stat_desc.static_tree,Q=E.stat_desc.has_stree,le=E.stat_desc.elems,ve=-1;for(b.heap_len=0,b.heap_max=s,V=0;V<le;V++)X[2*V]!==0?(b.heap[++b.heap_len]=ve=V,b.depth[V]=0):X[2*V+1]=0;for(;b.heap_len<2;)X[2*(z=b.heap[++b.heap_len]=ve<2?++ve:0)]=1,b.depth[z]=0,b.opt_len--,Q&&(b.static_len-=te[2*z+1]);for(E.max_code=ve,V=b.heap_len>>1;1<=V;V--)de(b,X,V);for(z=le;V=b.heap[1],b.heap[1]=b.heap[b.heap_len--],de(b,X,1),Z=b.heap[1],b.heap[--b.heap_max]=V,b.heap[--b.heap_max]=Z,X[2*z]=X[2*V]+X[2*Z],b.depth[z]=(b.depth[V]>=b.depth[Z]?b.depth[V]:b.depth[Z])+1,X[2*V+1]=X[2*Z+1]=z,b.heap[1]=z++,de(b,X,1),2<=b.heap_len;);b.heap[--b.heap_max]=b.heap[1],function(ge,Ne){var Ct,Ke,Tt,we,zt,Qt,Je=Ne.dyn_tree,_a=Ne.max_code,mn=Ne.stat_desc.static_tree,pn=Ne.stat_desc.has_stree,gn=Ne.stat_desc.extra_bits,wa=Ne.stat_desc.extra_base,St=Ne.stat_desc.max_length,Nt=0;for(we=0;we<=f;we++)ge.bl_count[we]=0;for(Je[2*ge.heap[ge.heap_max]+1]=0,Ct=ge.heap_max+1;Ct<s;Ct++)St<(we=Je[2*Je[2*(Ke=ge.heap[Ct])+1]+1]+1)&&(we=St,Nt++),Je[2*Ke+1]=we,_a<Ke||(ge.bl_count[we]++,zt=0,wa<=Ke&&(zt=gn[Ke-wa]),Qt=Je[2*Ke],ge.opt_len+=Qt*(we+zt),pn&&(ge.static_len+=Qt*(mn[2*Ke+1]+zt)));if(Nt!==0){do{for(we=St-1;ge.bl_count[we]===0;)we--;ge.bl_count[we]--,ge.bl_count[we+1]+=2,ge.bl_count[St]--,Nt-=2}while(0<Nt);for(we=St;we!==0;we--)for(Ke=ge.bl_count[we];Ke!==0;)_a<(Tt=ge.heap[--Ct])||(Je[2*Tt+1]!==we&&(ge.opt_len+=(we-Je[2*Tt+1])*Je[2*Tt],Je[2*Tt+1]=we),Ke--)}}(b,E),be(X,ve,b.bl_count)}function a(b,E,V){var Z,z,X=-1,te=E[1],Q=0,le=7,ve=4;for(te===0&&(le=138,ve=3),E[2*(V+1)+1]=65535,Z=0;Z<=V;Z++)z=te,te=E[2*(Z+1)+1],++Q<le&&z===te||(Q<ve?b.bl_tree[2*z]+=Q:z!==0?(z!==X&&b.bl_tree[2*z]++,b.bl_tree[2*I]++):Q<=10?b.bl_tree[2*S]++:b.bl_tree[2*L]++,X=z,ve=(Q=0)===te?(le=138,3):z===te?(le=6,3):(le=7,4))}function j(b,E,V){var Z,z,X=-1,te=E[1],Q=0,le=7,ve=4;for(te===0&&(le=138,ve=3),Z=0;Z<=V;Z++)if(z=te,te=E[2*(Z+1)+1],!(++Q<le&&z===te)){if(Q<ve)for(;$(b,z,b.bl_tree),--Q!=0;);else z!==0?(z!==X&&($(b,z,b.bl_tree),Q--),$(b,I,b.bl_tree),M(b,Q-3,2)):Q<=10?($(b,S,b.bl_tree),M(b,Q-3,3)):($(b,L,b.bl_tree),M(b,Q-11,7));X=z,ve=(Q=0)===te?(le=138,3):z===te?(le=6,3):(le=7,4)}}c(q);var U=!1;function v(b,E,V,Z){M(b,(m<<1)+(Z?1:0),3),function(z,X,te,Q){ce(z),K(z,te),K(z,~te),r.arraySet(z.pending_buf,z.window,X,te,z.pending),z.pending+=te}(b,E,V)}u._tr_init=function(b){U||(function(){var E,V,Z,z,X,te=new Array(f+1);for(z=Z=0;z<_-1;z++)for(B[z]=Z,E=0;E<1<<A[z];E++)l[Z++]=z;for(l[Z-1]=z,z=X=0;z<16;z++)for(q[z]=X,E=0;E<1<<O[z];E++)F[X++]=z;for(X>>=7;z<h;z++)for(q[z]=X<<7,E=0;E<1<<O[z]-7;E++)F[256+X++]=z;for(V=0;V<=f;V++)te[V]=0;for(E=0;E<=143;)G[2*E+1]=8,E++,te[8]++;for(;E<=255;)G[2*E+1]=9,E++,te[9]++;for(;E<=279;)G[2*E+1]=7,E++,te[7]++;for(;E<=287;)G[2*E+1]=8,E++,te[8]++;for(be(G,y+1,te),E=0;E<h;E++)C[2*E+1]=5,C[2*E]=ae(E,5);ee=new ne(G,A,k+1,y,f),W=new ne(C,O,0,h,f),ie=new ne(new Array(0),P,0,p,g)}(),U=!0),b.l_desc=new N(b.dyn_ltree,ee),b.d_desc=new N(b.dyn_dtree,W),b.bl_desc=new N(b.bl_tree,ie),b.bi_buf=0,b.bi_valid=0,re(b)},u._tr_stored_block=v,u._tr_flush_block=function(b,E,V,Z){var z,X,te=0;0<b.level?(b.strm.data_type===2&&(b.strm.data_type=function(Q){var le,ve=4093624447;for(le=0;le<=31;le++,ve>>>=1)if(1&ve&&Q.dyn_ltree[2*le]!==0)return d;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return i;for(le=32;le<k;le++)if(Q.dyn_ltree[2*le]!==0)return i;return d}(b)),Pe(b,b.l_desc),Pe(b,b.d_desc),te=function(Q){var le;for(a(Q,Q.dyn_ltree,Q.l_desc.max_code),a(Q,Q.dyn_dtree,Q.d_desc.max_code),Pe(Q,Q.bl_desc),le=p-1;3<=le&&Q.bl_tree[2*R[le]+1]===0;le--);return Q.opt_len+=3*(le+1)+5+5+4,le}(b),z=b.opt_len+3+7>>>3,(X=b.static_len+3+7>>>3)<=z&&(z=X)):z=X=V+5,V+4<=z&&E!==-1?v(b,E,V,Z):b.strategy===4||X===z?(M(b,2+(Z?1:0),3),xe(b,G,C)):(M(b,4+(Z?1:0),3),function(Q,le,ve,ge){var Ne;for(M(Q,le-257,5),M(Q,ve-1,5),M(Q,ge-4,4),Ne=0;Ne<ge;Ne++)M(Q,Q.bl_tree[2*R[Ne]+1],3);j(Q,Q.dyn_ltree,le-1),j(Q,Q.dyn_dtree,ve-1)}(b,b.l_desc.max_code+1,b.d_desc.max_code+1,te+1),xe(b,b.dyn_ltree,b.dyn_dtree)),re(b),Z&&ce(b)},u._tr_tally=function(b,E,V){return b.pending_buf[b.d_buf+2*b.last_lit]=E>>>8&255,b.pending_buf[b.d_buf+2*b.last_lit+1]=255&E,b.pending_buf[b.l_buf+b.last_lit]=255&V,b.last_lit++,E===0?b.dyn_ltree[2*V]++:(b.matches++,E--,b.dyn_ltree[2*(l[V]+k+1)]++,b.dyn_dtree[2*D(E)]++),b.last_lit===b.lit_bufsize-1},u._tr_align=function(b){M(b,2,3),$(b,w,G),function(E){E.bi_valid===16?(K(E,E.bi_buf),E.bi_buf=0,E.bi_valid=0):8<=E.bi_valid&&(E.pending_buf[E.pending++]=255&E.bi_buf,E.bi_buf>>=8,E.bi_valid-=8)}(b)}},{"../utils/common":41}],53:[function(t,n,u){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,u){(function(r){(function(d,i){if(!d.setImmediate){var c,m,_,k,y=1,h={},p=!1,s=d.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(d);f=f&&f.setTimeout?f:d,c={}.toString.call(d.process)==="[object process]"?function(I){process.nextTick(function(){g(I)})}:function(){if(d.postMessage&&!d.importScripts){var I=!0,S=d.onmessage;return d.onmessage=function(){I=!1},d.postMessage("","*"),d.onmessage=S,I}}()?(k="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",w,!1):d.attachEvent("onmessage",w),function(I){d.postMessage(k+I,"*")}):d.MessageChannel?((_=new MessageChannel).port1.onmessage=function(I){g(I.data)},function(I){_.port2.postMessage(I)}):s&&"onreadystatechange"in s.createElement("script")?(m=s.documentElement,function(I){var S=s.createElement("script");S.onreadystatechange=function(){g(I),S.onreadystatechange=null,m.removeChild(S),S=null},m.appendChild(S)}):function(I){setTimeout(g,0,I)},f.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var S=new Array(arguments.length-1),L=0;L<S.length;L++)S[L]=arguments[L+1];var A={callback:I,args:S};return h[y]=A,c(y),y++},f.clearImmediate=o}function o(I){delete h[I]}function g(I){if(p)setTimeout(g,0,I);else{var S=h[I];if(S){p=!0;try{(function(L){var A=L.callback,O=L.args;switch(O.length){case 0:A();break;case 1:A(O[0]);break;case 2:A(O[0],O[1]);break;case 3:A(O[0],O[1],O[2]);break;default:A.apply(i,O)}})(S)}finally{o(I),p=!1}}}}function w(I){I.source===d&&typeof I.data=="string"&&I.data.indexOf(k)===0&&g(+I.data.slice(k.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Bt<"u"?Bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(oa)),oa.exports}var di=ci();const ui=Un(di),la=({name:T,onChange:x})=>{const[t,n]=J(""),[u,r]=J(),[d,i]=J(!1),{control:c}=wt();return u&&(_=>new Promise(k=>{const y=new FileReader;y.onload=h=>{k(h.target?.result)},y.readAsDataURL(_)}))(u).then(_=>{n(_),x?.(_)}),e(fe,{name:T,control:c,defaultValue:"",render:({field:_})=>H(ye,{children:[d&&e(tt,{}),t&&e("img",{src:t,width:200,height:200}),e(Cr,{id:T,type:"dataURL",filename:u?.name,dropzoneProps:{accept:{"image/*":[".png",".gif",".jpeg",".jpg",".svg",".webp"]}},onFileInputChange:(k,y)=>r(y),onReadStarted:()=>i(!0),onReadFinished:(k,y)=>{r(y),_.onChange(y),i(!1)},onClearClick:()=>{r(void 0),_.onChange(void 0),n("")}})]})})},hn=[{name:"font",defaultValue:'"RedHatText", helvetica, arial, sans-serif',variable:"FontFamily--text"},{name:"errorColor",defaultValue:{light:"#c9190b",dark:"#fe5142"},variable:"danger-color--100"},{name:"successColor",defaultValue:{light:"#3e8635",dark:"#5ba352"},variable:"success-color--100"},{name:"activeColor",defaultValue:{light:"#0066cc",dark:"#1fa7f8"},variable:"active-color--100"},{name:"primaryColor",defaultValue:"#0066cc",variable:{light:"primary-color--100",dark:"primary-color--300"}},{name:"primaryColorHover",defaultValue:"#004080",variable:"primary-color--200"},{name:"secondaryColor",defaultValue:{light:"#0066cc",dark:"#1fa7f8"},variable:"primary-color--100"},{name:"linkColor",defaultValue:{light:"#0066cc",dark:"#1fa7f8"},variable:"link--Color"},{name:"linkColorHover",defaultValue:{light:"#004080",dark:"#73bcf7"},variable:"link--Color--hover"},{name:"backgroundColor",defaultValue:{light:"#ffffff",dark:"#1b1d21"},variable:"BackgroundColor--light-100"},{name:"backgroundColorAccent",defaultValue:"#26292d",variable:{dark:"BackgroundColor--300"}},{name:"backgroundColorNav",defaultValue:{light:"#212427",dark:"#1b1d21"},variable:{light:"BackgroundColor--dark-300",dark:"BackgroundColor--100"}},{name:"backgroundColorHeader",defaultValue:{light:"#151515",dark:"#030303"},variable:{light:"BackgroundColor--dark-100",dark:"palette--black-1000"}},{name:"iconColor",defaultValue:"#f0f0f0",variable:"Color--light-200"},{name:"textColor",defaultValue:{light:"#151515",dark:"#e0e0e0"},variable:"Color--100"},{name:"lightTextColor",defaultValue:{light:"#ffffff",dark:"#e0e0e0"},variable:"Color--light-100"},{name:"inputBackgroundColor",defaultValue:"#36373a",variable:{dark:"BackgroundColor--400"}},{name:"inputTextColor",defaultValue:{light:"#151515",dark:"#e0e0e0"},variable:"Color--dark-100"}],Jt=(T,x)=>typeof T=="string"?T:T[x],hi=()=>hn.filter(T=>typeof T.defaultValue!="string").map(T=>({name:T.name,defaultValue:Jt(T.defaultValue,"light"),variable:Jt(T.variable,"light")})),fi=()=>hn.map(T=>({name:T.name,defaultValue:Jt(T.defaultValue,"dark"),variable:Jt(T.variable,"dark")})),mi=({cssVars:T})=>H(ye,{children:[e("style",{children:`
      .preview {
        ${Object.entries(T).map(([x,t])=>`--pf-v5-global--${x}: ${t};`).join(`
`)}
      }
    `}),e(Mn,{className:"preview",header:e(Vn,{}),children:H(Ce,{variant:"light",style:{backgroundColor:T["BackgroundColor--light-100"]},children:[H(Ot,{activeKey:1,className:"pf-v5-u-p-lg",children:[e(me,{eventKey:0,title:e(pe,{children:"Tab One"})}),e(me,{eventKey:1,title:e(pe,{children:"Tab Two"})})]}),e(dt,{title:"Error",isInline:!0,variant:"danger"}),e(dt,{title:"Success",isInline:!0,variant:"success"}),e("p",{className:"pf-v5-u-p-lg pf-v5-c-content",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."}),H(kt,{children:[e(Dt,{id:"test",placeholder:"Text input"}),e(oe,{variant:"primary",children:"Primary"}),e(oe,{variant:"secondary",children:"Secondary"}),e(oe,{variant:"link",children:"Link button"})]})]})})]}),pi=({name:T,color:x,label:t,...n})=>{const{t:u}=ue(),{control:r,setValue:d}=wt(),i=We({control:r,name:T});return H(ja,{children:[e(da,{isFill:!0,children:e(Ae,{...n,name:T,label:u(t)})}),e("input",{type:"color",value:i||x,onChange:c=>d(T,c.target.value)})]})},Na=T=>{T==="light"?(document.querySelector('meta[name="color-scheme"]').setAttribute("content","light"),document.documentElement.classList.remove("pf-v5-theme-dark")):document.documentElement.classList.add("pf-v5-theme-dark")},Fa=({realm:T,save:x,theme:t})=>{const{t:n}=ue(),u=He(),{handleSubmit:r,watch:d}=u,i=d(),c=Hn(),m=window.matchMedia("(prefers-color-scheme: dark)"),_=ot(()=>t==="light"?hi():fi(),[]),k=()=>{u.reset({[t]:_.reduce((p,s)=>({...p,[s.variable]:s.defaultValue}),{})})},y=()=>{const p=JSON.parse(T.attributes?.style||"{}");p[t]?u.reset(p):k()},h=p=>{const s=JSON.parse(T.attributes?.style||"{}");x({...T,favicon:p.favicon,logo:p.logo,bgimage:p.bgimage,attributes:{...T.attributes,style:JSON.stringify({...s,...p})}})};return rt(()=>(y(),Na(t),()=>{Na(m.matches?"dark":"light")}),[T]),H(Ce,{variant:"light",children:[e(yt,{className:"pf-v5-u-mb-lg",children:e(Ge,{children:n("themeColorInfo")})}),m.matches&&t==="light"&&e(dt,{variant:"info",isInline:!0,title:n("themePreviewInfo")}),H(Xt,{className:"pf-v5-u-pt-lg",children:[e(Ve,{children:e(_e,{isHorizontal:!0,role:"manage-realm",children:H($e,{...u,children:[e(se,{label:n("favicon"),children:e(la,{name:"favicon"})}),e(se,{label:n("logo"),children:e(la,{name:"logo",onChange:p=>c?.setLogo(p)})}),e(se,{label:n("backgroundImage"),children:e(la,{name:"bgimage"})}),_.map(p=>e(pi,{color:p.defaultValue,name:`${t}.${p.variable}`,label:p.name},p.name))]})})}),e(Ve,{grow:{default:"grow"},style:{zIndex:0},children:e(mi,{cssVars:i?.[t]||{}})})]}),e(Qa,{name:"colors",saveText:n("downloadThemeJar"),save:r(h),reset:y,children:e(oe,{type:"button",variant:"link",onClick:k,children:n("defaults")})})]})},Ba=({realm:T,save:x})=>{const{t}=ue(),n=He(),{handleSubmit:u,setValue:r}=n,d=ht().themes,i=()=>{Rt(T,r)};rt(i,[]);const c=m=>[{key:"",value:t("choose")},...m];return e(Ce,{variant:"light",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:u(x),children:[H($e,{...n,children:[e(mt,{name:"attributes.darkMode",labelIcon:t("darkModeEnabledHelp"),label:t("darkModeEnabled"),defaultValue:"true",stringify:!0}),e(Me,{id:"kc-login-theme",name:"loginTheme",label:t("loginTheme"),labelIcon:t("loginThemeHelp"),controller:{defaultValue:""},options:c(d.login.map(m=>({key:m.name,value:m.name})))}),e(Me,{id:"kc-account-theme",name:"accountTheme",label:t("accountTheme"),labelIcon:t("accountThemeHelp"),placeholderText:t("selectATheme"),controller:{defaultValue:""},options:c(d.account.map(m=>({key:m.name,value:m.name})))}),e(Me,{id:"kc-admin-theme",name:"adminTheme",label:t("adminTheme"),labelIcon:t("adminThemeHelp"),placeholderText:t("selectATheme"),controller:{defaultValue:""},options:c(d.admin.map(m=>({key:m.name,value:m.name})))}),e(Me,{id:"kc-email-theme",name:"emailTheme",label:t("emailTheme"),labelIcon:t("emailThemeHelp"),placeholderText:t("selectATheme"),controller:{defaultValue:""},options:c(d.email.map(m=>({key:m.name,value:m.name})))})]}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"themes-tab-save",children:t("save")}),e(oe,{variant:"link",onClick:i,children:t("revert")})]})]})})};function gi({realm:T,save:x}){const{t}=ue(),{realm:n}=Te(),{environment:u}=ma(),r=Yt(),d=async k=>{const y=new ui,h=JSON.parse(k.attributes?.style??"{}"),{favicon:p,logo:s,bgimage:f,...o}=k,g="img/logo"+s?.name?.substring(s?.name?.lastIndexOf(".")),w="img/bgimage"+f?.name?.substring(f?.name?.lastIndexOf("."));p&&y.file("theme/quick-theme/common/resources/img/favicon.ico",p),s&&y.file(`theme/quick-theme/common/resources/${g}`,s),f&&y.file(`theme/quick-theme/common/resources/${w}`,f),y.file("theme/quick-theme/admin/theme.properties",`
parent=keycloak.v2
import=common/quick-theme

logo=${g}
styles=css/theme-styles.css
`),y.file("theme/quick-theme/account/theme.properties",`
parent=keycloak.v3
import=common/quick-theme

logo=${g}
styles=css/theme-styles.css
`),y.file("theme/quick-theme/login/theme.properties",`
parent=keycloak.v2
import=common/quick-theme

styles=css/login.css css/theme-styles.css
`),y.file("META-INF/keycloak-themes.json",`{
  "themes": [{
      "name" : "quick-theme",
      "types": [ "login", "account", "admin", "common" ]
  }]
}`);const I=L=>Object.entries(L||{}).map(([A,O])=>`--pf-v5-global--${A}: ${O};`).join(`
`),S=(await fetch(Ga(u.resourceUrl,"/theme/login.css"))).text();y.file("theme/quick-theme/common/resources/css/login.css",S),y.file("theme/quick-theme/common/resources/css/theme-styles.css",`:root {
        --keycloak-bg-logo-url: url('../${w}');
        --keycloak-logo-url: url('../${g}');
        --keycloak-logo-height: 63px;
        --keycloak-logo-width: 300px;
        ${I(h.light)}
      }
      .pf-v5-theme-dark {
        ${I(h.dark)}
      }
      `),x({...o,attributes:{...o.attributes,style:JSON.stringify({...h,logo:g,bgimage:w})}}),y.generateAsync({type:"blob"}).then(L=>{const A=URL.createObjectURL(L),O=document.createElement("a");O.href=A,O.download="quick-theme.jar",O.click(),URL.revokeObjectURL(A)})},i=k=>({realm:n,tab:k}),c=lt(Ut(i("settings"))),m=lt(Ut(i("lightColors"))),_=lt(Ut(i("darkColors")));return r(pt.QuickTheme)?H(Lt,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:Ut({realm:n,tab:"settings"}),children:[e(me,{id:"themes-settings",title:H(pe,{children:[t("themes")," "]}),"data-testid":"themes-settings-tab",...c,children:e(Ba,{realm:T,save:x})}),e(me,{id:"lightColors",title:e(pe,{children:t("themeColorsLight")}),"data-testid":"lightColors-tab",...m,children:e(Sa,{children:e(Fa,{realm:T,save:d,theme:"light"})})}),e(me,{id:"darkColors",title:e(pe,{children:t("themeColorsDark")}),"data-testid":"darkColors-tab",..._,children:e(Sa,{children:e(Fa,{realm:T,save:d,theme:"dark"})})})]}):e(Ba,{realm:T,save:x})}const bi=({realm:T,save:x})=>{const{t}=ue(),n=ht(),u=Yt(),{whoAmI:r}=Pt(),[d,i]=J(!1),c=Kn(n.providers.signature.providers),{control:m,register:_,reset:k,formState:y,handleSubmit:h}=wt(),p=We({control:m,name:"offlineSessionMaxLifespanEnabled",defaultValue:T.offlineSessionMaxLifespanEnabled}),s=We({control:m,name:"ssoSessionIdleTimeout",defaultValue:36e3}),f=We({control:m,name:"revokeRefreshToken",defaultValue:!1});return H(Ce,{variant:"light",children:[e(ze,{title:t("general"),className:"kc-sso-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",onSubmit:h(x),children:[e(se,{label:t("defaultSigAlg"),fieldId:"kc-default-signature-algorithm",labelIcon:e(he,{helpText:t("defaultSigAlgHelp"),fieldLabelId:"algorithm"}),children:e(fe,{name:"defaultSignatureAlgorithm",defaultValue:"RS256",control:m,render:({field:o})=>e(Ze,{toggleId:"kc-default-sig-alg",onToggle:()=>i(!d),onSelect:g=>{o.onChange(g.toString()),i(!1)},selections:o.value?.toString(),variant:Qe.single,"aria-label":t("defaultSigAlg"),isOpen:d,"data-testid":"select-default-sig-alg",children:c.map((g,w)=>e(Le,{selected:g===o.value,value:g,children:g},`default-sig-alg-${w}`))})})}),u(pt.DeviceFlow)&&H(ye,{children:[e(se,{label:t("oAuthDeviceCodeLifespan"),fieldId:"oAuthDeviceCodeLifespan",labelIcon:e(he,{helpText:t("oAuthDeviceCodeLifespanHelp"),fieldLabelId:"oAuthDeviceCodeLifespan"}),children:e(fe,{name:"oauth2DeviceCodeLifespan",defaultValue:0,control:m,render:({field:o})=>e(ke,{id:"oAuthDeviceCodeLifespan","data-testid":"oAuthDeviceCodeLifespan",value:o.value||0,onChange:o.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("oAuthDevicePollingInterval"),fieldId:"oAuthDevicePollingInterval",labelIcon:e(he,{helpText:t("oAuthDevicePollingIntervalHelp"),fieldLabelId:"oAuthDevicePollingInterval"}),children:e(fe,{name:"oauth2DevicePollingInterval",defaultValue:0,control:m,render:({field:o})=>e(xa,{id:"oAuthDevicePollingInterval",value:o.value,min:0,onPlus:()=>o.onChange(Number(o?.value)+1),onMinus:()=>o.onChange(Number(o?.value)>0?Number(o?.value)-1:0),onChange:g=>{const w=Number(g.currentTarget.value);o.onChange(isNaN(w)?0:w)},placeholder:t("oAuthDevicePollingInterval")})})}),e(se,{label:t("shortVerificationUri"),fieldId:"shortVerificationUri",labelIcon:e(he,{helpText:t("shortVerificationUriTooltipHelp"),fieldLabelId:"shortVerificationUri"}),children:e(Dt,{id:"shortVerificationUri",placeholder:t("shortVerificationUri"),..._("attributes.shortVerificationUri")})}),e(se,{label:t("parRequestUriLifespan"),fieldId:"parRequestUriLifespan",labelIcon:e(he,{helpText:t("parRequestUriLifespanHelp"),fieldLabelId:"parRequestUriLifespan"}),children:e(fe,{name:"attributes.parRequestUriLifespan",control:m,render:({field:o})=>e(ke,{id:"parRequestUriLifespan",className:"par-request-uri-lifespan","data-testid":"par-request-uri-lifespan-input","aria-label":"par-request-uri-lifespan",value:o.value,onChange:o.onChange})})})]})]})}),e(ze,{title:t("refreshTokens"),className:"kc-client-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:h(x),children:[e(se,{hasNoPaddingTop:!0,label:t("revokeRefreshToken"),fieldId:"kc-revoke-refresh-token",labelIcon:e(he,{helpText:t("revokeRefreshTokenHelp"),fieldLabelId:"revokeRefreshToken"}),children:e(fe,{name:"revokeRefreshToken",control:m,defaultValue:!1,render:({field:o})=>e(Re,{id:"kc-revoke-refresh-token","data-testid":"revoke-refresh-token-switch","aria-label":t("revokeRefreshToken"),label:t("enabled"),labelOff:t("disabled"),isChecked:o.value,onChange:o.onChange})})}),f&&e(se,{label:t("refreshTokenMaxReuse"),labelIcon:e(he,{helpText:t("refreshTokenMaxReuseHelp"),fieldLabelId:"refreshTokenMaxReuse"}),fieldId:"refreshTokenMaxReuse",children:e(fe,{name:"refreshTokenMaxReuse",defaultValue:0,control:m,render:({field:o})=>e(xa,{type:"text",id:"refreshTokenMaxReuseMs",value:o.value,onPlus:()=>o.onChange(o.value+1),onMinus:()=>o.onChange(o.value-1),onChange:g=>o.onChange(Number(g.target.value))})})})]})}),e(ze,{title:t("accessTokens"),className:"kc-offline-session-template",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:h(x),children:[H(se,{label:t("accessTokenLifespan"),fieldId:"accessTokenLifespan",labelIcon:e(he,{helpText:t("accessTokenLifespanHelp"),fieldLabelId:"accessTokenLifespan"}),children:[e(fe,{name:"accessTokenLifespan",control:m,render:({field:o})=>e(ke,{validated:o.value>s?"warning":"default",className:"kc-access-token-lifespan","data-testid":"access-token-lifespan-input","aria-label":"access-token-lifespan",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})}),e(jn,{children:e(Gn,{children:e(Wn,{children:t("recommendedSsoTimeout",{time:wr(s,r.getLocale())})})})})]}),e(se,{label:t("accessTokenLifespanImplicitFlow"),fieldId:"accessTokenLifespanImplicitFlow",labelIcon:e(he,{helpText:t("accessTokenLifespanImplicitFlow"),fieldLabelId:"accessTokenLifespanImplicitFlow"}),children:e(fe,{name:"accessTokenLifespanForImplicitFlow",control:m,render:({field:o})=>e(ke,{className:"kc-access-token-lifespan-implicit","data-testid":"access-token-lifespan-implicit-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("clientLoginTimeout"),fieldId:"clientLoginTimeout",labelIcon:e(he,{helpText:t("clientLoginTimeoutHelp"),fieldLabelId:"clientLoginTimeout"}),children:e(fe,{name:"accessCodeLifespan",control:m,render:({field:o})=>e(ke,{className:"kc-client-login-timeout","data-testid":"client-login-timeout-input","aria-label":"client-login-timeout",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),p&&e(se,{label:t("offlineSessionMax"),fieldId:"offlineSessionMax",id:"offline-session-max-label",labelIcon:e(he,{helpText:t("offlineSessionMaxHelp"),fieldLabelId:"offlineSessionMax"}),children:e(fe,{name:"offlineSessionMaxLifespan",control:m,render:({field:o})=>e(ke,{className:"kc-offline-session-max","data-testid":"offline-session-max-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})})]})}),e(ze,{className:"kc-login-settings-template",title:t("actionTokens"),children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg",onSubmit:h(x),children:[e(se,{label:t("userInitiatedActionLifespan"),id:"kc-user-initiated-action-lifespan",fieldId:"userInitiatedActionLifespan",labelIcon:e(he,{helpText:t("userInitiatedActionLifespanHelp"),fieldLabelId:"userInitiatedActionLifespan"}),children:e(fe,{name:"actionTokenGeneratedByUserLifespan",control:m,render:({field:o})=>e(ke,{className:"kc-user-initiated-action-lifespan","data-testid":"user-initiated-action-lifespan","aria-label":"user-initiated-action-lifespan",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("defaultAdminInitiated"),fieldId:"defaultAdminInitiated",id:"default-admin-initiated-label",labelIcon:e(he,{helpText:t("defaultAdminInitiatedActionLifespanHelp"),fieldLabelId:"defaultAdminInitiated"}),children:e(fe,{name:"actionTokenGeneratedByAdminLifespan",control:m,render:({field:o})=>e(ke,{className:"kc-default-admin-initiated","data-testid":"default-admin-initated-input","aria-label":"default-admin-initated-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),e(Ge,{className:"kc-override-action-tokens-subtitle",component:pa.h1,children:t("overrideActionTokens")}),e(se,{label:t("emailVerification"),fieldId:"emailVerification",id:"email-verification",labelIcon:e(he,{helpText:t("emailVerificationHelp"),fieldLabelId:"emailVerification"}),children:e(fe,{name:`attributes.${Mt("actionTokenGeneratedByUserLifespan.verify-email")}`,defaultValue:"",control:m,render:({field:o})=>e(ke,{className:"kc-email-verification","data-testid":"email-verification-input",value:o.value,onChange:g=>o.onChange(g.toString()),units:["minute","hour","day"]})})}),e(se,{label:t("idpAccountEmailVerification"),fieldId:"idpAccountEmailVerification",id:"idp-acct-label",labelIcon:e(he,{helpText:t("idpAccountEmailVerificationHelp"),fieldLabelId:"idpAccountEmailVerification"}),children:e(fe,{name:`attributes.${Mt("actionTokenGeneratedByUserLifespan.idp-verify-account-via-email")}`,defaultValue:"",control:m,render:({field:o})=>e(ke,{className:"kc-idp-email-verification","data-testid":"idp-email-verification-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("forgotPassword"),fieldId:"forgotPassword",id:"forgot-password-label",labelIcon:e(he,{helpText:t("forgotPasswordHelp"),fieldLabelId:"forgotPassword"}),children:e(fe,{name:`attributes.${Mt("actionTokenGeneratedByUserLifespan.reset-credentials")}`,defaultValue:"",control:m,render:({field:o})=>e(ke,{className:"kc-forgot-pw","data-testid":"forgot-pw-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),e(se,{label:t("executeActions"),fieldId:"executeActions",id:"execute-actions",labelIcon:e(he,{helpText:t("executeActionsHelp"),fieldLabelId:"executeActions"}),children:e(fe,{name:`attributes.${Mt("actionTokenGeneratedByUserLifespan.execute-actions")}`,defaultValue:"",control:m,render:({field:o})=>e(ke,{className:"kc-execute-actions","data-testid":"execute-actions-input",value:o.value,onChange:o.onChange,units:["minute","hour","day"]})})}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"tokens-tab-save",isDisabled:!y.isDirty,children:t("save")}),e(oe,{variant:"link",onClick:()=>k(T),children:t("revert")})]})]})})]})},vi=()=>{const{adminClient:T}=Se(),{t:x}=ue(),[t,n]=ct(),[u,r]=ct(),[d,i]=J(),[c,m]=J([]),[_,k]=J(0),[y,h]=J(0),p=()=>h(y+1),{realm:s}=Te(),{addAlert:f,addError:o}=Oe(),{enabled:g}=Zn(),{hasAccess:w}=ga(),I=w("view-users","manage-realm");et(()=>T.realms.getDefaultGroups({realm:s}),R=>{i(R),k(_+1)},[y]);const S=()=>Promise.resolve(d),L=async()=>{try{await Promise.all(c.map(R=>T.realms.removeDefaultGroup({realm:s,id:R.id}))),f(x("groupRemove",{count:c.length}),Ee.success),m([])}catch(R){o("groupRemoveError",R)}p()},A=async R=>{try{await Promise.all(R.map(G=>T.realms.addDefaultGroup({realm:s,id:G.id}))),f(x("defaultGroupAdded",{count:R.length}),Ee.success)}catch(G){o("defaultGroupAddedError",G)}p()},[O,P]=De({titleKey:x("removeConfirmTitle",{count:c.length}),messageKey:x("removeConfirm",{count:c.length}),continueButtonLabel:"delete",continueButtonVariant:Ie.danger,onConfirm:L});return d?H(ye,{children:[e(P,{}),u&&e(Sr,{type:"selectMany",text:{title:"addDefaultGroups",ok:"add"},onConfirm:R=>{A(R||[]),r()},onClose:r}),g&&e(qn,{bodyContent:H($t,{i18nKey:"defaultGroupsHelp",children:[" ",e(Fe,{to:Ia({realm:s})}),"."]}),children:e(yt,{className:"keycloak__section_intro__help",style:{paddingLeft:"var(--pf-v5-c-page__main-section--PaddingLeft)"},children:H(Ge,{children:[e(xr,{})," ",x("whatIsDefaultGroups")]})})}),e(nt,{canSelectAll:!0,onSelect:R=>m([...R]),loader:S,ariaLabelKey:"defaultGroups",searchPlaceholderKey:"searchForGroups",toolbarItem:I&&H(ye,{children:[e(Be,{children:e(oe,{"data-testid":"openCreateGroupModal",variant:"primary",onClick:r,children:x("addGroups")})}),e(Be,{children:e(Wa,{onOpenChange:n,toggle:R=>e(qa,{ref:R,isExpanded:t,variant:"plain",onClick:n,isDisabled:c.length===0,children:e($a,{})}),isOpen:t,shouldFocusToggleOnSelect:!0,children:e(Za,{children:e(At,{component:"button",onClick:()=>{O(),n()},children:x("remove")},"action")})})})]}),actions:I?[{title:x("remove"),onRowClick:R=>(m([R]),O(),Promise.resolve(!1))}]:[],columns:[{name:"name",displayKey:"groupName"},{name:"path",displayKey:"path"}],emptyState:e(qe,{hasIcon:!0,message:x("noDefaultGroups"),instructions:H($t,{i18nKey:"noDefaultGroupsInstructions",children:[" ",e(Fe,{className:"pf-v5-u-font-weight-light",to:Ia({realm:s}),role:"navigation","aria-label":x("identityBrokeringLink")}),"Add groups..."]}),primaryActionText:I?x("addGroups"):"",onPrimaryAction:r})},_)]}):e(tt,{})},yi=()=>{const{adminClient:T}=Se(),{t:x}=ue(),[t,n]=J(10),{realmRepresentation:u}=Te(),[r,d]=J(0),{addAlert:i,addError:c}=Oe(),{realm:m}=Te(),_=async k=>{const y=k;try{await T.roles.createComposite({roleId:u?.defaultRole.id,realm:m},y),d(r+1),i(x("addAssociatedRolesSuccess"),Ee.success)}catch(h){c("addAssociatedRolesError",h)}};return H(Ot,{activeKey:t,onSelect:(k,y)=>n(y),children:[e(me,{id:"roles",eventKey:10,title:e(pe,{children:x("defaultRoles")}),"data-testid":"default-roles-tab",children:e(Tr,{name:u?.defaultRole.name,id:u?.defaultRole.id,type:"roles",isManager:!0,save:k=>_(k.map(y=>y.role))})},r),e(me,{id:"groups",eventKey:20,title:e(pe,{children:x("defaultGroups")}),"data-testid":"default-groups-tab",children:e(vi,{})})]})};function fn({ariaLabelKey:T="userEventsRegistered",eventTypes:x,addTypes:t,onSelect:n,onDelete:u}){const{t:r}=ue(),d=x.map(i=>({id:i,name:r(`eventTypes.${i}.name`),description:r(`eventTypes.${i}.description`)}));return e(nt,{ariaLabelKey:T,searchPlaceholderKey:"searchEventType",loader:d,onSelect:n||void 0,canSelectAll:!!n,toolbarItem:t&&e(Be,{children:e(oe,{id:"addTypes",onClick:t,"data-testid":"addTypes",children:r("addSavedTypes")})}),actions:u?[{title:r("remove"),onRowClick:u}]:[],columns:[{name:"name",displayKey:"eventType"},{name:"description",cellFormatters:[rn(r)]}],emptyState:e(qe,{message:r("emptyEvents"),instructions:r("emptyEventsInstructions")})})}const ki=({onConfirm:T,onClose:x,configured:t})=>{const{t:n}=ue(),{enums:u}=ht(),[r,d]=J([]);return e(ut,{variant:bt.medium,title:n("addTypes"),isOpen:!0,onClose:x,actions:[e(oe,{"data-testid":"addEventTypeConfirm",variant:"primary",onClick:()=>T(r),children:n("add")},"confirm"),e(oe,{"data-testid":"moveCancel",variant:"link",onClick:x,children:n("cancel")},"cancel")],children:e(fn,{ariaLabelKey:"addTypes",onSelect:i=>d(i),eventTypes:u.eventType.filter(i=>!t.includes(i))})})},Ua=({type:T,form:x,reset:t,clear:n})=>{const{t:u}=ue(),{control:r,watch:d,setValue:i,formState:{isDirty:c}}=x,m=T==="admin"?"adminEventsEnabled":"eventsEnabled",_=d(m),[k,y]=De({titleKey:"events-disable-title",messageKey:"events-disable-confirm",continueButtonLabel:"confirm",onConfirm:()=>i(m,!1,{shouldDirty:!0})});return H($e,{...x,children:[e(y,{}),e(se,{hasNoPaddingTop:!0,label:u("saveEvents"),fieldId:m,labelIcon:e(he,{helpText:u(`save-${T}-eventsHelp`),fieldLabelId:"saveEvents"}),children:e(fe,{name:m,defaultValue:!1,control:r,render:({field:h})=>e(Re,{"data-testid":m,id:`${m}-switch`,label:u("on"),labelOff:u("off"),isChecked:h.value,onChange:(p,s)=>{s?h.onChange(s):k()},"aria-label":u("saveEvents")})})}),T==="admin"&&e(mt,{name:"adminEventsDetailsEnabled",label:u("includeRepresentation"),labelIcon:u("includeRepresentationHelp")}),_&&e(sn,{name:T==="user"?"eventsExpiration":"adminEventsExpiration",label:u("expiration"),labelIcon:u("expirationHelp"),defaultValue:"",units:["minute","hour","day"],controller:{defaultValue:""}}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit",id:`save-${T}`,"data-testid":`save-${T}`,isDisabled:!c,children:u("save")}),e(oe,{variant:"link",onClick:t,children:u("revert")})]}),e(at,{}),e(se,{label:u(T==="user"?"clearUserEvents":"clearAdminEvents"),fieldId:`clear-${T}-events`,labelIcon:e(he,{helpText:u(`${T}-clearEventsHelp`),fieldLabelId:`clear-${T}-events`}),children:e(oe,{variant:"danger",id:`clear-${T}-events`,"data-testid":`clear-${T}-events`,onClick:()=>n(),children:u(T==="user"?"clearUserEvents":"clearAdminEvents")})})]})},_i=({form:T,reset:x})=>{const{t}=ue(),[n,u]=J(),{adminClient:r}=Se();return et(()=>$n(r,"ui-ext/available-event-listeners"),u,[]),n?H($e,{...T,children:[e(Me,{name:"eventsListeners",label:t("eventListeners"),labelIcon:t("eventListenersHelpTextHelp"),controller:{defaultValue:""},className:"kc_eventListeners_select",chipGroupProps:{numChips:3,expandedText:t("hide"),collapsedText:t("showRemaining")},variant:Qe.typeaheadMulti,options:n.map(d=>d.id)}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"saveEventListenerBtn",children:t("save")}),e(oe,{variant:"link","data-testid":"revertEventListenerBtn",onClick:x,children:t("revert")})]})]}):e(tt,{})},wi=({realm:T})=>{const{adminClient:x}=Se(),{t}=ue(),n=He(),{setValue:u,handleSubmit:r}=n,[d,i]=J(0),c=()=>i(new Date().getTime()),[m,_]=J(0),k=()=>_(new Date().getTime()),[y,h]=J("event"),[p,s]=J(),[f,o]=J(),[g,w]=J(!1),{addAlert:I,addError:S}=Oe(),{realm:L,refresh:A}=Te(),O=B=>{s(B),Rt(B||{},u)},P=async B=>{o(B),R()},[R,G]=De({titleKey:"deleteEvents",messageKey:"deleteEventsConfirm",continueButtonLabel:"clear",continueButtonVariant:Ie.danger,onConfirm:async()=>{try{switch(f){case"admin":await x.realms.clearAdminEvents({realm:L});break;case"user":await x.realms.clearEvents({realm:L});break}I(t(`${f}-events-cleared`),Ee.success)}catch(B){S(`${f}-events-cleared-error`,B)}}});et(()=>x.realms.getConfigEvents({realm:L}),B=>{O({...B,adminEventsExpiration:T.attributes?.adminEventsExpiration}),k()},[d]);const C=async B=>{const ee=!on(p?.eventsListeners,B.eventsListeners),{adminEventsExpiration:W,...ie}=B;T.attributes?.adminEventsExpiration!==W&&await x.realms.update({realm:L},{...T,attributes:{...T.attributes||{},adminEventsExpiration:W}});try{await x.realms.updateConfigEvents({realm:L},ie),O({...p,...ie,adminEventsExpiration:W}),I(t(ee?"saveEventListenersSuccess":"eventConfigSuccessfully"),Ee.success)}catch(q){S(t(ee?"saveEventListenersError":"eventConfigError"),q)}A()},F=async B=>{const ee=B.map(ie=>ie.id),W=p.enabledEventTypes?.concat(ee);await l(W)},l=async(B=[])=>{const ee={...n.getValues(),enabledEventTypes:B};await C(ee),w(!1),c()};return H(ye,{children:[e(G,{}),g&&e(ki,{onConfirm:B=>F(B),configured:p?.enabledEventTypes||[],onClose:()=>w(!1)}),H(Ot,{activeKey:y,onSelect:(B,ee)=>h(ee),children:[e(me,{eventKey:"event",title:e(pe,{children:t("eventListeners")}),"data-testid":"rs-event-listeners-tab",children:e(Ce,{children:e(_e,{role:"manage-events",isHorizontal:!0,onSubmit:r(C),children:e(_i,{form:n,reset:()=>O(p)})})})}),H(me,{eventKey:"user",title:e(pe,{children:t("userEventsSettings")}),"data-testid":"rs-events-tab",children:[e(Ce,{children:e(_e,{role:"manage-events",isHorizontal:!0,onSubmit:r(C),children:e(Ua,{type:"user",form:n,reset:()=>O(p),clear:()=>P("user")})})}),e(Ce,{children:e(fn,{addTypes:()=>w(!0),eventTypes:p?.enabledEventTypes||[],onDelete:B=>{const ee=p?.enabledEventTypes?.filter(W=>W!==B.id);l(ee),s({...p,enabledEventTypes:ee})}},m)})]}),e(me,{eventKey:"admin",title:e(pe,{children:t("adminEventsSettings")}),"data-testid":"rs-admin-events-tab",children:e(Ce,{children:e(_e,{role:"manage-events",isHorizontal:!0,onSubmit:r(C),children:e(Ua,{type:"admin",form:n,reset:()=>O(p),clear:()=>P("admin")})})})})]})]})},Et=["ACTIVE","PASSIVE","DISABLED"],Ci=({onFilter:T})=>{const{t:x}=ue(),[t,n]=J(Et[0]),[u,r]=ct();return e(Ze,{width:300,"data-testid":"filter-type-select",isOpen:u,className:"kc-filter-type-select",variant:Qe.single,onToggle:r,toggleIcon:e(ln,{}),onSelect:d=>{const i=Et.find(c=>c===d.toString())||Et[0];n(i),T(i),r()},selections:t,"aria-label":x("selectFilterType"),children:Et.map(d=>e(Le,{"data-testid":`${d}-option`,value:d,children:x(`keysFilter.${d}`)},d))})},Ti=({realmComponents:T})=>{const{adminClient:x}=Se(),{t}=ue(),n=_t(),u=Ir(),[r,d]=J(""),[i,c]=J(""),{realm:m}=Te(),[_,k]=J([]),[y,h]=J(Et[0]),p=ot(()=>_?.filter(({status:w})=>w===y),[_,y]);et(async()=>(await x.realms.getKeys({realm:m})).keys?.map(I=>{const S=T.find(L=>L.id===I.providerId);return{...I,provider:S?.name}}),k,[]);const[s,f]=De({titleKey:t("publicKey"),messageKey:r,continueButtonLabel:"close",continueButtonVariant:Ie.primary,onConfirm:()=>Promise.resolve()}),[o,g]=De({titleKey:t("certificate"),messageKey:i,continueButtonLabel:"close",continueButtonVariant:Ie.primary,onConfirm:()=>Promise.resolve()});return _?H(Ce,{variant:"light",padding:{default:"noPadding"},children:[e(f,{}),e(g,{}),e(nt,{isNotCompact:!0,className:"kc-keys-list",loader:p,ariaLabelKey:"keysList",searchPlaceholderKey:"searchKey",searchTypeComponent:e(Ci,{onFilter:w=>h(w)}),columns:[{name:"algorithm",displayKey:"algorithm",cellFormatters:[Vt()],transforms:[it(15)]},{name:"type",displayKey:"type",cellFormatters:[Vt()],transforms:[it(10)]},{name:"kid",displayKey:"kid",cellFormatters:[Vt()],transforms:[it(10)]},{name:"use",displayKey:"use",cellFormatters:[Vt()],transforms:[it(10)]},{name:"provider",displayKey:"provider",cellRenderer:({provider:w})=>w||"-",transforms:[it(10)]},{name:"validTo",displayKey:"validTo",cellRenderer:({validTo:w})=>w?u(new Date(w)):"-",transforms:[it(10)]},{name:"publicKeys",displayKey:"publicKeys",cellRenderer:({publicKey:w,certificate:I})=>I?H("div",{className:"button-wrapper",children:[e(oe,{onClick:()=>{s(),d(w)},variant:"secondary",id:w,children:t("publicKey")}),e(oe,{onClick:()=>{o(),c(I)},variant:"secondary",id:I,className:"kc-certificate",children:t("certificate")})]}):w?e(oe,{onClick:()=>{s(),d(w)},variant:"secondary",id:"kc-public-key",children:t("publicKey")}):"",transforms:[it(20)]}],isSearching:!!p,emptyState:e(qe,{hasIcon:!0,message:t("noKeys"),instructions:t("noKeysDescription"),primaryActionText:t("addProvider"),onPrimaryAction:()=>n(ua({realm:m,tab:"providers"}))})})]}):e(tt,{})},Si="_dialog_121se_2",xi={dialog:Si},Ii=({providerType:T,onClose:x})=>{const{t}=ue();return e(ut,{className:xi.dialog,variant:bt.medium,title:t("addProvider"),isOpen:!0,onClose:x,children:e(Er,{providerType:T,onClose:x})})},Ei=({onConfirm:T,onClose:x})=>{const{t}=ue(),u=ht().componentTypes?.[ba]??[];return e(ut,{variant:"medium",title:t("addProvider"),isOpen:!0,onClose:x,children:e(en,{onSelectDataListItem:(r,d)=>{T(d)},"aria-label":t("addPredefinedMappers"),isCompact:!0,children:u.map(r=>e(tn,{"aria-label":r.id,id:r.id,children:e(an,{children:e(nn,{dataListCells:[e(ha,{"data-testid":`option-${r.id}`,children:r.id},`name-${r.id}`),e(ha,{width:2,children:r.helpText},`helpText-${r.helpText}`)]})})},r.id))})})},Ai=({realmComponents:T,refresh:x})=>{const{adminClient:t}=Se(),{t:n}=ue(),{addAlert:u,addError:r}=Oe(),{realm:d}=Te(),[i,c]=J(""),[m,_]=J([]),[k,y]=ct(),p=ht().componentTypes?.[ba]??[],[s,f]=ct(),[o,g]=J(),[w,I]=J(),S=ot(()=>T.map(G=>{const C=p.find(F=>G.providerId===F.id);return{...G,providerDescription:C?.helpText}}),[T]),[L,A]=De({titleKey:"deleteProviderTitle",messageKey:n("deleteProviderConfirm",{provider:w?.name}),continueButtonLabel:"delete",continueButtonVariant:Ie.danger,onConfirm:async()=>{try{await t.components.del({id:w.id,realm:d}),x(),u(n("deleteProviderSuccess"),Ee.success)}catch(G){r("deleteProviderError",G)}}}),O=()=>{if(i!==""){c(i);const G=S.filter(C=>C.name?.includes(i)||C.providerId?.includes(i));_(G)}else c(""),_(S)},P=G=>{G.key==="Enter"&&O()},R=G=>{c(G)};return H(ye,{children:[s&&e(Ei,{onClose:()=>f(),onConfirm:G=>{y(),g(G),f()}}),k&&o&&e(Ii,{providerType:o,onClose:()=>{y(),x()}}),e(A,{}),H(Ce,{variant:"light",padding:{default:"noPadding"},children:[e(Ja,{children:H(Jn,{className:"providers-toolbar",children:[e(Be,{children:H(ja,{children:[e(da,{isFill:!0,children:e(Dt,{name:"inputGroupName",id:"inputGroupName","data-testid":"provider-search-input",type:"search","aria-label":n("search"),placeholder:n("search"),onChange:(G,C)=>R(C),onKeyDown:P})}),e(da,{children:e(oe,{variant:Ie.control,"aria-label":n("search"),onClick:O,children:e(Ya,{})})})]})}),e(Be,{children:e(oe,{"data-testid":"addProviderDropdown",className:"add-provider-dropdown",onClick:()=>f(),children:n("addProvider")})})]})}),e(cn,{variant:"compact",className:"kc-draggable-table",keyField:"id",data:m.length===0?S:m,onDragFinish:async(G,C)=>{const F=S.map(l=>{const B={...l};return delete B.providerDescription,t.components.update({id:l.id},{...B,config:{priority:[(C.length-C.indexOf(l.id)+100).toString()]}})});try{await Promise.all(F),x(),u(n("saveProviderListSuccess"),Ee.success)}catch(l){r("saveProviderError",l)}},columns:[{name:"name",displayKey:"name",cellRenderer:G=>e(Fe,{"data-testid":"provider-name-link",to:Yn({realm:d,id:G.id,providerType:G.providerId}),children:G.name},G.name)},{name:"providerId",displayKey:"provider"},{name:"providerDescription",displayKey:"providerDescription"}],actions:[{title:n("delete"),onClick:(G,C,F)=>{I(F),L()}}]})]})]})},Li=T=>[...T].sort((t,n)=>{const u=Number(t.config?.priority),r=Number(n.config?.priority);return(isNaN(r)?0:r)-(isNaN(u)?0:u)}),Pi=()=>{const{adminClient:T}=Se(),{t:x}=ue(),{realm:t}=Te(),[n,u]=J(),[r,d]=J(0),i=()=>{d(r+1)};et(()=>T.components.find({type:ba,realm:t}),k=>u(Li(k)),[r]);const c=k=>lt(ua({realm:t,tab:k})),m=c("list"),_=c("providers");return n?H(Lt,{mountOnEnter:!0,unmountOnExit:!0,defaultLocation:ua({realm:t,tab:"list"}),children:[e(me,{id:"keysList","data-testid":"rs-keys-list-tab","aria-label":"keys-list-subtab",title:e(pe,{children:x("keysList")}),...m,children:e(Ti,{realmComponents:n})}),e(me,{id:"providers","data-testid":"rs-providers-tab","aria-label":"rs-providers-tab",title:e(pe,{children:x("providers")}),..._,children:e(Ai,{realmComponents:n,refresh:i})})]}):e(tt,{})},Ma={theme:"",themeType:"",locale:"",hasWords:[]},Ri=({defaultSupportedLocales:T,defaultLocales:x})=>{const{adminClient:t}=Se(),{t:n}=ue(),{realm:u}=Te(),r=ht(),{whoAmI:d}=Pt(),i=Lr(),[c,m]=J(!1),[_,k]=J(!1),[y,h]=J(!1),[p,s]=J(!1),[f,o]=J(!1),[g,w]=J({}),[I,S]=J(0),L=r.themes,A=ot(()=>L?i(Object.keys(L),K=>K):[],[L]),O=ot(()=>L?i(Object.values(L).flatMap(K=>K.map(M=>M.name)).filter((K,M,$)=>$.indexOf(K)===M),K=>K):[],[L]),P=ot(()=>Array.from(new Set([...x,...T])),[x,T]),R={theme:n("theme"),themeType:n("themeType"),locale:n("language"),hasWords:n("hasWords")},{getValues:G,reset:C,formState:{isDirty:F,isValid:l},control:B}=He({mode:"onChange",defaultValues:Ma}),ee=async()=>{try{const K=G();if(["theme","themeType","locale"].some(ce=>!K[ce]))return[];const ae=await t.serverInfo.findEffectiveMessageBundles({realm:u,...K,locale:K.locale||je,source:!0}),be=K.hasWords.length>0?ae.filter(ce=>K.hasWords.some(Y=>ce.value.includes(Y)||ce.key.includes(Y))):ae;return i([...be],Pr("key"))}catch{return[]}};function W(){m(!1),N()}function ie(){C(),N()}function q(K){const M={...G()};delete M[K],C({...Ma,...M}),N()}function ne(K,M){const $=G(),ae=$[K],be=Array.isArray(ae)?ae.filter(re=>re!==M):ae;C({...$,[K]:be}),N()}function N(){const K=Rr(G(),M=>M!==""||Array.isArray(M)&&M.length>0);w(K),S(I+1)}const D=()=>H(Xt,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"},children:[e(Ve,{children:e(yt,{children:e(Ge,{className:"pf-v5-u-mb-md pf-v5-u-mt-0 pf-v5-u-mr-md",component:pa.p,children:n("effectiveMessageBundlesDescription")})})}),e(Ve,{children:e(Ar,{buttonText:n("searchForEffectiveMessageBundles"),setSearchDropdownOpen:m,searchDropdownOpen:c,marginRight:"2.5rem",width:"15vw",children:H(kt,{isHorizontal:!0,className:"pf-v5-u-w-25vw","data-testid":"effectiveMessageBundlesSearchForm",onSubmit:K=>K.preventDefault(),children:[e(se,{label:n("theme"),fieldId:"kc-theme",isRequired:!0,children:e(fe,{name:"theme",control:B,defaultValue:"",rules:{validate:K=>(K||"").length>0},render:({field:K})=>e(Ze,{"data-testid":"effective_message_bundles-theme-searchField",chipGroupProps:{numChips:1,expandedText:n("hide"),collapsedText:n("showRemaining")},variant:Qe.single,typeAheadAriaLabel:"Select",onToggle:M=>h(M),selections:K.value,onSelect:M=>{K.onChange(M.toString()),h(!1)},onClear:()=>{K.onChange("")},isOpen:y,"aria-label":n("selectTheme"),chipGroupComponent:e(xt,{children:e(ft,{onClick:M=>{M.stopPropagation(),K.onChange("")},children:K.value},K.value)}),children:[e(Le,{label:n("selectTheme"),isDisabled:!0,children:n("selectTheme")},"theme_placeholder")].concat(O.map(M=>e(Le,{value:M,children:M},M)))})})}),e(se,{label:n("themeType"),fieldId:"kc-themeType",isRequired:!0,children:e(fe,{name:"themeType",control:B,defaultValue:"",rules:{validate:K=>(K||"").length>0},render:({field:K})=>e(Ze,{"data-testid":"effective-message-bundles-feature-searchField",chipGroupProps:{numChips:1,expandedText:n("hide"),collapsedText:n("showRemaining")},variant:Qe.single,typeAheadAriaLabel:"Select",onToggle:M=>s(M),selections:K.value,onSelect:M=>{K.onChange(M.toString()),s(!1)},onClear:()=>{K.onChange("")},isOpen:p,"aria-label":n("selectThemeType"),chipGroupComponent:e(xt,{children:e(ft,{onClick:M=>{M.stopPropagation(),K.onChange("")},children:K.value},K.value)}),children:[e(Le,{label:n("selectThemeType"),isDisabled:!0,children:n("selectThemeType")},"themeType_placeholder")].concat(A.map(M=>e(Le,{value:M,children:M},M)))})})}),e(se,{label:n("language"),fieldId:"kc-language",isRequired:!0,children:e(fe,{name:"locale",control:B,defaultValue:"",rules:{validate:K=>(K||"").length>0},render:({field:K})=>e(Ze,{"data-testid":"effective-message-bundles-language-searchField",chipGroupProps:{numChips:1,expandedText:n("hide"),collapsedText:n("showRemaining")},variant:Qe.single,typeAheadAriaLabel:"Select",onToggle:M=>o(M),selections:K.value,onSelect:M=>{K.onChange(M.toString()),o(!1)},onClear:()=>{K.onChange("")},isOpen:f,"aria-label":n("selectLanguage"),chipGroupComponent:e(xt,{children:K.value?e(ft,{onClick:M=>{M.stopPropagation(),K.onChange("")},children:Xe(K.value,d.getLocale())},K.value):null}),children:[e(Le,{label:n("selectLanguage"),isDisabled:!0,children:n("selectLanguage")},"language_placeholder")].concat(P.map(M=>e(Le,{value:M,children:Xe(M,d.getLocale())},M)))})})}),e(se,{label:n("hasWords"),fieldId:"kc-hasWords",children:e(fe,{name:"hasWords",control:B,render:({field:K})=>H("div",{children:[e(Dt,{id:"kc-hasWords","data-testid":"effective-message-bundles-hasWords-searchField",value:K.value.join(" "),onChange:M=>{const ae=M.target.value;if(ae.trim().length===0)K.onChange([]);else{const be=ae.split(" ").map(re=>re.trim());K.onChange(be)}}}),e(xt,{children:K.value.map((M,$)=>e(ft,{onClick:ae=>{ae.stopPropagation();const be=K.value.filter((re,ce)=>ce!==$);K.onChange(be)},children:M},$))})]})})}),H(Ue,{className:"pf-v5-u-mt-sm",children:[e(oe,{variant:"primary",onClick:()=>{k(!0),W()},"data-testid":"search-effective-message-bundles-btn",isDisabled:!l,children:n("search")}),e(oe,{variant:"secondary",onClick:ie,"data-testid":"reset-search-effective-message-bundles-btn",isDisabled:!F,children:n("reset")})]})]})})}),e(Ve,{children:Object.entries(g).length>0&&e(ye,{children:Object.entries(g).map(K=>{const[M,$]=K;return e(xt,{className:"pf-v5-u-mt-md pf-v5-u-mr-md",categoryName:R[M],isClosable:!0,onClick:()=>q(M),children:typeof $=="string"?e(ft,{isReadOnly:!0,children:M==="locale"?Xe($,d.getLocale())?.toLowerCase():$}):$.map(ae=>e(ft,{onClick:()=>ne(M,ae),children:ae},ae))},M)})})})]});return _?e(nt,{loader:ee,ariaLabelKey:"effectiveMessageBundles",toolbarItem:D(),columns:[{name:"key",displayKey:"key"},{name:"value",displayKey:"value"}],emptyState:e(qe,{message:n("noSearchResults"),instructions:n("noSearchResultsInstructions")}),isSearching:Object.keys(g).length>0},I):H(ye,{children:[e("div",{className:"pf-v5-u-py-lg pf-v5-u-pl-md",children:D()}),e(at,{}),e(qe,{message:n("emptyEffectiveMessageBundles"),instructions:n("emptyEffectiveMessageBundlesInstructions"),isSearchVariant:!0})]})},Di=({handleModalToggle:T,save:x,form:t})=>{const{t:n}=ue();return e(ut,{variant:bt.small,title:n("addTranslation"),isOpen:!0,onClose:T,actions:[e(oe,{"data-testid":"add-translation-confirm-button",variant:"primary",type:"submit",form:"translation-form",children:n("create")},"confirm"),e(oe,{id:"modal-cancel","data-testid":"cancel",variant:Ie.link,onClick:()=>{T()},children:n("cancel")},"cancel")],children:e(kt,{id:"translation-form",isHorizontal:!0,onSubmit:t.handleSubmit(x),children:H($e,{...t,children:[e(Ae,{name:"key",label:n("key"),autoFocus:!0,rules:{required:n("required")}}),e(Ae,{name:"value",label:n("value"),rules:{required:n("required")}})]})})})},Oi=({internationalizationEnabled:T,watchSupportedLocales:x,realm:t,tableData:n})=>{const{adminClient:u}=Se(),{t:r}=ue(),[d,i]=J(!1),[c,m]=J(!1),[_,k]=J([]),[y,h]=J(je),[p,s]=J(!1),{getValues:f,handleSubmit:o}=He(),[g,w]=J(!1),[I,S]=J([]),[L,A]=J(0),[O,P]=J(10),[R,G]=J(0),[C,F]=J(""),l=He({mode:"onChange"}),{addAlert:B,addError:ee}=Oe(),{realm:W}=Te(),{whoAmI:ie}=Pt(),[q,ne]=J([]),[N,D]=J(!1),[K,M]=J({}),[$,ae]=J(""),be=()=>{A(L+1)};rt(()=>{(async()=>{try{let b=await u.realms.getRealmLocalizationTexts({first:R,max:O,realm:t.realm,selectedLocale:y||f("defaultLocale")||ie.getLocale()});if(k(Object.entries(b)),C){const E=Z=>Object.entries(b).filter(z=>z[Z].includes(C)),V=Jr(E(0).concat(E(1)),on);b=Object.fromEntries(V)}return Object.entries(b).slice(R,R+O)}catch{return[]}})().then(b=>{const E=b.map(V=>({rowEditBtnAriaLabel:()=>r("rowEditBtnAriaLabel",{translation:V[1]}),rowSaveBtnAriaLabel:()=>r("rowSaveBtnAriaLabel",{translation:V[1]}),rowCancelBtnAriaLabel:()=>r("rowCancelBtnAriaLabel",{translation:V[1]}),cells:[{title:V[0],props:{value:V[0]}},{title:V[1],props:{value:V[1]}}]}));S(E)})},[L,n,R,O,C]);const re=()=>{i(!d)},ce=[e(fa,{label:r("defaultLocale"),children:e(Le,{value:je,children:Xe(je,ie.getDisplayName())},je)},"group1"),e(at,{},"divider"),e(fa,{label:r("supportedLocales"),children:x.map(v=>e(Le,{value:v,children:Xe(v,ie.getLocale())},v))},"group2")],Y=async v=>{try{await u.realms.addLocalization({realm:W,selectedLocale:y||f("defaultLocale")||je,key:v.key},v.value),u.setConfig({realmName:W}),be(),l.setValue("key",""),l.setValue("value",""),aa.reloadResources(),B(r("addTranslationSuccess"),Ee.success)}catch(b){ee("addTranslationError",b)}},[de,xe]=De({titleKey:"deleteConfirmTranslationTitle",messageKey:r("translationDeleteConfirmDialog",{count:q.length}),continueButtonLabel:"delete",continueButtonVariant:Ie.danger,onCancel:()=>{ne([]),D(!1)},onConfirm:async()=>{try{for(const v of q)delete aa.store.data[ie.getLocale()][W][v],await u.realms.deleteRealmLocalizationTexts({realm:W,selectedLocale:y,key:v});D(!1),ne([]),be(),B(r("deleteAllTranslationsSuccess"),Ee.success)}catch(v){ee("deleteAllTranslationsError",v)}}}),Pe=(v,b)=>{const E=(I[b].cells?.[0]).props.value;v.target.checked?ne(V=>[...V,E]):ne(V=>V.filter(Z=>Z!==E)),D(I.length===q.length+(v.target.checked?1:-1))},a=()=>{ne(N?[]:I.map(v=>(v.cells?.[0]).props.value)),D(!N)},j=v=>q.includes(v),U=async(v,b)=>{const E=Aa(I),V=Aa(E[b]);(V.cells?.[1]).props.value=v,E[b]=V;try{const Z=(V.cells?.[0]).props.value,z=(V.cells?.[1]).props.value;await u.realms.addLocalization({realm:t.realm,selectedLocale:y||f("defaultLocale")||je,key:Z},z),aa.reloadResources(),B(r("updateTranslationSuccess"),Ee.success),S(E)}catch(Z){ee("updateTranslationError",Z)}M(Z=>({...Z,[b]:!1}))};return H(ye,{children:[e(xe,{}),d&&e(Di,{handleModalToggle:re,save:v=>{Y(v),re()},form:l}),e(yt,{children:e(Ge,{className:"pf-v5-u-mt-lg pf-v5-u-ml-md",component:pa.p,children:r("realmOverridesDescription")})}),H(Xn,{count:_.length,first:R,max:O,onNextClick:G,onPreviousClick:G,onPerPageSelect:(v,b)=>{G(v),P(b)},inputGroupName:"search",inputGroupOnEnter:v=>{F(v),G(0),P(10)},inputGroupPlaceholder:r("searchForTranslation"),toolbarItem:H(ye,{children:[e(oe,{"data-testid":"add-translationBtn",onClick:()=>{i(!0),D(!1),ne([])},children:r("addTranslation")}),e(Be,{children:e(Wa,{onOpenChange:v=>s(v),toggle:v=>e(qa,{ref:v,onClick:()=>s(!p),variant:"plain",isExpanded:p,"data-testid":"toolbar-deleteBtn","aria-label":"kebab",children:e($a,{})}),isOpen:p,isPlain:!0,children:e(Za,{children:e(At,{component:"button","data-testid":"delete-selected-TranslationBtn",isDisabled:_.length===0||q.length===0,onClick:()=>{de(),s(!1)},children:r("delete")},"action")})})})]}),searchTypeComponent:e(Be,{children:e(Ze,{width:180,isOpen:c,className:"kc-filter-by-locale-select",variant:Qe.single,isDisabled:!T,onToggle:v=>m(v),onSelect:v=>{h(v.toString()),w(!0),be(),m(!1)},selections:g?Xe(y,ie.getLocale()):t.defaultLocale!==""?Xe(je,ie.getLocale()):r("placeholderText"),children:ce})}),children:[_.length===0&&!C&&e(qe,{hasIcon:!0,message:r("noTranslations"),instructions:r("noTranslationsInstructions"),onPrimaryAction:re}),_.length===0&&C&&e(qe,{hasIcon:!0,icon:Ya,isSearchVariant:!0,message:r("noSearchResults"),instructions:r("noRealmOverridesSearchResultsInstructions")}),_.length!==0&&H(Qn,{"aria-label":r("editableRowsTable"),"data-testid":"editable-rows-table",children:[e(er,{children:H(Ea,{children:[e(Ht,{className:"pf-v5-u-px-lg",children:e("input",{type:"checkbox","aria-label":r("selectAll"),checked:N,onChange:a,"data-testid":"selectAll"})}),e(Ht,{className:"pf-v5-u-py-lg",children:r("key")}),e(Ht,{className:"pf-v5-u-py-lg",children:r("value")}),e(Ht,{"aria-hidden":"true"})]})}),e(tr,{children:I.map((v,b)=>H(Ea,{children:[e(Kt,{className:"pf-v5-u-px-lg",select:{rowIndex:b,onSelect:E=>Pe(E,b),isSelected:j((v.cells?.[0]).props.value)}}),e(Kt,{className:"pf-m-sm pf-v5-u-px-sm",dataLabel:r("key"),children:(v.cells?.[0]).props.value}),e(Kt,{className:"pf-m-sm pf-v5-u-px-sm",dataLabel:r("value"),children:e(kt,{isHorizontal:!0,className:"kc-form-translationValue",onSubmit:o(()=>{U($,b)}),children:e(se,{fieldId:"kc-translationValue",className:"pf-v5-u-display-inline-block",children:K[b]?H(ye,{children:[e(Dt,{"aria-label":r("editTranslationValue"),type:"text",className:"pf-v5-u-w-initial","data-testid":`editTranslationValueInput-${b}`,value:$,onChange:(E,V)=>{ae(V)}},`edit-input-${b}`),e(oe,{variant:"link",className:"pf-m-plain","data-testid":`editTranslationAcceptBtn-${b}`,type:"submit","aria-label":r("acceptBtn"),icon:e(ar,{})}),e(oe,{variant:"link",className:"pf-m-plain","data-testid":`editTranslationCancelBtn-${b}`,icon:e(nr,{}),"aria-label":r("cancelBtn"),onClick:()=>{M(E=>({...E,[b]:!1}))}})]}):H(ye,{children:[e("span",{children:(v.cells?.[1]).props.value}),e(oe,{onClick:()=>{const E=(I[b].cells?.[1]).props.value;ae(E),M(V=>({...V,[b]:!0}))},"aria-label":r("editBtn"),variant:"link",className:"pf-m-plain","data-testid":`editTranslationBtn-${b}`,children:e(Or,{})},`edit-button-${b}`)]})})})},b),e(Kt,{isActionCell:!0,children:e(rr,{items:[{title:r("delete"),onClick:()=>{ne([(v.cells?.[0]).props.value]),_.length===1&&D(!0),de(),s(!1)}}]})})]},(v.cells?.[0]).props.value))})]})]})]})},zi=({save:T,realm:x,tableData:t})=>{const{t:n}=ue(),{whoAmI:u}=Pt(),[r,d]=J(0),i=wt(),{control:c,reset:m,handleSubmit:_,formState:k}=i,y=x.supportedLocales?.length?x.supportedLocales:[je],h=ht().themes,p=ot(()=>{const g=Object.values(h).flatMap(w=>w.flatMap(({locales:I})=>I||[]));return Array.from(new Set(g))},[h]),s=We({control:c,name:"supportedLocales",defaultValue:y}),f=We({control:c,name:"internationalizationEnabled",defaultValue:x.internationalizationEnabled}),o=We({name:"defaultLocale",control:c,defaultValue:"en"});return H(Ot,{activeKey:r,onSelect:(g,w)=>d(w),children:[e(me,{id:"locales",eventKey:0,title:e(pe,{children:n("locales")}),"data-testid":"rs-localization-locales-tab",children:H(_e,{isHorizontal:!0,role:"manage-realm",className:"pf-v5-u-mt-lg pf-v5-u-ml-md",onSubmit:_(T),children:[H($e,{...i,children:[e(Ha,{name:"internationalizationEnabled",label:n("internationalization"),labelIcon:n("internationalizationHelp"),labelOn:n("enabled"),labelOff:n("disabled"),"aria-label":n("internationalization")}),f&&H(ye,{children:[e(Me,{name:"supportedLocales",isScrollable:!0,label:n("supportedLocales"),controller:{defaultValue:y},variant:"typeaheadMulti",placeholderText:n("selectLocales"),options:p.map(g=>({key:g,value:Xe(g,u.getLocale())||g}))}),e(Me,{name:"defaultLocale",label:n("defaultLocale"),controller:{defaultValue:je},"data-testid":"select-default-locale",options:s.map(g=>({key:g,value:Xe(g,u.getLocale())||g}))})]})]}),H(Ue,{children:[e(oe,{variant:"primary",isDisabled:!k.isDirty,type:"submit","data-testid":"localization-tab-save",children:n("save")}),e(oe,{variant:"link",onClick:()=>m(x),children:n("revert")})]})]})}),e(me,{id:"realm-overrides",eventKey:1,title:H(pe,{children:[n("realmOverrides")," "]}),"data-testid":"rs-localization-realm-overrides-tab",children:e(Oi,{internationalizationEnabled:f||!1,watchSupportedLocales:s||[],realm:x,tableData:t})}),e(me,{id:"effective-message-bundles",eventKey:2,title:e(pe,{children:n("effectiveMessageBundles")}),"data-testid":"rs-localization-effective-message-bundles-tab",children:e(Ri,{defaultSupportedLocales:y,defaultLocales:[o]})})]})},st=({fieldName:T,url:x})=>{const{t}=ue(),n=T.substring(T.indexOf(".")+1);return e(Ae,{name:T,label:t(n),labelIcon:H($t,{i18nKey:`${n}Help`,children:["Default value prevents pages from being included",e(Zt,{href:x,title:t("learnMore")})]})})},Ni=({realm:T,save:x})=>{const{t}=ue(),n=wt(),{reset:u,formState:{isDirty:r},handleSubmit:d}=n;return H(_e,{isHorizontal:!0,role:"manage-realm",className:"keycloak__security-defences__form",onSubmit:d(x),children:[e(st,{fieldName:"browserSecurityHeaders.xFrameOptions",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"}),e(st,{fieldName:"browserSecurityHeaders.contentSecurityPolicy",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"}),e(st,{fieldName:"browserSecurityHeaders.contentSecurityPolicyReportOnly",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only"}),e(st,{fieldName:"browserSecurityHeaders.xContentTypeOptions",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"}),e(st,{fieldName:"browserSecurityHeaders.xRobotsTag",url:"https://developers.google.com/search/docs/advanced/robots/robots_meta_tag"}),e(st,{fieldName:"browserSecurityHeaders.strictTransportSecurity",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security"}),e(st,{fieldName:"browserSecurityHeaders.referrerPolicy",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy"}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"headers-form-tab-save",isDisabled:!r,children:t("save")}),e(oe,{variant:"link",onClick:()=>u(T),children:t("revert")})]})]})},Gt=({name:T,style:x})=>{const{t}=ue();return e(sn,{name:T,style:x,label:t(T),labelIcon:t(`${T}Help`),controller:{defaultValue:"",rules:{required:t("required")}}})},Fi=({realm:T,save:x})=>{const{t}=ue(),n=He(),{setValue:u,handleSubmit:r,formState:{isDirty:d}}=n,[i,c]=J(!1),[m,_]=J(!1);let k;(f=>{f.Disabled="Disabled",f.PermanentLockout="PermanentLockout",f.TemporaryLockout="TemporaryLockout",f.PermanentAfterTemporaryLockout="PermanentAfterTemporaryLockout"})(k||(k={}));const y=["Disabled","PermanentLockout","TemporaryLockout","PermanentAfterTemporaryLockout"],h=["MULTIPLE","LINEAR"],p=()=>{Rt(T,u),_(!1)};rt(p,[]);const s=n.getValues("bruteForceProtected")?n.getValues("permanentLockout")?n.getValues("maxTemporaryLockouts")==0?"PermanentLockout":"PermanentAfterTemporaryLockout":"TemporaryLockout":"Disabled";return e($e,{...n,children:H(_e,{role:"manage-realm",isHorizontal:!0,onSubmit:r(x),children:[e(se,{label:t("bruteForceMode"),fieldId:"kc-brute-force-mode",labelIcon:e(he,{helpText:t("bruteForceModeHelpText"),fieldLabelId:"bruteForceMode"}),children:e(Ze,{toggleId:"kc-brute-force-mode",onToggle:()=>c(!i),onSelect:f=>{switch(f){case"Disabled":n.setValue("bruteForceProtected",!1),n.setValue("permanentLockout",!1),n.setValue("maxTemporaryLockouts",0);break;case"TemporaryLockout":n.setValue("bruteForceProtected",!0),n.setValue("permanentLockout",!1),n.setValue("maxTemporaryLockouts",0);break;case"PermanentLockout":n.setValue("bruteForceProtected",!0),n.setValue("permanentLockout",!0),n.setValue("maxTemporaryLockouts",0);break;case"PermanentAfterTemporaryLockout":n.setValue("bruteForceProtected",!0),n.setValue("permanentLockout",!0),n.setValue("maxTemporaryLockouts",1);break}_(!0),c(!1)},selections:s,variant:Qe.single,isOpen:i,"data-testid":"select-brute-force-mode","aria-label":t("selectUnmanagedAttributePolicy"),children:y.map(f=>e(Le,{value:f,children:t(`bruteForceMode.${f}`)},f))})}),s!=="Disabled"&&H(ye,{children:[e(na,{name:"failureFactor",label:t("failureFactor"),labelIcon:t("failureFactorHelp"),controller:{defaultValue:0,rules:{required:t("required")}}}),s==="PermanentAfterTemporaryLockout"&&e(na,{name:"maxTemporaryLockouts",label:t("maxTemporaryLockouts"),labelIcon:t("maxTemporaryLockoutsHelp"),controller:{defaultValue:0}}),(s==="TemporaryLockout"||s==="PermanentAfterTemporaryLockout")&&H(ye,{children:[e(Me,{name:"bruteForceStrategy",label:t("bruteForceStrategy"),labelIcon:t("bruteForceStrategyHelp"),controller:{defaultValue:""},options:h.map(f=>({key:f,value:t(`bruteForceStrategy.${f}`)}))}),e(Gt,{name:"waitIncrementSeconds"}),e(Gt,{name:"maxFailureWaitSeconds"}),e(Gt,{name:"maxDeltaTimeSeconds"})]}),e(na,{name:"quickLoginCheckMilliSeconds",label:t("quickLoginCheckMilliSeconds"),labelIcon:t("quickLoginCheckMilliSecondsHelp"),controller:{defaultValue:0}}),e(Gt,{name:"minimumQuickLoginWaitSeconds"})]}),H(Ue,{children:[e(oe,{variant:"primary",type:"submit","data-testid":"brute-force-tab-save",isDisabled:!d&&!m,children:t("save")}),e(oe,{variant:"link",onClick:p,children:t("revert")})]})]})})},Bi=({realm:T,save:x})=>{const{t}=ue(),[n,u]=J(10);return H(Ot,{activeKey:n,onSelect:(r,d)=>u(d),children:[e(me,{id:"headers",eventKey:10,"data-testid":"security-defenses-headers-tab",title:e(pe,{children:t("headers")}),children:e(Ce,{variant:"light",children:e(Ni,{realm:T,save:x})})}),e(me,{id:"bruteForce",eventKey:20,"data-testid":"security-defenses-brute-force-tab",title:e(pe,{children:t("bruteForceDetection")}),children:e(Ce,{variant:"light",children:e(Fi,{realm:T,save:x})})})]})},Ui=({setTableData:T})=>{const{adminClient:x}=Se(),{config:t,save:n}=ka(),{t:u}=ue(),r=va(),d=_t(),{realm:i}=Te(),[c,m]=J(0),[_,k]=J();rt(()=>m(f=>f+1),[t]);async function y(){return t?.groups??[]}const[h,p]=De({titleKey:"deleteDialogTitle",children:H($t,{i18nKey:"deleteDialogDescription",children:[" ",e("strong",{children:{group:_?.name}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:Ie.danger,onConfirm:async()=>{const f=(t?.groups??[]).filter(w=>w!==_),o=_?.displayHeader?.substring(2,_?.displayHeader.length-1),g=_?.displayDescription?.substring(2,_?.displayDescription.length-1);try{await Promise.all(r.map(async w=>{try{if(await x.realms.getRealmLocalizationTexts({realm:i,selectedLocale:w})){await x.realms.deleteRealmLocalizationTexts({realm:i,selectedLocale:w,key:o}),await x.realms.deleteRealmLocalizationTexts({realm:i,selectedLocale:w,key:g});const S=await x.realms.getRealmLocalizationTexts({realm:i,selectedLocale:w});T([S])}}catch{console.error(`Error removing translations for ${w}`)}})),n({...t,groups:f},{successMessageKey:"deleteSuccess",errorMessageKey:"deleteAttributeGroupError"})}catch(w){console.error(`Error removing translations or updating attributes group: ${w}`)}}});function s(f){k(f),h()}return H(Ce,{variant:"light",className:"pf-v5-u-p-0",children:[e(p,{}),e(nt,{loader:y,ariaLabelKey:"tableTitle",toolbarItem:e(Be,{children:e(oe,{component:f=>e(Fe,{"data-testid":"create-attributes-groups-action",...f,to:La({realm:i})}),children:u("createGroupText")})}),columns:[{name:"name",displayKey:"columnName",cellRenderer:f=>e(Fe,{to:ir({realm:i,name:f.name}),children:f.name})},{name:"displayHeader",displayKey:"columnDisplayName"},{name:"displayDescription",displayKey:"columnDisplayDescription"}],actions:[{title:u("delete"),onRowClick:s}],emptyState:e(qe,{message:u("emptyStateMessage"),instructions:u("emptyStateInstructions"),primaryActionText:u("createGroupText"),onPrimaryAction:()=>d(La({realm:i}))})},c)]})},Mi=["username","email"],Vi=({setTableData:T})=>{const{adminClient:x}=Se(),{config:t,save:n}=ka(),{realm:u}=Te(),{t:r}=ue(),d=va(),i=_t(),[c,m]=J("allGroups"),[_,k]=ct(),[y,h]=J(t?.attributes),[p,s]=J(""),[f,o]=De({titleKey:r("deleteAttributeConfirmTitle"),messageKey:r("deleteAttributeConfirm",{attributeName:p}),continueButtonLabel:r("delete"),continueButtonVariant:Ie.danger,onConfirm:async()=>{if(!t?.attributes)return;const L=t.attributes.find(O=>O.name===p)?.displayName,A=L?.substring(2,L.length-1);try{await Promise.all(d.map(async P=>{try{if(await x.realms.getRealmLocalizationTexts({realm:u,selectedLocale:P})){await x.realms.deleteRealmLocalizationTexts({realm:u,selectedLocale:P,key:A});const G=await x.realms.getRealmLocalizationTexts({realm:u,selectedLocale:P});T([G])}}catch{console.error(`Error removing translations for ${P}`)}}));const O=t.attributes.filter(P=>P.name!==p);n({...t,attributes:O,groups:t.groups},{successMessageKey:"deleteAttributeSuccess",errorMessageKey:"deleteAttributeError"}),s("")}catch(O){console.error(`Error removing translations or updating attributes: ${O}`)}}});if(!t)return e(tt,{});const g=t.attributes??[],w=t.groups??[],I=async(L,A)=>{const O=g.findIndex(R=>R.name===L.name);let P={};P=g[O],g.splice(O,1),g.splice(A,0,P),n({attributes:g,groups:w},{successMessageKey:"updatedUserProfileSuccess",errorMessageKey:"updatedUserProfileError"})},S=L=>e(Fe,{to:Pa({realm:u,attributeName:L.name}),children:L.name},L.name);return H(ye,{children:[e(Ja,{children:H(sr,{children:[e(Be,{children:e(Ze,{toggleId:"kc-group-filter",width:200,"data-testid":"filter-select",isOpen:_,variant:Qe.single,onToggle:k,toggleIcon:e(ln,{}),onSelect:L=>{const A=L.toString();m(A),h(A==="allGroups"?g:g.filter(O=>O.group===A)),k()},selections:c==="allGroups"?r(c):c,children:[e(Le,{"data-testid":"all-groups",value:"allGroups",children:r("allGroups")},"allGroups"),...or(g.filter(L=>!!L.group),"group").map(L=>e(Le,{value:L.group,children:L.group},L.group))]})}),e(Be,{className:"kc-toolbar-attributesTab",children:e(oe,{"data-testid":"createAttributeBtn",variant:"primary",component:L=>e(Fe,{...L,to:lr({realm:u})}),children:r("createAttribute")})})]})}),e(at,{}),e(o,{}),e(cn,{keyField:"name",onDragFinish:async(L,A)=>{const O=g.map(C=>C.name),P=A.indexOf(L),R=O.indexOf(L),G=g[R];G.name&&I(G,P)},actions:[{title:r("edit"),onClick:(L,A,O)=>{i(Pa({realm:u,attributeName:O.name}))}},{title:r("delete"),isActionable:({name:L})=>!Mi.includes(L),onClick:(L,A,O)=>{s(O.name),f()}}],columns:[{name:"name",displayKey:r("attributeName"),cellRenderer:S},{name:"displayName",displayKey:r("attributeDisplayName")},{name:"group",displayKey:r("attributeGroup")}],data:y??g})]})},Hi=()=>{const{config:T,save:x,isSaving:t}=ka(),{t:n}=ue(),{addError:u}=Oe(),[r,d]=J(vt(T));function i(){d(T?vt(T):"")}async function c(){const m=r;if(m)try{await x(JSON.parse(m))}catch(_){u("invalidJsonError",_);return}}return H(Ce,{variant:"light",children:[e(ya,{language:"json",value:r,onChange:m=>d(m??""),height:480}),e(kt,{children:H(Ue,{children:[e(oe,{"data-testid":"save",variant:"primary",onClick:c,isDisabled:t,children:n("save")}),e(oe,{variant:"link",onClick:i,isDisabled:t,children:n("revert")})]})})]})},Ki=({setTableData:T})=>{const{realm:x}=Te(),{t}=ue(),n=i=>lt(Ra({realm:x,tab:i})),u=n("attributes"),r=n("attributes-group"),d=n("json-editor");return e(zr,{children:H(Lt,{defaultLocation:Ra({realm:x,tab:"attributes"}),mountOnEnter:!0,children:[e(me,{title:e(pe,{children:t("attributes")}),"data-testid":"attributesTab",...u,children:e(Vi,{setTableData:T})}),e(me,{title:e(pe,{children:t("attributesGroup")}),"data-testid":"attributesGroupTab",...r,children:e(Ui,{setTableData:T})}),e(me,{title:e(pe,{children:t("jsonEditor")}),"data-testid":"jsonEditorTab",...d,children:e(Hi,{})})]})})},ji=({save:T,onChange:x,value:t,realmName:n,refresh:u})=>{const{adminClient:r}=Se(),{environment:d}=ma(),{t:i}=ue(),{addAlert:c,addError:m}=Oe(),_=_t(),[k,y]=J(!1),[h,p]=J(!1),{hasAccess:s}=ga(),f=s("manage-realm"),[o,g]=De({titleKey:"disableConfirmTitle",messageKey:"disableConfirmRealm",continueButtonLabel:"disable",onConfirm:()=>{x(!t),T()}}),[w,I]=De({titleKey:"deleteConfirmTitle",messageKey:"deleteConfirmRealmSetting",continueButtonLabel:"delete",continueButtonVariant:Ie.danger,onConfirm:async()=>{try{await r.realms.del({realm:n}),c(i("deletedSuccessRealmSetting"),Ee.success),_(cr({realm:d.masterRealm})),u()}catch(S){m("deleteErrorRealmSetting",S)}}});return H(ye,{children:[e(g,{}),e(I,{}),e(ri,{open:k,toggleDialog:()=>y(!k)}),e(ni,{isOpen:h,onClose:()=>p(!1)}),e(pr,{titleKey:n,subKey:"realmSettingsExplain",helpUrl:dr.realmSettingsUrl,divider:!1,dropdownItems:[e(At,{"data-testid":"openPartialImportModal",isDisabled:!f,onClick:()=>{y(!0)},children:i("partialImport")},"import"),e(At,{"data-testid":"openPartialExportModal",isDisabled:!f,onClick:()=>p(!0),children:i("partialExport")},"export"),e(at,{},"separator"),e(At,{isDisabled:!f,onClick:w,children:i("delete")},"delete")],isEnabled:t,isReadOnly:!f,onToggle:S=>{S?(x(S),T()):o()}})]})},Gi=()=>{const{adminClient:T}=Se(),{t:x}=ue(),{addAlert:t,addError:n}=Oe(),{realm:u,realmRepresentation:r,refresh:d}=Te(),i=va(),c=_t(),m=Yt(),[_,k]=J(void 0),y=He({mode:"onChange"}),{control:h,setValue:p,getValues:s}=y,[f,o]=J(0),g=()=>{o(f+1)},w=(ae=r)=>{Rt(ae,p)};rt(()=>{w(),(async()=>{try{await Promise.all(i.map(async be=>{try{const re=await T.realms.getRealmLocalizationTexts({realm:u,selectedLocale:be});re&&k([re])}catch{return[]}}))}catch{return[]}})()},[p,r]);const I=async ae=>{ae=ur(ae),ae.attributes?.["acr.loa.map"]&&typeof ae.attributes["acr.loa.map"]!="string"&&(ae.attributes["acr.loa.map"]=JSON.stringify(Object.fromEntries(ae.attributes["acr.loa.map"].filter(({key:re})=>re!=="").map(({key:re,value:ce})=>[re,ce]))));try{const re={...r,...ae,id:ae.realm};re.smtpServer?.port===""&&(re.smtpServer={...re.smtpServer,port:null});const ce=await hr(Ga(T.baseUrl,`admin/realms/${u}/ui-ext`),{method:"PUT",body:JSON.stringify(re),headers:{"Content-Type":"application/json",...fr(await T.getAccessToken())}});if(!ce.ok)throw new Error(ce.statusText);t(x("realmSaveSuccess"),Ee.success)}catch(re){n("realmSaveError",re)}u!==(ae.realm||r?.realm)&&c(ra({realm:ae.realm,tab:"general"})),d()},S=ae=>lt(ra({realm:u,tab:ae})),L=S("general"),A=S("login"),O=S("email"),P=S("themes"),R=S("keys"),G=S("events"),C=S("localization"),F=S("security-defenses"),l=S("sessions"),B=S("tokens"),ee=S("client-policies"),W=S("user-profile"),ie=S("user-registration"),{hasAccess:q,hasSomeAccess:ne}=ga(),N=q("view-realm")&&ne("view-events","manage-events"),D=q("view-realm")&&ne("view-clients","manage-clients"),K=ae=>lt(ca({realm:u,tab:ae})),M=K("profiles"),$=K("policies");return H($e,{...y,children:[e(fe,{name:"enabled",defaultValue:!0,control:h,render:({field:ae})=>e(ji,{value:ae.value,onChange:ae.onChange,realmName:u,refresh:g,save:()=>I(s())})}),e(Ce,{variant:"light",className:"pf-v5-u-p-0",children:H(Lt,{isBox:!0,mountOnEnter:!0,"aria-label":"realm-settings-tabs",defaultLocation:ra({realm:u,tab:"general"}),children:[e(me,{title:e(pe,{children:x("general")}),"data-testid":"rs-general-tab",...L,children:e(Qr,{realm:r,save:I})}),e(me,{title:e(pe,{children:x("login")}),"data-testid":"rs-login-tab",...A,children:e(ai,{refresh:d,realm:r})}),e(me,{title:e(pe,{children:x("email")}),"data-testid":"rs-email-tab",...O,children:e(Xr,{realm:r,save:I})}),e(me,{title:e(pe,{children:x("themes")}),"data-testid":"rs-themes-tab",...P,children:e(gi,{realm:r,save:I})}),e(me,{title:e(pe,{children:x("keys")}),"data-testid":"rs-keys-tab",...R,children:e(Pi,{})}),N&&e(me,{title:e(pe,{children:x("events")}),"data-testid":"rs-realm-events-tab",...G,children:e(wi,{realm:r})}),e(me,{title:e(pe,{children:x("localization")}),"data-testid":"rs-localization-tab",...C,children:e(zi,{save:I,realm:r,tableData:_},f)}),e(me,{title:e(pe,{children:x("securityDefences")}),"data-testid":"rs-security-defenses-tab",...F,children:e(Bi,{realm:r,save:I})}),e(me,{title:e(pe,{children:x("sessions")}),"data-testid":"rs-sessions-tab",...l,children:e(li,{realm:r,save:I},f)}),e(me,{title:e(pe,{children:x("tokens")}),"data-testid":"rs-tokens-tab",...B,children:e(bi,{save:I,realm:r})}),m(pt.ClientPolicies)&&e(me,{title:e(pe,{children:x("clientPolicies")}),"data-testid":"rs-clientPolicies-tab",...ee,children:H(Lt,{mountOnEnter:!0,defaultLocation:ca({realm:u,tab:"profiles"}),children:[e(me,{id:"profiles","data-testid":"rs-policies-clientProfiles-tab","aria-label":x("clientProfilesSubTab"),title:e(pe,{children:x("profiles")}),tooltip:e(Da,{content:x("clientPoliciesProfilesHelpText")}),...M,children:e(oi,{})}),e(me,{id:"policies","data-testid":"rs-policies-clientPolicies-tab","aria-label":x("clientPoliciesSubTab"),...$,title:e(pe,{children:x("policies")}),tooltip:e(Da,{content:x("clientPoliciesPoliciesHelpText")}),children:e(ii,{})})]})}),e(me,{title:e(pe,{children:x("userProfile")}),"data-testid":"rs-user-profile-tab",...W,children:e(Ki,{setTableData:k})}),D&&e(me,{title:e(pe,{children:x("userRegistration")}),"data-testid":"rs-userRegistration-tab",...ie,children:e(yi,{})})]})})]})};function Us(){return e(Gi,{})}export{Us as default};
//# sourceMappingURL=RealmSettingsSection-C9o5VrkJ.js.map
